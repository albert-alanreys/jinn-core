var Ic=Object.defineProperty;var Xn=n=>{throw TypeError(n)};var $c=(n,t,e)=>t in n?Ic(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var T=(n,t,e)=>$c(n,typeof t!="symbol"?t+"":t,e),$s=(n,t,e)=>t.has(n)||Xn("Cannot "+e);var c=(n,t,e)=>($s(n,t,"read from private field"),e?e.call(n):t.get(n)),m=(n,t,e)=>t.has(n)?Xn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),y=(n,t,e,i)=>($s(n,t,"write to private field"),i?i.call(n,e):t.set(n,e),e),d=(n,t,e)=>($s(n,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();class Mi{constructor(t){if(typeof t=="string"){if(this.element=document.querySelector(t),!this.element)throw new Error(`No element found for the selector: "${t}"`)}else if(t instanceof Element||t instanceof Document)this.element=t;else throw new Error("The selector must be a string, HTMLElement, or Document.")}find(t){const e=new Mi(this.element.querySelector(t));if(e)return e;throw new Error(`No element found for the selector: "${t}"`)}findAll(t){const e=this.element.querySelectorAll(t);return Array.from(e).map(i=>new Mi(i))}closest(t){const e=this.element.closest(t);return e?new Mi(e):null}append(t){if(!(t instanceof HTMLElement))throw new Error("The provided childElement must be an instance of HTMLElement.");return this.element.appendChild(t),this}prepend(t){if(!(t instanceof HTMLElement))throw new Error("The provided childElement must be an instance of HTMLElement.");const e=this.element.firstChild;return e?this.element.insertBefore(t,e):this.element.appendChild(t),this}before(t){if(!(t instanceof HTMLElement))throw new Error("The provided newElement must be an instance of HTMLElement.");const e=this.element.parentElement;if(!e)throw new Error("The current element does not have a parent element.");return e.insertBefore(t,this.element),this}html(t){return typeof t>"u"?this.element.innerHTML:(this.element.innerHTML=t,this)}text(t){return typeof t>"u"?this.element.textContent:(this.element.textContent=t,this)}click(t){return this.element.addEventListener("click",t),this}on(t,e){if(typeof t!="string"||typeof e!="function")throw new Error("eventType must be a string and callback must be a function");return this.element.addEventListener(t,e),this}off(t,e){if(typeof t!="string")throw new Error("eventType must be a string");if(e)this.element.removeEventListener(t,e);else if(this.element instanceof Document){const i=()=>{};this.element.addEventListener(t,i),this.element.removeEventListener(t,i)}else{const i=this.element.cloneNode(!0);this.element.parentNode.replaceChild(i,this.element),this.element=i}return this}trigger(t,e={},i={}){if(typeof t!="string")throw new Error("Event name must be a string");const s=new CustomEvent(t,{detail:e,bubbles:i.bubbles??!0,cancelable:i.cancelable??!0,composed:i.composed??!1});return this.element.dispatchEvent(s)}input({onInput:t,...e}){if(this.element.tagName.toLowerCase()!=="input")throw new Error("Element must be an input.");for(const[i,s]of Object.entries(e))this.element.setAttribute(i,s);return t&&this.element.addEventListener("input",t),this}css(t,e){if(typeof t=="string"&&typeof e>"u")return window.getComputedStyle(this.element).getPropertyValue(t);if(typeof t=="object")for(const[i,s]of Object.entries(t))this.element.style[i]=s;else if(typeof t=="string"&&e)this.element.style[t]=e;else throw new Error("Invalid arguments");return this}cursor(t){return this.element===document?document.body.style.cursor=t:this.element.style.cursor=t,this}addClass(t){if(Array.isArray(t))for(const e of t)this.element.classList.add(e);else if(typeof t=="string")this.element.classList.add(t);else throw new Error('The "classNames" parameter must be a string or an array of strings.');return this}removeClass(t){if(Array.isArray(t))for(const e of t)this.element.classList.remove(e);else this.element.classList.remove(t);return this}hasClass(t){if(typeof t!="string")throw new Error("Class name must be a string.");return this.element.classList.contains(t)}attr(t,e){if(typeof t!="string")throw new Error("Attribute name must be a string.");return typeof e>"u"?this.element.getAttribute(t):(this.element.setAttribute(t,e),this)}data(t,e){if(typeof t!="string")throw new Error("Key must be a string.");const i=`data-${t}`;return typeof e>"u"?this.element.getAttribute(i):(this.element.setAttribute(i,e),this)}is(t){if(typeof t!="string")throw new Error("Attribute name must be a string.");const e=this.element.getAttribute(t);return e!==null&&e!=="false"}removeAttr(t){if(typeof t!="string")throw new Error("attrName must be a string");return this.element.removeAttribute(t),this}}const C=n=>new Mi(n);var xs,eh;class Yc{constructor(){m(this,xs);this.state={},this.subscribers=new Map}set(t,e){this.state[t]=e,d(this,xs,eh).call(this,t,e)}get(t){return this.state[t]}subscribe(t,e){this.subscribers.has(t)||this.subscribers.set(t,new Set),this.subscribers.get(t).add(e)}unsubscribe(t,e){if(this.subscribers.has(t)){const i=this.subscribers.get(t);i.delete(e),i.size===0&&this.subscribers.delete(t)}}}xs=new WeakSet,eh=function(t,e){var i;(i=this.subscribers.get(t))==null||i.forEach(s=>s(e))};const _=new Yc,Fc=typeof window.SERVER_URL=="string"&&!window.SERVER_URL.startsWith("{")?window.SERVER_URL:void 0;function Un(n){if(typeof n=="string")return n;if(n!=null&&n.message){if(typeof n.message=="string")return n.message;if(Array.isArray(n.message))return n.message[0]}return n!=null&&n.type?n.type:typeof n=="object"?JSON.stringify(n):"Unknown error occurred"}async function Wc({path:n,method:t="GET",body:e=null,headers:i={}}){let s=!0,r=null,h=null;const o=`${Fc}${n}`,l={method:t,headers:{"Content-Type":"application/json",...i}};e&&(l.body=JSON.stringify(e));try{const a=await fetch(o,l);if(a.ok)h=await a.json();else{const u=await a.json();r=Un(u)}}catch(a){r=Un(a)}finally{s=!1}return{isLoading:s,data:h,error:r}}const qc="_notification_1wo9y_1",Hc="_visible_1wo9y_25",Qc="_content_1wo9y_33",Xc="_info_1wo9y_51",Uc="_success_1wo9y_59",Jc="_warning_1wo9y_67",Zc="_error_1wo9y_75",ms={notification:qc,"slide-up-fade":"_slide-up-fade_1wo9y_1",visible:Hc,content:Qc,info:Xc,success:Uc,warning:Jc,error:Zc};var $e,re,Ai,on;class jc{constructor(){m(this,Ai);m(this,$e,[]);m(this,re,!1)}show(t,e){if(!["info","success","warning","error"].includes(t))throw new Error('Invalid notification type: expected "success" or "error".');c(this,$e).push({type:t,message:e}),c(this,re)||d(this,Ai,on).call(this)}}$e=new WeakMap,re=new WeakMap,Ai=new WeakSet,on=function(){if(c(this,$e).length===0||c(this,re))return;const t=C('[data-ref="notification"]'),{type:e,message:i}=c(this,$e).shift(),s=ms[e],r=parseFloat(t.css("animation-duration"))*1e3,h=r+100,o=r+500;t.find('[data-field="content"]').text(i),t.addClass(ms.visible),t.addClass(s),y(this,re,!0),setTimeout(()=>{t.removeClass(ms.visible),t.removeClass(s),y(this,re,!1)},h),setTimeout(()=>{d(this,Ai,on).call(this)},o)};const Qt=new jc;var Ss,si,ih,sh;class Es{constructor(){m(this,si);m(this,Ss,"/api")}async _executeRequest({path:t,method:e,body:i,queryParams:s,errorMessage:r}){try{const{data:h,error:o}=await Wc({path:d(this,si,ih).call(this,t,s),method:e,body:i});if(o)throw new Error(o);return h}catch(h){throw d(this,si,sh).call(this,r),h}}_validateRequired(t,e){const i=Object.entries(t).filter(([s,r])=>!r).map(([s])=>s);if(i.length>0)throw new Error(e||`Missing required parameters: ${i.join(", ")}`)}}Ss=new WeakMap,si=new WeakSet,ih=function(t,e){let i=`${c(this,Ss)}${t}`;if(e){const s=new URLSearchParams;Object.entries(e).forEach(([r,h])=>{h!=null&&s.append(r,h.toString())}),i+=`?${s.toString()}`}return i},sh=function(t){try{Qt.show("error",t)}catch(e){console.error("Notification display failed:",e)}};class Gc extends Es{async getAll(){return this._executeRequest({path:"/contexts",method:"GET",errorMessage:"Не удалось загрузить список стратегий"})}async get(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/contexts/${t}`,method:"GET",errorMessage:"Не удалось загрузить данные стратегии"})}async update(t,e,i){return this._validateRequired({contextId:t,param:e},"contextId and param are required"),this._executeRequest({path:`/contexts/${t}`,method:"PATCH",body:{param:e,value:i},errorMessage:"Не удалось изменить параметр стратегии"})}async delete(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/contexts/${t}`,method:"DELETE",errorMessage:"Не удалось удалить стратегию"})}async getUpdates(){return this._executeRequest({path:"/contexts/updates",method:"GET",errorMessage:"Не удалось получить список обновлений"})}}const zs=new Gc;var At,Cs;class Kc{constructor(){m(this,At,null);m(this,Cs,5e3)}start(){c(this,At)===null&&y(this,At,setInterval(async()=>{try{const t=await zs.getUpdates(),e=_.get("context");t.includes(e.id)&&_.set("context",{...e})}catch(t){console.error("Failed to fetch IDs of updated contexts.",t)}},c(this,Cs)))}stop(){c(this,At)!==null&&(clearInterval(c(this,At)),y(this,At,null))}}At=new WeakMap,Cs=new WeakMap;const tu=new Kc;var he,wi;class eu{constructor(){m(this,he)}getItem(t){if(!d(this,he,wi).call(this))return console.warn("localStorage is not available."),null;const e=localStorage.getItem(t);if(e===null)return null;try{return JSON.parse(e)}catch(i){return console.error(`Failed to parse localStorage item: "${t}"`,i),null}}setItem(t,e){if(!d(this,he,wi).call(this)){console.warn("localStorage is not available.");return}localStorage.setItem(t,JSON.stringify(e))}removeItem(t){if(!d(this,he,wi).call(this)){console.warn("localStorage is not available.");return}localStorage.removeItem(t)}clear(){if(!d(this,he,wi).call(this)){console.warn("localStorage is not available.");return}localStorage.clear()}}he=new WeakSet,wi=function(){try{const t="__test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch{return!1}};const zt=new eu;var Xt,nh,rh,hh;class iu{constructor(){m(this,Xt)}async initialize(){d(this,Xt,nh).call(this);const t=await d(this,Xt,rh).call(this);d(this,Xt,hh).call(this,t)}}Xt=new WeakSet,nh=function(){const t=zt.getItem("theme")||"light";document.documentElement.setAttribute("data-theme",t),_.set("theme",t)},rh=async function(){const t=await zs.getAll(),[e,i]=Object.entries(t)[0],s={id:e,...i};return _.set("contexts",t),_.set("context",s),_.set("drawings",[]),Object.keys(t)},hh=function(t,e="trendlines"){const i=zt.getItem("drawings")||{[e]:{}},s=i[e]||{},r=Object.fromEntries(Object.entries(s).filter(([h])=>t.includes(h)));zt.setItem("drawings",{...i,[e]:r})};const su=new iu;class k{render(){throw new Error("Render method must be implemented in the child class")}}var ni,oh,lh;class nu{constructor(){m(this,ni)}htmlToElement(t,e=[],i=null){const h=new DOMParser().parseFromString(t,"text/html").body.firstElementChild;return i&&d(this,ni,lh).call(this,h,i),d(this,ni,oh).call(this,h,e),h}}ni=new WeakSet,oh=function(t,e){const i=new Map,s=t.querySelectorAll("*");e.map(h=>h instanceof k?h:new h).forEach(h=>{const o=h.constructor.componentName.toLowerCase();i.set(o,h)}),s.forEach(h=>{const l=h.tagName.toLowerCase().replace(/^component-/,"").replace(/-/g,""),a=i.get(l);if(a){const u=a.render();h.replaceWith(u)}})},lh=function(t,e){if(!t||!e)return;const i=t.querySelectorAll("[class]");[t,...i].forEach(s=>{for(const[r,h]of Object.entries(e))s.classList.contains(r)&&s.classList.replace(r,h)})};const E=new nu,ru="_layout_jq8e7_1",hu={layout:ru},ou=`<div class="layout">\r
	<component-toolbox></component-toolbox>\r
	<component-dashboard></component-dashboard>\r
	<component-controller></component-controller>\r
</div>\r
`,lu="_controller_1qyyi_1",au={controller:lu},cu=`<div class="controller">\r
	<component-controller-content></component-controller-content>\r
	<component-controller-sidebar></component-controller-sidebar>\r
</div>\r
`,uu={"controller-content":"_controller-content_1r5el_1"},du=`<div class="controller-content">\r
	<component-strategies-tab></component-strategies-tab>\r
	<component-params-tab></component-params-tab>\r
	<component-alerts-tab></component-alerts-tab>\r
</div>\r
`,ah=typeof window.SERVER_MODE=="string"&&!window.SERVER_MODE.startsWith("{")?window.SERVER_MODE:void 0,fu=100,pu=5e3,Jn={status:{исполнен:"green","ожидает исполнения":"gray",отменён:"red"},side:{покупка:"green",продажа:"red"}};class mu extends Es{async getAll(t){const e=t?{limit:t}:void 0;return this._executeRequest({path:"/alerts",method:"GET",queryParams:e,errorMessage:"Не удалось загрузить оповещения"})}async delete(t){return this._validateRequired({alertId:t},"alertId is required"),this._executeRequest({path:`/alerts/${t}`,method:"DELETE",errorMessage:"Не удалось удалить оповещение"})}async getNew(){return this._executeRequest({path:"/alerts/new",method:"GET",errorMessage:"Не удалось получить новые оповещения"})}}const Ys=new mu,gu="_header_11wty_13",vu="_items_11wty_33",wu={"alerts-tab":"_alerts-tab_11wty_1",header:gu,items:vu},bu=`<div class="alerts-tab">\r
	<div class="header"><span>Список оповещений</span></div>\r
	<div class="items" data-ref="alertsItems"></div>\r
</div>\r
`,yu="_header_1i6c9_11",_u="_details_1i6c9_119",Mu="_red_1i6c9_145",xu="_green_1i6c9_153",Su="_gray_1i6c9_161",Zn={"alerts-item":"_alerts-item_1i6c9_1",header:yu,"meta-info":"_meta-info_1i6c9_29","strategy-name":"_strategy-name_1i6c9_47","date-time":"_date-time_1i6c9_59",details:_u,"field-row":"_field-row_1i6c9_129",red:Mu,green:xu,gray:Su},Cu=`<div\r
	class="alerts-item"\r
	data-active="false"\r
	data-context-id=""\r
	data-alert-id=""\r
>\r
	<div class="header">\r
		<div class="meta-info">\r
			<span class="strategy-name" data-field="strategy"></span>\r
			<span class="date-time" data-field="time"></span>\r
		</div>\r
		<button data-ref="openStrategy" title="Открыть стратегию">\r
			<svg\r
				xmlns="http://www.w3.org/2000/svg"\r
				viewBox="0 0 28 28"\r
				width="28"\r
				height="28"\r
				fill="none"\r
			>\r
				<path\r
					fill="currentColor"\r
					fill-rule="evenodd"\r
					clip-rule="evenodd"\r
					d="M14 9.5a.5.5 0 0 0 1 0V7.02A6.5 6.5 0 0 1 20.98 13H18.5a.5.5 0 0 0 0 1h2.48A6.5 6.5 0 0 1 15 19.98V17.5a.5.5 0 0 0-1 0v2.48A6.5 6.5 0 0 1 8.02 14h2.48a.5.5 0 0 0 0-1H8.02A6.5 6.5 0 0 1 14 7.02V9.5zm1-3.48V4.5a.5.5 0 0 0-1 0v1.52A7.5 7.5 0 0 0 7.02 13H5.5a.5.5 0 0 0 0 1h1.52A7.5 7.5 0 0 0 14 20.98v1.52a.5.5 0 0 0 1 0v-1.52A7.5 7.5 0 0 0 21.98 14h1.52a.5.5 0 0 0 0-1h-1.52A7.5 7.5 0 0 0 15 6.02z"\r
				></path>\r
			</svg>\r
		</button>\r
		<button data-ref="removeAlert" title="Удалить оповещение">\r
			<svg\r
				xmlns="http://www.w3.org/2000/svg"\r
				viewBox="0 0 18 18"\r
				width="18"\r
				height="18"\r
			>\r
				<path\r
					fill="currentColor"\r
					d="M12 4h3v1h-1.04l-.88 9.64a1.5 1.5 0 0 1-1.5 1.36H6.42a1.5 1.5 0 0 1-1.5-1.36L4.05 5H3V4h3v-.5C6 2.67 6.67 2 7.5 2h3c.83 0 1.5.67 1.5 1.5V4ZM7.5 3a.5.5 0 0 0-.5.5V4h4v-.5a.5.5 0 0 0-.5-.5h-3ZM5.05 5l.87 9.55a.5.5 0 0 0 .5.45h5.17a.5.5 0 0 0 .5-.45L12.94 5h-7.9Z"\r
				></path>\r
			</svg>\r
		</button>\r
	</div>\r
	<div class="details">\r
		<div class="field-row">\r
			<span>Биржа</span><span data-field="exchange"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Тип</span><span data-field="type"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Статус</span><span data-field="status"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Направление</span><span data-field="side"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Символ</span><span data-field="symbol"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Количество</span><span data-field="qty"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Цена</span><span data-field="price"></span>\r
		</div>\r
	</div>\r
</div>\r
`;var oe,Li,ri,uh,dh;class ch extends k{constructor(){super(...arguments);m(this,ri);m(this,oe);m(this,Li,new Map)}render(){return d(this,ri,uh).call(this),d(this,ri,dh).call(this),this.element}remove(){this.element.remove()}update(e,i){c(this,Li).forEach(({element:s},r)=>{c(this,oe).data("context-id",i["context-id"]),c(this,oe).data("alert-id",e);const h=i[r];if(s.text(h),Jn[r]){const o=Zn[Jn[r][h]];o&&s.addClass(o)}})}}oe=new WeakMap,Li=new WeakMap,ri=new WeakSet,uh=function(){this.element=E.htmlToElement(Cu,[],Zn),y(this,oe,C(this.element))},dh=function(){c(this,oe).findAll("[data-field]").forEach(e=>{const i=e.data("field");c(this,Li).set(i,{element:e})})},T(ch,"componentName","AlertsItem");var ut,le,ae,P,ph,mh,gh,vh,wh,bh,yh,_h,ln;class fh extends k{constructor(){super(...arguments);m(this,P);m(this,ut);m(this,le,null);m(this,ae,new Map)}get isActive(){return c(this,ut).css("display")==="flex"}render(){return d(this,P,ph).call(this),d(this,P,mh).call(this),this.element}update(e){c(this,le)!==e.id&&y(this,le,e.id)}hide(){c(this,ut).css("display","none")}show(){c(this,ut).css("display","flex")}}ut=new WeakMap,le=new WeakMap,ae=new WeakMap,P=new WeakSet,ph=function(){this.element=E.htmlToElement(bu,[],wu),y(this,ut,C(this.element))},mh=function(){ah==="AUTOMATION"&&(y(this,le,_.get("context").id),d(this,P,gh).call(this),d(this,P,vh).call(this))},gh=async function(){const e=await Ys.getAll(fu),i=c(this,ut).find('[data-ref="alertsItems"]');Object.entries(e).forEach(([s,r])=>{d(this,P,ln).call(this,s,r,i)})},vh=function(){c(this,ut).click(d(this,P,wh).bind(this)),_.subscribe("context",this.update.bind(this)),d(this,P,_h).call(this)},wh=function(e){const i=C(e.target),s=i.closest("[data-alert-id]");if(!s)return;if(i.closest('[data-ref="openStrategy"]')){d(this,P,bh).call(this,s.data("context-id"));return}if(i.closest('[data-ref="removeAlert"]')){d(this,P,yh).call(this,s.data("alert-id"));return}const r=s.is("data-active");s.data("active",String(!r))},bh=function(e){if(c(this,le)===e)return;const i=_.get("contexts")[e];_.set("context",{id:e,...i})},yh=async function(e){try{await Ys.delete(e),c(this,ae).get(e).remove(),c(this,ae).delete(e),Qt.show("success","Оповещение успешно удалено")}catch(i){console.error("Failed to remove alert.",i)}},_h=function(){setInterval(async()=>{try{const e=await Ys.getNew(),i=c(this,ut).find('[data-ref="alertsItems"]');Object.entries(e).forEach(([s,r])=>{c(this,ae).has(s)||d(this,P,ln).call(this,s,r,i)})}catch(e){console.error("Failed to fetch new alerts.",e)}},pu)},ln=function(e,i,s){const r=new ch;c(this,ae).set(e,r),s.prepend(r.render()),r.update(e,i)},T(fh,"componentName","AlertsTab");const Tu="_header_nemla_13",ku="_items_nemla_33",Eu={"params-tab":"_params-tab_nemla_1",header:Tu,items:ku},zu=`<div class="params-tab">\r
	<div class="header"><span>Параметры стратегии</span></div>\r
	<div class="items" data-ref="paramsItems"></div>\r
</div>\r
`;function Ru(n){if(n===0)return 1;const t=n.toString();if(!t.includes("."))return 1;const i=t.split(".")[1].length;return Math.pow(10,-i)}const Nu={"params-item":"_params-item_1yduv_1"},Au=`<div class="params-item">\r
	<label for=""></label>\r
	<input id="" />\r
</div>\r
`;var ce,at,Lt;class an extends k{constructor(){super(...arguments);m(this,ce);m(this,at);m(this,Lt,{id:null,title:null,value:null,group:null})}get title(){return c(this,Lt).title}get value(){const e=c(this,at).element.type,i=c(this,at).element;return e==="number"?i.valueAsNumber:e==="checkbox"?i.checked:i.value}get group(){return c(this,Lt).group}render(){return this.element=E.htmlToElement(Au,[],Nu),y(this,ce,C(this.element)),this.element}remove(){this.element.remove()}update({id:e,title:i,value:s,group:r=null}){if(y(this,Lt,{id:e,title:i,value:s,group:r}),r&&c(this,ce).attr("data-group",r),c(this,ce).find("label").attr("for",e).text(i),y(this,at,c(this,ce).find("input").attr("id",e)),typeof s=="number"){c(this,at).attr("type","number"),c(this,at).element.value=s;const h=Ru(s);c(this,at).attr("step",h)}else typeof s=="boolean"&&(c(this,at).attr("type","checkbox"),c(this,at).element.checked=!!s)}commit({id:e,title:i,value:s,group:r=null}){y(this,Lt,{id:e,title:i,value:s,group:r})}rollback(){this.update(c(this,Lt))}}ce=new WeakMap,at=new WeakMap,Lt=new WeakMap,T(an,"componentName","ParamsItem");var xt,Bi,ue,de,j,xh,Sh,Ch,cn,Th,kh;class Mh extends k{constructor(){super(...arguments);m(this,j);m(this,xt);m(this,Bi,null);m(this,ue,new Map);m(this,de,new Map)}get isActive(){return c(this,xt).css("display")==="flex"}render(){return d(this,j,xh).call(this),d(this,j,Sh).call(this),this.element}update(e){if(c(this,Bi)===e.id)return;y(this,Bi,e.id),d(this,j,kh).call(this);const i=e.strategyParams,s=c(this,xt).find('[data-ref="paramsItems"]');Object.entries(i).forEach(([r,h])=>{if(Array.isArray(h))h.forEach((o,l)=>{const a=new an,u=`${r} ${l+1}`,f=`param-${r}-${l}`;s.append(a.render()),a.update({id:f,title:u,value:o,group:r}),d(this,j,cn).call(this,a,f,r)});else{const o=new an,l=`param-${r}`;s.append(o.render()),o.update({id:l,title:r,value:h}),d(this,j,cn).call(this,o,l)}})}hide(){c(this,xt).css("display","none")}show(){c(this,xt).css("display","flex")}}xt=new WeakMap,Bi=new WeakMap,ue=new WeakMap,de=new WeakMap,j=new WeakSet,xh=function(){this.element=E.htmlToElement(zu,[],Eu),y(this,xt,C(this.element))},Sh=function(){d(this,j,Ch).call(this),this.update(_.get("context"))},Ch=function(){c(this,xt).on("change",d(this,j,Th).bind(this)),_.subscribe("context",this.update.bind(this))},cn=function(e,i,s=null){if(c(this,ue).set(i,e),!s)return;const r=c(this,de).get(s)??[];r.push(e),c(this,de).set(s,r)},Th=async function(e){const i=_.get("context"),s=i.id,r=C(e.target).attr("id"),h=c(this,ue).get(r),o=h.title,l=h.group,a=h.value;try{let u=null,f=null;l?(u=l,f=Array.from(c(this,de).get(l).values()).map(p=>p.value)):(u=o,f=a),await zs.update(s,u,f),h.commit({id:r,title:o,value:a,group:l}),_.set("context",{...i,strategyParams:{...i.strategyParams,[u]:a}})}catch(u){console.error("Failed to update strategy parameter.",u),h.rollback()}},kh=function(){c(this,ue).forEach(e=>e.remove()),c(this,ue).clear(),c(this,de).clear()},T(Mh,"componentName","ParamsTab");const Lu="_header_vgi08_13",Bu="_items_vgi08_33",Ou={"strategies-tab":"_strategies-tab_vgi08_1",header:Lu,items:Bu},Vu=`<div class="strategies-tab">\r
	<div class="header"><span>Список стратегий</span></div>\r
	<div class="items" data-ref="strategiesItems"></div>\r
</div>\r
`,Pu="_content_ij1pu_29",Du={"strategies-item":"_strategies-item_ij1pu_1",content:Pu,"strategy-name":"_strategy-name_ij1pu_47","meta-info":"_meta-info_ij1pu_59"},Iu=`<div class="strategies-item" data-active="false" data-context-id="">\r
	<div class="content">\r
		<span class="strategy-name" data-field="name"></span>\r
		<div class="meta-info">\r
			<span data-field="symbol"></span> • <span data-field="exchange"></span> •\r
			<span data-field="market"></span> •\r
			<span data-field="interval"></span>\r
		</div>\r
	</div>\r
	<button title="Удалить стратегию">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 18 18"\r
			width="18"\r
			height="18"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M12 4h3v1h-1.04l-.88 9.64a1.5 1.5 0 0 1-1.5 1.36H6.42a1.5 1.5 0 0 1-1.5-1.36L4.05 5H3V4h3v-.5C6 2.67 6.67 2 7.5 2h3c.83 0 1.5.67 1.5 1.5V4ZM7.5 3a.5.5 0 0 0-.5.5V4h4v-.5a.5.5 0 0 0-.5-.5h-3ZM5.05 5l.87 9.55a.5.5 0 0 0 .5.45h5.17a.5.5 0 0 0 .5-.45L12.94 5h-7.9Z"\r
			></path>\r
		</svg>\r
	</button>\r
</div>\r
`;var Bt,Oi,hi,zh,Rh;class Eh extends k{constructor(){super(...arguments);m(this,hi);m(this,Bt);m(this,Oi,new Map)}render(){return d(this,hi,zh).call(this),d(this,hi,Rh).call(this),this.element}remove(){this.element.remove()}update(e,i){c(this,Oi).forEach(({element:s},r)=>{c(this,Bt).data("context-id",e),s.text(i[r])})}activate(){c(this,Bt).data("active","true")}deactivate(){c(this,Bt).data("active","false")}}Bt=new WeakMap,Oi=new WeakMap,hi=new WeakSet,zh=function(){this.element=E.htmlToElement(Iu,[],Du),y(this,Bt,C(this.element))},Rh=function(){c(this,Bt).findAll("[data-field]").forEach(e=>{const i=e.data("field");c(this,Oi).set(i,{element:e})})},T(Eh,"componentName","StrategiesItem");var St,Ot,Ct,H,Ah,Lh,Bh,Oh,Vh,Ph,un;class Nh extends k{constructor(){super(...arguments);m(this,H);m(this,St);m(this,Ot,null);m(this,Ct,new Map)}get isActive(){return c(this,St).css("display")==="flex"}render(){return d(this,H,Ah).call(this),d(this,H,Lh).call(this),this.element}update(e){c(this,Ot)!==e.id&&(c(this,Ct).get(c(this,Ot)).deactivate(),c(this,Ct).get(e.id).activate(),y(this,Ot,e.id))}hide(){c(this,St).css("display","none")}show(){c(this,St).css("display","flex")}}St=new WeakMap,Ot=new WeakMap,Ct=new WeakMap,H=new WeakSet,Ah=function(){this.element=E.htmlToElement(Vu,[],Ou),y(this,St,C(this.element))},Lh=function(){y(this,Ot,_.get("context").id),d(this,H,Bh).call(this),d(this,H,Oh).call(this)},Bh=function(){var r;const e=_.get("contexts"),i=_.get("context").id,s=c(this,St).find('[data-ref="strategiesItems"]');Object.entries(e).forEach(([h,o])=>{const l=new Eh;c(this,Ct).set(h,l),s.append(l.render()),l.update(h,o)}),(r=c(this,Ct).get(i))==null||r.activate()},Oh=function(){c(this,St).click(d(this,H,Vh).bind(this)),_.subscribe("context",this.update.bind(this))},Vh=function(e){const i=C(e.target),s=i.closest("[data-context-id]");if(!s)return;const r=s.data("context-id");i.closest("button")?d(this,H,Ph).call(this,r):d(this,H,un).call(this,r)},Ph=async function(e){try{const i=_.get("contexts");if(Object.keys(i).length===1){Qt.show("warning","Нельзя удалить последнюю стратегию");return}await zs.delete(e);const s=_.get("context").id,{[e]:r,...h}=i;if(_.set("contexts",h),e===s){const o=Object.keys(h)[0];d(this,H,un).call(this,o)}c(this,Ct).get(e).remove(),c(this,Ct).delete(e),Qt.show("success","Стратегия успешно удалена")}catch(i){console.error("Failed to remove strategy context.",i)}},un=function(e){if(c(this,Ot)===e)return;const i=_.get("contexts")[e];_.set("context",{id:e,...i})},T(Nh,"componentName","StrategiesTab");var fe,tt,Ih,$h,Yh,Fh,Wh,qh;class Dh extends k{constructor(){super(...arguments);m(this,tt);m(this,fe)}render(){return d(this,tt,$h).call(this),d(this,tt,Yh).call(this),this.element}showOnly(e){if(this.tabs[e].isActive&&c(this,tt,Ih)){d(this,tt,Fh).call(this);return}d(this,tt,Wh).call(this),d(this,tt,qh).call(this,e)}}fe=new WeakMap,tt=new WeakSet,Ih=function(){return c(this,fe).css("display")==="flex"},$h=function(){this.tabs={strategies:new Nh,params:new Mh,alerts:new fh}},Yh=function(){this.element=E.htmlToElement(du,[this.tabs.strategies,this.tabs.params,this.tabs.alerts],uu),y(this,fe,C(this.element))},Fh=function(){c(this,fe).css("display","none")},Wh=function(){c(this,fe).css("display","flex")},qh=function(e){for(const[i,s]of Object.entries(this.tabs))i===e?s.show():s.hide()},T(Dh,"componentName","ControllerContent");const $u={"controller-sidebar":"_controller-sidebar_djhqt_1"},Yu=`<div class="controller-sidebar">\r
	<component-strategies-tab-button></component-strategies-tab-button>\r
	<component-params-tab-button></component-params-tab-button>\r
	<component-alerts-tab-button></component-alerts-tab-button>\r
	<component-theme-button></component-theme-button>\r
</div>\r
`,Fu={"alerts-tab-button":"_alerts-tab-button_1tr6j_1"},Wu=`<button class="alerts-tab-button" data-active="false" title="Оповещения">\r
	<span>\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 44 44"\r
			width="44"\r
			height="44"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M35 14.66 29.16 9l-.7.72 5.84 5.66.7-.72ZM9 14.66 14.84 9l.7.72-5.84 5.66-.7-.72ZM22 16v7h-5v1h6v-8h-1Z"\r
			></path>\r
			<path\r
				fill="currentColor"\r
				fill-rule="evenodd"\r
				d="M22 33a11 11 0 1 0 0-22 11 11 0 0 0 0 22Zm0-1a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z"\r
			></path>\r
		</svg>\r
	</span>\r
</button>\r
`;var Vt;class Hh extends k{constructor(){super(...arguments);m(this,Vt)}get isActive(){return c(this,Vt).is("data-active")}render(){return this.element=E.htmlToElement(Wu,[],Fu),y(this,Vt,C(this.element)),this.element}setOnClick(e){c(this,Vt).click(e)}activate(){c(this,Vt).data("active","true")}deactivate(){c(this,Vt).data("active","false")}}Vt=new WeakMap,T(Hh,"componentName","AlertsTabButton");const qu={"params-tab-button":"_params-tab-button_1xwfe_1"},Hu=`<button class="params-tab-button" data-active="false" title="Параметры">\r
	<span>\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 28 28"\r
			width="28"\r
			height="28"\r
			fill="currentColor"\r
		>\r
			<path\r
				fill-rule="evenodd"\r
				d="M18 14a4 4 0 1 1-8 0 4 4 0 0 1 8 0Zm-1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"\r
			></path>\r
			<path\r
				fill-rule="evenodd"\r
				d="M8.5 5h11l5 9-5 9h-11l-5-9 5-9Zm-3.86 9L9.1 6h9.82l4.45 8-4.45 8H9.1l-4.45-8Z"\r
			></path>\r
		</svg>\r
	</span>\r
</button>\r
`;var Pt;class Qh extends k{constructor(){super(...arguments);m(this,Pt)}get isActive(){return c(this,Pt).is("data-active")}render(){return this.element=E.htmlToElement(Hu,[],qu),y(this,Pt,C(this.element)),this.element}setOnClick(e){c(this,Pt).click(e)}activate(){c(this,Pt).data("active","true")}deactivate(){c(this,Pt).data("active","false")}}Pt=new WeakMap,T(Qh,"componentName","ParamsTabButton");const Qu={"strategies-tab-button":"_strategies-tab-button_bh98p_1"},Xu=`<button class="strategies-tab-button" data-active="true" title="Стратегии">\r
	<span>\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 44 44"\r
			width="44"\r
			height="44"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M13 11h18a2 2 0 0 1 2 2v17a2 2 0 0 1-2 2H13a2 2 0 0 1-2-2V13c0-1.1.9-2 2-2Zm18-1H13a3 3 0 0 0-3 3v17a3 3 0 0 0 3 3h18a3 3 0 0 0 3-3V13a3 3 0 0 0-3-3Zm-2 11H15v1h14v-1Zm-14-5h14v1H15v-1Zm14 10H15v1h14v-1Z"\r
			></path>\r
		</svg>\r
	</span>\r
</button>\r
`;var Dt;class Xh extends k{constructor(){super(...arguments);m(this,Dt)}get isActive(){return c(this,Dt).is("data-active")}render(){return this.element=E.htmlToElement(Xu,[],Qu),y(this,Dt,C(this.element)),this.element}setOnClick(e){c(this,Dt).click(e)}activate(){c(this,Dt).data("active","true")}deactivate(){c(this,Dt).data("active","false")}}Dt=new WeakMap,T(Xh,"componentName","StrategiesTabButton");const Uu={"theme-button":"_theme-button_19q0t_1"},Ju=`<button class="theme-button" data-active="false" title="Тёмная тема">\r
	<span>\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 28 28"\r
			width="28"\r
			height="28"\r
		>\r
			<path\r
				fill="currentColor"\r
				fill-rule="evenodd"\r
				d="M19.67 6.44a8.27 8.27 0 0 0-3.57-1.39 9 9 0 1 0 .54 17.83 8.71 8.71 0 0 0 3.63-1.8c.38-.29.74-.6 1.07-.9 0 0-.55 0-1.35-.15-2.11-.38-5.96-1.68-5.96-6.03 0-4.32 3.5-5.92 5.46-6.47.76-.22 1.3-.28 1.3-.28a14.2 14.2 0 0 0-1.12-.8Zm-1.3.4a6.54 6.54 0 0 0-2.37-.8 8 8 0 1 0 .48 15.85c.79-.13 1.63-.54 2.44-1.07-.51-.13-1.07-.31-1.63-.56a7.46 7.46 0 0 1-2.9-2.14A6.44 6.44 0 0 1 13.03 14a7.13 7.13 0 0 1 3.9-6.5c.49-.28.99-.5 1.45-.66Z"\r
			></path>\r
		</svg>\r
	</span>\r
</button>\r
`;var pe,Vi,J,dn,Jh,Zh,jh,Gh,fn;class Uh extends k{constructor(){super(...arguments);m(this,J);m(this,pe);m(this,Vi)}render(){return d(this,J,Zh).call(this),d(this,J,jh).call(this),this.element}}pe=new WeakMap,Vi=new WeakMap,J=new WeakSet,dn=function(){return document.documentElement.getAttribute("data-theme")||"light"},Jh=function(){return c(this,J,dn)==="dark"?"light":"dark"},Zh=function(){this.element=E.htmlToElement(Ju,[],Uu),y(this,pe,C(this.element)),y(this,Vi,C(document.documentElement))},jh=function(){c(this,pe).on("click",d(this,J,Gh).bind(this)),d(this,J,fn).call(this,c(this,J,dn))},Gh=function(){const e=c(this,J,Jh);c(this,Vi).data("theme",e),zt.setItem("theme",e),_.set("theme",e),d(this,J,fn).call(this,e)},fn=function(e){e==="dark"?c(this,pe).data("active","true"):c(this,pe).data("active","false")},T(Uh,"componentName","ThemeButton");var Ut,to,eo,io;class Kh extends k{constructor(){super(...arguments);m(this,Ut)}render(){return d(this,Ut,to).call(this),d(this,Ut,eo).call(this),this.element}connectButtons(e){Object.entries(this.buttons).forEach(([i,s])=>{s.setOnClick(()=>{s.isActive?s.deactivate():d(this,Ut,io).call(this,i),e==null||e(i)})})}}Ut=new WeakSet,to=function(){this.buttons={strategies:new Xh,params:new Qh,alerts:new Hh},this.themeButton=new Uh},eo=function(){this.element=E.htmlToElement(Yu,[this.buttons.strategies,this.buttons.params,this.buttons.alerts,this.themeButton],$u)},io=function(e){for(const[i,s]of Object.entries(this.buttons))i===e?s.activate():s.deactivate()},T(Kh,"componentName","ControllerSidebar");var Jt,no,ro,ho;class so extends k{constructor(){super(...arguments);m(this,Jt)}render(){return d(this,Jt,no).call(this),d(this,Jt,ro).call(this),d(this,Jt,ho).call(this),this.element}}Jt=new WeakSet,no=function(){this.controllerContent=new Dh,this.controllerSidebar=new Kh},ro=function(){this.element=E.htmlToElement(cu,[this.controllerContent,this.controllerSidebar],au)},ho=function(){this.controllerSidebar.connectButtons(e=>{this.controllerContent.showOnly(e)})},T(so,"componentName","Controller");const Zu="_dashboard_x3hjs_1",ju={dashboard:Zu},Gu=`<div class="dashboard">\r
	<component-chart></component-chart>\r
	<component-report></component-report>\r
</div>\r
`;function A(n){var t=n.width,e=n.height;if(t<0)throw new Error("Negative width is not allowed for Size");if(e<0)throw new Error("Negative height is not allowed for Size");return{width:t,height:e}}function Ee(n,t){return n.width===t.width&&n.height===t.height}var Ku=function(){function n(t){var e=this;this._resolutionListener=function(){return e._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return n.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(n.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),n.prototype.subscribe=function(t){var e=this,i={next:t};return this._observers.push(i),{unsubscribe:function(){e._observers=e._observers.filter(function(s){return s!==i})}}},n.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},n.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},n.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},n.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach(function(e){return e.next(t._window.devicePixelRatio)}),this._reinstallResolutionListener()},n}();function td(n){return new Ku(n)}var ed=function(){function n(t,e,i){var s;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=A({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=e??function(r){return r},this._allowResizeObserver=(s=i==null?void 0:i.allowResizeObserver)!==null&&s!==void 0?s:!0,this._chooseAndInitObserver()}return n.prototype.dispose=function(){var t,e;if(this._canvasElement===null)throw new Error("Object is disposed");(t=this._canvasElementResizeObserver)===null||t===void 0||t.disconnect(),this._canvasElementResizeObserver=null,(e=this._devicePixelRatioObservable)===null||e===void 0||e.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(n.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bitmapSize",{get:function(){return A({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),n.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=A(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},n.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},n.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(e){return e!==t})},Object.defineProperty(n.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),n.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},n.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(e){return e!==t})},n.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},n.prototype._resizeBitmap=function(t){var e=this.bitmapSize;Ee(e,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(e,t))},n.prototype._emitBitmapSizeChanged=function(t,e){var i=this;this._bitmapSizeChangedListeners.forEach(function(s){return s.call(i,t,e)})},n.prototype._suggestNewBitmapSize=function(t){var e=this._suggestedBitmapSize,i=A(this._transformBitmapSize(t,this._canvasElementClientSize)),s=Ee(this.bitmapSize,i)?null:i;e===null&&s===null||e!==null&&s!==null&&Ee(e,s)||(this._suggestedBitmapSize=s,this._emitSuggestedBitmapSizeChanged(e,s))},n.prototype._emitSuggestedBitmapSizeChanged=function(t,e){var i=this;this._suggestedBitmapSizeChangedListeners.forEach(function(s){return s.call(i,t,e)})},n.prototype._chooseAndInitObserver=function(){var t=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}sd().then(function(e){return e?t._initResizeObserver():t._initDevicePixelRatioObservable()})},n.prototype._initDevicePixelRatioObservable=function(){var t=this;if(this._canvasElement!==null){var e=jn(this._canvasElement);if(e===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=td(e),this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()}),this._invalidateBitmapSize()}},n.prototype._invalidateBitmapSize=function(){var t,e;if(this._canvasElement!==null){var i=jn(this._canvasElement);if(i!==null){var s=(e=(t=this._devicePixelRatioObservable)===null||t===void 0?void 0:t.value)!==null&&e!==void 0?e:i.devicePixelRatio,r=this._canvasElement.getClientRects(),h=r[0]!==void 0?nd(r[0],s):A({width:this._canvasElementClientSize.width*s,height:this._canvasElementClientSize.height*s});this._suggestNewBitmapSize(h)}}},n.prototype._initResizeObserver=function(){var t=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(e){var i=e.find(function(h){return h.target===t._canvasElement});if(!(!i||!i.devicePixelContentBoxSize||!i.devicePixelContentBoxSize[0])){var s=i.devicePixelContentBoxSize[0],r=A({width:s.inlineSize,height:s.blockSize});t._suggestNewBitmapSize(r)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},n}();function id(n,t){return new ed(n,t.transform,t.options)}function jn(n){return n.ownerDocument.defaultView}function sd(){return new Promise(function(n){var t=new ResizeObserver(function(e){n(e.every(function(i){return"devicePixelContentBoxSize"in i})),t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function nd(n,t){return A({width:Math.round(n.left*t+n.width*t)-Math.round(n.left*t),height:Math.round(n.top*t+n.height*t)-Math.round(n.top*t)})}var rd=function(){function n(t,e,i){if(e.width===0||e.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=e,i.width===0||i.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=i,this._context=t}return n.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},n.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(n.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),n}();function ze(n,t){var e=n.canvasElementClientSize;if(e.width===0||e.height===0)return null;var i=n.bitmapSize;if(i.width===0||i.height===0)return null;var s=n.canvasElement.getContext("2d",t);return s===null?null:new rd(s,e,i)}/*!
 * @license
 * TradingView Lightweight Charts™ v5.0.7
 * Copyright (c) 2025 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const oo={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var Gn,Kn;function Re(n,t){const e={0:[],1:[n.lineWidth,n.lineWidth],2:[2*n.lineWidth,2*n.lineWidth],3:[6*n.lineWidth,6*n.lineWidth],4:[n.lineWidth,4*n.lineWidth]}[t];n.setLineDash(e)}function lo(n,t,e,i){n.beginPath();const s=n.lineWidth%2?.5:0;n.moveTo(e,t+s),n.lineTo(i,t+s),n.stroke()}function U(n,t){if(!n)throw new Error("Assertion failed"+(t?": "+t:""))}function K(n){if(n===void 0)throw new Error("Value is undefined");return n}function w(n){if(n===null)throw new Error("Value is null");return n}function Ht(n){return w(K(n))}(function(n){n[n.Simple=0]="Simple",n[n.WithSteps=1]="WithSteps",n[n.Curved=2]="Curved"})(Gn||(Gn={})),function(n){n[n.Solid=0]="Solid",n[n.Dotted=1]="Dotted",n[n.Dashed=2]="Dashed",n[n.LargeDashed=3]="LargeDashed",n[n.SparseDotted=4]="SparseDotted"}(Kn||(Kn={}));class V{constructor(){this.t=[]}i(t,e,i){const s={h:t,l:e,o:i===!0};this.t.push(s)}_(t){const e=this.t.findIndex(i=>t===i.h);e>-1&&this.t.splice(e,1)}u(t){this.t=this.t.filter(e=>e.l!==t)}p(t,e,i){const s=[...this.t];this.t=this.t.filter(r=>!r.o),s.forEach(r=>r.h(t,e,i))}v(){return this.t.length>0}m(){this.t=[]}}function st(n,...t){for(const e of t)for(const i in e)e[i]!==void 0&&Object.prototype.hasOwnProperty.call(e,i)&&!["__proto__","constructor","prototype"].includes(i)&&(typeof e[i]!="object"||n[i]===void 0||Array.isArray(e[i])?n[i]=e[i]:st(n[i],e[i]));return n}function Ne(n){return typeof n=="number"&&isFinite(n)}function Ei(n){return typeof n=="number"&&n%1==0}function rs(n){return typeof n=="string"}function os(n){return typeof n=="boolean"}function kt(n){const t=n;if(!t||typeof t!="object")return t;let e,i,s;for(i in e=Array.isArray(t)?[]:{},t)t.hasOwnProperty(i)&&(s=t[i],e[i]=s&&typeof s=="object"?kt(s):s);return e}function hd(n){return n!==null}function zi(n){return n===null?void 0:n}const ao="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function Ri(n,t,e){return t===void 0&&(t=ao),`${e=e!==void 0?`${e} `:""}${n}px ${t}`}class od{constructor(t){this.M={S:1,C:5,k:NaN,P:"",T:"",R:"",D:"",V:0,I:0,B:0,A:0,L:0},this.O=t}N(){const t=this.M,e=this.W(),i=this.F();return t.k===e&&t.T===i||(t.k=e,t.T=i,t.P=Ri(e,i),t.A=2.5/12*e,t.V=t.A,t.I=e/12*t.C,t.B=e/12*t.C,t.L=0),t.R=this.H(),t.D=this.U(),this.M}H(){return this.O.N().layout.textColor}U(){return this.O.$()}W(){return this.O.N().layout.fontSize}F(){return this.O.N().layout.fontFamily}}function Fs(n){return n<0?0:n>255?255:Math.round(n)||0}function tr(n){return .199*n[0]+.687*n[1]+.114*n[2]}class ld{constructor(t,e){this.q=new Map,this.Y=t,e&&(this.q=e)}j(t,e){if(t==="transparent")return t;const i=this.K(t),s=i[3];return`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${e*s})`}X(t){const e=this.K(t);return{Z:`rgb(${e[0]}, ${e[1]}, ${e[2]})`,G:tr(e)>160?"black":"white"}}J(t){return tr(this.K(t))}tt(t,e,i){const[s,r,h,o]=this.K(t),[l,a,u,f]=this.K(e),p=[Fs(s+i*(l-s)),Fs(r+i*(a-r)),Fs(h+i*(u-h)),(g=o+i*(f-o),g<=0||g>1?Math.min(Math.max(g,0),1):Math.round(1e4*g)/1e4)];var g;return`rgba(${p[0]}, ${p[1]}, ${p[2]}, ${p[3]})`}K(t){const e=this.q.get(t);if(e)return e;const i=function(h){const o=document.createElement("div");o.style.display="none",document.body.appendChild(o),o.style.color=h;const l=window.getComputedStyle(o).color;return document.body.removeChild(o),l}(t),s=i.match(/^rgba?\s*\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d+))?\)$/);if(!s){if(this.Y.length)for(const h of this.Y){const o=h(t);if(o)return this.q.set(t,o),o}throw new Error(`Failed to parse color: ${t}`)}const r=[parseInt(s[1],10),parseInt(s[2],10),parseInt(s[3],10),s[4]?parseFloat(s[4]):1];return this.q.set(t,r),r}}class co{constructor(){this.it=[]}st(t){this.it=t}nt(t,e,i){this.it.forEach(s=>{s.nt(t,e,i)})}}class se{nt(t,e,i){t.useBitmapCoordinateSpace(s=>this.et(s,e,i))}}class ad extends se{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.rt===null||this.rt.lt===null)return;const s=this.rt.lt,r=this.rt,h=Math.max(1,Math.floor(e))%2/2,o=l=>{t.beginPath();for(let a=s.to-1;a>=s.from;--a){const u=r.ot[a],f=Math.round(u._t*e)+h,p=u.ut*i,g=l*i+h;t.moveTo(f,p),t.arc(f,p,g,0,2*Math.PI)}t.fill()};r.ct>0&&(t.fillStyle=r.dt,o(r.ft+r.ct)),t.fillStyle=r.vt,o(r.ft)}}function cd(){return{ot:[{_t:0,ut:0,wt:0,gt:0}],vt:"",dt:"",ft:0,ct:0,lt:null}}const ud={from:0,to:1};class dd{constructor(t,e,i){this.Mt=new co,this.bt=[],this.St=[],this.xt=!0,this.O=t,this.Ct=e,this.yt=i,this.Mt.st(this.bt)}kt(t){this.Pt(),this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Mt}Pt(){const t=this.yt.Dt();t.length!==this.bt.length&&(this.St=t.map(cd),this.bt=this.St.map(e=>{const i=new ad;return i.ht(e),i}),this.Mt.st(this.bt))}Rt(){const t=this.Ct.N().mode===2||!this.Ct.Vt(),e=this.yt.It(),i=this.Ct.Bt(),s=this.O.At();this.Pt(),e.forEach((r,h)=>{const o=this.St[h],l=r.Et(i),a=r.zt();!t&&l!==null&&r.Vt()&&a!==null?(o.vt=l.Lt,o.ft=l.ft,o.ct=l.Ot,o.ot[0].gt=l.gt,o.ot[0].ut=r.Wt().Nt(l.gt,a.Ft),o.dt=l.Ht??this.O.Ut(o.ot[0].ut/r.Wt().$t()),o.ot[0].wt=i,o.ot[0]._t=s.qt(i),o.lt=ud):o.lt=null})}}class fd extends se{constructor(t){super(),this.Yt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.Yt===null)return;const r=this.Yt.jt.Vt,h=this.Yt.Kt.Vt;if(!r&&!h)return;const o=Math.round(this.Yt._t*i),l=Math.round(this.Yt.ut*s);t.lineCap="butt",r&&o>=0&&(t.lineWidth=Math.floor(this.Yt.jt.ct*i),t.strokeStyle=this.Yt.jt.R,t.fillStyle=this.Yt.jt.R,Re(t,this.Yt.jt.Xt),function(a,u,f,p){a.beginPath();const g=a.lineWidth%2?.5:0;a.moveTo(u+g,f),a.lineTo(u+g,p),a.stroke()}(t,o,0,e.height)),h&&l>=0&&(t.lineWidth=Math.floor(this.Yt.Kt.ct*s),t.strokeStyle=this.Yt.Kt.R,t.fillStyle=this.Yt.Kt.R,Re(t,this.Yt.Kt.Xt),lo(t,l,0,e.width))}}class pd{constructor(t,e){this.xt=!0,this.Zt={jt:{ct:1,Xt:0,R:"",Vt:!1},Kt:{ct:1,Xt:0,R:"",Vt:!1},_t:0,ut:0},this.Gt=new fd(this.Zt),this.Jt=t,this.yt=e}kt(){this.xt=!0}Tt(t){return this.xt&&(this.Rt(),this.xt=!1),this.Gt}Rt(){const t=this.Jt.Vt(),e=this.yt.Qt().N().crosshair,i=this.Zt;if(e.mode===2)return i.Kt.Vt=!1,void(i.jt.Vt=!1);i.Kt.Vt=t&&this.Jt.ti(this.yt),i.jt.Vt=t&&this.Jt.ii(),i.Kt.ct=e.horzLine.width,i.Kt.Xt=e.horzLine.style,i.Kt.R=e.horzLine.color,i.jt.ct=e.vertLine.width,i.jt.Xt=e.vertLine.style,i.jt.R=e.vertLine.color,i._t=this.Jt.si(),i.ut=this.Jt.ni()}}function md(n,t,e,i,s,r){n.fillRect(t+r,e,i-2*r,r),n.fillRect(t+r,e+s-r,i-2*r,r),n.fillRect(t,e,r,s),n.fillRect(t+i-r,e,r,s)}function Rs(n,t,e,i,s,r){n.save(),n.globalCompositeOperation="copy",n.fillStyle=r,n.fillRect(t,e,i,s),n.restore()}function er(n,t,e,i,s,r){n.beginPath(),n.roundRect?n.roundRect(t,e,i,s,r):(n.lineTo(t+i-r[1],e),r[1]!==0&&n.arcTo(t+i,e,t+i,e+r[1],r[1]),n.lineTo(t+i,e+s-r[2]),r[2]!==0&&n.arcTo(t+i,e+s,t+i-r[2],e+s,r[2]),n.lineTo(t+r[3],e+s),r[3]!==0&&n.arcTo(t,e+s,t,e+s-r[3],r[3]),n.lineTo(t,e+r[0]),r[0]!==0&&n.arcTo(t,e,t+r[0],e,r[0]))}function ir(n,t,e,i,s,r,h=0,o=[0,0,0,0],l=""){if(n.save(),!h||!l||l===r)return er(n,t,e,i,s,o),n.fillStyle=r,n.fill(),void n.restore();const a=h/2;var u;er(n,t+a,e+a,i-h,s-h,(u=-a,o.map(f=>f===0?f:f+u))),r!=="transparent"&&(n.fillStyle=r,n.fill()),l!=="transparent"&&(n.lineWidth=h,n.strokeStyle=l,n.closePath(),n.stroke()),n.restore()}function uo(n,t,e,i,s,r,h){n.save(),n.globalCompositeOperation="copy";const o=n.createLinearGradient(0,0,0,s);o.addColorStop(0,r),o.addColorStop(1,h),n.fillStyle=o,n.fillRect(t,e,i,s),n.restore()}class sr{constructor(t,e){this.ht(t,e)}ht(t,e){this.Yt=t,this.ei=e}$t(t,e){return this.Yt.Vt?t.k+t.A+t.V:0}nt(t,e,i,s){if(!this.Yt.Vt||this.Yt.ri.length===0)return;const r=this.Yt.R,h=this.ei.Z,o=t.useBitmapCoordinateSpace(l=>{const a=l.context;a.font=e.P;const u=this.hi(l,e,i,s),f=u.ai;return u.li?ir(a,f.oi,f._i,f.ui,f.ci,h,f.di,[f.ft,0,0,f.ft],h):ir(a,f.fi,f._i,f.ui,f.ci,h,f.di,[0,f.ft,f.ft,0],h),this.Yt.pi&&(a.fillStyle=r,a.fillRect(f.fi,f.mi,f.wi-f.fi,f.gi)),this.Yt.Mi&&(a.fillStyle=e.D,a.fillRect(u.li?f.bi-f.di:0,f._i,f.di,f.Si-f._i)),u});t.useMediaCoordinateSpace(({context:l})=>{const a=o.xi;l.font=e.P,l.textAlign=o.li?"right":"left",l.textBaseline="middle",l.fillStyle=r,l.fillText(this.Yt.ri,a.Ci,(a._i+a.Si)/2+a.yi)})}hi(t,e,i,s){const{context:r,bitmapSize:h,mediaSize:o,horizontalPixelRatio:l,verticalPixelRatio:a}=t,u=this.Yt.pi||!this.Yt.ki?e.C:0,f=this.Yt.Pi?e.S:0,p=e.A+this.ei.Ti,g=e.V+this.ei.Ri,v=e.I,b=e.B,M=this.Yt.ri,S=e.k,R=i.Di(r,M),B=Math.ceil(i.Vi(r,M)),O=S+p+g,et=e.S+v+b+B+u,lt=Math.max(1,Math.floor(a));let nt=Math.round(O*a);nt%2!=lt%2&&(nt+=1);const Mt=f>0?Math.max(1,Math.floor(f*l)):0,Rt=Math.round(et*l),ui=Math.round(u*l),Dc=this.ei.Ii??this.ei.Bi,qn=Math.round(Dc*a)-Math.floor(.5*a),Vs=Math.floor(qn+lt/2-nt/2),Hn=Vs+nt,hs=s==="right",Qn=hs?o.width-f:f,di=hs?h.width-Mt:Mt;let Ps,Ds,Is;return hs?(Ps=di-Rt,Ds=di-ui,Is=Qn-u-v-f):(Ps=di+Rt,Ds=di+ui,Is=Qn+u+v),{li:hs,ai:{_i:Vs,mi:qn,Si:Hn,ui:Rt,ci:nt,ft:2*l,di:Mt,oi:Ps,fi:di,wi:Ds,gi:lt,bi:h.width},xi:{_i:Vs/a,Si:Hn/a,Ci:Is,yi:R}}}}class Ns{constructor(t){this.Ai={Bi:0,Z:"#000",Ri:0,Ti:0},this.Ei={ri:"",Vt:!1,pi:!0,ki:!1,Ht:"",R:"#FFF",Mi:!1,Pi:!1},this.zi={ri:"",Vt:!1,pi:!1,ki:!0,Ht:"",R:"#FFF",Mi:!0,Pi:!0},this.xt=!0,this.Li=new(t||sr)(this.Ei,this.Ai),this.Oi=new(t||sr)(this.zi,this.Ai)}ri(){return this.Ni(),this.Ei.ri}Bi(){return this.Ni(),this.Ai.Bi}kt(){this.xt=!0}$t(t,e=!1){return Math.max(this.Li.$t(t,e),this.Oi.$t(t,e))}Wi(){return this.Ai.Ii||0}Fi(t){this.Ai.Ii=t}Hi(){return this.Ni(),this.Ei.Vt||this.zi.Vt}Ui(){return this.Ni(),this.Ei.Vt}Tt(t){return this.Ni(),this.Ei.pi=this.Ei.pi&&t.N().ticksVisible,this.zi.pi=this.zi.pi&&t.N().ticksVisible,this.Li.ht(this.Ei,this.Ai),this.Oi.ht(this.zi,this.Ai),this.Li}$i(){return this.Ni(),this.Li.ht(this.Ei,this.Ai),this.Oi.ht(this.zi,this.Ai),this.Oi}Ni(){this.xt&&(this.Ei.pi=!0,this.zi.pi=!1,this.qi(this.Ei,this.zi,this.Ai))}}class gd extends Ns{constructor(t,e,i){super(),this.Jt=t,this.Yi=e,this.ji=i}qi(t,e,i){if(t.Vt=!1,this.Jt.N().mode===2)return;const s=this.Jt.N().horzLine;if(!s.labelVisible)return;const r=this.Yi.zt();if(!this.Jt.Vt()||this.Yi.Ki()||r===null)return;const h=this.Yi.Xi().X(s.labelBackgroundColor);i.Z=h.Z,t.R=h.G;const o=2/12*this.Yi.k();i.Ti=o,i.Ri=o;const l=this.ji(this.Yi);i.Bi=l.Bi,t.ri=this.Yi.Zi(l.gt,r),t.Vt=!0}}const vd=/[1-9]/g;class fo{constructor(){this.Yt=null}ht(t){this.Yt=t}nt(t,e){if(this.Yt===null||this.Yt.Vt===!1||this.Yt.ri.length===0)return;const i=t.useMediaCoordinateSpace(({context:p})=>(p.font=e.P,Math.round(e.Gi.Vi(p,w(this.Yt).ri,vd))));if(i<=0)return;const s=e.Ji,r=i+2*s,h=r/2,o=this.Yt.Qi;let l=this.Yt.Bi,a=Math.floor(l-h)+.5;a<0?(l+=Math.abs(0-a),a=Math.floor(l-h)+.5):a+r>o&&(l-=Math.abs(o-(a+r)),a=Math.floor(l-h)+.5);const u=a+r,f=Math.ceil(0+e.S+e.C+e.A+e.k+e.V);t.useBitmapCoordinateSpace(({context:p,horizontalPixelRatio:g,verticalPixelRatio:v})=>{const b=w(this.Yt);p.fillStyle=b.Z;const M=Math.round(a*g),S=Math.round(0*v),R=Math.round(u*g),B=Math.round(f*v),O=Math.round(2*g);if(p.beginPath(),p.moveTo(M,S),p.lineTo(M,B-O),p.arcTo(M,B,M+O,B,O),p.lineTo(R-O,B),p.arcTo(R,B,R,B-O,O),p.lineTo(R,S),p.fill(),b.pi){const et=Math.round(b.Bi*g),lt=S,nt=Math.round((lt+e.C)*v);p.fillStyle=b.R;const Mt=Math.max(1,Math.floor(g)),Rt=Math.floor(.5*g);p.fillRect(et-Rt,lt,Mt,nt-lt)}}),t.useMediaCoordinateSpace(({context:p})=>{const g=w(this.Yt),v=0+e.S+e.C+e.A+e.k/2;p.font=e.P,p.textAlign="left",p.textBaseline="middle",p.fillStyle=g.R;const b=e.Gi.Di(p,"Apr0");p.translate(a+s,v+b),p.fillText(g.ri,0,0)})}}class wd{constructor(t,e,i){this.xt=!0,this.Gt=new fo,this.Zt={Vt:!1,Z:"#4c525e",R:"white",ri:"",Qi:0,Bi:NaN,pi:!0},this.Ct=t,this.ts=e,this.ji=i}kt(){this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Gt.ht(this.Zt),this.Gt}Rt(){const t=this.Zt;if(t.Vt=!1,this.Ct.N().mode===2)return;const e=this.Ct.N().vertLine;if(!e.labelVisible)return;const i=this.ts.At();if(i.Ki())return;t.Qi=i.Qi();const s=this.ji();if(s===null)return;t.Bi=s.Bi;const r=i.ss(this.Ct.Bt());t.ri=i.ns(w(r)),t.Vt=!0;const h=this.ts.Xi().X(e.labelBackgroundColor);t.Z=h.Z,t.R=h.G,t.pi=i.N().ticksVisible}}class po{constructor(){this.es=null,this.rs=0}hs(){return this.rs}ls(t){this.rs=t}Wt(){return this.es}_s(t){this.es=t}us(t){return[]}cs(){return[]}Vt(){return!0}}var nr;(function(n){n[n.Normal=0]="Normal",n[n.Magnet=1]="Magnet",n[n.Hidden=2]="Hidden",n[n.MagnetOHLC=3]="MagnetOHLC"})(nr||(nr={}));class bd extends po{constructor(t,e){super(),this.yt=null,this.ds=NaN,this.fs=0,this.ps=!1,this.vs=new Map,this.ws=!1,this.gs=new WeakMap,this.Ms=new WeakMap,this.bs=NaN,this.Ss=NaN,this.xs=NaN,this.Cs=NaN,this.ts=t,this.ys=e,this.ks=((s,r)=>h=>{const o=r(),l=s();if(h===w(this.yt).Ps())return{gt:l,Bi:o};{const a=w(h.zt());return{gt:h.Ts(o,a),Bi:o}}})(()=>this.ds,()=>this.Ss);const i=((s,r)=>()=>{const h=this.ts.At().Rs(s()),o=r();return h&&Number.isFinite(o)?{wt:h,Bi:o}:null})(()=>this.fs,()=>this.si());this.Ds=new wd(this,t,i)}N(){return this.ys}Vs(t,e){this.xs=t,this.Cs=e}Is(){this.xs=NaN,this.Cs=NaN}Bs(){return this.xs}As(){return this.Cs}Es(t,e,i){this.ws||(this.ws=!0),this.ps=!0,this.zs(t,e,i)}Bt(){return this.fs}si(){return this.bs}ni(){return this.Ss}Vt(){return this.ps}Ls(){this.ps=!1,this.Os(),this.ds=NaN,this.bs=NaN,this.Ss=NaN,this.yt=null,this.Is(),this.Ns()}Ws(t){let e=this.gs.get(t);e||(e=new pd(this,t),this.gs.set(t,e));let i=this.Ms.get(t);return i||(i=new dd(this.ts,this,t),this.Ms.set(t,i)),[e,i]}ti(t){return t===this.yt&&this.ys.horzLine.visible}ii(){return this.ys.vertLine.visible}Fs(t,e){this.ps&&this.yt===t||this.vs.clear();const i=[];return this.yt===t&&i.push(this.Hs(this.vs,e,this.ks)),i}cs(){return this.ps?[this.Ds]:[]}Us(){return this.yt}Ns(){this.ts.$s().forEach(t=>{var e,i;(e=this.gs.get(t))==null||e.kt(),(i=this.Ms.get(t))==null||i.kt()}),this.vs.forEach(t=>t.kt()),this.Ds.kt()}qs(t){return t&&!t.Ps().Ki()?t.Ps():null}zs(t,e,i){this.Ys(t,e,i)&&this.Ns()}Ys(t,e,i){const s=this.bs,r=this.Ss,h=this.ds,o=this.fs,l=this.yt,a=this.qs(i);this.fs=t,this.bs=isNaN(t)?NaN:this.ts.At().qt(t),this.yt=i;const u=a!==null?a.zt():null;return a!==null&&u!==null?(this.ds=e,this.Ss=a.Nt(e,u)):(this.ds=NaN,this.Ss=NaN),s!==this.bs||r!==this.Ss||o!==this.fs||h!==this.ds||l!==this.yt}Os(){const t=this.ts.js().map(i=>i.Xs().Ks()).filter(hd),e=t.length===0?null:Math.max(...t);this.fs=e!==null?e:NaN}Hs(t,e,i){let s=t.get(e);return s===void 0&&(s=new gd(this,e,i),t.set(e,s)),s}}function As(n){return n==="left"||n==="right"}class q{constructor(t){this.Zs=new Map,this.Gs=[],this.Js=t}Qs(t,e){const i=function(s,r){return s===void 0?r:{tn:Math.max(s.tn,r.tn),sn:s.sn||r.sn}}(this.Zs.get(t),e);this.Zs.set(t,i)}nn(){return this.Js}en(t){const e=this.Zs.get(t);return e===void 0?{tn:this.Js}:{tn:Math.max(this.Js,e.tn),sn:e.sn}}rn(){this.hn(),this.Gs=[{an:0}]}ln(t){this.hn(),this.Gs=[{an:1,Ft:t}]}_n(t){this.un(),this.Gs.push({an:5,Ft:t})}hn(){this.un(),this.Gs.push({an:6})}cn(){this.hn(),this.Gs=[{an:4}]}dn(t){this.hn(),this.Gs.push({an:2,Ft:t})}fn(t){this.hn(),this.Gs.push({an:3,Ft:t})}pn(){return this.Gs}vn(t){for(const e of t.Gs)this.mn(e);this.Js=Math.max(this.Js,t.Js),t.Zs.forEach((e,i)=>{this.Qs(i,e)})}static wn(){return new q(2)}static gn(){return new q(3)}mn(t){switch(t.an){case 0:this.rn();break;case 1:this.ln(t.Ft);break;case 2:this.dn(t.Ft);break;case 3:this.fn(t.Ft);break;case 4:this.cn();break;case 5:this._n(t.Ft);break;case 6:this.un()}}un(){const t=this.Gs.findIndex(e=>e.an===5);t!==-1&&this.Gs.splice(t,1)}}const rr=".";function Et(n,t){if(!Ne(n))return"n/a";if(!Ei(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return t===0?n.toString():("0000000000000000"+n.toString()).slice(-t)}class Ls{constructor(t,e){if(e||(e=1),Ne(t)&&Ei(t)||(t=100),t<0)throw new TypeError("invalid base");this.Yi=t,this.Mn=e,this.bn()}format(t){const e=t<0?"−":"";return t=Math.abs(t),e+this.Sn(t)}bn(){if(this.xn=0,this.Yi>0&&this.Mn>0){let t=this.Yi;for(;t>1;)t/=10,this.xn++}}Sn(t){const e=this.Yi/this.Mn;let i=Math.floor(t),s="";const r=this.xn!==void 0?this.xn:NaN;if(e>1){let h=+(Math.round(t*e)-i*e).toFixed(this.xn);h>=e&&(h-=e,i+=1),s=rr+Et(+h.toFixed(this.xn)*this.Mn,r)}else i=Math.round(i*e)/e,r>0&&(s=rr+Et(0,r));return i.toFixed(0)+s}}class mo extends Ls{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class yd{constructor(t){this.Cn=t}format(t){let e="";return t<0&&(e="-",t=-t),t<995?e+this.yn(t):t<999995?e+this.yn(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this.yn(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.yn(t/1e9)+"B")}yn(t){let e;const i=Math.pow(10,this.Cn);return e=(t=Math.round(t*i)/i)>=1e-15&&t<1?t.toFixed(this.Cn).replace(/\.?0+$/,""):String(t),e.replace(/(\.[1-9]*)0+$/,(s,r)=>r)}}const _d=/[2-9]/g;class Ni{constructor(t=50){this.kn=0,this.Pn=1,this.Tn=1,this.Rn={},this.Dn=new Map,this.Vn=t}In(){this.kn=0,this.Dn.clear(),this.Pn=1,this.Tn=1,this.Rn={}}Vi(t,e,i){return this.Bn(t,e,i).width}Di(t,e,i){const s=this.Bn(t,e,i);return((s.actualBoundingBoxAscent||0)-(s.actualBoundingBoxDescent||0))/2}Bn(t,e,i){const s=i||_d,r=String(e).replace(s,"0");if(this.Dn.has(r))return K(this.Dn.get(r)).An;if(this.kn===this.Vn){const o=this.Rn[this.Tn];delete this.Rn[this.Tn],this.Dn.delete(o),this.Tn++,this.kn--}t.save(),t.textBaseline="middle";const h=t.measureText(r);return t.restore(),h.width===0&&e.length||(this.Dn.set(r,{An:h,En:this.Pn}),this.Rn[this.Pn]=r,this.kn++,this.Pn++),h}}class Md{constructor(t){this.zn=null,this.M=null,this.Ln="right",this.On=t}Nn(t,e,i){this.zn=t,this.M=e,this.Ln=i}nt(t){this.M!==null&&this.zn!==null&&this.zn.nt(t,this.M,this.On,this.Ln)}}class go{constructor(t,e,i){this.Wn=t,this.On=new Ni(50),this.Fn=e,this.O=i,this.W=-1,this.Gt=new Md(this.On)}Tt(){const t=this.O.Hn(this.Fn);if(t===null)return null;const e=t.Un(this.Fn)?t.$n():this.Fn.Wt();if(e===null)return null;const i=t.qn(e);if(i==="overlay")return null;const s=this.O.Yn();return s.k!==this.W&&(this.W=s.k,this.On.In()),this.Gt.Nn(this.Wn.$i(),s,i),this.Gt}}class xd extends se{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}jn(t,e){var h;if(!((h=this.Yt)!=null&&h.Vt))return null;const{ut:i,ct:s,Kn:r}=this.Yt;return e>=i-s-7&&e<=i+s+7?{Xn:this.Yt,Kn:r}:null}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.Yt===null||this.Yt.Vt===!1)return;const r=Math.round(this.Yt.ut*s);r<0||r>e.height||(t.lineCap="butt",t.strokeStyle=this.Yt.R,t.lineWidth=Math.floor(this.Yt.ct*i),Re(t,this.Yt.Xt),lo(t,r,0,e.width))}}class Vn{constructor(t){this.Zn={ut:0,R:"rgba(0, 0, 0, 0)",ct:1,Xt:0,Vt:!1},this.Gn=new xd,this.xt=!0,this.Jn=t,this.Qn=t.Qt(),this.Gn.ht(this.Zn)}kt(){this.xt=!0}Tt(){return this.Jn.Vt()?(this.xt&&(this.te(),this.xt=!1),this.Gn):null}}class Sd extends Vn{constructor(t){super(t)}te(){this.Zn.Vt=!1;const t=this.Jn.Wt(),e=t.ie().ie;if(e!==2&&e!==3)return;const i=this.Jn.N();if(!i.baseLineVisible||!this.Jn.Vt())return;const s=this.Jn.zt();s!==null&&(this.Zn.Vt=!0,this.Zn.ut=t.Nt(s.Ft,s.Ft),this.Zn.R=i.baseLineColor,this.Zn.ct=i.baseLineWidth,this.Zn.Xt=i.baseLineStyle)}}class Cd extends se{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}se(){return this.Yt}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){const s=this.Yt;if(s===null)return;const r=Math.max(1,Math.floor(e)),h=r%2/2,o=Math.round(s.ne.x*e)+h,l=s.ne.y*i;t.fillStyle=s.ee,t.beginPath();const a=Math.max(2,1.5*s.re)*e;t.arc(o,l,a,0,2*Math.PI,!1),t.fill(),t.fillStyle=s.he,t.beginPath(),t.arc(o,l,s.ft*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=s.ae,t.beginPath(),t.arc(o,l,s.ft*e+r/2,0,2*Math.PI,!1),t.stroke()}}const Td=[{le:0,oe:.25,_e:4,ue:10,ce:.25,de:0,fe:.4,pe:.8},{le:.25,oe:.525,_e:10,ue:14,ce:0,de:0,fe:.8,pe:0},{le:.525,oe:1,_e:14,ue:14,ce:0,de:0,fe:0,pe:0}];class kd{constructor(t){this.Gt=new Cd,this.xt=!0,this.ve=!0,this.me=performance.now(),this.we=this.me-1,this.ge=t}Me(){this.we=this.me-1,this.kt()}be(){if(this.kt(),this.ge.N().lastPriceAnimation===2){const t=performance.now(),e=this.we-t;if(e>0)return void(e<650&&(this.we+=2600));this.me=t,this.we=t+2600}}kt(){this.xt=!0}Se(){this.ve=!0}Vt(){return this.ge.N().lastPriceAnimation!==0}xe(){switch(this.ge.N().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.we}}Tt(){return this.xt?(this.Rt(),this.xt=!1,this.ve=!1):this.ve&&(this.Ce(),this.ve=!1),this.Gt}Rt(){this.Gt.ht(null);const t=this.ge.Qt().At(),e=t.ye(),i=this.ge.zt();if(e===null||i===null)return;const s=this.ge.ke(!0);if(s.Pe||!e.Te(s.Re))return;const r={x:t.qt(s.Re),y:this.ge.Wt().Nt(s.gt,i.Ft)},h=s.R,o=this.ge.N().lineWidth,l=this.De(this.Ve(),h);this.Gt.ht({ee:h,re:o,he:l.he,ae:l.ae,ft:l.ft,ne:r})}Ce(){const t=this.Gt.se();if(t!==null){const e=this.De(this.Ve(),t.ee);t.he=e.he,t.ae=e.ae,t.ft=e.ft}}Ve(){return this.xe()?performance.now()-this.me:2599}Ie(t,e,i,s){const r=i+(s-i)*e;return this.ge.Qt().Xi().j(t,r)}De(t,e){const i=t%2600/2600;let s;for(const a of Td)if(i>=a.le&&i<=a.oe){s=a;break}U(s!==void 0,"Last price animation internal logic error");const r=(i-s.le)/(s.oe-s.le);return{he:this.Ie(e,r,s.ce,s.de),ae:this.Ie(e,r,s.fe,s.pe),ft:(h=r,o=s._e,l=s.ue,o+(l-o)*h)};var h,o,l}}class Ed extends Vn{constructor(t){super(t)}te(){const t=this.Zn;t.Vt=!1;const e=this.Jn.N();if(!e.priceLineVisible||!this.Jn.Vt())return;const i=this.Jn.ke(e.priceLineSource===0);i.Pe||(t.Vt=!0,t.ut=i.Bi,t.R=this.Jn.Be(i.R),t.ct=e.priceLineWidth,t.Xt=e.priceLineStyle)}}class zd extends Ns{constructor(t){super(),this.Jt=t}qi(t,e,i){t.Vt=!1,e.Vt=!1;const s=this.Jt;if(!s.Vt())return;const r=s.N(),h=r.lastValueVisible,o=s.Ae()!=="",l=r.seriesLastValueMode===0,a=s.ke(!1);if(a.Pe)return;h&&(t.ri=this.Ee(a,h,l),t.Vt=t.ri.length!==0),(o||l)&&(e.ri=this.ze(a,h,o,l),e.Vt=e.ri.length>0);const u=s.Be(a.R),f=this.Jt.Qt().Xi().X(u);i.Z=f.Z,i.Bi=a.Bi,e.Ht=s.Qt().Ut(a.Bi/s.Wt().$t()),t.Ht=u,t.R=f.G,e.R=f.G}ze(t,e,i,s){let r="";const h=this.Jt.Ae();return i&&h.length!==0&&(r+=`${h} `),e&&s&&(r+=this.Jt.Wt().Le()?t.Oe:t.Ne),r.trim()}Ee(t,e,i){return e?i?this.Jt.Wt().Le()?t.Ne:t.Oe:t.ri:""}}function hr(n,t,e,i){const s=Number.isFinite(t),r=Number.isFinite(e);return s&&r?n(t,e):s||r?s?t:e:i}class Z{constructor(t,e){this.We=t,this.Fe=e}He(t){return t!==null&&this.We===t.We&&this.Fe===t.Fe}Ue(){return new Z(this.We,this.Fe)}$e(){return this.We}qe(){return this.Fe}Ye(){return this.Fe-this.We}Ki(){return this.Fe===this.We||Number.isNaN(this.Fe)||Number.isNaN(this.We)}vn(t){return t===null?this:new Z(hr(Math.min,this.$e(),t.$e(),-1/0),hr(Math.max,this.qe(),t.qe(),1/0))}je(t){if(!Ne(t)||this.Fe-this.We===0)return;const e=.5*(this.Fe+this.We);let i=this.Fe-e,s=this.We-e;i*=t,s*=t,this.Fe=e+i,this.We=e+s}Ke(t){Ne(t)&&(this.Fe+=t,this.We+=t)}Xe(){return{minValue:this.We,maxValue:this.Fe}}static Ze(t){return t===null?null:new Z(t.minValue,t.maxValue)}}class ys{constructor(t,e){this.Ge=t,this.Je=e||null}Qe(){return this.Ge}tr(){return this.Je}Xe(){return{priceRange:this.Ge===null?null:this.Ge.Xe(),margins:this.Je||void 0}}static Ze(t){return t===null?null:new ys(Z.Ze(t.priceRange),t.margins)}}class Rd extends Vn{constructor(t,e){super(t),this.ir=e}te(){const t=this.Zn;t.Vt=!1;const e=this.ir.N();if(!this.Jn.Vt()||!e.lineVisible)return;const i=this.ir.sr();i!==null&&(t.Vt=!0,t.ut=i,t.R=e.color,t.ct=e.lineWidth,t.Xt=e.lineStyle,t.Kn=this.ir.N().id)}}class Nd extends Ns{constructor(t,e){super(),this.ge=t,this.ir=e}qi(t,e,i){t.Vt=!1,e.Vt=!1;const s=this.ir.N(),r=s.axisLabelVisible,h=s.title!=="",o=this.ge;if(!r||!o.Vt())return;const l=this.ir.sr();if(l===null)return;h&&(e.ri=s.title,e.Vt=!0),e.Ht=o.Qt().Ut(l/o.Wt().$t()),t.ri=this.nr(s.price),t.Vt=!0;const a=this.ge.Qt().Xi().X(s.axisLabelColor||s.color);i.Z=a.Z;const u=s.axisLabelTextColor||a.G;t.R=u,e.R=u,i.Bi=l}nr(t){const e=this.ge.zt();return e===null?"":this.ge.Wt().Zi(t,e.Ft)}}class Ad{constructor(t,e){this.ge=t,this.ys=e,this.er=new Rd(t,this),this.Wn=new Nd(t,this),this.rr=new go(this.Wn,t,t.Qt())}hr(t){st(this.ys,t),this.kt(),this.ge.Qt().ar()}N(){return this.ys}lr(){return this.er}_r(){return this.rr}ur(){return this.Wn}kt(){this.er.kt(),this.Wn.kt()}sr(){const t=this.ge,e=t.Wt();if(t.Qt().At().Ki()||e.Ki())return null;const i=t.zt();return i===null?null:e.Nt(this.ys.price,i.Ft)}}class Ld extends po{constructor(t){super(),this.ts=t}Qt(){return this.ts}}const Bd={Bar:(n,t,e,i)=>{const s=t.upColor,r=t.downColor,h=w(n(e,i)),o=Ht(h.Ft[0])<=Ht(h.Ft[3]);return{cr:h.R??(o?s:r)}},Candlestick:(n,t,e,i)=>{const s=t.upColor,r=t.downColor,h=t.borderUpColor,o=t.borderDownColor,l=t.wickUpColor,a=t.wickDownColor,u=w(n(e,i)),f=Ht(u.Ft[0])<=Ht(u.Ft[3]);return{cr:u.R??(f?s:r),dr:u.Ht??(f?h:o),pr:u.vr??(f?l:a)}},Custom:(n,t,e,i)=>({cr:w(n(e,i)).R??t.color}),Area:(n,t,e,i)=>{const s=w(n(e,i));return{cr:s.vt??t.lineColor,vt:s.vt??t.lineColor,mr:s.mr??t.topColor,wr:s.wr??t.bottomColor}},Baseline:(n,t,e,i)=>{const s=w(n(e,i));return{cr:s.Ft[3]>=t.baseValue.price?t.topLineColor:t.bottomLineColor,gr:s.gr??t.topLineColor,Mr:s.Mr??t.bottomLineColor,br:s.br??t.topFillColor1,Sr:s.Sr??t.topFillColor2,Cr:s.Cr??t.bottomFillColor1,yr:s.yr??t.bottomFillColor2}},Line:(n,t,e,i)=>{const s=w(n(e,i));return{cr:s.R??t.color,vt:s.R??t.color}},Histogram:(n,t,e,i)=>({cr:w(n(e,i)).R??t.color})};class Od{constructor(t){this.kr=(e,i)=>i!==void 0?i.Ft:this.ge.Xs().Pr(e),this.ge=t,this.Tr=Bd[t.Rr()]}Dr(t,e){return this.Tr(this.kr,this.ge.N(),t,e)}}function vo(n,t,e,i,s=0,r=t.length){let h=r-s;for(;0<h;){const o=h>>1,l=s+o;i(t[l],e)===n?(s=l+1,h-=o+1):h=o}return s}const ti=vo.bind(null,!0),wo=vo.bind(null,!1);var or;(function(n){n[n.NearestLeft=-1]="NearestLeft",n[n.None=0]="None",n[n.NearestRight=1]="NearestRight"})(or||(or={}));const Nt=30;class Vd{constructor(){this.Vr=[],this.Ir=new Map,this.Br=new Map,this.Ar=[]}Er(){return this.zr()>0?this.Vr[this.Vr.length-1]:null}Lr(){return this.zr()>0?this.Or(0):null}Ks(){return this.zr()>0?this.Or(this.Vr.length-1):null}zr(){return this.Vr.length}Ki(){return this.zr()===0}Te(t){return this.Nr(t,0)!==null}Pr(t){return this.Wr(t)}Wr(t,e=0){const i=this.Nr(t,e);return i===null?null:{...this.Fr(i),Re:this.Or(i)}}Hr(){return this.Vr}Ur(t,e,i){if(this.Ki())return null;let s=null;for(const r of i)s=ls(s,this.$r(t,e,r));return s}ht(t){this.Br.clear(),this.Ir.clear(),this.Vr=t,this.Ar=t.map(e=>e.Re)}qr(){return this.Ar}Or(t){return this.Vr[t].Re}Fr(t){return this.Vr[t]}Nr(t,e){const i=this.Yr(t);if(i===null&&e!==0)switch(e){case-1:return this.jr(t);case 1:return this.Kr(t);default:throw new TypeError("Unknown search mode")}return i}jr(t){let e=this.Xr(t);return e>0&&(e-=1),e!==this.Vr.length&&this.Or(e)<t?e:null}Kr(t){const e=this.Zr(t);return e!==this.Vr.length&&t<this.Or(e)?e:null}Yr(t){const e=this.Xr(t);return e===this.Vr.length||t<this.Vr[e].Re?null:e}Xr(t){return ti(this.Vr,t,(e,i)=>e.Re<i)}Zr(t){return wo(this.Vr,t,(e,i)=>e.Re>i)}Gr(t,e,i){let s=null;for(let r=t;r<e;r++){const h=this.Vr[r].Ft[i];Number.isNaN(h)||(s===null?s={Jr:h,Qr:h}:(h<s.Jr&&(s.Jr=h),h>s.Qr&&(s.Qr=h)))}return s}$r(t,e,i){if(this.Ki())return null;let s=null;const r=w(this.Lr()),h=w(this.Ks()),o=Math.max(t,r),l=Math.min(e,h),a=Math.ceil(o/Nt)*Nt,u=Math.max(a,Math.floor(l/Nt)*Nt);{const p=this.Xr(o),g=this.Zr(Math.min(l,a,e));s=ls(s,this.Gr(p,g,i))}let f=this.Ir.get(i);f===void 0&&(f=new Map,this.Ir.set(i,f));for(let p=Math.max(a+1,o);p<u;p+=Nt){const g=Math.floor(p/Nt);let v=f.get(g);if(v===void 0){const b=this.Xr(g*Nt),M=this.Zr((g+1)*Nt-1);v=this.Gr(b,M,i),f.set(g,v)}s=ls(s,v)}{const p=this.Xr(u),g=this.Zr(l);s=ls(s,this.Gr(p,g,i))}return s}}function ls(n,t){return n===null?t:t===null?n:{Jr:Math.min(n.Jr,t.Jr),Qr:Math.max(n.Qr,t.Qr)}}class Pd{constructor(t){this.th=t}nt(t,e,i){this.th.draw(t)}ih(t,e,i){var s,r;(r=(s=this.th).drawBackground)==null||r.call(s,t)}}class Dd{constructor(t){this.Dn=null,this.sh=t}Tt(){var i;const t=this.sh.renderer();if(t===null)return null;if(((i=this.Dn)==null?void 0:i.nh)===t)return this.Dn.eh;const e=new Pd(t);return this.Dn={nh:t,eh:e},e}rh(){var t,e;return((e=(t=this.sh).zOrder)==null?void 0:e.call(t))??"normal"}}class bo{constructor(t){this.hh=null,this.ah=t}oh(){return this.ah}Ns(){var t,e;(e=(t=this.ah).updateAllViews)==null||e.call(t)}Ws(){var i,s,r;const t=((s=(i=this.ah).paneViews)==null?void 0:s.call(i))??[];if(((r=this.hh)==null?void 0:r.nh)===t)return this.hh.eh;const e=t.map(h=>new Dd(h));return this.hh={nh:t,eh:e},e}jn(t,e){var i,s;return((s=(i=this.ah).hitTest)==null?void 0:s.call(i,t,e))??null}}let Id=class extends bo{us(){return[]}};class $d{constructor(t){this.th=t}nt(t,e,i){this.th.draw(t)}ih(t,e,i){var s,r;(r=(s=this.th).drawBackground)==null||r.call(s,t)}}class lr{constructor(t){this.Dn=null,this.sh=t}Tt(){var i;const t=this.sh.renderer();if(t===null)return null;if(((i=this.Dn)==null?void 0:i.nh)===t)return this.Dn.eh;const e=new $d(t);return this.Dn={nh:t,eh:e},e}rh(){var t,e;return((e=(t=this.sh).zOrder)==null?void 0:e.call(t))??"normal"}}function yo(n){var t,e,i;return{ri:n.text(),Bi:n.coordinate(),Ii:(t=n.fixedCoordinate)==null?void 0:t.call(n),R:n.textColor(),Z:n.backColor(),Vt:((e=n.visible)==null?void 0:e.call(n))??!0,pi:((i=n.tickVisible)==null?void 0:i.call(n))??!0}}class Yd{constructor(t,e){this.Gt=new fo,this._h=t,this.uh=e}Tt(){return this.Gt.ht({Qi:this.uh.Qi(),...yo(this._h)}),this.Gt}}class Fd extends Ns{constructor(t,e){super(),this._h=t,this.Yi=e}qi(t,e,i){const s=yo(this._h);i.Z=s.Z,t.R=s.R;const r=2/12*this.Yi.k();i.Ti=r,i.Ri=r,i.Bi=s.Bi,i.Ii=s.Ii,t.ri=s.ri,t.Vt=s.Vt,t.pi=s.pi}}class Wd extends bo{constructor(t,e){super(t),this.dh=null,this.fh=null,this.ph=null,this.mh=null,this.ge=e}cs(){var s,r,h;const t=((r=(s=this.ah).timeAxisViews)==null?void 0:r.call(s))??[];if(((h=this.dh)==null?void 0:h.nh)===t)return this.dh.eh;const e=this.ge.Qt().At(),i=t.map(o=>new Yd(o,e));return this.dh={nh:t,eh:i},i}Fs(){var s,r,h;const t=((r=(s=this.ah).priceAxisViews)==null?void 0:r.call(s))??[];if(((h=this.fh)==null?void 0:h.nh)===t)return this.fh.eh;const e=this.ge.Wt(),i=t.map(o=>new Fd(o,e));return this.fh={nh:t,eh:i},i}wh(){var i,s,r;const t=((s=(i=this.ah).priceAxisPaneViews)==null?void 0:s.call(i))??[];if(((r=this.ph)==null?void 0:r.nh)===t)return this.ph.eh;const e=t.map(h=>new lr(h));return this.ph={nh:t,eh:e},e}gh(){var i,s,r;const t=((s=(i=this.ah).timeAxisPaneViews)==null?void 0:s.call(i))??[];if(((r=this.mh)==null?void 0:r.nh)===t)return this.mh.eh;const e=t.map(h=>new lr(h));return this.mh={nh:t,eh:e},e}Mh(t,e){var i,s;return((s=(i=this.ah).autoscaleInfo)==null?void 0:s.call(i,t,e))??null}}function Ws(n,t,e,i){n.forEach(s=>{t(s).forEach(r=>{r.rh()===e&&i.push(r)})})}function qs(n){return n.Ws()}function qd(n){return n.wh()}function Hd(n){return n.gh()}const Qd=["Area","Line","Baseline"];class Bs extends Ld{constructor(t,e,i,s,r){super(t),this.Yt=new Vd,this.er=new Ed(this),this.bh=[],this.Sh=new Sd(this),this.xh=null,this.Ch=null,this.yh=null,this.kh=[],this.ys=i,this.Ph=e;const h=new zd(this);this.vs=[h],this.rr=new go(h,this,t),Qd.includes(this.Ph)&&(this.xh=new kd(this)),this.Th(),this.sh=s(this,this.Qt(),r)}m(){this.yh!==null&&clearTimeout(this.yh)}Be(t){return this.ys.priceLineColor||t}ke(t){const e={Pe:!0},i=this.Wt();if(this.Qt().At().Ki()||i.Ki()||this.Yt.Ki())return e;const s=this.Qt().At().ye(),r=this.zt();if(s===null||r===null)return e;let h,o;if(t){const f=this.Yt.Er();if(f===null)return e;h=f,o=f.Re}else{const f=this.Yt.Wr(s.bi(),-1);if(f===null||(h=this.Yt.Pr(f.Re),h===null))return e;o=f.Re}const l=h.Ft[3],a=this.Rh().Dr(o,{Ft:h}),u=i.Nt(l,r.Ft);return{Pe:!1,gt:l,ri:i.Zi(l,r.Ft),Oe:i.Dh(l),Ne:i.Vh(l,r.Ft),R:a.cr,Bi:u,Re:o}}Rh(){return this.Ch!==null||(this.Ch=new Od(this)),this.Ch}N(){return this.ys}hr(t){const e=t.priceScaleId;e!==void 0&&e!==this.ys.priceScaleId&&this.Qt().Ih(this,e),st(this.ys,t),t.priceFormat!==void 0&&(this.Th(),this.Qt().Bh()),this.Qt().Ah(this),this.Qt().Eh(),this.sh.kt("options")}ht(t,e){this.Yt.ht(t),this.sh.kt("data"),this.xh!==null&&(e&&e.zh?this.xh.be():t.length===0&&this.xh.Me());const i=this.Qt().Hn(this);this.Qt().Lh(i),this.Qt().Ah(this),this.Qt().Eh(),this.Qt().ar()}Oh(t){const e=new Ad(this,t);return this.bh.push(e),this.Qt().Ah(this),e}Nh(t){const e=this.bh.indexOf(t);e!==-1&&this.bh.splice(e,1),this.Qt().Ah(this)}Wh(){return this.bh}Rr(){return this.Ph}zt(){const t=this.Fh();return t===null?null:{Ft:t.Ft[3],Hh:t.wt}}Fh(){const t=this.Qt().At().ye();if(t===null)return null;const e=t.Uh();return this.Yt.Wr(e,1)}Xs(){return this.Yt}$h(t){const e=this.Yt.Pr(t);return e===null?null:this.Ph==="Bar"||this.Ph==="Candlestick"||this.Ph==="Custom"?{qh:e.Ft[0],Yh:e.Ft[1],jh:e.Ft[2],Kh:e.Ft[3]}:e.Ft[3]}Xh(t){const e=[];Ws(this.kh,qs,"top",e);const i=this.xh;return i!==null&&i.Vt()&&(this.yh===null&&i.xe()&&(this.yh=setTimeout(()=>{this.yh=null,this.Qt().Zh()},0)),i.Se(),e.unshift(i)),e}Ws(){const t=[];this.Gh()||t.push(this.Sh),t.push(this.sh,this.er);const e=this.bh.map(i=>i.lr());return t.push(...e),Ws(this.kh,qs,"normal",t),t}Jh(){return this.Qh(qs,"bottom")}ta(t){return this.Qh(qd,t)}ia(t){return this.Qh(Hd,t)}sa(t,e){return this.kh.map(i=>i.jn(t,e)).filter(i=>i!==null)}us(){return[this.rr,...this.bh.map(t=>t._r())]}Fs(t,e){if(e!==this.es&&!this.Gh())return[];const i=[...this.vs];for(const s of this.bh)i.push(s.ur());return this.kh.forEach(s=>{i.push(...s.Fs())}),i}cs(){const t=[];return this.kh.forEach(e=>{t.push(...e.cs())}),t}Mh(t,e){if(this.ys.autoscaleInfoProvider!==void 0){const i=this.ys.autoscaleInfoProvider(()=>{const s=this.na(t,e);return s===null?null:s.Xe()});return ys.Ze(i)}return this.na(t,e)}ea(){return this.ys.priceFormat.minMove}ra(){return this.ha}Ns(){var t;this.sh.kt();for(const e of this.vs)e.kt();for(const e of this.bh)e.kt();this.er.kt(),this.Sh.kt(),(t=this.xh)==null||t.kt(),this.kh.forEach(e=>e.Ns())}Wt(){return w(super.Wt())}Et(t){if(!((this.Ph==="Line"||this.Ph==="Area"||this.Ph==="Baseline")&&this.ys.crosshairMarkerVisible))return null;const e=this.Yt.Pr(t);return e===null?null:{gt:e.Ft[3],ft:this.aa(),Ht:this.la(),Ot:this.oa(),Lt:this._a(t)}}Ae(){return this.ys.title}Vt(){return this.ys.visible}ua(t){this.kh.push(new Wd(t,this))}ca(t){this.kh=this.kh.filter(e=>e.oh()!==t)}da(){if(this.Ph==="Custom")return t=>this.sh.fa(t)}pa(){if(this.Ph==="Custom")return t=>this.sh.va(t)}ma(){return this.Yt.qr()}Gh(){return!As(this.Wt().wa())}na(t,e){if(!Ei(t)||!Ei(e)||this.Yt.Ki())return null;const i=this.Ph==="Line"||this.Ph==="Area"||this.Ph==="Baseline"||this.Ph==="Histogram"?[3]:[2,1],s=this.Yt.Ur(t,e,i);let r=s!==null?new Z(s.Jr,s.Qr):null,h=null;if(this.Rr()==="Histogram"){const o=this.ys.base,l=new Z(o,o);r=r!==null?r.vn(l):l}return this.kh.forEach(o=>{const l=o.Mh(t,e);if(l!=null&&l.priceRange){const a=new Z(l.priceRange.minValue,l.priceRange.maxValue);r=r!==null?r.vn(a):a}l!=null&&l.margins&&(h=l.margins)}),new ys(r,h)}aa(){switch(this.Ph){case"Line":case"Area":case"Baseline":return this.ys.crosshairMarkerRadius}return 0}la(){switch(this.Ph){case"Line":case"Area":case"Baseline":{const t=this.ys.crosshairMarkerBorderColor;if(t.length!==0)return t}}return null}oa(){switch(this.Ph){case"Line":case"Area":case"Baseline":return this.ys.crosshairMarkerBorderWidth}return 0}_a(t){switch(this.Ph){case"Line":case"Area":case"Baseline":{const e=this.ys.crosshairMarkerBackgroundColor;if(e.length!==0)return e}}return this.Rh().Dr(t).cr}Th(){switch(this.ys.priceFormat.type){case"custom":this.ha={format:this.ys.priceFormat.formatter};break;case"volume":this.ha=new yd(this.ys.priceFormat.precision);break;case"percent":this.ha=new mo(this.ys.priceFormat.precision);break;default:{const t=Math.pow(10,this.ys.priceFormat.precision);this.ha=new Ls(t,this.ys.priceFormat.minMove*t)}}this.es!==null&&this.es.ga()}Qh(t,e){const i=[];return Ws(this.kh,t,e,i),i}}const Xd=[3],Ud=[0,1,2,3];class Jd{constructor(t){this.ys=t}Ma(t,e,i){let s=t;if(this.ys.mode===0)return s;const r=i.Ps(),h=r.zt();if(h===null)return s;const o=r.Nt(t,h),l=i.ba().filter(u=>u instanceof Bs).reduce((u,f)=>{if(i.Un(f)||!f.Vt())return u;const p=f.Wt(),g=f.Xs();if(p.Ki()||!g.Te(e))return u;const v=g.Pr(e);if(v===null)return u;const b=Ht(f.zt()),M=this.ys.mode===3?Ud:Xd;return u.concat(M.map(S=>p.Nt(v.Ft[S],b.Ft)))},[]);if(l.length===0)return s;l.sort((u,f)=>Math.abs(u-o)-Math.abs(f-o));const a=l[0];return s=r.Ts(a,h),s}}function Pe(n,t,e){return Math.min(Math.max(n,t),e)}function as(n,t,e){return t-n<=e}function Pn(n){const t=Math.ceil(n);return t%2==0?t-1:t}class Zd extends se{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.Yt===null)return;const r=Math.max(1,Math.floor(i));t.lineWidth=r,function(h,o){h.save(),h.lineWidth%2&&h.translate(.5,.5),o(),h.restore()}(t,()=>{const h=w(this.Yt);if(h.Sa){t.strokeStyle=h.xa,Re(t,h.Ca),t.beginPath();for(const o of h.ya){const l=Math.round(o.ka*i);t.moveTo(l,-r),t.lineTo(l,e.height+r)}t.stroke()}if(h.Pa){t.strokeStyle=h.Ta,Re(t,h.Ra),t.beginPath();for(const o of h.Da){const l=Math.round(o.ka*s);t.moveTo(-r,l),t.lineTo(e.width+r,l)}t.stroke()}})}}class jd{constructor(t){this.Gt=new Zd,this.xt=!0,this.yt=t}kt(){this.xt=!0}Tt(){if(this.xt){const t=this.yt.Qt().N().grid,e={Pa:t.horzLines.visible,Sa:t.vertLines.visible,Ta:t.horzLines.color,xa:t.vertLines.color,Ra:t.horzLines.style,Ca:t.vertLines.style,Da:this.yt.Ps().Va(),ya:(this.yt.Qt().At().Va()||[]).map(i=>({ka:i.coord}))};this.Gt.ht(e),this.xt=!1}return this.Gt}}class Gd{constructor(t){this.sh=new jd(t)}lr(){return this.sh}}const Hs={Ia:4,Ba:1e-4};function Ve(n,t){const e=100*(n-t)/t;return t<0?-e:e}function Kd(n,t){const e=Ve(n.$e(),t),i=Ve(n.qe(),t);return new Z(e,i)}function xi(n,t){const e=100*(n-t)/t+100;return t<0?-e:e}function tf(n,t){const e=xi(n.$e(),t),i=xi(n.qe(),t);return new Z(e,i)}function _s(n,t){const e=Math.abs(n);if(e<1e-15)return 0;const i=Math.log10(e+t.Ba)+t.Ia;return n<0?-i:i}function Si(n,t){const e=Math.abs(n);if(e<1e-15)return 0;const i=Math.pow(10,e-t.Ia)-t.Ba;return n<0?-i:i}function fi(n,t){if(n===null)return null;const e=_s(n.$e(),t),i=_s(n.qe(),t);return new Z(e,i)}function bi(n,t){if(n===null)return null;const e=Si(n.$e(),t),i=Si(n.qe(),t);return new Z(e,i)}function Qs(n){if(n===null)return Hs;const t=Math.abs(n.qe()-n.$e());if(t>=1||t<1e-15)return Hs;const e=Math.ceil(Math.abs(Math.log10(t))),i=Hs.Ia+e;return{Ia:i,Ba:1/Math.pow(10,i)}}class Xs{constructor(t,e){if(this.Aa=t,this.Ea=e,function(i){if(i<0)return!1;for(let s=i;s>1;s/=10)if(s%10!=0)return!1;return!0}(this.Aa))this.za=[2,2.5,2];else{this.za=[];for(let i=this.Aa;i!==1;){if(i%2==0)this.za.push(2),i/=2;else{if(i%5!=0)throw new Error("unexpected base");this.za.push(2,2.5),i/=5}if(this.za.length>100)throw new Error("something wrong with base")}}}La(t,e,i){const s=this.Aa===0?0:1/this.Aa;let r=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-e)))),h=0,o=this.Ea[0];for(;;){const f=as(r,s,1e-14)&&r>s+1e-14,p=as(r,i*o,1e-14),g=as(r,1,1e-14);if(!(f&&p&&g))break;r/=o,o=this.Ea[++h%this.Ea.length]}if(r<=s+1e-14&&(r=s),r=Math.max(1,r),this.za.length>0&&(l=r,a=1,u=1e-14,Math.abs(l-a)<u))for(h=0,o=this.za[0];as(r,i*o,1e-14)&&r>s+1e-14;)r/=o,o=this.za[++h%this.za.length];var l,a,u;return r}}class ar{constructor(t,e,i,s){this.Oa=[],this.Yi=t,this.Aa=e,this.Na=i,this.Wa=s}La(t,e){if(t<e)throw new Error("high < low");const i=this.Yi.$t(),s=(t-e)*this.Fa()/i,r=new Xs(this.Aa,[2,2.5,2]),h=new Xs(this.Aa,[2,2,2.5]),o=new Xs(this.Aa,[2.5,2,2]),l=[];return l.push(r.La(t,e,s),h.La(t,e,s),o.La(t,e,s)),function(a){if(a.length<1)throw Error("array is empty");let u=a[0];for(let f=1;f<a.length;++f)a[f]<u&&(u=a[f]);return u}(l)}Ha(){const t=this.Yi,e=t.zt();if(e===null)return void(this.Oa=[]);const i=t.$t(),s=this.Na(i-1,e),r=this.Na(0,e),h=this.Yi.N().entireTextOnly?this.Ua()/2:0,o=h,l=i-1-h,a=Math.max(s,r),u=Math.min(s,r);if(a===u)return void(this.Oa=[]);const f=this.La(a,u);if(this.$a(e,f,a,u,o,l),t.qa()&&this.Ya(f,u,a)){const p=this.Yi.ja();this.Ka(e,f,o,l,p,2*p)}}Va(){return this.Oa}Ua(){return this.Yi.k()}Fa(){return Math.ceil(2.5*this.Ua())}$a(t,e,i,s,r,h){const o=this.Oa,l=this.Yi;let a=i%e;a+=a<0?e:0;const u=i>=s?1:-1;let f=null,p=0;for(let g=i-a;g>s;g-=e){const v=this.Wa(g,t,!0);f!==null&&Math.abs(v-f)<this.Fa()||v<r||v>h||(p<o.length?(o[p].ka=v,o[p].Xa=l.Za(g)):o.push({ka:v,Xa:l.Za(g)}),p++,f=v,l.Ga()&&(e=this.La(g*u,s)))}o.length=p}Ka(t,e,i,s,r,h){const o=this.Oa,l=this.Ja(t,i,r,h),a=this.Ja(t,s,-h,-r),u=this.Wa(0,t,!0)-this.Wa(e,t,!0);o.length>0&&o[0].ka-l.ka<u/2&&o.shift(),o.length>0&&a.ka-o[o.length-1].ka<u/2&&o.pop(),o.unshift(l),o.push(a)}Ja(t,e,i,s){const r=(i+s)/2,h=this.Na(e+i,t),o=this.Na(e+s,t),l=Math.min(h,o),a=Math.max(h,o),u=Math.max(.1,this.La(a,l)),f=this.Na(e+r,t),p=f-f%u,g=this.Wa(p,t,!0);return{Xa:this.Yi.Za(p),ka:g}}Ya(t,e,i){let s=Ht(this.Yi.Qe());return this.Yi.Ga()&&(s=bi(s,this.Yi.Qa())),s.$e()-e<t&&i-s.qe()<t}}function _o(n){return n.slice().sort((t,e)=>w(t.hs())-w(e.hs()))}var cr;(function(n){n[n.Normal=0]="Normal",n[n.Logarithmic=1]="Logarithmic",n[n.Percentage=2]="Percentage",n[n.IndexedTo100=3]="IndexedTo100"})(cr||(cr={}));const ur=new mo,dr=new Ls(100,1);class ef{constructor(t,e,i,s,r){this.tl=0,this.il=null,this.Ge=null,this.sl=null,this.nl={el:!1,rl:null},this.hl=!1,this.al=0,this.ll=0,this.ol=new V,this._l=new V,this.ul=[],this.cl=null,this.dl=null,this.fl=null,this.pl=null,this.vl=null,this.ha=dr,this.ml=Qs(null),this.wl=t,this.ys=e,this.gl=i,this.Ml=s,this.bl=r,this.Sl=new ar(this,100,this.xl.bind(this),this.Cl.bind(this))}wa(){return this.wl}N(){return this.ys}hr(t){if(st(this.ys,t),this.ga(),t.mode!==void 0&&this.yl({ie:t.mode}),t.scaleMargins!==void 0){const e=K(t.scaleMargins.top),i=K(t.scaleMargins.bottom);if(e<0||e>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${e}`);if(i<0||i>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${i}`);if(e+i>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${e+i}`);this.kl(),this.fl=null}}Pl(){return this.ys.autoScale}Tl(){return this.hl}Ga(){return this.ys.mode===1}Le(){return this.ys.mode===2}Rl(){return this.ys.mode===3}Qa(){return this.ml}ie(){return{sn:this.ys.autoScale,Dl:this.ys.invertScale,ie:this.ys.mode}}yl(t){const e=this.ie();let i=null;t.sn!==void 0&&(this.ys.autoScale=t.sn),t.ie!==void 0&&(this.ys.mode=t.ie,t.ie!==2&&t.ie!==3||(this.ys.autoScale=!0),this.nl.el=!1),e.ie===1&&t.ie!==e.ie&&(function(r,h){if(r===null)return!1;const o=Si(r.$e(),h),l=Si(r.qe(),h);return isFinite(o)&&isFinite(l)}(this.Ge,this.ml)?(i=bi(this.Ge,this.ml),i!==null&&this.Vl(i)):this.ys.autoScale=!0),t.ie===1&&t.ie!==e.ie&&(i=fi(this.Ge,this.ml),i!==null&&this.Vl(i));const s=e.ie!==this.ys.mode;s&&(e.ie===2||this.Le())&&this.ga(),s&&(e.ie===3||this.Rl())&&this.ga(),t.Dl!==void 0&&e.Dl!==t.Dl&&(this.ys.invertScale=t.Dl,this.Il()),this._l.p(e,this.ie())}Bl(){return this._l}k(){return this.gl.fontSize}$t(){return this.tl}Al(t){this.tl!==t&&(this.tl=t,this.kl(),this.fl=null)}El(){if(this.il)return this.il;const t=this.$t()-this.zl()-this.Ll();return this.il=t,t}Qe(){return this.Ol(),this.Ge}Vl(t,e){const i=this.Ge;(e||i===null&&t!==null||i!==null&&!i.He(t))&&(this.fl=null,this.Ge=t)}Nl(t){this.Vl(t),this.Wl(t!==null)}Ki(){return this.Ol(),this.tl===0||!this.Ge||this.Ge.Ki()}Fl(t){return this.Dl()?t:this.$t()-1-t}Nt(t,e){return this.Le()?t=Ve(t,e):this.Rl()&&(t=xi(t,e)),this.Cl(t,e)}Hl(t,e,i){this.Ol();const s=this.Ll(),r=w(this.Qe()),h=r.$e(),o=r.qe(),l=this.El()-1,a=this.Dl(),u=l/(o-h),f=i===void 0?0:i.from,p=i===void 0?t.length:i.to,g=this.Ul();for(let v=f;v<p;v++){const b=t[v],M=b.gt;if(isNaN(M))continue;let S=M;g!==null&&(S=g(b.gt,e));const R=s+u*(S-h),B=a?R:this.tl-1-R;b.ut=B}}$l(t,e,i){this.Ol();const s=this.Ll(),r=w(this.Qe()),h=r.$e(),o=r.qe(),l=this.El()-1,a=this.Dl(),u=l/(o-h),f=i===void 0?0:i.from,p=i===void 0?t.length:i.to,g=this.Ul();for(let v=f;v<p;v++){const b=t[v];let M=b.qh,S=b.Yh,R=b.jh,B=b.Kh;g!==null&&(M=g(b.qh,e),S=g(b.Yh,e),R=g(b.jh,e),B=g(b.Kh,e));let O=s+u*(M-h),et=a?O:this.tl-1-O;b.ql=et,O=s+u*(S-h),et=a?O:this.tl-1-O,b.Yl=et,O=s+u*(R-h),et=a?O:this.tl-1-O,b.jl=et,O=s+u*(B-h),et=a?O:this.tl-1-O,b.Kl=et}}Ts(t,e){const i=this.xl(t,e);return this.Xl(i,e)}Xl(t,e){let i=t;return this.Le()?i=function(s,r){return r<0&&(s=-s),s/100*r+r}(i,e):this.Rl()&&(i=function(s,r){return s-=100,r<0&&(s=-s),s/100*r+r}(i,e)),i}ba(){return this.ul}Dt(){return this.dl||(this.dl=_o(this.ul)),this.dl}Zl(t){this.ul.indexOf(t)===-1&&(this.ul.push(t),this.ga(),this.Gl())}Jl(t){const e=this.ul.indexOf(t);if(e===-1)throw new Error("source is not attached to scale");this.ul.splice(e,1),this.ul.length===0&&(this.yl({sn:!0}),this.Vl(null)),this.ga(),this.Gl()}zt(){let t=null;for(const e of this.ul){const i=e.zt();i!==null&&(t===null||i.Hh<t.Hh)&&(t=i)}return t===null?null:t.Ft}Dl(){return this.ys.invertScale}Va(){const t=this.zt()===null;if(this.fl!==null&&(t||this.fl.Ql===t))return this.fl.Va;this.Sl.Ha();const e=this.Sl.Va();return this.fl={Va:e,Ql:t},this.ol.p(),e}io(){return this.ol}so(t){this.Le()||this.Rl()||this.pl===null&&this.sl===null&&(this.Ki()||(this.pl=this.tl-t,this.sl=w(this.Qe()).Ue()))}no(t){if(this.Le()||this.Rl()||this.pl===null)return;this.yl({sn:!1}),(t=this.tl-t)<0&&(t=0);let e=(this.pl+.2*(this.tl-1))/(t+.2*(this.tl-1));const i=w(this.sl).Ue();e=Math.max(e,.1),i.je(e),this.Vl(i)}eo(){this.Le()||this.Rl()||(this.pl=null,this.sl=null)}ro(t){this.Pl()||this.vl===null&&this.sl===null&&(this.Ki()||(this.vl=t,this.sl=w(this.Qe()).Ue()))}ho(t){if(this.Pl()||this.vl===null)return;const e=w(this.Qe()).Ye()/(this.El()-1);let i=t-this.vl;this.Dl()&&(i*=-1);const s=i*e,r=w(this.sl).Ue();r.Ke(s),this.Vl(r,!0),this.fl=null}ao(){this.Pl()||this.vl!==null&&(this.vl=null,this.sl=null)}ra(){return this.ha||this.ga(),this.ha}Zi(t,e){switch(this.ys.mode){case 2:return this.lo(Ve(t,e));case 3:return this.ra().format(xi(t,e));default:return this.nr(t)}}Za(t){switch(this.ys.mode){case 2:return this.lo(t);case 3:return this.ra().format(t);default:return this.nr(t)}}Dh(t){return this.nr(t,w(this.cl).ra())}Vh(t,e){return t=Ve(t,e),this.lo(t,ur)}oo(){return this.ul}_o(t){this.nl={rl:t,el:!1}}Ns(){this.ul.forEach(t=>t.Ns())}qa(){return this.ys.ensureEdgeTickMarksVisible&&this.Pl()}ja(){return this.k()/2}ga(){this.fl=null;let t=1/0;this.cl=null;for(const i of this.ul)i.hs()<t&&(t=i.hs(),this.cl=i);let e=100;this.cl!==null&&(e=Math.round(1/this.cl.ea())),this.ha=dr,this.Le()?(this.ha=ur,e=100):this.Rl()?(this.ha=new Ls(100,1),e=100):this.cl!==null&&(this.ha=this.cl.ra()),this.Sl=new ar(this,e,this.xl.bind(this),this.Cl.bind(this)),this.Sl.Ha()}Gl(){this.dl=null}Xi(){return this.bl}Wl(t){this.hl=t}zl(){return this.Dl()?this.ys.scaleMargins.bottom*this.$t()+this.ll:this.ys.scaleMargins.top*this.$t()+this.al}Ll(){return this.Dl()?this.ys.scaleMargins.top*this.$t()+this.al:this.ys.scaleMargins.bottom*this.$t()+this.ll}Ol(){this.nl.el||(this.nl.el=!0,this.uo())}kl(){this.il=null}Cl(t,e){if(this.Ol(),this.Ki())return 0;t=this.Ga()&&t?_s(t,this.ml):t;const i=w(this.Qe()),s=this.Ll()+(this.El()-1)*(t-i.$e())/i.Ye();return this.Fl(s)}xl(t,e){if(this.Ol(),this.Ki())return 0;const i=this.Fl(t),s=w(this.Qe()),r=s.$e()+s.Ye()*((i-this.Ll())/(this.El()-1));return this.Ga()?Si(r,this.ml):r}Il(){this.fl=null,this.Sl.Ha()}uo(){if(this.Tl()&&!this.Pl())return;const t=this.nl.rl;if(t===null)return;let e=null;const i=this.oo();let s=0,r=0;for(const l of i){if(!l.Vt())continue;const a=l.zt();if(a===null)continue;const u=l.Mh(t.Uh(),t.bi());let f=u&&u.Qe();if(f!==null){switch(this.ys.mode){case 1:f=fi(f,this.ml);break;case 2:f=Kd(f,a.Ft);break;case 3:f=tf(f,a.Ft)}if(e=e===null?f:e.vn(w(f)),u!==null){const p=u.tr();p!==null&&(s=Math.max(s,p.above),r=Math.max(r,p.below))}}}if(this.qa()&&(s=Math.max(s,this.ja()),r=Math.max(r,this.ja())),s===this.al&&r===this.ll||(this.al=s,this.ll=r,this.fl=null,this.kl()),e!==null){if(e.$e()===e.qe()){const l=this.cl,a=5*(l===null||this.Le()||this.Rl()?1:l.ea());this.Ga()&&(e=bi(e,this.ml)),e=new Z(e.$e()-a,e.qe()+a),this.Ga()&&(e=fi(e,this.ml))}if(this.Ga()){const l=bi(e,this.ml),a=Qs(l);if(h=a,o=this.ml,h.Ia!==o.Ia||h.Ba!==o.Ba){const u=this.sl!==null?bi(this.sl,this.ml):null;this.ml=a,e=fi(l,a),u!==null&&(this.sl=fi(u,a))}}this.Vl(e)}else this.Ge===null&&(this.Vl(new Z(-.5,.5)),this.ml=Qs(null));var h,o}Ul(){return this.Le()?Ve:this.Rl()?xi:this.Ga()?t=>_s(t,this.ml):null}co(t,e,i){return e===void 0?(i===void 0&&(i=this.ra()),i.format(t)):e(t)}nr(t,e){return this.co(t,this.Ml.priceFormatter,e)}lo(t,e){return this.co(t,this.Ml.percentageFormatter,e)}}function fr(n){return n instanceof Bs}class pr{constructor(t,e){this.ul=[],this.do=new Map,this.tl=0,this.fo=0,this.po=1e3,this.dl=null,this.vo=new V,this.kh=[],this.uh=t,this.ts=e,this.mo=new Gd(this);const i=e.N();this.wo=this.Mo("left",i.leftPriceScale),this.bo=this.Mo("right",i.rightPriceScale),this.wo.Bl().i(this.So.bind(this,this.wo),this),this.bo.Bl().i(this.So.bind(this,this.bo),this),this.xo(i)}xo(t){if(t.leftPriceScale&&this.wo.hr(t.leftPriceScale),t.rightPriceScale&&this.bo.hr(t.rightPriceScale),t.localization&&(this.wo.ga(),this.bo.ga()),t.overlayPriceScales){const e=Array.from(this.do.values());for(const i of e){const s=w(i[0].Wt());s.hr(t.overlayPriceScales),t.localization&&s.ga()}}}Co(t){switch(t){case"left":return this.wo;case"right":return this.bo}return this.do.has(t)?K(this.do.get(t))[0].Wt():null}m(){this.Qt().yo().u(this),this.wo.Bl().u(this),this.bo.Bl().u(this),this.ul.forEach(t=>{t.m&&t.m()}),this.kh=this.kh.filter(t=>{const e=t.oh();return e.detached&&e.detached(),!1}),this.vo.p()}ko(){return this.po}Po(t){this.po=t}Qt(){return this.ts}Qi(){return this.fo}$t(){return this.tl}To(t){this.fo=t,this.Ro()}Al(t){this.tl=t,this.wo.Al(t),this.bo.Al(t),this.ul.forEach(e=>{if(this.Un(e)){const i=e.Wt();i!==null&&i.Al(t)}}),this.Ro()}Do(){return this.ul.filter(fr)}ba(){return this.ul}Un(t){const e=t.Wt();return e===null||this.wo!==e&&this.bo!==e}Zl(t,e,i){this.Vo(t,e,i?t.hs():this.ul.length)}Jl(t,e){const i=this.ul.indexOf(t);U(i!==-1,"removeDataSource: invalid data source"),this.ul.splice(i,1),e||this.ul.forEach((h,o)=>h.ls(o));const s=w(t.Wt()).wa();if(this.do.has(s)){const h=K(this.do.get(s)),o=h.indexOf(t);o!==-1&&(h.splice(o,1),h.length===0&&this.do.delete(s))}const r=t.Wt();r&&r.ba().indexOf(t)>=0&&(r.Jl(t),this.Io(r)),this.dl=null}qn(t){return t===this.wo?"left":t===this.bo?"right":"overlay"}Bo(){return this.wo}Ao(){return this.bo}Eo(t,e){t.so(e)}zo(t,e){t.no(e),this.Ro()}Lo(t){t.eo()}Oo(t,e){t.ro(e)}No(t,e){t.ho(e),this.Ro()}Wo(t){t.ao()}Ro(){this.ul.forEach(t=>{t.Ns()})}Ps(){let t=null;return this.ts.N().rightPriceScale.visible&&this.bo.ba().length!==0?t=this.bo:this.ts.N().leftPriceScale.visible&&this.wo.ba().length!==0?t=this.wo:this.ul.length!==0&&(t=this.ul[0].Wt()),t===null&&(t=this.bo),t}$n(){let t=null;return this.ts.N().rightPriceScale.visible?t=this.bo:this.ts.N().leftPriceScale.visible&&(t=this.wo),t}Io(t){t!==null&&t.Pl()&&this.Fo(t)}Ho(t){const e=this.uh.ye();t.yl({sn:!0}),e!==null&&t._o(e),this.Ro()}Uo(){this.Fo(this.wo),this.Fo(this.bo)}$o(){this.Io(this.wo),this.Io(this.bo),this.ul.forEach(t=>{this.Un(t)&&this.Io(t.Wt())}),this.Ro(),this.ts.ar()}Dt(){return this.dl===null&&(this.dl=_o(this.ul)),this.dl}qo(t,e){e=Pe(e,0,this.ul.length-1);const i=this.ul.indexOf(t);U(i!==-1,"setSeriesOrder: invalid data source"),this.ul.splice(i,1),this.ul.splice(e,0,t),this.ul.forEach((s,r)=>s.ls(r)),this.dl=null;for(const s of[this.wo,this.bo])s.Gl(),s.ga();this.ts.ar()}It(){return this.Dt().filter(fr)}Yo(){return this.vo}jo(){return this.mo}ua(t){this.kh.push(new Id(t))}ca(t){this.kh=this.kh.filter(e=>e.oh()!==t),t.detached&&t.detached(),this.ts.ar()}Ko(){return this.kh}sa(t,e){return this.kh.map(i=>i.jn(t,e)).filter(i=>i!==null)}Fo(t){const e=t.oo();if(e&&e.length>0&&!this.uh.Ki()){const i=this.uh.ye();i!==null&&t._o(i)}t.Ns()}Vo(t,e,i){let s=this.Co(e);if(s===null&&(s=this.Mo(e,this.ts.N().overlayPriceScales)),this.ul.splice(i,0,t),!As(e)){const r=this.do.get(e)||[];r.push(t),this.do.set(e,r)}t.ls(i),s.Zl(t),t._s(s),this.Io(s),this.dl=null}So(t,e,i){e.ie!==i.ie&&this.Fo(t)}Mo(t,e){const i={visible:!0,autoScale:!0,...kt(e)},s=new ef(t,i,this.ts.N().layout,this.ts.N().localization,this.ts.Xi());return s.Al(this.$t()),s}}function cs(n){return{Xo:n.Xo,Zo:{Kn:n.Go.externalId},Jo:n.Go.cursorStyle}}function sf(n,t,e,i){for(const s of n){const r=s.Tt(i);if(r!==null&&r.jn){const h=r.jn(t,e);if(h!==null)return{Qo:s,Zo:h}}}return null}function nf(n){return n.Ws!==void 0}function Mo(n,t,e){const i=[n,...n.Dt()],s=function(r,h,o){var p;let l,a;for(const g of r){const v=((p=g.sa)==null?void 0:p.call(g,h,o))??[];for(const b of v)u=b.zOrder,f=l==null?void 0:l.zOrder,(!f||u==="top"&&f!=="top"||u==="normal"&&f==="bottom")&&(l=b,a=g)}var u,f;return l&&a?{Go:l,Xo:a}:null}(i,t,e);if((s==null?void 0:s.Go.zOrder)==="top")return cs(s);for(const r of i){if(s&&s.Xo===r&&s.Go.zOrder!=="bottom"&&!s.Go.isBackground)return cs(s);if(nf(r)){const h=sf(r.Ws(n),t,e,n);if(h!==null)return{Xo:r,Qo:h.Qo,Zo:h.Zo}}if(s&&s.Xo===r&&s.Go.zOrder!=="bottom"&&s.Go.isBackground)return cs(s)}return s!=null&&s.Go?cs(s):null}class rf{constructor(t,e,i=50){this.kn=0,this.Pn=1,this.Tn=1,this.Dn=new Map,this.Rn=new Map,this.t_=t,this.i_=e,this.Vn=i}s_(t){const e=t.time,i=this.i_.cacheKey(e),s=this.Dn.get(i);if(s!==void 0)return s.n_;if(this.kn===this.Vn){const h=this.Rn.get(this.Tn);this.Rn.delete(this.Tn),this.Dn.delete(K(h)),this.Tn++,this.kn--}const r=this.t_(t);return this.Dn.set(i,{n_:r,En:this.Pn}),this.Rn.set(this.Pn,i),this.kn++,this.Pn++,r}}class De{constructor(t,e){U(t<=e,"right should be >= left"),this.e_=t,this.r_=e}Uh(){return this.e_}bi(){return this.r_}h_(){return this.r_-this.e_+1}Te(t){return this.e_<=t&&t<=this.r_}He(t){return this.e_===t.Uh()&&this.r_===t.bi()}}function mr(n,t){return n===null||t===null?n===t:n.He(t)}class hf{constructor(){this.a_=new Map,this.Dn=null,this.l_=!1}o_(t){this.l_=t,this.Dn=null}__(t,e){this.u_(e),this.Dn=null;for(let i=e;i<t.length;++i){const s=t[i];let r=this.a_.get(s.timeWeight);r===void 0&&(r=[],this.a_.set(s.timeWeight,r)),r.push({index:i,time:s.time,weight:s.timeWeight,originalTime:s.originalTime})}}c_(t,e,i,s,r){const h=Math.ceil(e/t);return this.Dn!==null&&this.Dn.d_===h&&r===this.Dn.f_&&i===this.Dn.p_||(this.Dn={f_:r,p_:i,Va:this.v_(h,i,s),d_:h}),this.Dn.Va}u_(t){if(t===0)return void this.a_.clear();const e=[];this.a_.forEach((i,s)=>{t<=i[0].index?e.push(s):i.splice(ti(i,t,r=>r.index<t),1/0)});for(const i of e)this.a_.delete(i)}v_(t,e,i){let s=[];const r=h=>!e||i.has(h.index);for(const h of Array.from(this.a_.keys()).sort((o,l)=>l-o)){if(!this.a_.get(h))continue;const o=s;s=[];const l=o.length;let a=0;const u=K(this.a_.get(h)),f=u.length;let p=1/0,g=-1/0;for(let v=0;v<f;v++){const b=u[v],M=b.index;for(;a<l;){const S=o[a],R=S.index;if(!(R<M&&r(S))){p=R;break}a++,s.push(S),g=R,p=1/0}if(p-M>=t&&M-g>=t&&r(b))s.push(b),g=M;else if(this.l_)return o}for(;a<l;a++)r(o[a])&&s.push(o[a])}return s}}class Ie{constructor(t){this.m_=t}w_(){return this.m_===null?null:new De(Math.floor(this.m_.Uh()),Math.ceil(this.m_.bi()))}g_(){return this.m_}static M_(){return new Ie(null)}}function of(n,t){return n.weight>t.weight?n:t}class lf{constructor(t,e,i,s){this.fo=0,this.b_=null,this.S_=[],this.vl=null,this.pl=null,this.x_=new hf,this.C_=new Map,this.y_=Ie.M_(),this.k_=!0,this.P_=new V,this.T_=new V,this.R_=new V,this.D_=null,this.V_=null,this.I_=new Map,this.B_=-1,this.A_=[],this.ys=e,this.Ml=i,this.E_=e.rightOffset,this.z_=e.barSpacing,this.ts=t,this.i_=s,this.L_(),this.x_.o_(e.uniformDistribution),this.O_()}N(){return this.ys}N_(t){st(this.Ml,t),this.W_(),this.L_()}hr(t,e){st(this.ys,t),this.ys.fixLeftEdge&&this.F_(),this.ys.fixRightEdge&&this.H_(),t.barSpacing!==void 0&&this.ts.dn(t.barSpacing),t.rightOffset!==void 0&&this.ts.fn(t.rightOffset),t.minBarSpacing===void 0&&t.maxBarSpacing===void 0||this.ts.dn(t.barSpacing??this.z_),t.ignoreWhitespaceIndices!==void 0&&t.ignoreWhitespaceIndices!==this.ys.ignoreWhitespaceIndices&&this.O_(),this.W_(),this.L_(),this.R_.p()}Rs(t){var e;return((e=this.S_[t])==null?void 0:e.time)??null}ss(t){return this.S_[t]??null}U_(t,e){if(this.S_.length<1)return null;if(this.i_.key(t)>this.i_.key(this.S_[this.S_.length-1].time))return e?this.S_.length-1:null;const i=ti(this.S_,this.i_.key(t),(s,r)=>this.i_.key(s.time)<r);return this.i_.key(t)<this.i_.key(this.S_[i].time)?e?i:null:i}Ki(){return this.fo===0||this.S_.length===0||this.b_===null}q_(){return this.S_.length>0}ye(){return this.Y_(),this.y_.w_()}j_(){return this.Y_(),this.y_.g_()}K_(){const t=this.ye();if(t===null)return null;const e={from:t.Uh(),to:t.bi()};return this.X_(e)}X_(t){const e=Math.round(t.from),i=Math.round(t.to),s=w(this.Z_()),r=w(this.G_());return{from:w(this.ss(Math.max(s,e))),to:w(this.ss(Math.min(r,i)))}}J_(t){return{from:w(this.U_(t.from,!0)),to:w(this.U_(t.to,!0))}}Qi(){return this.fo}To(t){if(!isFinite(t)||t<=0||this.fo===t)return;const e=this.j_(),i=this.fo;if(this.fo=t,this.k_=!0,this.ys.lockVisibleTimeRangeOnResize&&i!==0){const s=this.z_*t/i;this.z_=s}if(this.ys.fixLeftEdge&&e!==null&&e.Uh()<=0){const s=i-t;this.E_-=Math.round(s/this.z_)+1,this.k_=!0}this.Q_(),this.tu()}qt(t){if(this.Ki()||!Ei(t))return 0;const e=this.iu()+this.E_-t;return this.fo-(e+.5)*this.z_-1}su(t,e){const i=this.iu(),s=e===void 0?0:e.from,r=e===void 0?t.length:e.to;for(let h=s;h<r;h++){const o=t[h].wt,l=i+this.E_-o,a=this.fo-(l+.5)*this.z_-1;t[h]._t=a}}nu(t,e){const i=Math.ceil(this.eu(t));return e&&this.ys.ignoreWhitespaceIndices&&!this.ru(i)?this.hu(i):i}fn(t){this.k_=!0,this.E_=t,this.tu(),this.ts.au(),this.ts.ar()}lu(){return this.z_}dn(t){this.ou(t),this.tu(),this.ts.au(),this.ts.ar()}_u(){return this.E_}Va(){if(this.Ki())return null;if(this.V_!==null)return this.V_;const t=this.z_,e=5*(this.ts.N().layout.fontSize+4)/8*(this.ys.tickMarkMaxCharacterLength||8),i=Math.round(e/t),s=w(this.ye()),r=Math.max(s.Uh(),s.Uh()-i),h=Math.max(s.bi(),s.bi()-i),o=this.x_.c_(t,e,this.ys.ignoreWhitespaceIndices,this.I_,this.B_),l=this.Z_()+i,a=this.G_()-i,u=this.uu(),f=this.ys.fixLeftEdge||u,p=this.ys.fixRightEdge||u;let g=0;for(const v of o){if(!(r<=v.index&&v.index<=h))continue;let b;g<this.A_.length?(b=this.A_[g],b.coord=this.qt(v.index),b.label=this.cu(v),b.weight=v.weight):(b={needAlignCoordinate:!1,coord:this.qt(v.index),label:this.cu(v),weight:v.weight},this.A_.push(b)),this.z_>e/2&&!u?b.needAlignCoordinate=!1:b.needAlignCoordinate=f&&v.index<=l||p&&v.index>=a,g++}return this.A_.length=g,this.V_=this.A_,this.A_}du(){this.k_=!0,this.dn(this.ys.barSpacing),this.fn(this.ys.rightOffset)}fu(t){this.k_=!0,this.b_=t,this.tu(),this.F_()}pu(t,e){const i=this.eu(t),s=this.lu(),r=s+e*(s/10);this.dn(r),this.ys.rightBarStaysOnScroll||this.fn(this._u()+(i-this.eu(t)))}so(t){this.vl&&this.ao(),this.pl===null&&this.D_===null&&(this.Ki()||(this.pl=t,this.vu()))}no(t){if(this.D_===null)return;const e=Pe(this.fo-t,0,this.fo),i=Pe(this.fo-w(this.pl),0,this.fo);e!==0&&i!==0&&this.dn(this.D_.lu*e/i)}eo(){this.pl!==null&&(this.pl=null,this.mu())}ro(t){this.vl===null&&this.D_===null&&(this.Ki()||(this.vl=t,this.vu()))}ho(t){if(this.vl===null)return;const e=(this.vl-t)/this.lu();this.E_=w(this.D_)._u+e,this.k_=!0,this.tu()}ao(){this.vl!==null&&(this.vl=null,this.mu())}wu(){this.gu(this.ys.rightOffset)}gu(t,e=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const i=this.E_,s=performance.now();this.ts._n({Mu:r=>(r-s)/e>=1,bu:r=>{const h=(r-s)/e;return h>=1?t:i+(t-i)*h}})}kt(t,e){this.k_=!0,this.S_=t,this.x_.__(t,e),this.tu()}Su(){return this.P_}xu(){return this.T_}Cu(){return this.R_}iu(){return this.b_||0}yu(t){const e=t.h_();this.ou(this.fo/e),this.E_=t.bi()-this.iu(),this.tu(),this.k_=!0,this.ts.au(),this.ts.ar()}ku(){const t=this.Z_(),e=this.G_();t!==null&&e!==null&&this.yu(new De(t,e+this.ys.rightOffset))}Pu(t){const e=new De(t.from,t.to);this.yu(e)}ns(t){return this.Ml.timeFormatter!==void 0?this.Ml.timeFormatter(t.originalTime):this.i_.formatHorzItem(t.time)}O_(){if(!this.ys.ignoreWhitespaceIndices)return;this.I_.clear();const t=this.ts.js();for(const e of t)for(const i of e.ma())this.I_.set(i,!0);this.B_++}uu(){const t=this.ts.N().handleScroll,e=this.ts.N().handleScale;return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||e.axisDoubleClickReset.time||e.axisPressedMouseMove.time||e.mouseWheel||e.pinch)}Z_(){return this.S_.length===0?null:0}G_(){return this.S_.length===0?null:this.S_.length-1}Tu(t){return(this.fo-1-t)/this.z_}eu(t){const e=this.Tu(t),i=this.iu()+this.E_-e;return Math.round(1e6*i)/1e6}ou(t){const e=this.z_;this.z_=t,this.Q_(),e!==this.z_&&(this.k_=!0,this.Ru())}Y_(){if(!this.k_)return;if(this.k_=!1,this.Ki())return void this.Du(Ie.M_());const t=this.iu(),e=this.fo/this.z_,i=this.E_+t,s=new De(i-e+1,i);this.Du(new Ie(s))}Q_(){const t=Pe(this.z_,this.Vu(),this.Iu());this.z_!==t&&(this.z_=t,this.k_=!0)}Iu(){return this.ys.maxBarSpacing>0?this.ys.maxBarSpacing:.5*this.fo}Vu(){return this.ys.fixLeftEdge&&this.ys.fixRightEdge&&this.S_.length!==0?this.fo/this.S_.length:this.ys.minBarSpacing}tu(){const t=this.Bu();t!==null&&this.E_<t&&(this.E_=t,this.k_=!0);const e=this.Au();this.E_>e&&(this.E_=e,this.k_=!0)}Bu(){const t=this.Z_(),e=this.b_;return t===null||e===null?null:t-e-1+(this.ys.fixLeftEdge?this.fo/this.z_:Math.min(2,this.S_.length))}Au(){return this.ys.fixRightEdge?0:this.fo/this.z_-Math.min(2,this.S_.length)}vu(){this.D_={lu:this.lu(),_u:this._u()}}mu(){this.D_=null}cu(t){let e=this.C_.get(t.weight);return e===void 0&&(e=new rf(i=>this.Eu(i),this.i_),this.C_.set(t.weight,e)),e.s_(t)}Eu(t){return this.i_.formatTickmark(t,this.Ml)}Du(t){const e=this.y_;this.y_=t,mr(e.w_(),this.y_.w_())||this.P_.p(),mr(e.g_(),this.y_.g_())||this.T_.p(),this.Ru()}Ru(){this.V_=null}W_(){this.Ru(),this.C_.clear()}L_(){this.i_.updateFormatter(this.Ml)}F_(){if(!this.ys.fixLeftEdge)return;const t=this.Z_();if(t===null)return;const e=this.ye();if(e===null)return;const i=e.Uh()-t;if(i<0){const s=this.E_-i-1;this.fn(s)}this.Q_()}H_(){this.tu(),this.Q_()}ru(t){return!this.ys.ignoreWhitespaceIndices||this.I_.get(t)||!1}hu(t){const e=function*(s){const r=Math.round(s),h=r<s;let o=1;for(;;)h?(yield r+o,yield r-o):(yield r-o,yield r+o),o++}(t),i=this.G_();for(;i;){const s=e.next().value;if(this.I_.get(s))return s;if(s<0||s>i)break}return t}}var gr,vr,wr,br,yr;(function(n){n[n.OnTouchEnd=0]="OnTouchEnd",n[n.OnNextTap=1]="OnNextTap"})(gr||(gr={}));class af{constructor(t,e,i){this.zu=[],this.Lu=[],this.fo=0,this.Ou=null,this.Nu=new V,this.Wu=new V,this.Fu=null,this.Hu=t,this.ys=e,this.i_=i,this.bl=new ld(this.ys.layout.colorParsers),this.Uu=new od(this),this.uh=new lf(this,e.timeScale,this.ys.localization,i),this.Ct=new bd(this,e.crosshair),this.$u=new Jd(e.crosshair),this.qu(0),this.zu[0].Po(2e3),this.Yu=this.ju(0),this.Ku=this.ju(1)}Bh(){this.Xu(q.gn())}ar(){this.Xu(q.wn())}Zh(){this.Xu(new q(1))}Ah(t){const e=this.Zu(t);this.Xu(e)}Gu(){return this.Ou}Ju(t){var i,s,r,h;if(((i=this.Ou)==null?void 0:i.Xo)===(t==null?void 0:t.Xo)&&((r=(s=this.Ou)==null?void 0:s.Zo)==null?void 0:r.Kn)===((h=t==null?void 0:t.Zo)==null?void 0:h.Kn))return;const e=this.Ou;this.Ou=t,e!==null&&this.Ah(e.Xo),t!==null&&t.Xo!==(e==null?void 0:e.Xo)&&this.Ah(t.Xo)}N(){return this.ys}hr(t){st(this.ys,t),this.zu.forEach(e=>e.xo(t)),t.timeScale!==void 0&&this.uh.hr(t.timeScale),t.localization!==void 0&&this.uh.N_(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.Nu.p(),this.Yu=this.ju(0),this.Ku=this.ju(1),this.Bh()}Qu(t,e,i=0){const s=this.zu[i];if(s===void 0)return;if(t==="left")return st(this.ys,{leftPriceScale:e}),s.xo({leftPriceScale:e}),this.Nu.p(),void this.Bh();if(t==="right")return st(this.ys,{rightPriceScale:e}),s.xo({rightPriceScale:e}),this.Nu.p(),void this.Bh();const r=this.tc(t,i);r!==null&&(r.Wt.hr(e),this.Nu.p())}tc(t,e){const i=this.zu[e];if(i===void 0)return null;const s=i.Co(t);return s!==null?{Us:i,Wt:s}:null}At(){return this.uh}$s(){return this.zu}sc(){return this.Ct}nc(){return this.Wu}ec(t,e){t.Al(e),this.au()}To(t){this.fo=t,this.uh.To(this.fo),this.zu.forEach(e=>e.To(t)),this.au()}rc(t){this.zu.length!==1&&(U(t>=0&&t<this.zu.length,"Invalid pane index"),this.zu.splice(t,1),this.Bh())}hc(t,e){if(this.zu.length<2)return;U(t>=0&&t<this.zu.length,"Invalid pane index");const i=this.zu[t],s=this.zu.reduce((f,p)=>f+p.ko(),0),r=this.zu.reduce((f,p)=>f+p.$t(),0),h=r-30*(this.zu.length-1);e=Math.min(h,Math.max(30,e));const o=s/r,l=i.$t();i.Po(e*o);let a=e-l,u=this.zu.length-1;for(const f of this.zu)if(f!==i){const p=Math.min(h,Math.max(30,f.$t()-a/u));a-=f.$t()-p,u-=1;const g=p*o;f.Po(g)}this.Bh()}ac(t,e){U(t>=0&&t<this.zu.length&&e>=0&&e<this.zu.length,"Invalid pane index");const i=this.zu[t],s=this.zu[e];this.zu[t]=s,this.zu[e]=i,this.Bh()}Eo(t,e,i){t.Eo(e,i)}zo(t,e,i){t.zo(e,i),this.Eh(),this.Xu(this.lc(t,2))}Lo(t,e){t.Lo(e),this.Xu(this.lc(t,2))}Oo(t,e,i){e.Pl()||t.Oo(e,i)}No(t,e,i){e.Pl()||(t.No(e,i),this.Eh(),this.Xu(this.lc(t,2)))}Wo(t,e){e.Pl()||(t.Wo(e),this.Xu(this.lc(t,2)))}Ho(t,e){t.Ho(e),this.Xu(this.lc(t,2))}oc(t){this.uh.so(t)}_c(t,e){const i=this.At();if(i.Ki()||e===0)return;const s=i.Qi();t=Math.max(1,Math.min(t,s)),i.pu(t,e),this.au()}uc(t){this.cc(0),this.dc(t),this.fc()}vc(t){this.uh.no(t),this.au()}mc(){this.uh.eo(),this.ar()}cc(t){this.uh.ro(t)}dc(t){this.uh.ho(t),this.au()}fc(){this.uh.ao(),this.ar()}js(){return this.Lu}wc(t,e,i,s,r){this.Ct.Vs(t,e);let h=NaN,o=this.uh.nu(t,!0);const l=this.uh.ye();l!==null&&(o=Math.min(Math.max(l.Uh(),o),l.bi()));const a=s.Ps(),u=a.zt();if(u!==null&&(h=a.Ts(e,u)),h=this.$u.Ma(h,o,s),this.Ct.Es(o,h,s),this.Zh(),!r){const f=Mo(s,t,e);this.Ju(f&&{Xo:f.Xo,Zo:f.Zo,Jo:f.Jo||null}),this.Wu.p(this.Ct.Bt(),{x:t,y:e},i)}}gc(t,e,i){const s=i.Ps(),r=s.zt(),h=s.Nt(t,w(r)),o=this.uh.U_(e,!0),l=this.uh.qt(w(o));this.wc(l,h,null,i,!0)}Mc(t){this.sc().Ls(),this.Zh(),t||this.Wu.p(null,null,null)}Eh(){const t=this.Ct.Us();if(t!==null){const e=this.Ct.Bs(),i=this.Ct.As();this.wc(e,i,null,t)}this.Ct.Ns()}bc(t,e,i){const s=this.uh.Rs(0);e!==void 0&&i!==void 0&&this.uh.kt(e,i);const r=this.uh.Rs(0),h=this.uh.iu(),o=this.uh.ye();if(o!==null&&s!==null&&r!==null){const l=o.Te(h),a=this.i_.key(s)>this.i_.key(r),u=t!==null&&t>h&&!a,f=this.uh.N().allowShiftVisibleRangeOnWhitespaceReplacement,p=l&&(i!==void 0||f)&&this.uh.N().shiftVisibleRangeOnNewBar;if(u&&!p){const g=t-h;this.uh.fn(this.uh._u()-g)}}this.uh.fu(t)}Lh(t){t!==null&&t.$o()}Hn(t){if(function(i){return i instanceof pr}(t))return t;const e=this.zu.find(i=>i.Dt().includes(t));return e===void 0?null:e}au(){this.zu.forEach(t=>t.$o()),this.Eh()}m(){this.zu.forEach(t=>t.m()),this.zu.length=0,this.ys.localization.priceFormatter=void 0,this.ys.localization.percentageFormatter=void 0,this.ys.localization.timeFormatter=void 0}Sc(){return this.Uu}Yn(){return this.Uu.N()}yo(){return this.Nu}xc(t,e){const i=this.qu(e);this.Cc(t,i),this.Lu.push(t),this.Lu.length===1?this.Bh():this.ar()}yc(t){const e=this.Hn(t),i=this.Lu.indexOf(t);U(i!==-1,"Series not found");const s=w(e);this.Lu.splice(i,1),s.Jl(t),t.m&&t.m(),this.uh.O_(),this.kc(s)}Ih(t,e){const i=w(this.Hn(t));i.Jl(t,!0),i.Zl(t,e,!0)}ku(){const t=q.wn();t.rn(),this.Xu(t)}Pc(t){const e=q.wn();e.ln(t),this.Xu(e)}cn(){const t=q.wn();t.cn(),this.Xu(t)}dn(t){const e=q.wn();e.dn(t),this.Xu(e)}fn(t){const e=q.wn();e.fn(t),this.Xu(e)}_n(t){const e=q.wn();e._n(t),this.Xu(e)}hn(){const t=q.wn();t.hn(),this.Xu(t)}Tc(){return this.ys.rightPriceScale.visible?"right":"left"}Rc(t,e){if(U(e>=0,"Index should be greater or equal to 0"),e===this.Dc(t))return;const i=w(this.Hn(t));i.Jl(t);const s=this.qu(e);this.Cc(t,s),i.ba().length===0&&this.kc(i)}Vc(){return this.Ku}$(){return this.Yu}Ut(t){const e=this.Ku,i=this.Yu;if(e===i)return e;if(t=Math.max(0,Math.min(100,Math.round(100*t))),this.Fu===null||this.Fu.mr!==i||this.Fu.wr!==e)this.Fu={mr:i,wr:e,Ic:new Map};else{const r=this.Fu.Ic.get(t);if(r!==void 0)return r}const s=this.bl.tt(i,e,t/100);return this.Fu.Ic.set(t,s),s}Bc(t){return this.zu.indexOf(t)}Xi(){return this.bl}qu(t){if(U(t>=0,"Index should be greater or equal to 0"),(t=Math.min(this.zu.length,t))<this.zu.length)return this.zu[t];const e=new pr(this.uh,this);this.zu.push(e);const i=q.gn();return i.Qs(t,{tn:0,sn:!0}),this.Xu(i),e}Dc(t){return this.zu.findIndex(e=>e.Do().includes(t))}lc(t,e){const i=new q(e);if(t!==null){const s=this.zu.indexOf(t);i.Qs(s,{tn:e})}return i}Zu(t,e){return e===void 0&&(e=2),this.lc(this.Hn(t),e)}Xu(t){this.Hu&&this.Hu(t),this.zu.forEach(e=>e.jo().lr().kt())}Cc(t,e){const i=t.N().priceScaleId,s=i!==void 0?i:this.Tc();e.Zl(t,s),As(s)||t.hr(t.N())}ju(t){const e=this.ys.layout;return e.background.type==="gradient"?t===0?e.background.topColor:e.background.bottomColor:e.background.color}kc(t){t.ba().length===0&&this.zu.length>1&&(this.zu.splice(this.Bc(t),1),this.Bh())}}function pn(n){return!Ne(n)&&!rs(n)}function xo(n){return Ne(n)}(function(n){n[n.Disabled=0]="Disabled",n[n.Continuous=1]="Continuous",n[n.OnDataUpdate=2]="OnDataUpdate"})(vr||(vr={})),function(n){n[n.LastBar=0]="LastBar",n[n.LastVisible=1]="LastVisible"}(wr||(wr={})),function(n){n.Solid="solid",n.VerticalGradient="gradient"}(br||(br={})),function(n){n[n.Year=0]="Year",n[n.Month=1]="Month",n[n.DayOfMonth=2]="DayOfMonth",n[n.Time=3]="Time",n[n.TimeWithSeconds=4]="TimeWithSeconds"}(yr||(yr={}));const _r=n=>n.getUTCFullYear();function cf(n,t,e){return t.replace(/yyyy/g,(i=>Et(_r(i),4))(n)).replace(/yy/g,(i=>Et(_r(i)%100,2))(n)).replace(/MMMM/g,((i,s)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(s,{month:"long"}))(n,e)).replace(/MMM/g,((i,s)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(s,{month:"short"}))(n,e)).replace(/MM/g,(i=>Et((s=>s.getUTCMonth()+1)(i),2))(n)).replace(/dd/g,(i=>Et((s=>s.getUTCDate())(i),2))(n))}class So{constructor(t="yyyy-MM-dd",e="default"){this.Ac=t,this.Ec=e}s_(t){return cf(t,this.Ac,this.Ec)}}class uf{constructor(t){this.zc=t||"%h:%m:%s"}s_(t){return this.zc.replace("%h",Et(t.getUTCHours(),2)).replace("%m",Et(t.getUTCMinutes(),2)).replace("%s",Et(t.getUTCSeconds(),2))}}const df={Lc:"yyyy-MM-dd",Oc:"%h:%m:%s",Nc:" ",Wc:"default"};class ff{constructor(t={}){const e={...df,...t};this.Fc=new So(e.Lc,e.Wc),this.Hc=new uf(e.Oc),this.Uc=e.Nc}s_(t){return`${this.Fc.s_(t)}${this.Uc}${this.Hc.s_(t)}`}}function us(n){return 60*n*60*1e3}function Us(n){return 60*n*1e3}const ds=[{$c:(Mr=1,1e3*Mr),qc:10},{$c:Us(1),qc:20},{$c:Us(5),qc:21},{$c:Us(30),qc:22},{$c:us(1),qc:30},{$c:us(3),qc:31},{$c:us(6),qc:32},{$c:us(12),qc:33}];var Mr;function xr(n,t){if(n.getUTCFullYear()!==t.getUTCFullYear())return 70;if(n.getUTCMonth()!==t.getUTCMonth())return 60;if(n.getUTCDate()!==t.getUTCDate())return 50;for(let e=ds.length-1;e>=0;--e)if(Math.floor(t.getTime()/ds[e].$c)!==Math.floor(n.getTime()/ds[e].$c))return ds[e].qc;return 0}function Js(n){let t=n;if(rs(n)&&(t=Dn(n)),!pn(t))throw new Error("time must be of type BusinessDay");const e=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{Yc:Math.round(e.getTime()/1e3),jc:t}}function Sr(n){if(!xo(n))throw new Error("time must be of type isUTCTimestamp");return{Yc:n}}function Dn(n){const t=new Date(n);if(isNaN(t.getTime()))throw new Error(`Invalid date string=${n}, expected format=yyyy-mm-dd`);return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function Cr(n){rs(n.time)&&(n.time=Dn(n.time))}class Tr{options(){return this.ys}setOptions(t){this.ys=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?function(e){e.forEach(Cr)}(t):Cr(t)}createConverterToInternalObj(t){return w(function(e){return e.length===0?null:pn(e[0].time)||rs(e[0].time)?Js:Sr}(t))}key(t){return typeof t=="object"&&"Yc"in t?t.Yc:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){const e=t;return e.jc===void 0?new Date(1e3*e.Yc).getTime():new Date(Date.UTC(e.jc.year,e.jc.month-1,e.jc.day)).getTime()}convertHorzItemToInternal(t){return xo(e=t)?Sr(e):pn(e)?Js(e):Js(Dn(e));var e}updateFormatter(t){if(!this.ys)return;const e=t.dateFormat;this.ys.timeScale.timeVisible?this.Kc=new ff({Lc:e,Oc:this.ys.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",Nc:"   ",Wc:t.locale}):this.Kc=new So(e,t.locale)}formatHorzItem(t){const e=t;return this.Kc.s_(new Date(1e3*e.Yc))}formatTickmark(t,e){const i=function(r,h,o){switch(r){case 0:case 10:return h?o?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return h?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.weight,this.ys.timeScale.timeVisible,this.ys.timeScale.secondsVisible),s=this.ys.timeScale;if(s.tickMarkFormatter!==void 0){const r=s.tickMarkFormatter(t.originalTime,i,e.locale);if(r!==null)return r}return function(r,h,o){const l={};switch(h){case 0:l.year="numeric";break;case 1:l.month="short";break;case 2:l.day="numeric";break;case 3:l.hour12=!1,l.hour="2-digit",l.minute="2-digit";break;case 4:l.hour12=!1,l.hour="2-digit",l.minute="2-digit",l.second="2-digit"}const a=r.jc===void 0?new Date(1e3*r.Yc):new Date(Date.UTC(r.jc.year,r.jc.month-1,r.jc.day));return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()).toLocaleString(o,l)}(t.time,i,e.locale)}maxTickMarkWeight(t){let e=t.reduce(of,t[0]).weight;return e>30&&e<50&&(e=30),e}fillWeightsForPoints(t,e){(function(i,s=0){if(i.length===0)return;let r=s===0?null:i[s-1].time.Yc,h=r!==null?new Date(1e3*r):null,o=0;for(let l=s;l<i.length;++l){const a=i[l],u=new Date(1e3*a.time.Yc);h!==null&&(a.timeWeight=xr(u,h)),o+=a.time.Yc-(r||a.time.Yc),r=a.time.Yc,h=u}if(s===0&&i.length>1){const l=Math.ceil(o/(i.length-1)),a=new Date(1e3*(i[0].time.Yc-l));i[0].timeWeight=xr(new Date(1e3*i[0].time.Yc),a)}})(t,e)}static Xc(t){return st({localization:{dateFormat:"dd MMM 'yy"}},t??{})}}const ei=typeof window<"u";function kr(){return!!ei&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function Zs(){return!!ei&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function mn(n){return n+n%2}function pf(n){ei&&window.chrome!==void 0&&n.addEventListener("mousedown",t=>{if(t.button===1)return t.preventDefault(),!1})}class Os{constructor(t,e,i){this.Zc=0,this.Gc=null,this.Jc={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.Qc=0,this.td=null,this.sd={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.nd=null,this.ed=!1,this.rd=null,this.hd=null,this.ad=!1,this.ld=!1,this.od=!1,this._d=null,this.ud=null,this.dd=null,this.fd=null,this.pd=null,this.vd=null,this.md=null,this.wd=0,this.gd=!1,this.Md=!1,this.bd=!1,this.Sd=0,this.xd=null,this.Cd=!Zs(),this.yd=s=>{this.kd(s)},this.Pd=s=>{if(this.Td(s)){const r=this.Rd(s);if(++this.Qc,this.td&&this.Qc>1){const{Dd:h}=this.Vd(ct(s),this.sd);h<30&&!this.od&&this.Id(r,this.Ad.Bd),this.Ed()}}else{const r=this.Rd(s);if(++this.Zc,this.Gc&&this.Zc>1){const{Dd:h}=this.Vd(ct(s),this.Jc);h<5&&!this.ld&&this.zd(r,this.Ad.Ld),this.Od()}}},this.Nd=t,this.Ad=e,this.ys=i,this.Wd()}m(){this._d!==null&&(this._d(),this._d=null),this.ud!==null&&(this.ud(),this.ud=null),this.fd!==null&&(this.fd(),this.fd=null),this.pd!==null&&(this.pd(),this.pd=null),this.vd!==null&&(this.vd(),this.vd=null),this.dd!==null&&(this.dd(),this.dd=null),this.Fd(),this.Od()}Hd(t){this.fd&&this.fd();const e=this.Ud.bind(this);if(this.fd=()=>{this.Nd.removeEventListener("mousemove",e)},this.Nd.addEventListener("mousemove",e),this.Td(t))return;const i=this.Rd(t);this.zd(i,this.Ad.$d),this.Cd=!0}Od(){this.Gc!==null&&clearTimeout(this.Gc),this.Zc=0,this.Gc=null,this.Jc={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}Ed(){this.td!==null&&clearTimeout(this.td),this.Qc=0,this.td=null,this.sd={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}Ud(t){if(this.bd||this.hd!==null||this.Td(t))return;const e=this.Rd(t);this.zd(e,this.Ad.qd),this.Cd=!0}Yd(t){const e=js(t.changedTouches,w(this.xd));if(e===null||(this.Sd=fs(t),this.md!==null)||this.Md)return;this.gd=!0;const i=this.Vd(ct(e),w(this.hd)),{jd:s,Kd:r,Dd:h}=i;if(this.ad||!(h<5)){if(!this.ad){const o=.5*s,l=r>=o&&!this.ys.Xd(),a=o>r&&!this.ys.Zd();l||a||(this.Md=!0),this.ad=!0,this.od=!0,this.Fd(),this.Ed()}if(!this.Md){const o=this.Rd(t,e);this.Id(o,this.Ad.Gd),Be(t)}}}Jd(t){if(t.button!==0)return;const e=this.Vd(ct(t),w(this.rd)),{Dd:i}=e;if(i>=5&&(this.ld=!0,this.Od()),this.ld){const s=this.Rd(t);this.zd(s,this.Ad.Qd)}}Vd(t,e){const i=Math.abs(e._t-t._t),s=Math.abs(e.ut-t.ut);return{jd:i,Kd:s,Dd:i+s}}tf(t){let e=js(t.changedTouches,w(this.xd));if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e===null)return;this.xd=null,this.Sd=fs(t),this.Fd(),this.hd=null,this.vd&&(this.vd(),this.vd=null);const i=this.Rd(t,e);if(this.Id(i,this.Ad.if),++this.Qc,this.td&&this.Qc>1){const{Dd:s}=this.Vd(ct(e),this.sd);s<30&&!this.od&&this.Id(i,this.Ad.Bd),this.Ed()}else this.od||(this.Id(i,this.Ad.sf),this.Ad.sf&&Be(t));this.Qc===0&&Be(t),t.touches.length===0&&this.ed&&(this.ed=!1,Be(t))}kd(t){if(t.button!==0)return;const e=this.Rd(t);if(this.rd=null,this.bd=!1,this.pd&&(this.pd(),this.pd=null),kr()&&this.Nd.ownerDocument.documentElement.removeEventListener("mouseleave",this.yd),!this.Td(t))if(this.zd(e,this.Ad.nf),++this.Zc,this.Gc&&this.Zc>1){const{Dd:i}=this.Vd(ct(t),this.Jc);i<5&&!this.ld&&this.zd(e,this.Ad.Ld),this.Od()}else this.ld||this.zd(e,this.Ad.ef)}Fd(){this.nd!==null&&(clearTimeout(this.nd),this.nd=null)}rf(t){if(this.xd!==null)return;const e=t.changedTouches[0];this.xd=e.identifier,this.Sd=fs(t);const i=this.Nd.ownerDocument.documentElement;this.od=!1,this.ad=!1,this.Md=!1,this.hd=ct(e),this.vd&&(this.vd(),this.vd=null);{const r=this.Yd.bind(this),h=this.tf.bind(this);this.vd=()=>{i.removeEventListener("touchmove",r),i.removeEventListener("touchend",h)},i.addEventListener("touchmove",r,{passive:!1}),i.addEventListener("touchend",h,{passive:!1}),this.Fd(),this.nd=setTimeout(this.hf.bind(this,t),240)}const s=this.Rd(t,e);this.Id(s,this.Ad.af),this.td||(this.Qc=0,this.td=setTimeout(this.Ed.bind(this),500),this.sd=ct(e))}lf(t){if(t.button!==0)return;const e=this.Nd.ownerDocument.documentElement;kr()&&e.addEventListener("mouseleave",this.yd),this.ld=!1,this.rd=ct(t),this.pd&&(this.pd(),this.pd=null);{const s=this.Jd.bind(this),r=this.kd.bind(this);this.pd=()=>{e.removeEventListener("mousemove",s),e.removeEventListener("mouseup",r)},e.addEventListener("mousemove",s),e.addEventListener("mouseup",r)}if(this.bd=!0,this.Td(t))return;const i=this.Rd(t);this.zd(i,this.Ad._f),this.Gc||(this.Zc=0,this.Gc=setTimeout(this.Od.bind(this),500),this.Jc=ct(t))}Wd(){this.Nd.addEventListener("mouseenter",this.Hd.bind(this)),this.Nd.addEventListener("touchcancel",this.Fd.bind(this));{const t=this.Nd.ownerDocument,e=i=>{this.Ad.uf&&(i.composed&&this.Nd.contains(i.composedPath()[0])||i.target&&this.Nd.contains(i.target)||this.Ad.uf())};this.ud=()=>{t.removeEventListener("touchstart",e)},this._d=()=>{t.removeEventListener("mousedown",e)},t.addEventListener("mousedown",e),t.addEventListener("touchstart",e,{passive:!0})}Zs()&&(this.dd=()=>{this.Nd.removeEventListener("dblclick",this.Pd)},this.Nd.addEventListener("dblclick",this.Pd)),this.Nd.addEventListener("mouseleave",this.cf.bind(this)),this.Nd.addEventListener("touchstart",this.rf.bind(this),{passive:!0}),pf(this.Nd),this.Nd.addEventListener("mousedown",this.lf.bind(this)),this.df(),this.Nd.addEventListener("touchmove",()=>{},{passive:!1})}df(){this.Ad.ff===void 0&&this.Ad.pf===void 0&&this.Ad.vf===void 0||(this.Nd.addEventListener("touchstart",t=>this.mf(t.touches),{passive:!0}),this.Nd.addEventListener("touchmove",t=>{if(t.touches.length===2&&this.md!==null&&this.Ad.pf!==void 0){const e=Er(t.touches[0],t.touches[1])/this.wd;this.Ad.pf(this.md,e),Be(t)}},{passive:!1}),this.Nd.addEventListener("touchend",t=>{this.mf(t.touches)}))}mf(t){t.length===1&&(this.gd=!1),t.length!==2||this.gd||this.ed?this.wf():this.gf(t)}gf(t){const e=this.Nd.getBoundingClientRect()||{left:0,top:0};this.md={_t:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,ut:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.wd=Er(t[0],t[1]),this.Ad.ff!==void 0&&this.Ad.ff(),this.Fd()}wf(){this.md!==null&&(this.md=null,this.Ad.vf!==void 0&&this.Ad.vf())}cf(t){if(this.fd&&this.fd(),this.Td(t)||!this.Cd)return;const e=this.Rd(t);this.zd(e,this.Ad.Mf),this.Cd=!Zs()}hf(t){const e=js(t.touches,w(this.xd));if(e===null)return;const i=this.Rd(t,e);this.Id(i,this.Ad.bf),this.od=!0,this.ed=!0}Td(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents!==void 0?t.sourceCapabilities.firesTouchEvents:fs(t)<this.Sd+500}Id(t,e){e&&e.call(this.Ad,t)}zd(t,e){e&&e.call(this.Ad,t)}Rd(t,e){const i=e||t,s=this.Nd.getBoundingClientRect()||{left:0,top:0};return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-s.left,localY:i.clientY-s.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,Sf:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",xf:t.type,Cf:i.target,Qo:t.view,yf:()=>{t.type!=="touchstart"&&Be(t)}}}}function Er(n,t){const e=n.clientX-t.clientX,i=n.clientY-t.clientY;return Math.sqrt(e*e+i*i)}function Be(n){n.cancelable&&n.preventDefault()}function ct(n){return{_t:n.pageX,ut:n.pageY}}function fs(n){return n.timeStamp||performance.now()}function js(n,t){for(let e=0;e<n.length;++e)if(n[e].identifier===t)return n[e];return null}class mf{constructor(t,e,i){this.kf=null,this.Pf=null,this.Tf=!0,this.Rf=null,this.Df=t,this.Vf=t.If()[e],this.Bf=t.If()[i],this.Af=document.createElement("tr"),this.Af.style.height="1px",this.Ef=document.createElement("td"),this.Ef.style.position="relative",this.Ef.style.padding="0",this.Ef.style.margin="0",this.Ef.setAttribute("colspan","3"),this.zf(),this.Af.appendChild(this.Ef),this.Tf=this.Df.N().layout.panes.enableResize,this.Tf?this.Lf():(this.kf=null,this.Pf=null)}m(){this.Pf!==null&&this.Pf.m()}Of(){return this.Af}Nf(){return A({width:this.Vf.Nf().width,height:1})}Wf(){return A({width:this.Vf.Wf().width,height:1*window.devicePixelRatio})}Ff(t,e,i){const s=this.Wf();t.fillStyle=this.Df.N().layout.panes.separatorColor,t.fillRect(e,i,s.width,s.height)}kt(){this.zf(),this.Df.N().layout.panes.enableResize!==this.Tf&&(this.Tf=this.Df.N().layout.panes.enableResize,this.Tf?this.Lf():(this.kf!==null&&(this.Ef.removeChild(this.kf.Hf),this.Ef.removeChild(this.kf.Uf),this.kf=null),this.Pf!==null&&(this.Pf.m(),this.Pf=null)))}Lf(){const t=document.createElement("div"),e=t.style;e.position="fixed",e.display="none",e.zIndex="49",e.top="0",e.left="0",e.width="100%",e.height="100%",e.cursor="row-resize",this.Ef.appendChild(t);const i=document.createElement("div"),s=i.style;s.position="absolute",s.zIndex="50",s.top="-4px",s.height="9px",s.width="100%",s.backgroundColor="",s.cursor="row-resize",this.Ef.appendChild(i);const r={$d:this.$f.bind(this),Mf:this.qf.bind(this),_f:this.Yf.bind(this),af:this.Yf.bind(this),Qd:this.jf.bind(this),Gd:this.jf.bind(this),nf:this.Kf.bind(this),if:this.Kf.bind(this)};this.Pf=new Os(i,r,{Xd:()=>!1,Zd:()=>!0}),this.kf={Uf:i,Hf:t}}zf(){this.Ef.style.background=this.Df.N().layout.panes.separatorColor}$f(t){this.kf!==null&&(this.kf.Uf.style.backgroundColor=this.Df.N().layout.panes.separatorHoverColor)}qf(t){this.kf!==null&&this.Rf===null&&(this.kf.Uf.style.backgroundColor="")}Yf(t){if(this.kf===null)return;const e=this.Vf.Xf().ko()+this.Bf.Xf().ko(),i=e/(this.Vf.Nf().height+this.Bf.Nf().height),s=30*i;e<=2*s||(this.Rf={Zf:t.pageY,Gf:this.Vf.Xf().ko(),Jf:e-s,Qf:e,tp:i,ip:s},this.kf.Hf.style.display="block")}jf(t){const e=this.Rf;if(e===null)return;const i=(t.pageY-e.Zf)*e.tp,s=Pe(e.Gf+i,e.ip,e.Jf);this.Vf.Xf().Po(s),this.Bf.Xf().Po(e.Qf-s),this.Df.Qt().Bh()}Kf(t){this.Rf!==null&&this.kf!==null&&(this.Rf=null,this.kf.Hf.style.display="none")}}function Gs(n,t){return n.sp-t.sp}function Ks(n,t,e){const i=(n.sp-t.sp)/(n.wt-t.wt);return Math.sign(i)*Math.min(Math.abs(i),e)}class gf{constructor(t,e,i,s){this.np=null,this.ep=null,this.rp=null,this.hp=null,this.ap=null,this.lp=0,this.op=0,this._p=t,this.up=e,this.cp=i,this.Mn=s}dp(t,e){if(this.np!==null){if(this.np.wt===e)return void(this.np.sp=t);if(Math.abs(this.np.sp-t)<this.Mn)return}this.hp=this.rp,this.rp=this.ep,this.ep=this.np,this.np={wt:e,sp:t}}le(t,e){if(this.np===null||this.ep===null||e-this.np.wt>50)return;let i=0;const s=Ks(this.np,this.ep,this.up),r=Gs(this.np,this.ep),h=[s],o=[r];if(i+=r,this.rp!==null){const a=Ks(this.ep,this.rp,this.up);if(Math.sign(a)===Math.sign(s)){const u=Gs(this.ep,this.rp);if(h.push(a),o.push(u),i+=u,this.hp!==null){const f=Ks(this.rp,this.hp,this.up);if(Math.sign(f)===Math.sign(s)){const p=Gs(this.rp,this.hp);h.push(f),o.push(p),i+=p}}}}let l=0;for(let a=0;a<h.length;++a)l+=o[a]/i*h[a];Math.abs(l)<this._p||(this.ap={sp:t,wt:e},this.op=l,this.lp=function(a,u){const f=Math.log(u);return Math.log(1*f/-a)/f}(Math.abs(l),this.cp))}bu(t){const e=w(this.ap),i=t-e.wt;return e.sp+this.op*(Math.pow(this.cp,i)-1)/Math.log(this.cp)}Mu(t){return this.ap===null||this.fp(t)===this.lp}fp(t){const e=t-w(this.ap).wt;return Math.min(e,this.lp)}}class vf{constructor(t,e){this.pp=void 0,this.vp=void 0,this.mp=void 0,this.ps=!1,this.wp=t,this.gp=e,this.Mp()}kt(){this.Mp()}bp(){this.pp&&this.wp.removeChild(this.pp),this.vp&&this.wp.removeChild(this.vp),this.pp=void 0,this.vp=void 0}Sp(){return this.ps!==this.xp()||this.mp!==this.Cp()}Cp(){return this.gp.Qt().Xi().J(this.gp.N().layout.textColor)>160?"dark":"light"}xp(){return this.gp.N().layout.attributionLogo}yp(){const t=new URL(location.href);return t.hostname?"&utm_source="+t.hostname+t.pathname:""}Mp(){this.Sp()&&(this.bp(),this.ps=this.xp(),this.ps&&(this.mp=this.Cp(),this.vp=document.createElement("style"),this.vp.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.pp=document.createElement("a"),this.pp.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.yp()}`,this.pp.title="Charting by TradingView",this.pp.id="tv-attr-logo",this.pp.target="_blank",this.pp.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.pp.toggleAttribute("data-dark",this.mp==="dark"),this.wp.appendChild(this.vp),this.wp.appendChild(this.pp)))}}function Ae(n,t){const e=w(n.ownerDocument).createElement("canvas");n.appendChild(e);const i=id(e,{options:{allowResizeObserver:!0},transform:(s,r)=>({width:Math.max(s.width,r.width),height:Math.max(s.height,r.height)})});return i.resizeCanvasElement(t),i}function Le(n){var t;n.width=1,n.height=1,(t=n.getContext("2d"))==null||t.clearRect(0,0,1,1)}function gn(n,t,e,i){n.ih&&n.ih(t,e,i)}function gs(n,t,e,i){n.nt(t,e,i)}function vn(n,t,e,i){const s=n(e,i);for(const r of s){const h=r.Tt(i);h!==null&&t(h)}}function tn(n,t){return e=>{var i,s;return function(r){return r.Wt!==void 0}(e)?(((i=e.Wt())==null?void 0:i.wa())??"")!==t?[]:((s=e.ta)==null?void 0:s.call(e,n))??[]:[]}}function zr(n,t,e,i){if(!n.length)return;let s=0;const r=n[0].$t(i,!0);let h=t===1?e/2-(n[0].Wi()-r/2):n[0].Wi()-r/2-e/2;h=Math.max(0,h);for(let o=1;o<n.length;o++){const l=n[o],a=n[o-1],u=a.$t(i,!1),f=l.Wi(),p=a.Wi();if(t===1?f>p-u:f<p+u){const g=p-u*t;l.Fi(g);const v=g-t*u/2;if((t===1?v<0:v>e)&&h>0){const b=t===1?-1-v:v-e,M=Math.min(b,h);for(let S=s;S<n.length;S++)n[S].Fi(n[S].Wi()+t*M);h-=M}}else s=o,h=t===1?p-u-f:f-(p+u)}}class Rr{constructor(t,e,i,s){this.Yi=null,this.kp=null,this.Pp=!1,this.Tp=new Ni(200),this.Rp=null,this.Dp=0,this.Vp=!1,this.Ip=()=>{this.Vp||this.yt.Bp().Qt().ar()},this.Ap=()=>{this.Vp||this.yt.Bp().Qt().ar()},this.yt=t,this.ys=e,this.gl=e.layout,this.Uu=i,this.Ep=s==="left",this.zp=tn("normal",s),this.Lp=tn("top",s),this.Op=tn("bottom",s),this.Ef=document.createElement("div"),this.Ef.style.height="100%",this.Ef.style.overflow="hidden",this.Ef.style.width="25px",this.Ef.style.left="0",this.Ef.style.position="relative",this.Np=Ae(this.Ef,A({width:16,height:16})),this.Np.subscribeSuggestedBitmapSizeChanged(this.Ip);const r=this.Np.canvasElement;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Wp=Ae(this.Ef,A({width:16,height:16})),this.Wp.subscribeSuggestedBitmapSizeChanged(this.Ap);const h=this.Wp.canvasElement;h.style.position="absolute",h.style.zIndex="2",h.style.left="0",h.style.top="0";const o={_f:this.Yf.bind(this),af:this.Yf.bind(this),Qd:this.jf.bind(this),Gd:this.jf.bind(this),uf:this.Fp.bind(this),nf:this.Kf.bind(this),if:this.Kf.bind(this),Ld:this.Hp.bind(this),Bd:this.Hp.bind(this),$d:this.Up.bind(this),Mf:this.qf.bind(this)};this.Pf=new Os(this.Wp.canvasElement,o,{Xd:()=>!this.ys.handleScroll.vertTouchDrag,Zd:()=>!0})}m(){this.Pf.m(),this.Wp.unsubscribeSuggestedBitmapSizeChanged(this.Ap),Le(this.Wp.canvasElement),this.Wp.dispose(),this.Np.unsubscribeSuggestedBitmapSizeChanged(this.Ip),Le(this.Np.canvasElement),this.Np.dispose(),this.Yi!==null&&this.Yi.io().u(this),this.Yi=null}Of(){return this.Ef}k(){return this.gl.fontSize}$p(){const t=this.Uu.N();return this.Rp!==t.P&&(this.Tp.In(),this.Rp=t.P),t}qp(){if(this.Yi===null)return 0;let t=0;const e=this.$p(),i=w(this.Np.canvasElement.getContext("2d",{colorSpace:this.yt.Bp().N().layout.colorSpace}));i.save();const s=this.Yi.Va();i.font=this.Yp(),s.length>0&&(t=Math.max(this.Tp.Vi(i,s[0].Xa),this.Tp.Vi(i,s[s.length-1].Xa)));const r=this.jp();for(let a=r.length;a--;){const u=this.Tp.Vi(i,r[a].ri());u>t&&(t=u)}const h=this.Yi.zt();if(h!==null&&this.kp!==null&&(o=this.ys.crosshair).mode!==2&&o.horzLine.visible&&o.horzLine.labelVisible){const a=this.Yi.Ts(1,h),u=this.Yi.Ts(this.kp.height-2,h);t=Math.max(t,this.Tp.Vi(i,this.Yi.Zi(Math.floor(Math.min(a,u))+.11111111111111,h)),this.Tp.Vi(i,this.Yi.Zi(Math.ceil(Math.max(a,u))-.11111111111111,h)))}var o;i.restore();const l=t||34;return mn(Math.ceil(e.S+e.C+e.I+e.B+5+l))}Kp(t){this.kp!==null&&Ee(this.kp,t)||(this.kp=t,this.Vp=!0,this.Np.resizeCanvasElement(t),this.Wp.resizeCanvasElement(t),this.Vp=!1,this.Ef.style.width=`${t.width}px`,this.Ef.style.height=`${t.height}px`)}Xp(){return w(this.kp).width}_s(t){this.Yi!==t&&(this.Yi!==null&&this.Yi.io().u(this),this.Yi=t,t.io().i(this.ol.bind(this),this))}Wt(){return this.Yi}In(){const t=this.yt.Xf();this.yt.Bp().Qt().Ho(t,w(this.Wt()))}Zp(t){if(this.kp===null)return;const e={colorSpace:this.yt.Bp().N().layout.colorSpace};if(t!==1){this.Gp(),this.Np.applySuggestedBitmapSize();const s=ze(this.Np,e);s!==null&&(s.useBitmapCoordinateSpace(r=>{this.Jp(r),this.Qp(r)}),this.yt.tv(s,this.Op),this.iv(s),this.yt.tv(s,this.zp),this.sv(s))}this.Wp.applySuggestedBitmapSize();const i=ze(this.Wp,e);i!==null&&(i.useBitmapCoordinateSpace(({context:s,bitmapSize:r})=>{s.clearRect(0,0,r.width,r.height)}),this.nv(i),this.yt.tv(i,this.Lp))}Wf(){return this.Np.bitmapSize}Ff(t,e,i){const s=this.Wf();s.width>0&&s.height>0&&t.drawImage(this.Np.canvasElement,e,i)}kt(){var t;(t=this.Yi)==null||t.Va()}Yf(t){if(this.Yi===null||this.Yi.Ki()||!this.ys.handleScale.axisPressedMouseMove.price)return;const e=this.yt.Bp().Qt(),i=this.yt.Xf();this.Pp=!0,e.Eo(i,this.Yi,t.localY)}jf(t){if(this.Yi===null||!this.ys.handleScale.axisPressedMouseMove.price)return;const e=this.yt.Bp().Qt(),i=this.yt.Xf(),s=this.Yi;e.zo(i,s,t.localY)}Fp(){if(this.Yi===null||!this.ys.handleScale.axisPressedMouseMove.price)return;const t=this.yt.Bp().Qt(),e=this.yt.Xf(),i=this.Yi;this.Pp&&(this.Pp=!1,t.Lo(e,i))}Kf(t){if(this.Yi===null||!this.ys.handleScale.axisPressedMouseMove.price)return;const e=this.yt.Bp().Qt(),i=this.yt.Xf();this.Pp=!1,e.Lo(i,this.Yi)}Hp(t){this.ys.handleScale.axisDoubleClickReset.price&&this.In()}Up(t){this.Yi!==null&&(!this.yt.Bp().Qt().N().handleScale.axisPressedMouseMove.price||this.Yi.Le()||this.Yi.Rl()||this.ev(1))}qf(t){this.ev(0)}jp(){const t=[],e=this.Yi===null?void 0:this.Yi;return(i=>{for(let s=0;s<i.length;++s){const r=i[s].Fs(this.yt.Xf(),e);for(let h=0;h<r.length;h++)t.push(r[h])}})(this.yt.Xf().Dt()),t}Jp({context:t,bitmapSize:e}){const{width:i,height:s}=e,r=this.yt.Xf().Qt(),h=r.$(),o=r.Vc();h===o?Rs(t,0,0,i,s,h):uo(t,0,0,i,s,h,o)}Qp({context:t,bitmapSize:e,horizontalPixelRatio:i}){if(this.kp===null||this.Yi===null||!this.Yi.N().borderVisible)return;t.fillStyle=this.Yi.N().borderColor;const s=Math.max(1,Math.floor(this.$p().S*i));let r;r=this.Ep?e.width-s:0,t.fillRect(r,0,s,e.height)}iv(t){if(this.kp===null||this.Yi===null)return;const e=this.Yi.Va(),i=this.Yi.N(),s=this.$p(),r=this.Ep?this.kp.width-s.C:0;i.borderVisible&&i.ticksVisible&&t.useBitmapCoordinateSpace(({context:h,horizontalPixelRatio:o,verticalPixelRatio:l})=>{h.fillStyle=i.borderColor;const a=Math.max(1,Math.floor(l)),u=Math.floor(.5*l),f=Math.round(s.C*o);h.beginPath();for(const p of e)h.rect(Math.floor(r*o),Math.round(p.ka*l)-u,f,a);h.fill()}),t.useMediaCoordinateSpace(({context:h})=>{h.font=this.Yp(),h.fillStyle=i.textColor??this.gl.textColor,h.textAlign=this.Ep?"right":"left",h.textBaseline="middle";const o=this.Ep?Math.round(r-s.I):Math.round(r+s.C+s.I),l=e.map(a=>this.Tp.Di(h,a.Xa));for(let a=e.length;a--;){const u=e[a];h.fillText(u.Xa,o,u.ka+l[a])}})}Gp(){if(this.kp===null||this.Yi===null)return;let t=this.kp.height/2;const e=[],i=this.Yi.Dt().slice(),s=this.yt.Xf(),r=this.$p();this.Yi===s.$n()&&this.yt.Xf().Dt().forEach(l=>{s.Un(l)&&i.push(l)});const h=this.Yi.ba()[0],o=this.Yi;i.forEach(l=>{const a=l.Fs(s,o);a.forEach(u=>{u.Fi(null),u.Hi()&&e.push(u)}),h===l&&a.length>0&&(t=a[0].Bi())}),e.forEach(l=>l.Fi(l.Bi())),this.Yi.N().alignLabels&&this.rv(e,r,t)}rv(t,e,i){if(this.kp===null)return;const s=t.filter(h=>h.Bi()<=i),r=t.filter(h=>h.Bi()>i);s.sort((h,o)=>o.Bi()-h.Bi()),s.length&&r.length&&r.push(s[0]),r.sort((h,o)=>h.Bi()-o.Bi());for(const h of t){const o=Math.floor(h.$t(e)/2),l=h.Bi();l>-o&&l<o&&h.Fi(o),l>this.kp.height-o&&l<this.kp.height+o&&h.Fi(this.kp.height-o)}zr(s,1,this.kp.height,e),zr(r,-1,this.kp.height,e)}sv(t){if(this.kp===null)return;const e=this.jp(),i=this.$p(),s=this.Ep?"right":"left";e.forEach(r=>{r.Ui()&&r.Tt(w(this.Yi)).nt(t,i,this.Tp,s)})}nv(t){if(this.kp===null||this.Yi===null)return;const e=this.yt.Bp().Qt(),i=[],s=this.yt.Xf(),r=e.sc().Fs(s,this.Yi);r.length&&i.push(r);const h=this.$p(),o=this.Ep?"right":"left";i.forEach(l=>{l.forEach(a=>{a.Tt(w(this.Yi)).nt(t,h,this.Tp,o)})})}ev(t){this.Ef.style.cursor=t===1?"ns-resize":"default"}ol(){const t=this.qp();this.Dp<t&&this.yt.Bp().Qt().Bh(),this.Dp=t}Yp(){return Ri(this.gl.fontSize,this.gl.fontFamily)}}function wf(n,t){var e;return((e=n.Jh)==null?void 0:e.call(n,t))??[]}function Nr(n,t){var e;return((e=n.Ws)==null?void 0:e.call(n,t))??[]}function Ar(n,t){var e;return((e=n.us)==null?void 0:e.call(n,t))??[]}function bf(n,t){var e;return((e=n.Xh)==null?void 0:e.call(n,t))??[]}class In{constructor(t,e){this.kp=A({width:0,height:0}),this.hv=null,this.av=null,this.lv=null,this.ov=null,this._v=!1,this.uv=new V,this.cv=new V,this.dv=0,this.fv=!1,this.pv=null,this.vv=!1,this.mv=null,this.wv=null,this.Vp=!1,this.Ip=()=>{this.Vp||this.gv===null||this.ts().ar()},this.Ap=()=>{this.Vp||this.gv===null||this.ts().ar()},this.gp=t,this.gv=e,this.gv.Yo().i(this.Mv.bind(this),this,!0),this.bv=document.createElement("td"),this.bv.style.padding="0",this.bv.style.position="relative";const i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.position="relative",i.style.overflow="hidden",this.Sv=document.createElement("td"),this.Sv.style.padding="0",this.xv=document.createElement("td"),this.xv.style.padding="0",this.bv.appendChild(i),this.Np=Ae(i,A({width:16,height:16})),this.Np.subscribeSuggestedBitmapSizeChanged(this.Ip);const s=this.Np.canvasElement;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.Wp=Ae(i,A({width:16,height:16})),this.Wp.subscribeSuggestedBitmapSizeChanged(this.Ap);const r=this.Wp.canvasElement;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.Af=document.createElement("tr"),this.Af.appendChild(this.Sv),this.Af.appendChild(this.bv),this.Af.appendChild(this.xv),this.Cv(),this.Pf=new Os(this.Wp.canvasElement,this,{Xd:()=>this.pv===null&&!this.gp.N().handleScroll.vertTouchDrag,Zd:()=>this.pv===null&&!this.gp.N().handleScroll.horzTouchDrag})}m(){this.hv!==null&&this.hv.m(),this.av!==null&&this.av.m(),this.lv=null,this.Wp.unsubscribeSuggestedBitmapSizeChanged(this.Ap),Le(this.Wp.canvasElement),this.Wp.dispose(),this.Np.unsubscribeSuggestedBitmapSizeChanged(this.Ip),Le(this.Np.canvasElement),this.Np.dispose(),this.gv!==null&&(this.gv.Yo().u(this),this.gv.m()),this.Pf.m()}Xf(){return w(this.gv)}yv(t){var e;this.gv!==null&&this.gv.Yo().u(this),this.gv=t,this.gv!==null&&this.gv.Yo().i(In.prototype.Mv.bind(this),this,!0),this.Cv(),this.gp.If().indexOf(this)===this.gp.If().length-1?(this.lv=this.lv??new vf(this.bv,this.gp),this.lv.kt()):((e=this.lv)==null||e.bp(),this.lv=null)}Bp(){return this.gp}Of(){return this.Af}Cv(){if(this.gv!==null&&(this.kv(),this.ts().js().length!==0)){if(this.hv!==null){const t=this.gv.Bo();this.hv._s(w(t))}if(this.av!==null){const t=this.gv.Ao();this.av._s(w(t))}}}Pv(){this.hv!==null&&this.hv.kt(),this.av!==null&&this.av.kt()}ko(){return this.gv!==null?this.gv.ko():0}Po(t){this.gv&&this.gv.Po(t)}$d(t){if(!this.gv)return;this.Tv();const e=t.localX,i=t.localY;this.Rv(e,i,t)}_f(t){this.Tv(),this.Dv(),this.Rv(t.localX,t.localY,t)}qd(t){if(!this.gv)return;this.Tv();const e=t.localX,i=t.localY;this.Rv(e,i,t)}ef(t){this.gv!==null&&(this.Tv(),this.Vv(t))}Ld(t){this.gv!==null&&this.Iv(this.cv,t)}Bd(t){this.Ld(t)}Qd(t){this.Tv(),this.Bv(t),this.Rv(t.localX,t.localY,t)}nf(t){this.gv!==null&&(this.Tv(),this.fv=!1,this.Av(t))}sf(t){this.gv!==null&&this.Vv(t)}bf(t){if(this.fv=!0,this.pv===null){const e={x:t.localX,y:t.localY};this.Ev(e,e,t)}}Mf(t){this.gv!==null&&(this.Tv(),this.gv.Qt().Ju(null),this.zv())}Lv(){return this.uv}Ov(){return this.cv}ff(){this.dv=1,this.ts().hn()}pf(t,e){if(!this.gp.N().handleScale.pinch)return;const i=5*(e-this.dv);this.dv=e,this.ts()._c(t._t,i)}af(t){this.fv=!1,this.vv=this.pv!==null,this.Dv();const e=this.ts().sc();this.pv!==null&&e.Vt()&&(this.mv={x:e.si(),y:e.ni()},this.pv={x:t.localX,y:t.localY})}Gd(t){if(this.gv===null)return;const e=t.localX,i=t.localY;if(this.pv===null)this.Bv(t);else{this.vv=!1;const s=w(this.mv),r=s.x+(e-this.pv.x),h=s.y+(i-this.pv.y);this.Rv(r,h,t)}}if(t){this.Bp().N().trackingMode.exitMode===0&&(this.vv=!0),this.Nv(),this.Av(t)}jn(t,e){const i=this.gv;return i===null?null:Mo(i,t,e)}Wv(t,e){w(e==="left"?this.hv:this.av).Kp(A({width:t,height:this.kp.height}))}Nf(){return this.kp}Kp(t){Ee(this.kp,t)||(this.kp=t,this.Vp=!0,this.Np.resizeCanvasElement(t),this.Wp.resizeCanvasElement(t),this.Vp=!1,this.bv.style.width=t.width+"px",this.bv.style.height=t.height+"px")}Fv(){const t=w(this.gv);t.Io(t.Bo()),t.Io(t.Ao());for(const e of t.ba())if(t.Un(e)){const i=e.Wt();i!==null&&t.Io(i),e.Ns()}for(const e of t.Ko())e.Ns()}Wf(){return this.Np.bitmapSize}Ff(t,e,i){const s=this.Wf();s.width>0&&s.height>0&&t.drawImage(this.Np.canvasElement,e,i)}Zp(t){if(t===0||this.gv===null)return;t>1&&this.Fv(),this.hv!==null&&this.hv.Zp(t),this.av!==null&&this.av.Zp(t);const e={colorSpace:this.gp.N().layout.colorSpace};if(t!==1){this.Np.applySuggestedBitmapSize();const s=ze(this.Np,e);s!==null&&(s.useBitmapCoordinateSpace(r=>{this.Jp(r)}),this.gv&&(this.Hv(s,wf),this.Uv(s),this.Hv(s,Nr),this.Hv(s,Ar)))}this.Wp.applySuggestedBitmapSize();const i=ze(this.Wp,e);i!==null&&(i.useBitmapCoordinateSpace(({context:s,bitmapSize:r})=>{s.clearRect(0,0,r.width,r.height)}),this.$v(i),this.Hv(i,bf),this.Hv(i,Ar))}qv(){return this.hv}Yv(){return this.av}tv(t,e){this.Hv(t,e)}Mv(){this.gv!==null&&this.gv.Yo().u(this),this.gv=null}Vv(t){this.Iv(this.uv,t)}Iv(t,e){const i=e.localX,s=e.localY;t.v()&&t.p(this.ts().At().nu(i),{x:i,y:s},e)}Jp({context:t,bitmapSize:e}){const{width:i,height:s}=e,r=this.ts(),h=r.$(),o=r.Vc();h===o?Rs(t,0,0,i,s,o):uo(t,0,0,i,s,h,o)}Uv(t){const e=w(this.gv),i=e.jo().lr().Tt(e);i!==null&&i.nt(t,!1)}$v(t){this.jv(t,Nr,gs,this.ts().sc())}Hv(t,e){const i=w(this.gv),s=i.Dt(),r=i.Ko();for(const h of r)this.jv(t,e,gn,h);for(const h of s)this.jv(t,e,gn,h);for(const h of r)this.jv(t,e,gs,h);for(const h of s)this.jv(t,e,gs,h)}jv(t,e,i,s){const r=w(this.gv),h=r.Qt().Gu(),o=h!==null&&h.Xo===s,l=h!==null&&o&&h.Zo!==void 0?h.Zo.Xn:void 0;vn(e,a=>i(a,t,o,l),s,r)}kv(){if(this.gv===null)return;const t=this.gp,e=this.gv.Bo().N().visible,i=this.gv.Ao().N().visible;e||this.hv===null||(this.Sv.removeChild(this.hv.Of()),this.hv.m(),this.hv=null),i||this.av===null||(this.xv.removeChild(this.av.Of()),this.av.m(),this.av=null);const s=t.Qt().Sc();e&&this.hv===null&&(this.hv=new Rr(this,t.N(),s,"left"),this.Sv.appendChild(this.hv.Of())),i&&this.av===null&&(this.av=new Rr(this,t.N(),s,"right"),this.xv.appendChild(this.av.Of()))}Kv(t){return t.Sf&&this.fv||this.pv!==null}Xv(t){return Math.max(0,Math.min(t,this.kp.width-1))}Zv(t){return Math.max(0,Math.min(t,this.kp.height-1))}Rv(t,e,i){this.ts().wc(this.Xv(t),this.Zv(e),i,w(this.gv))}zv(){this.ts().Mc()}Nv(){this.vv&&(this.pv=null,this.zv())}Ev(t,e,i){this.pv=t,this.vv=!1,this.Rv(e.x,e.y,i);const s=this.ts().sc();this.mv={x:s.si(),y:s.ni()}}ts(){return this.gp.Qt()}Av(t){if(!this._v)return;const e=this.ts(),i=this.Xf();if(e.Wo(i,i.Ps()),this.ov=null,this._v=!1,e.fc(),this.wv!==null){const s=performance.now(),r=e.At();this.wv.le(r._u(),s),this.wv.Mu(s)||e._n(this.wv)}}Tv(){this.pv=null}Dv(){if(this.gv){if(this.ts().hn(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)w(document.activeElement).blur();else{const t=document.getSelection();t!==null&&t.removeAllRanges()}!this.gv.Ps().Ki()&&this.ts().At().Ki()}}Bv(t){if(this.gv===null)return;const e=this.ts(),i=e.At();if(i.Ki())return;const s=this.gp.N(),r=s.handleScroll,h=s.kineticScroll;if((!r.pressedMouseMove||t.Sf)&&(!r.horzTouchDrag&&!r.vertTouchDrag||!t.Sf))return;const o=this.gv.Ps(),l=performance.now();if(this.ov!==null||this.Kv(t)||(this.ov={x:t.clientX,y:t.clientY,Yc:l,Gv:t.localX,Jv:t.localY}),this.ov!==null&&!this._v&&(this.ov.x!==t.clientX||this.ov.y!==t.clientY)){if(t.Sf&&h.touch||!t.Sf&&h.mouse){const a=i.lu();this.wv=new gf(.2/a,7/a,.997,15/a),this.wv.dp(i._u(),this.ov.Yc)}else this.wv=null;o.Ki()||e.Oo(this.gv,o,t.localY),e.cc(t.localX),this._v=!0}this._v&&(o.Ki()||e.No(this.gv,o,t.localY),e.dc(t.localX),this.wv!==null&&this.wv.dp(i._u(),l))}}class Lr{constructor(t,e,i,s,r){this.xt=!0,this.kp=A({width:0,height:0}),this.Ip=()=>this.Zp(3),this.Ep=t==="left",this.Uu=i.Sc,this.ys=e,this.Qv=s,this.tm=r,this.Ef=document.createElement("div"),this.Ef.style.width="25px",this.Ef.style.height="100%",this.Ef.style.overflow="hidden",this.Np=Ae(this.Ef,A({width:16,height:16})),this.Np.subscribeSuggestedBitmapSizeChanged(this.Ip)}m(){this.Np.unsubscribeSuggestedBitmapSizeChanged(this.Ip),Le(this.Np.canvasElement),this.Np.dispose()}Of(){return this.Ef}Nf(){return this.kp}Kp(t){Ee(this.kp,t)||(this.kp=t,this.Np.resizeCanvasElement(t),this.Ef.style.width=`${t.width}px`,this.Ef.style.height=`${t.height}px`,this.xt=!0)}Zp(t){if(t<3&&!this.xt||this.kp.width===0||this.kp.height===0)return;this.xt=!1,this.Np.applySuggestedBitmapSize();const e=ze(this.Np,{colorSpace:this.ys.layout.colorSpace});e!==null&&e.useBitmapCoordinateSpace(i=>{this.Jp(i),this.Qp(i)})}Wf(){return this.Np.bitmapSize}Ff(t,e,i){const s=this.Wf();s.width>0&&s.height>0&&t.drawImage(this.Np.canvasElement,e,i)}Qp({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(!this.Qv())return;t.fillStyle=this.ys.timeScale.borderColor;const r=Math.floor(this.Uu.N().S*i),h=Math.floor(this.Uu.N().S*s),o=this.Ep?e.width-r:0;t.fillRect(o,0,r,h)}Jp({context:t,bitmapSize:e}){Rs(t,0,0,e.width,e.height,this.tm())}}function $n(n){return t=>{var e;return((e=t.ia)==null?void 0:e.call(t,n))??[]}}const yf=$n("normal"),_f=$n("top"),Mf=$n("bottom");class xf{constructor(t,e){this.im=null,this.sm=null,this.M=null,this.nm=!1,this.kp=A({width:0,height:0}),this.rm=new V,this.Tp=new Ni(5),this.Vp=!1,this.Ip=()=>{this.Vp||this.gp.Qt().ar()},this.Ap=()=>{this.Vp||this.gp.Qt().ar()},this.gp=t,this.i_=e,this.ys=t.N().layout,this.pp=document.createElement("tr"),this.hm=document.createElement("td"),this.hm.style.padding="0",this.am=document.createElement("td"),this.am.style.padding="0",this.Ef=document.createElement("td"),this.Ef.style.height="25px",this.Ef.style.padding="0",this.lm=document.createElement("div"),this.lm.style.width="100%",this.lm.style.height="100%",this.lm.style.position="relative",this.lm.style.overflow="hidden",this.Ef.appendChild(this.lm),this.Np=Ae(this.lm,A({width:16,height:16})),this.Np.subscribeSuggestedBitmapSizeChanged(this.Ip);const i=this.Np.canvasElement;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.Wp=Ae(this.lm,A({width:16,height:16})),this.Wp.subscribeSuggestedBitmapSizeChanged(this.Ap);const s=this.Wp.canvasElement;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this.pp.appendChild(this.hm),this.pp.appendChild(this.Ef),this.pp.appendChild(this.am),this.om(),this.gp.Qt().yo().i(this.om.bind(this),this),this.Pf=new Os(this.Wp.canvasElement,this,{Xd:()=>!0,Zd:()=>!this.gp.N().handleScroll.horzTouchDrag})}m(){this.Pf.m(),this.im!==null&&this.im.m(),this.sm!==null&&this.sm.m(),this.Wp.unsubscribeSuggestedBitmapSizeChanged(this.Ap),Le(this.Wp.canvasElement),this.Wp.dispose(),this.Np.unsubscribeSuggestedBitmapSizeChanged(this.Ip),Le(this.Np.canvasElement),this.Np.dispose()}Of(){return this.pp}_m(){return this.im}um(){return this.sm}_f(t){if(this.nm)return;this.nm=!0;const e=this.gp.Qt();!e.At().Ki()&&this.gp.N().handleScale.axisPressedMouseMove.time&&e.oc(t.localX)}af(t){this._f(t)}uf(){const t=this.gp.Qt();!t.At().Ki()&&this.nm&&(this.nm=!1,this.gp.N().handleScale.axisPressedMouseMove.time&&t.mc())}Qd(t){const e=this.gp.Qt();!e.At().Ki()&&this.gp.N().handleScale.axisPressedMouseMove.time&&e.vc(t.localX)}Gd(t){this.Qd(t)}nf(){this.nm=!1;const t=this.gp.Qt();t.At().Ki()&&!this.gp.N().handleScale.axisPressedMouseMove.time||t.mc()}if(){this.nf()}Ld(){this.gp.N().handleScale.axisDoubleClickReset.time&&this.gp.Qt().cn()}Bd(){this.Ld()}$d(){this.gp.Qt().N().handleScale.axisPressedMouseMove.time&&this.ev(1)}Mf(){this.ev(0)}Nf(){return this.kp}dm(){return this.rm}fm(t,e,i){Ee(this.kp,t)||(this.kp=t,this.Vp=!0,this.Np.resizeCanvasElement(t),this.Wp.resizeCanvasElement(t),this.Vp=!1,this.Ef.style.width=`${t.width}px`,this.Ef.style.height=`${t.height}px`,this.rm.p(t)),this.im!==null&&this.im.Kp(A({width:e,height:t.height})),this.sm!==null&&this.sm.Kp(A({width:i,height:t.height}))}pm(){const t=this.vm();return Math.ceil(t.S+t.C+t.k+t.A+t.V+t.wm)}kt(){this.gp.Qt().At().Va()}Wf(){return this.Np.bitmapSize}Ff(t,e,i){const s=this.Wf();s.width>0&&s.height>0&&t.drawImage(this.Np.canvasElement,e,i)}Zp(t){if(t===0)return;const e={colorSpace:this.ys.colorSpace};if(t!==1){this.Np.applySuggestedBitmapSize();const s=ze(this.Np,e);s!==null&&(s.useBitmapCoordinateSpace(r=>{this.Jp(r),this.Qp(r),this.gm(s,Mf)}),this.iv(s),this.gm(s,yf)),this.im!==null&&this.im.Zp(t),this.sm!==null&&this.sm.Zp(t)}this.Wp.applySuggestedBitmapSize();const i=ze(this.Wp,e);i!==null&&(i.useBitmapCoordinateSpace(({context:s,bitmapSize:r})=>{s.clearRect(0,0,r.width,r.height)}),this.Mm([...this.gp.Qt().js(),this.gp.Qt().sc()],i),this.gm(i,_f))}gm(t,e){const i=this.gp.Qt().js();for(const s of i)vn(e,r=>gn(r,t,!1,void 0),s,void 0);for(const s of i)vn(e,r=>gs(r,t,!1,void 0),s,void 0)}Jp({context:t,bitmapSize:e}){Rs(t,0,0,e.width,e.height,this.gp.Qt().Vc())}Qp({context:t,bitmapSize:e,verticalPixelRatio:i}){if(this.gp.N().timeScale.borderVisible){t.fillStyle=this.bm();const s=Math.max(1,Math.floor(this.vm().S*i));t.fillRect(0,0,e.width,s)}}iv(t){const e=this.gp.Qt().At(),i=e.Va();if(!i||i.length===0)return;const s=this.i_.maxTickMarkWeight(i),r=this.vm(),h=e.N();h.borderVisible&&h.ticksVisible&&t.useBitmapCoordinateSpace(({context:o,horizontalPixelRatio:l,verticalPixelRatio:a})=>{o.strokeStyle=this.bm(),o.fillStyle=this.bm();const u=Math.max(1,Math.floor(l)),f=Math.floor(.5*l);o.beginPath();const p=Math.round(r.C*a);for(let g=i.length;g--;){const v=Math.round(i[g].coord*l);o.rect(v-f,0,u,p)}o.fill()}),t.useMediaCoordinateSpace(({context:o})=>{const l=r.S+r.C+r.A+r.k/2;o.textAlign="center",o.textBaseline="middle",o.fillStyle=this.H(),o.font=this.Yp();for(const a of i)if(a.weight<s){const u=a.needAlignCoordinate?this.Sm(o,a.coord,a.label):a.coord;o.fillText(a.label,u,l)}this.gp.N().timeScale.allowBoldLabels&&(o.font=this.xm());for(const a of i)if(a.weight>=s){const u=a.needAlignCoordinate?this.Sm(o,a.coord,a.label):a.coord;o.fillText(a.label,u,l)}})}Sm(t,e,i){const s=this.Tp.Vi(t,i),r=s/2,h=Math.floor(e-r)+.5;return h<0?e+=Math.abs(0-h):h+s>this.kp.width&&(e-=Math.abs(this.kp.width-(h+s))),e}Mm(t,e){const i=this.vm();for(const s of t)for(const r of s.cs())r.Tt().nt(e,i)}bm(){return this.gp.N().timeScale.borderColor}H(){return this.ys.textColor}W(){return this.ys.fontSize}Yp(){return Ri(this.W(),this.ys.fontFamily)}xm(){return Ri(this.W(),this.ys.fontFamily,"bold")}vm(){this.M===null&&(this.M={S:1,L:NaN,A:NaN,V:NaN,Ji:NaN,C:5,k:NaN,P:"",Gi:new Ni,wm:0});const t=this.M,e=this.Yp();if(t.P!==e){const i=this.W();t.k=i,t.P=e,t.A=3*i/12,t.V=3*i/12,t.Ji=9*i/12,t.L=0,t.wm=4*i/12,t.Gi.In()}return this.M}ev(t){this.Ef.style.cursor=t===1?"ew-resize":"default"}om(){const t=this.gp.Qt(),e=t.N();e.leftPriceScale.visible||this.im===null||(this.hm.removeChild(this.im.Of()),this.im.m(),this.im=null),e.rightPriceScale.visible||this.sm===null||(this.am.removeChild(this.sm.Of()),this.sm.m(),this.sm=null);const i={Sc:this.gp.Qt().Sc()},s=()=>e.leftPriceScale.borderVisible&&t.At().N().borderVisible,r=()=>t.Vc();e.leftPriceScale.visible&&this.im===null&&(this.im=new Lr("left",e,i,s,r),this.hm.appendChild(this.im.Of())),e.rightPriceScale.visible&&this.sm===null&&(this.sm=new Lr("right",e,i,s,r),this.am.appendChild(this.sm.Of()))}}var th;const Sf=!!ei&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(n=>n.brand.includes("Chromium"))&&!!ei&&((th=navigator==null?void 0:navigator.userAgentData)!=null&&th.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);class Cf{constructor(t,e,i){var s;this.Cm=[],this.ym=[],this.km=0,this.tl=0,this.fo=0,this.Pm=0,this.Tm=0,this.Rm=null,this.Dm=!1,this.uv=new V,this.cv=new V,this.Wu=new V,this.Vm=null,this.Im=null,this.wp=t,this.ys=e,this.i_=i,this.pp=document.createElement("div"),this.pp.classList.add("tv-lightweight-charts"),this.pp.style.overflow="hidden",this.pp.style.direction="ltr",this.pp.style.width="100%",this.pp.style.height="100%",(s=this.pp).style.userSelect="none",s.style.webkitUserSelect="none",s.style.msUserSelect="none",s.style.MozUserSelect="none",s.style.webkitTapHighlightColor="transparent",this.Bm=document.createElement("table"),this.Bm.setAttribute("cellspacing","0"),this.pp.appendChild(this.Bm),this.Am=this.Em.bind(this),en(this.ys)&&this.zm(!0),this.ts=new af(this.Hu.bind(this),this.ys,i),this.Qt().nc().i(this.Lm.bind(this),this),this.Om=new xf(this,this.i_),this.Bm.appendChild(this.Om.Of());const r=e.autoSize&&this.Nm();let h=this.ys.width,o=this.ys.height;if(r||h===0||o===0){const l=t.getBoundingClientRect();h=h||l.width,o=o||l.height}this.Wm(h,o),this.Fm(),t.appendChild(this.pp),this.Hm(),this.ts.At().Cu().i(this.ts.Bh.bind(this.ts),this),this.ts.yo().i(this.ts.Bh.bind(this.ts),this)}Qt(){return this.ts}N(){return this.ys}If(){return this.Cm}Um(){return this.Om}m(){this.zm(!1),this.km!==0&&window.cancelAnimationFrame(this.km),this.ts.nc().u(this),this.ts.At().Cu().u(this),this.ts.yo().u(this),this.ts.m();for(const t of this.Cm)this.Bm.removeChild(t.Of()),t.Lv().u(this),t.Ov().u(this),t.m();this.Cm=[];for(const t of this.ym)this.$m(t);this.ym=[],w(this.Om).m(),this.pp.parentElement!==null&&this.pp.parentElement.removeChild(this.pp),this.Wu.m(),this.uv.m(),this.cv.m(),this.qm()}Wm(t,e,i=!1){if(this.tl===e&&this.fo===t)return;const s=function(o){const l=Math.floor(o.width),a=Math.floor(o.height);return A({width:l-l%2,height:a-a%2})}(A({width:t,height:e}));this.tl=s.height,this.fo=s.width;const r=this.tl+"px",h=this.fo+"px";w(this.pp).style.height=r,w(this.pp).style.width=h,this.Bm.style.height=r,this.Bm.style.width=h,i?this.Ym(q.gn(),performance.now()):this.ts.Bh()}Zp(t){t===void 0&&(t=q.gn());for(let e=0;e<this.Cm.length;e++)this.Cm[e].Zp(t.en(e).tn);this.ys.timeScale.visible&&this.Om.Zp(t.nn())}hr(t){var s;const e=en(this.ys);this.ts.hr(t);const i=en(this.ys);i!==e&&this.zm(i),(s=t.layout)!=null&&s.panes&&this.jm(),this.Hm(),this.Km(t)}Lv(){return this.uv}Ov(){return this.cv}nc(){return this.Wu}Xm(){this.Rm!==null&&(this.Ym(this.Rm,performance.now()),this.Rm=null);const t=this.Zm(null),e=document.createElement("canvas");e.width=t.width,e.height=t.height;const i=w(e.getContext("2d"));return this.Zm(i),e}Gm(t){return t==="left"&&!this.Jm()||t==="right"&&!this.Qm()||this.Cm.length===0?0:w(t==="left"?this.Cm[0].qv():this.Cm[0].Yv()).Xp()}tw(){return this.ys.autoSize&&this.Vm!==null}Uf(){return this.pp}iw(t){this.Im=t,this.Im?this.Uf().style.setProperty("cursor",t):this.Uf().style.removeProperty("cursor")}sw(){return this.Im}nw(t){return K(this.Cm[t]).Nf()}jm(){this.ym.forEach(t=>{t.kt()})}Km(t){(t.autoSize!==void 0||!this.Vm||t.width===void 0&&t.height===void 0)&&(t.autoSize&&!this.Vm&&this.Nm(),t.autoSize===!1&&this.Vm!==null&&this.qm(),t.autoSize||t.width===void 0&&t.height===void 0||this.Wm(t.width||this.fo,t.height||this.tl))}Zm(t){let e=0,i=0;const s=this.Cm[0],r=(o,l)=>{let a=0;for(let u=0;u<this.Cm.length;u++){const f=this.Cm[u],p=w(o==="left"?f.qv():f.Yv()),g=p.Wf();if(t!==null&&p.Ff(t,l,a),a+=g.height,u<this.Cm.length-1){const v=this.ym[u],b=v.Wf();t!==null&&v.Ff(t,l,a),a+=b.height}}};this.Jm()&&(r("left",0),e+=w(s.qv()).Wf().width);for(let o=0;o<this.Cm.length;o++){const l=this.Cm[o],a=l.Wf();if(t!==null&&l.Ff(t,e,i),i+=a.height,o<this.Cm.length-1){const u=this.ym[o],f=u.Wf();t!==null&&u.Ff(t,e,i),i+=f.height}}e+=s.Wf().width,this.Qm()&&(r("right",e),e+=w(s.Yv()).Wf().width);const h=(o,l,a)=>{w(o==="left"?this.Om._m():this.Om.um()).Ff(w(t),l,a)};if(this.ys.timeScale.visible){const o=this.Om.Wf();if(t!==null){let l=0;this.Jm()&&(h("left",l,i),l=w(s.qv()).Wf().width),this.Om.Ff(t,l,i),l+=o.width,this.Qm()&&h("right",l,i)}i+=o.height}return A({width:e,height:i})}ew(){let t=0,e=0,i=0;for(const M of this.Cm)this.Jm()&&(e=Math.max(e,w(M.qv()).qp(),this.ys.leftPriceScale.minimumWidth)),this.Qm()&&(i=Math.max(i,w(M.Yv()).qp(),this.ys.rightPriceScale.minimumWidth)),t+=M.ko();e=mn(e),i=mn(i);const s=this.fo,r=this.tl,h=Math.max(s-e-i,0),o=1*this.ym.length,l=this.ys.timeScale.visible;let a=l?Math.max(this.Om.pm(),this.ys.timeScale.minimumHeight):0;var u;a=(u=a)+u%2;const f=o+a,p=r<f?0:r-f,g=p/t;let v=0;const b=window.devicePixelRatio||1;for(let M=0;M<this.Cm.length;++M){const S=this.Cm[M];S.yv(this.ts.$s()[M]);let R=0,B=0;B=M===this.Cm.length-1?Math.ceil((p-v)*b)/b:Math.round(S.ko()*g*b)/b,R=Math.max(B,2),v+=R,S.Kp(A({width:h,height:R})),this.Jm()&&S.Wv(e,"left"),this.Qm()&&S.Wv(i,"right"),S.Xf()&&this.ts.ec(S.Xf(),R)}this.Om.fm(A({width:l?h:0,height:a}),l?e:0,l?i:0),this.ts.To(h),this.Pm!==e&&(this.Pm=e),this.Tm!==i&&(this.Tm=i)}zm(t){t?this.pp.addEventListener("wheel",this.Am,{passive:!1}):this.pp.removeEventListener("wheel",this.Am)}rw(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return Sf?1/window.devicePixelRatio:1}Em(t){if(!(t.deltaX!==0&&this.ys.handleScroll.mouseWheel||t.deltaY!==0&&this.ys.handleScale.mouseWheel))return;const e=this.rw(t),i=e*t.deltaX/100,s=-e*t.deltaY/100;if(t.cancelable&&t.preventDefault(),s!==0&&this.ys.handleScale.mouseWheel){const r=Math.sign(s)*Math.min(1,Math.abs(s)),h=t.clientX-this.pp.getBoundingClientRect().left;this.Qt()._c(h,r)}i!==0&&this.ys.handleScroll.mouseWheel&&this.Qt().uc(-80*i)}Ym(t,e){var s;const i=t.nn();i===3&&this.hw(),i!==3&&i!==2||(this.aw(t),this.lw(t,e),this.Om.kt(),this.Cm.forEach(r=>{r.Pv()}),((s=this.Rm)==null?void 0:s.nn())===3&&(this.Rm.vn(t),this.hw(),this.aw(this.Rm),this.lw(this.Rm,e),t=this.Rm,this.Rm=null)),this.Zp(t)}lw(t,e){for(const i of t.pn())this.mn(i,e)}aw(t){const e=this.ts.$s();for(let i=0;i<e.length;i++)t.en(i).sn&&e[i].Uo()}mn(t,e){const i=this.ts.At();switch(t.an){case 0:i.ku();break;case 1:i.Pu(t.Ft);break;case 2:i.dn(t.Ft);break;case 3:i.fn(t.Ft);break;case 4:i.du();break;case 5:t.Ft.Mu(e)||i.fn(t.Ft.bu(e))}}Hu(t){this.Rm!==null?this.Rm.vn(t):this.Rm=t,this.Dm||(this.Dm=!0,this.km=window.requestAnimationFrame(e=>{if(this.Dm=!1,this.km=0,this.Rm!==null){const i=this.Rm;this.Rm=null,this.Ym(i,e);for(const s of i.pn())if(s.an===5&&!s.Ft.Mu(e)){this.Qt()._n(s.Ft);break}}}))}hw(){this.Fm()}$m(t){this.Bm.removeChild(t.Of()),t.m()}Fm(){const t=this.ts.$s(),e=t.length,i=this.Cm.length;for(let s=e;s<i;s++){const r=K(this.Cm.pop());this.Bm.removeChild(r.Of()),r.Lv().u(this),r.Ov().u(this),r.m();const h=this.ym.pop();h!==void 0&&this.$m(h)}for(let s=i;s<e;s++){const r=new In(this,t[s]);if(r.Lv().i(this.ow.bind(this,r),this),r.Ov().i(this._w.bind(this,r),this),this.Cm.push(r),s>0){const h=new mf(this,s-1,s);this.ym.push(h),this.Bm.insertBefore(h.Of(),this.Om.Of())}this.Bm.insertBefore(r.Of(),this.Om.Of())}for(let s=0;s<e;s++){const r=t[s],h=this.Cm[s];h.Xf()!==r?h.yv(r):h.Cv()}this.Hm(),this.ew()}uw(t,e,i,s){var f;const r=new Map;t!==null&&this.ts.js().forEach(p=>{const g=p.Xs().Wr(t);g!==null&&r.set(p,g)});let h;if(t!==null){const p=(f=this.ts.At().ss(t))==null?void 0:f.originalTime;p!==void 0&&(h=p)}const o=this.Qt().Gu(),l=o!==null&&o.Xo instanceof Bs?o.Xo:void 0,a=o!==null&&o.Zo!==void 0?o.Zo.Kn:void 0,u=this.cw(s);return{dw:h,Re:t??void 0,fw:e??void 0,pw:u!==-1?u:void 0,mw:l,ww:r,gw:a,Mw:i??void 0}}cw(t){let e=-1;if(t)e=this.Cm.indexOf(t);else{const i=this.Qt().sc().Us();i!==null&&(e=this.Qt().$s().indexOf(i))}return e}ow(t,e,i,s){this.uv.p(()=>this.uw(e,i,s,t))}_w(t,e,i,s){this.cv.p(()=>this.uw(e,i,s,t))}Lm(t,e,i){var s;this.iw(((s=this.Qt().Gu())==null?void 0:s.Jo)??null),this.Wu.p(()=>this.uw(t,e,i))}Hm(){const t=this.ys.timeScale.visible?"":"none";this.Om.Of().style.display=t}Jm(){return this.Cm[0].Xf().Bo().N().visible}Qm(){return this.Cm[0].Xf().Ao().N().visible}Nm(){return"ResizeObserver"in window&&(this.Vm=new ResizeObserver(t=>{const e=t[t.length-1];e&&this.Wm(e.contentRect.width,e.contentRect.height)}),this.Vm.observe(this.wp,{box:"border-box"}),!0)}qm(){this.Vm!==null&&this.Vm.disconnect(),this.Vm=null}}function en(n){return!!(n.handleScroll.mouseWheel||n.handleScale.mouseWheel)}function Tf(n){return n.open===void 0&&n.value===void 0}function kf(n){return function(t){return t.open!==void 0}(n)||function(t){return t.value!==void 0}(n)}function Br(n,t,e,i){const s=e.value,r={Re:t,wt:n,Ft:[s,s,s,s],dw:i};return e.color!==void 0&&(r.R=e.color),r}function Ef(n,t,e,i){const s=e.value,r={Re:t,wt:n,Ft:[s,s,s,s],dw:i};return e.lineColor!==void 0&&(r.vt=e.lineColor),e.topColor!==void 0&&(r.mr=e.topColor),e.bottomColor!==void 0&&(r.wr=e.bottomColor),r}function zf(n,t,e,i){const s=e.value,r={Re:t,wt:n,Ft:[s,s,s,s],dw:i};return e.topLineColor!==void 0&&(r.gr=e.topLineColor),e.bottomLineColor!==void 0&&(r.Mr=e.bottomLineColor),e.topFillColor1!==void 0&&(r.br=e.topFillColor1),e.topFillColor2!==void 0&&(r.Sr=e.topFillColor2),e.bottomFillColor1!==void 0&&(r.Cr=e.bottomFillColor1),e.bottomFillColor2!==void 0&&(r.yr=e.bottomFillColor2),r}function Rf(n,t,e,i){const s={Re:t,wt:n,Ft:[e.open,e.high,e.low,e.close],dw:i};return e.color!==void 0&&(s.R=e.color),s}function Nf(n,t,e,i){const s={Re:t,wt:n,Ft:[e.open,e.high,e.low,e.close],dw:i};return e.color!==void 0&&(s.R=e.color),e.borderColor!==void 0&&(s.Ht=e.borderColor),e.wickColor!==void 0&&(s.vr=e.wickColor),s}function Af(n,t,e,i,s){const r=K(s)(e),h=Math.max(...r),o=Math.min(...r),l=r[r.length-1],a=[l,h,o,l],{time:u,color:f,...p}=e;return{Re:t,wt:n,Ft:a,dw:i,se:p,R:f}}function pi(n){return n.Ft!==void 0}function Or(n,t){return t.customValues!==void 0&&(n.bw=t.customValues),n}function ne(n){return(t,e,i,s,r,h)=>function(o,l){return l?l(o):Tf(o)}(i,h)?Or({wt:t,Re:e,dw:s},i):Or(n(t,e,i,s,r),i)}function Vr(n){return{Candlestick:ne(Nf),Bar:ne(Rf),Area:ne(Ef),Baseline:ne(zf),Histogram:ne(Br),Line:ne(Br),Custom:ne(Af)}[n]}function Pr(n){return{Re:0,Sw:new Map,Hh:n}}function Dr(n,t){if(n!==void 0&&n.length!==0)return{xw:t.key(n[0].wt),Cw:t.key(n[n.length-1].wt)}}function Ir(n){let t;return n.forEach(e=>{t===void 0&&(t=e.dw)}),K(t)}class Lf{constructor(t){this.yw=new Map,this.kw=new Map,this.Pw=new Map,this.Tw=[],this.i_=t}m(){this.yw.clear(),this.kw.clear(),this.Pw.clear(),this.Tw=[]}Rw(t,e){let i=this.yw.size!==0,s=!1;const r=this.kw.get(t);if(r!==void 0)if(this.kw.size===1)i=!1,s=!0,this.yw.clear();else for(const l of this.Tw)l.pointData.Sw.delete(t)&&(s=!0);let h=[];if(e.length!==0){const l=e.map(g=>g.time),a=this.i_.createConverterToInternalObj(e),u=Vr(t.Rr()),f=t.da(),p=t.pa();h=e.map((g,v)=>{const b=a(g.time),M=this.i_.key(b);let S=this.yw.get(M);S===void 0&&(S=Pr(b),this.yw.set(M,S),s=!0);const R=u(b,S.Re,g,l[v],f,p);return S.Sw.set(t,R),R})}i&&this.Dw(),this.Vw(t,h);let o=-1;if(s){const l=[];this.yw.forEach(a=>{l.push({timeWeight:0,time:a.Hh,pointData:a,originalTime:Ir(a.Sw)})}),l.sort((a,u)=>this.i_.key(a.time)-this.i_.key(u.time)),o=this.Iw(l)}return this.Bw(t,o,function(l,a,u){const f=Dr(l,u),p=Dr(a,u);if(f!==void 0&&p!==void 0)return{Aw:!1,zh:f.Cw>=p.Cw&&f.xw>=p.xw}}(this.kw.get(t),r,this.i_))}yc(t){return this.Rw(t,[])}Ew(t,e,i){const s=e;(function(M){M.dw===void 0&&(M.dw=M.time)})(s),this.i_.preprocessData(e);const r=this.i_.createConverterToInternalObj([e])(e.time),h=this.Pw.get(t);if(!i&&h!==void 0&&this.i_.key(r)<this.i_.key(h))throw new Error(`Cannot update oldest data, last time=${h}, new time=${r}`);let o=this.yw.get(this.i_.key(r));if(i&&o===void 0)throw new Error("Cannot update non-existing data point when historicalUpdate is true");const l=o===void 0;o===void 0&&(o=Pr(r),this.yw.set(this.i_.key(r),o));const a=Vr(t.Rr()),u=t.da(),f=t.pa(),p=a(r,o.Re,e,s.dw,u,f);o.Sw.set(t,p),i?this.zw(t,p,o.Re):this.Lw(t,p);const g={zh:pi(p),Aw:i};if(!l)return this.Bw(t,-1,g);const v={timeWeight:0,time:o.Hh,pointData:o,originalTime:Ir(o.Sw)},b=ti(this.Tw,this.i_.key(v.time),(M,S)=>this.i_.key(M.time)<S);this.Tw.splice(b,0,v);for(let M=b;M<this.Tw.length;++M)sn(this.Tw[M].pointData,M);return this.i_.fillWeightsForPoints(this.Tw,b),this.Bw(t,b,g)}Lw(t,e){let i=this.kw.get(t);i===void 0&&(i=[],this.kw.set(t,i));const s=i.length!==0?i[i.length-1]:null;s===null||this.i_.key(e.wt)>this.i_.key(s.wt)?pi(e)&&i.push(e):pi(e)?i[i.length-1]=e:i.splice(-1,1),this.Pw.set(t,e.wt)}zw(t,e,i){const s=this.kw.get(t);if(s===void 0)return;const r=ti(s,i,(h,o)=>h.Re<o);pi(e)?s[r]=e:s.splice(r,1)}Vw(t,e){e.length!==0?(this.kw.set(t,e.filter(pi)),this.Pw.set(t,e[e.length-1].wt)):(this.kw.delete(t),this.Pw.delete(t))}Dw(){for(const t of this.Tw)t.pointData.Sw.size===0&&this.yw.delete(this.i_.key(t.time))}Iw(t){let e=-1;for(let i=0;i<this.Tw.length&&i<t.length;++i){const s=this.Tw[i],r=t[i];if(this.i_.key(s.time)!==this.i_.key(r.time)){e=i;break}r.timeWeight=s.timeWeight,sn(r.pointData,i)}if(e===-1&&this.Tw.length!==t.length&&(e=Math.min(this.Tw.length,t.length)),e===-1)return-1;for(let i=e;i<t.length;++i)sn(t[i].pointData,i);return this.i_.fillWeightsForPoints(t,e),this.Tw=t,e}Ow(){if(this.kw.size===0)return null;let t=0;return this.kw.forEach(e=>{e.length!==0&&(t=Math.max(t,e[e.length-1].Re))}),t}Bw(t,e,i){const s={Do:new Map,At:{iu:this.Ow()}};if(e!==-1)this.kw.forEach((r,h)=>{s.Do.set(h,{se:r,Nw:h===t?i:void 0})}),this.kw.has(t)||s.Do.set(t,{se:[],Nw:i}),s.At.Ww=this.Tw,s.At.Fw=e;else{const r=this.kw.get(t);s.Do.set(t,{se:r||[],Nw:i})}return s}}function sn(n,t){n.Re=t,n.Sw.forEach(e=>{e.Re=t})}function Bf(n,t){return n.wt<t}function Of(n,t){return t<n.wt}function Co(n,t,e){const i=t.Uh(),s=t.bi(),r=ti(n,i,Bf),h=wo(n,s,Of);if(!e)return{from:r,to:h};let o=r,l=h;return r>0&&r<n.length&&n[r].wt>=i&&(o=r-1),h>0&&h<n.length&&n[h-1].wt<=s&&(l=h+1),{from:o,to:l}}class Yn{constructor(t,e,i){this.Hw=!0,this.Uw=!0,this.$w=!0,this.qw=[],this.Yw=null,this.Jn=t,this.Qn=e,this.jw=i}kt(t){this.Hw=!0,t==="data"&&(this.Uw=!0),t==="options"&&(this.$w=!0)}Tt(){return this.Jn.Vt()?(this.Kw(),this.Yw===null?null:this.Xw):null}Zw(){this.qw=this.qw.map(t=>({...t,...this.Jn.Rh().Dr(t.wt)}))}Gw(){this.Yw=null}Kw(){this.Uw&&(this.Jw(),this.Uw=!1),this.$w&&(this.Zw(),this.$w=!1),this.Hw&&(this.Qw(),this.Hw=!1)}Qw(){const t=this.Jn.Wt(),e=this.Qn.At();if(this.Gw(),e.Ki()||t.Ki())return;const i=e.ye();if(i===null||this.Jn.Xs().zr()===0)return;const s=this.Jn.zt();s!==null&&(this.Yw=Co(this.qw,i,this.jw),this.tg(t,e,s.Ft),this.ig())}}class Vf{constructor(t,e){this.sg=t,this.Yi=e}nt(t,e,i){this.sg.draw(t,this.Yi,e,i)}}class Pf extends Yn{constructor(t,e,i){super(t,e,!1),this.sh=i,this.Xw=new Vf(this.sh.renderer(),s=>{const r=t.zt();return r===null?null:t.Wt().Nt(s,r.Ft)})}fa(t){return this.sh.priceValueBuilder(t)}va(t){return this.sh.isWhitespace(t)}Jw(){const t=this.Jn.Rh();this.qw=this.Jn.Xs().Hr().map(e=>({wt:e.Re,_t:NaN,...t.Dr(e.Re),ng:e.se}))}tg(t,e){e.su(this.qw,zi(this.Yw))}ig(){this.sh.update({bars:this.qw.map(Df),barSpacing:this.Qn.At().lu(),visibleRange:this.Yw},this.Jn.N())}}function Df(n){return{x:n._t,time:n.wt,originalData:n.ng,barColor:n.cr}}const If={color:"#2196f3"},$f=(n,t,e)=>{const i=Ht(e);return new Pf(n,t,i)};function Fn(n){const t={value:n.Ft[3],time:n.dw};return n.bw!==void 0&&(t.customValues=n.bw),t}function $r(n){const t=Fn(n);return n.R!==void 0&&(t.color=n.R),t}function Yf(n){const t=Fn(n);return n.vt!==void 0&&(t.lineColor=n.vt),n.mr!==void 0&&(t.topColor=n.mr),n.wr!==void 0&&(t.bottomColor=n.wr),t}function Ff(n){const t=Fn(n);return n.gr!==void 0&&(t.topLineColor=n.gr),n.Mr!==void 0&&(t.bottomLineColor=n.Mr),n.br!==void 0&&(t.topFillColor1=n.br),n.Sr!==void 0&&(t.topFillColor2=n.Sr),n.Cr!==void 0&&(t.bottomFillColor1=n.Cr),n.yr!==void 0&&(t.bottomFillColor2=n.yr),t}function To(n){const t={open:n.Ft[0],high:n.Ft[1],low:n.Ft[2],close:n.Ft[3],time:n.dw};return n.bw!==void 0&&(t.customValues=n.bw),t}function Wf(n){const t=To(n);return n.R!==void 0&&(t.color=n.R),t}function qf(n){const t=To(n),{R:e,Ht:i,vr:s}=n;return e!==void 0&&(t.color=e),i!==void 0&&(t.borderColor=i),s!==void 0&&(t.wickColor=s),t}function wn(n){return{Area:Yf,Line:$r,Baseline:Ff,Histogram:$r,Bar:Wf,Candlestick:qf,Custom:Hf}[n]}function Hf(n){const t=n.dw;return{...n.se,time:t}}const Qf={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},Xf={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},Uf={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:ao,panes:{enableResize:!0,separatorColor:"#E0E3EB",separatorHoverColor:"rgba(178, 181, 189, 0.2)"},attributionLogo:!0,colorSpace:"srgb",colorParsers:[]},nn={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0,ensureEdgeTickMarksVisible:!1},Jf={rightOffset:0,barSpacing:6,minBarSpacing:.5,maxBarSpacing:0,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0,ignoreWhitespaceIndices:!1};function Yr(){return{width:0,height:0,autoSize:!1,layout:Uf,crosshair:Qf,grid:Xf,overlayPriceScales:{...nn},leftPriceScale:{...nn,visible:!1},rightPriceScale:{...nn,visible:!0},timeScale:Jf,localization:{locale:ei?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class ko{constructor(t,e,i){this.Df=t,this.eg=e,this.rg=i??0}applyOptions(t){this.Df.Qt().Qu(this.eg,t,this.rg)}options(){return this.Yi().N()}width(){return As(this.eg)?this.Df.Gm(this.eg):0}setVisibleRange(t){this.setAutoScale(!1),this.Yi().Nl(new Z(t.from,t.to))}getVisibleRange(){const t=this.Yi().Qe();return t===null?null:{from:t.$e(),to:t.qe()}}setAutoScale(t){this.applyOptions({autoScale:t})}Yi(){return w(this.Df.Qt().tc(this.eg,this.rg)).Wt}}class Zf{constructor(t,e,i,s){this.Df=t,this.yt=i,this.hg=e,this.ag=s}getHeight(){return this.yt.$t()}setHeight(t){const e=this.Df.Qt(),i=e.Bc(this.yt);e.hc(i,t)}paneIndex(){return this.Df.Qt().Bc(this.yt)}moveTo(t){const e=this.paneIndex();e!==t&&(U(t>=0&&t<this.Df.If().length,"Invalid pane index"),this.Df.Qt().ac(e,t))}getSeries(){return this.yt.Do().map(t=>this.hg(t))??[]}getHTMLElement(){return this.Df.If()[this.paneIndex()].Of()}attachPrimitive(t){this.yt.ua(t),t.attached&&t.attached({chart:this.ag,requestUpdate:()=>this.yt.Qt().Bh()})}detachPrimitive(t){this.yt.ca(t)}priceScale(t){if(this.yt.Co(t)===null)throw new Error(`Cannot find price scale with id: ${t}`);return new ko(this.Df,t,this.paneIndex())}}const jf={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class Fr{constructor(t){this.ir=t}applyOptions(t){this.ir.hr(t)}options(){return this.ir.N()}lg(){return this.ir}}class Gf{constructor(t,e,i,s,r,h){this.og=new V,this.Jn=t,this._g=e,this.ug=i,this.i_=r,this.ag=s,this.cg=h}m(){this.og.m()}priceFormatter(){return this.Jn.ra()}priceToCoordinate(t){const e=this.Jn.zt();return e===null?null:this.Jn.Wt().Nt(t,e.Ft)}coordinateToPrice(t){const e=this.Jn.zt();return e===null?null:this.Jn.Wt().Ts(t,e.Ft)}barsInLogicalRange(t){if(t===null)return null;const e=new Ie(new De(t.from,t.to)).w_(),i=this.Jn.Xs();if(i.Ki())return null;const s=i.Wr(e.Uh(),1),r=i.Wr(e.bi(),-1),h=w(i.Lr()),o=w(i.Ks());if(s!==null&&r!==null&&s.Re>r.Re)return{barsBefore:t.from-h,barsAfter:o-t.to};const l={barsBefore:s===null||s.Re===h?t.from-h:s.Re-h,barsAfter:r===null||r.Re===o?o-t.to:o-r.Re};return s!==null&&r!==null&&(l.from=s.dw,l.to=r.dw),l}setData(t){this.i_,this.Jn.Rr(),this._g.dg(this.Jn,t),this.fg("full")}update(t,e=!1){this.Jn.Rr(),this._g.pg(this.Jn,t,e),this.fg("update")}dataByIndex(t,e){const i=this.Jn.Xs().Wr(t,e);return i===null?null:wn(this.seriesType())(i)}data(){const t=wn(this.seriesType());return this.Jn.Xs().Hr().map(e=>t(e))}subscribeDataChanged(t){this.og.i(t)}unsubscribeDataChanged(t){this.og._(t)}applyOptions(t){this.Jn.hr(t)}options(){return kt(this.Jn.N())}priceScale(){return this.ug.priceScale(this.Jn.Wt().wa(),this.getPane().paneIndex())}createPriceLine(t){const e=st(kt(jf),t),i=this.Jn.Oh(e);return new Fr(i)}removePriceLine(t){this.Jn.Nh(t.lg())}priceLines(){return this.Jn.Wh().map(t=>new Fr(t))}seriesType(){return this.Jn.Rr()}attachPrimitive(t){this.Jn.ua(t),t.attached&&t.attached({chart:this.ag,series:this,requestUpdate:()=>this.Jn.Qt().Bh(),horzScaleBehavior:this.i_})}detachPrimitive(t){this.Jn.ca(t),t.detached&&t.detached(),this.Jn.Qt().Bh()}getPane(){const t=this.Jn,e=w(this.Jn.Qt().Hn(t));return this.cg(e)}moveToPane(t){this.Jn.Qt().Rc(this.Jn,t)}seriesOrder(){const t=this.Jn.Qt().Hn(this.Jn);return t===null?-1:t.Do().indexOf(this.Jn)}setSeriesOrder(t){const e=this.Jn.Qt().Hn(this.Jn);e!==null&&e.qo(this.Jn,t)}fg(t){this.og.v()&&this.og.p(t)}}class Kf{constructor(t,e,i){this.vg=new V,this.T_=new V,this.rm=new V,this.ts=t,this.uh=t.At(),this.Om=e,this.uh.Su().i(this.mg.bind(this)),this.uh.xu().i(this.wg.bind(this)),this.Om.dm().i(this.gg.bind(this)),this.i_=i}m(){this.uh.Su().u(this),this.uh.xu().u(this),this.Om.dm().u(this),this.vg.m(),this.T_.m(),this.rm.m()}scrollPosition(){return this.uh._u()}scrollToPosition(t,e){e?this.uh.gu(t,1e3):this.ts.fn(t)}scrollToRealTime(){this.uh.wu()}getVisibleRange(){const t=this.uh.K_();return t===null?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){const e={from:this.i_.convertHorzItemToInternal(t.from),to:this.i_.convertHorzItemToInternal(t.to)},i=this.uh.J_(e);this.ts.Pc(i)}getVisibleLogicalRange(){const t=this.uh.j_();return t===null?null:{from:t.Uh(),to:t.bi()}}setVisibleLogicalRange(t){U(t.from<=t.to,"The from index cannot be after the to index."),this.ts.Pc(t)}resetTimeScale(){this.ts.cn()}fitContent(){this.ts.ku()}logicalToCoordinate(t){const e=this.ts.At();return e.Ki()?null:e.qt(t)}coordinateToLogical(t){return this.uh.Ki()?null:this.uh.nu(t)}timeToIndex(t,e){const i=this.i_.convertHorzItemToInternal(t);return this.uh.U_(i,e)}timeToCoordinate(t){const e=this.timeToIndex(t,!1);return e===null?null:this.uh.qt(e)}coordinateToTime(t){const e=this.ts.At(),i=e.nu(t),s=e.ss(i);return s===null?null:s.originalTime}width(){return this.Om.Nf().width}height(){return this.Om.Nf().height}subscribeVisibleTimeRangeChange(t){this.vg.i(t)}unsubscribeVisibleTimeRangeChange(t){this.vg._(t)}subscribeVisibleLogicalRangeChange(t){this.T_.i(t)}unsubscribeVisibleLogicalRangeChange(t){this.T_._(t)}subscribeSizeChange(t){this.rm.i(t)}unsubscribeSizeChange(t){this.rm._(t)}applyOptions(t){this.uh.hr(t)}options(){return{...kt(this.uh.N()),barSpacing:this.uh.lu()}}mg(){this.vg.v()&&this.vg.p(this.getVisibleRange())}wg(){this.T_.v()&&this.T_.p(this.getVisibleLogicalRange())}gg(t){this.rm.p(t.width,t.height)}}function tp(n){if(n===void 0||n.type==="custom")return;const t=n;t.minMove!==void 0&&t.precision===void 0&&(t.precision=function(e){if(e>=1)return 0;let i=0;for(;i<8;i++){const s=Math.round(e);if(Math.abs(s-e)<1e-8)return i;e*=10}return i}(t.minMove))}function Wr(n){return function(t){if(os(t.handleScale)){const i=t.handleScale;t.handleScale={axisDoubleClickReset:{time:i,price:i},axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(t.handleScale!==void 0){const{axisPressedMouseMove:i,axisDoubleClickReset:s}=t.handleScale;os(i)&&(t.handleScale.axisPressedMouseMove={time:i,price:i}),os(s)&&(t.handleScale.axisDoubleClickReset={time:s,price:s})}const e=t.handleScroll;os(e)&&(t.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e})}(n),n}class ep{constructor(t,e,i){this.Mg=new Map,this.bg=new Map,this.Sg=new V,this.xg=new V,this.Cg=new V,this.zu=new WeakMap,this.yg=new Lf(e);const s=i===void 0?kt(Yr()):st(kt(Yr()),Wr(i));this.kg=e,this.Df=new Cf(t,s,e),this.Df.Lv().i(h=>{this.Sg.v()&&this.Sg.p(this.Pg(h()))},this),this.Df.Ov().i(h=>{this.xg.v()&&this.xg.p(this.Pg(h()))},this),this.Df.nc().i(h=>{this.Cg.v()&&this.Cg.p(this.Pg(h()))},this);const r=this.Df.Qt();this.Tg=new Kf(r,this.Df.Um(),this.kg)}remove(){this.Df.Lv().u(this),this.Df.Ov().u(this),this.Df.nc().u(this),this.Tg.m(),this.Df.m(),this.Mg.clear(),this.bg.clear(),this.Sg.m(),this.xg.m(),this.Cg.m(),this.yg.m()}resize(t,e,i){this.autoSizeActive()||this.Df.Wm(t,e,i)}addCustomSeries(t,e={},i=0){const s=(r=>({type:"Custom",isBuiltIn:!1,defaultOptions:{...If,...r.defaultOptions()},Rg:$f,Dg:r}))(Ht(t));return this.Vg(s,e,i)}addSeries(t,e={},i=0){return this.Vg(t,e,i)}removeSeries(t){const e=K(this.Mg.get(t)),i=this.yg.yc(e);this.Df.Qt().yc(e),this.Ig(i),this.Mg.delete(t),this.bg.delete(e)}dg(t,e){this.Ig(this.yg.Rw(t,e))}pg(t,e,i){this.Ig(this.yg.Ew(t,e,i))}subscribeClick(t){this.Sg.i(t)}unsubscribeClick(t){this.Sg._(t)}subscribeCrosshairMove(t){this.Cg.i(t)}unsubscribeCrosshairMove(t){this.Cg._(t)}subscribeDblClick(t){this.xg.i(t)}unsubscribeDblClick(t){this.xg._(t)}priceScale(t,e=0){return new ko(this.Df,t,e)}timeScale(){return this.Tg}applyOptions(t){this.Df.hr(Wr(t))}options(){return this.Df.N()}takeScreenshot(){return this.Df.Xm()}removePane(t){this.Df.Qt().rc(t)}swapPanes(t,e){this.Df.Qt().ac(t,e)}autoSizeActive(){return this.Df.tw()}chartElement(){return this.Df.Uf()}panes(){return this.Df.Qt().$s().map(t=>this.Bg(t))}paneSize(t=0){const e=this.Df.nw(t);return{height:e.height,width:e.width}}setCrosshairPosition(t,e,i){const s=this.Mg.get(i);if(s===void 0)return;const r=this.Df.Qt().Hn(s);r!==null&&this.Df.Qt().gc(t,e,r)}clearCrosshairPosition(){this.Df.Qt().Mc(!0)}horzBehaviour(){return this.kg}Vg(t,e={},i=0){U(t.Rg!==void 0),tp(e.priceFormat),t.type==="Candlestick"&&function(l){l.borderColor!==void 0&&(l.borderUpColor=l.borderColor,l.borderDownColor=l.borderColor),l.wickColor!==void 0&&(l.wickUpColor=l.wickColor,l.wickDownColor=l.wickColor)}(e);const s=st(kt(oo),kt(t.defaultOptions),e),r=t.Rg,h=new Bs(this.Df.Qt(),t.type,s,r,t.Dg);this.Df.Qt().xc(h,i);const o=new Gf(h,this,this,this,this.kg,l=>this.Bg(l));return this.Mg.set(o,h),this.bg.set(h,o),o}Ig(t){const e=this.Df.Qt();e.bc(t.At.iu,t.At.Ww,t.At.Fw),t.Do.forEach((i,s)=>s.ht(i.se,i.Nw)),e.At().O_(),e.au()}Ag(t){return K(this.bg.get(t))}Pg(t){const e=new Map;t.ww.forEach((s,r)=>{const h=r.Rr(),o=wn(h)(s);if(h!=="Custom")U(kf(o));else{const l=r.pa();U(!l||l(o)===!1)}e.set(this.Ag(r),o)});const i=t.mw!==void 0&&this.bg.has(t.mw)?this.Ag(t.mw):void 0;return{time:t.dw,logical:t.Re,point:t.fw,paneIndex:t.pw,hoveredSeries:i,hoveredObjectId:t.gw,seriesData:e,sourceEvent:t.Mw}}Bg(t){let e=this.zu.get(t);return e||(e=new Zf(this.Df,i=>this.Ag(i),t,this),this.zu.set(t,e)),e}}function ip(n){if(rs(n)){const t=document.getElementById(n);return U(t!==null,`Cannot find element in DOM with id=${n}`),t}return n}function sp(n,t,e){const i=ip(n),s=new ep(i,t,e);return t.setOptions(s.options()),s}function Eo(n,t){return sp(n,new Tr,Tr.Xc(t))}class zo extends Yn{constructor(t,e){super(t,e,!0)}tg(t,e,i){e.su(this.qw,zi(this.Yw)),t.Hl(this.qw,i,zi(this.Yw))}Eg(t,e){return{wt:t,gt:e,_t:NaN,ut:NaN}}Jw(){const t=this.Jn.Rh();this.qw=this.Jn.Xs().Hr().map(e=>{const i=e.Ft[3];return this.zg(e.Re,i,t)})}}function Ro(n,t,e,i,s,r,h){if(t.length===0||i.from>=t.length||i.to<=0)return;const{context:o,horizontalPixelRatio:l,verticalPixelRatio:a}=n,u=t[i.from];let f=r(n,u),p=u;if(i.to-i.from<2){const g=s/2;o.beginPath();const v={_t:u._t-g,ut:u.ut},b={_t:u._t+g,ut:u.ut};o.moveTo(v._t*l,v.ut*a),o.lineTo(b._t*l,b.ut*a),h(n,f,v,b)}else{const g=(b,M)=>{h(n,f,p,M),o.beginPath(),f=b,p=M};let v=p;o.beginPath(),o.moveTo(u._t*l,u.ut*a);for(let b=i.from+1;b<i.to;++b){v=t[b];const M=r(n,v);switch(e){case 0:o.lineTo(v._t*l,v.ut*a);break;case 1:o.lineTo(v._t*l,t[b-1].ut*a),M!==f&&(g(M,v),o.lineTo(v._t*l,t[b-1].ut*a)),o.lineTo(v._t*l,v.ut*a);break;case 2:{const[S,R]=np(t,b-1,b);o.bezierCurveTo(S._t*l,S.ut*a,R._t*l,R.ut*a,v._t*l,v.ut*a);break}}e!==1&&M!==f&&(g(M,v),o.moveTo(v._t*l,v.ut*a))}(p!==v||p===v&&e===1)&&h(n,f,p,v)}}const qr=6;function rn(n,t){return{_t:n._t-t._t,ut:n.ut-t.ut}}function Hr(n,t){return{_t:n._t/t,ut:n.ut/t}}function np(n,t,e){const i=Math.max(0,t-1),s=Math.min(n.length-1,e+1);var r,h;return[(r=n[t],h=Hr(rn(n[e],n[i]),qr),{_t:r._t+h._t,ut:r.ut+h.ut}),rn(n[e],Hr(rn(n[s],n[t]),qr))]}function rp(n,t){const e=n.context;e.strokeStyle=t,e.stroke()}class hp extends se{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et(t){if(this.rt===null)return;const{ot:e,lt:i,Lg:s,Og:r,ct:h,Xt:o,Ng:l}=this.rt;if(i===null)return;const a=t.context;a.lineCap="butt",a.lineWidth=h*t.verticalPixelRatio,Re(a,o),a.lineJoin="round";const u=this.Wg.bind(this);r!==void 0&&Ro(t,e,r,i,s,u,rp),l&&function(f,p,g,v,b){if(v.to-v.from<=0)return;const{horizontalPixelRatio:M,verticalPixelRatio:S,context:R}=f;let B=null;const O=Math.max(1,Math.floor(M))%2/2,et=g*S+O;for(let lt=v.to-1;lt>=v.from;--lt){const nt=p[lt];if(nt){const Mt=b(f,nt);Mt!==B&&(R.beginPath(),B!==null&&R.fill(),R.fillStyle=Mt,B=Mt);const Rt=Math.round(nt._t*M)+O,ui=nt.ut*S;R.moveTo(Rt,ui),R.arc(Rt,ui,et,0,2*Math.PI)}}R.fill()}(t,e,l,i,u)}}class No extends hp{Wg(t,e){return e.vt}}class op extends zo{constructor(){super(...arguments),this.Xw=new No}zg(t,e,i){return{...this.Eg(t,e),...i.Dr(t)}}ig(){const t=this.Jn.N(),e={ot:this.qw,Xt:t.lineStyle,Og:t.lineVisible?t.lineType:void 0,ct:t.lineWidth,Ng:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0,lt:this.Yw,Lg:this.Qn.At().lu()};this.Xw.ht(e)}}const bn={type:"Line",isBuiltIn:!0,defaultOptions:{color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Rg:(n,t)=>new op(n,t)};function lp(n,t,e,i,s){const{context:r,horizontalPixelRatio:h,verticalPixelRatio:o}=t;r.lineTo(s._t*h,n*o),r.lineTo(i._t*h,n*o),r.closePath(),r.fillStyle=e,r.fill()}class ap extends se{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et(t){if(this.rt===null)return;const{ot:e,lt:i,Lg:s,ct:r,Xt:h,Og:o}=this.rt,l=this.rt.jg??(this.rt.Kg?0:t.mediaSize.height);if(i===null)return;const a=t.context;a.lineCap="butt",a.lineJoin="round",a.lineWidth=r,Re(a,h),a.lineWidth=1,Ro(t,e,o,i,s,this.Xg.bind(this),lp.bind(null,l))}}class cp{Zg(t,e){const i=this.Gg,{Jg:s,Qg:r,tM:h,iM:o,jg:l,sM:a,nM:u}=e;if(this.eM===void 0||i===void 0||i.Jg!==s||i.Qg!==r||i.tM!==h||i.iM!==o||i.jg!==l||i.sM!==a||i.nM!==u){const{verticalPixelRatio:f}=t,p=l||a>0?f:1,g=a*p,v=u===t.bitmapSize.height?u:u*p,b=(l??0)*p,M=t.context.createLinearGradient(0,g,0,v);if(M.addColorStop(0,s),l!=null){const S=Pe((b-g)/(v-g),0,1);M.addColorStop(S,r),M.addColorStop(S,h)}M.addColorStop(1,o),this.eM=M,this.Gg=e}return this.eM}}class up extends ap{constructor(){super(...arguments),this.rM=new cp}Xg(t,e){var i;return this.rM.Zg(t,{Jg:e.mr,Qg:"",tM:"",iM:e.wr,sM:((i=this.rt)==null?void 0:i.sM)??0,nM:t.bitmapSize.height})}}class dp extends zo{constructor(t,e){super(t,e),this.Xw=new co,this.oM=new up,this._M=new No,this.Xw.st([this.oM,this._M])}zg(t,e,i){return{...this.Eg(t,e),...i.Dr(t)}}ig(){const t=this.Jn.N();if(this.Yw===null||this.qw.length===0)return;let e;if(t.relativeGradient){e=this.qw[this.Yw.from].ut;for(let i=this.Yw.from;i<this.Yw.to;i++){const s=this.qw[i];s.ut<e&&(e=s.ut)}}this.oM.ht({Og:t.lineType,ot:this.qw,Xt:t.lineStyle,ct:t.lineWidth,jg:null,sM:e,Kg:t.invertFilledArea,lt:this.Yw,Lg:this.Qn.At().lu()}),this._M.ht({Og:t.lineVisible?t.lineType:void 0,ot:this.qw,Xt:t.lineStyle,ct:t.lineWidth,lt:this.Yw,Lg:this.Qn.At().lu(),Ng:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0})}}const fp={type:"Area",isBuiltIn:!0,defaultOptions:{topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,relativeGradient:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Rg:(n,t)=>new dp(n,t)};class pp extends Yn{constructor(t,e){super(t,e,!1)}tg(t,e,i){e.su(this.qw,zi(this.Yw)),t.$l(this.qw,i,zi(this.Yw))}vM(t,e,i){return{wt:t,qh:e.Ft[0],Yh:e.Ft[1],jh:e.Ft[2],Kh:e.Ft[3],_t:NaN,ql:NaN,Yl:NaN,jl:NaN,Kl:NaN}}Jw(){const t=this.Jn.Rh();this.qw=this.Jn.Xs().Hr().map(e=>this.zg(e.Re,e,t))}}class mp extends se{constructor(){super(...arguments),this.Yt=null,this.uM=0}ht(t){this.Yt=t}et(t){if(this.Yt===null||this.Yt.Xs.length===0||this.Yt.lt===null)return;const{horizontalPixelRatio:e}=t;this.uM=function(r,h){if(r>=2.5&&r<=4)return Math.floor(3*h);const o=1-.2*Math.atan(Math.max(4,r)-4)/(.5*Math.PI),l=Math.floor(r*o*h),a=Math.floor(r*h),u=Math.min(l,a);return Math.max(Math.floor(h),u)}(this.Yt.lu,e),this.uM>=2&&Math.floor(e)%2!=this.uM%2&&this.uM--;const i=this.Yt.Xs;this.Yt.mM&&this.wM(t,i,this.Yt.lt),this.Yt.Mi&&this.Qp(t,i,this.Yt.lt);const s=this.gM(e);(!this.Yt.Mi||this.uM>2*s)&&this.MM(t,i,this.Yt.lt)}wM(t,e,i){if(this.Yt===null)return;const{context:s,horizontalPixelRatio:r,verticalPixelRatio:h}=t;let o="",l=Math.min(Math.floor(r),Math.floor(this.Yt.lu*r));l=Math.max(Math.floor(r),Math.min(l,this.uM));const a=Math.floor(.5*l);let u=null;for(let f=i.from;f<i.to;f++){const p=e[f];p.pr!==o&&(s.fillStyle=p.pr,o=p.pr);const g=Math.round(Math.min(p.ql,p.Kl)*h),v=Math.round(Math.max(p.ql,p.Kl)*h),b=Math.round(p.Yl*h),M=Math.round(p.jl*h);let S=Math.round(r*p._t)-a;const R=S+l-1;u!==null&&(S=Math.max(u+1,S),S=Math.min(S,R));const B=R-S+1;s.fillRect(S,b,B,g-b),s.fillRect(S,v+1,B,M-v),u=R}}gM(t){let e=Math.floor(1*t);this.uM<=2*e&&(e=Math.floor(.5*(this.uM-1)));const i=Math.max(Math.floor(t),e);return this.uM<=2*i?Math.max(Math.floor(t),Math.floor(1*t)):i}Qp(t,e,i){if(this.Yt===null)return;const{context:s,horizontalPixelRatio:r,verticalPixelRatio:h}=t;let o="";const l=this.gM(r);let a=null;for(let u=i.from;u<i.to;u++){const f=e[u];f.dr!==o&&(s.fillStyle=f.dr,o=f.dr);let p=Math.round(f._t*r)-Math.floor(.5*this.uM);const g=p+this.uM-1,v=Math.round(Math.min(f.ql,f.Kl)*h),b=Math.round(Math.max(f.ql,f.Kl)*h);if(a!==null&&(p=Math.max(a+1,p),p=Math.min(p,g)),this.Yt.lu*r>2*l)md(s,p,v,g-p+1,b-v+1,l);else{const M=g-p+1;s.fillRect(p,v,M,b-v+1)}a=g}}MM(t,e,i){if(this.Yt===null)return;const{context:s,horizontalPixelRatio:r,verticalPixelRatio:h}=t;let o="";const l=this.gM(r);for(let a=i.from;a<i.to;a++){const u=e[a];let f=Math.round(Math.min(u.ql,u.Kl)*h),p=Math.round(Math.max(u.ql,u.Kl)*h),g=Math.round(u._t*r)-Math.floor(.5*this.uM),v=g+this.uM-1;if(u.cr!==o){const b=u.cr;s.fillStyle=b,o=b}this.Yt.Mi&&(g+=l,f+=l,v-=l,p-=l),f>p||s.fillRect(g,f,v-g+1,p-f+1)}}}class gp extends pp{constructor(){super(...arguments),this.Xw=new mp}zg(t,e,i){return{...this.vM(t,e,i),...i.Dr(t)}}ig(){const t=this.Jn.N();this.Xw.ht({Xs:this.qw,lu:this.Qn.At().lu(),mM:t.wickVisible,Mi:t.borderVisible,lt:this.Yw})}}const vp={type:"Candlestick",isBuiltIn:!0,defaultOptions:{upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Rg:(n,t)=>new gp(n,t)};class wp{constructor(t,e){this.Jn=t,this.ah=e,this.kM()}detach(){this.Jn.detachPrimitive(this.ah)}getSeries(){return this.Jn}applyOptions(t){this.ah&&this.ah.hr&&this.ah.hr(t)}kM(){this.Jn.attachPrimitive(this.ah)}}const bp={zOrder:"normal"};function Ci(n,t){return Pn(Math.min(Math.max(n,12),30)*t)}function ii(n,t){switch(n){case"arrowDown":case"arrowUp":return Ci(t,1);case"circle":return Ci(t,.8);case"square":return Ci(t,.7)}}function Ao(n){return function(t){const e=Math.ceil(t);return e%2!=0?e-1:e}(Ci(n,1))}function Lo(n){return Math.max(Ci(n,.1),3)}function Qr(n,t,e){return t?n:e?Math.ceil(n/2):0}function Xr(n,t,e,i){const s=(ii("arrowUp",i)-1)/2*e.XM,r=(Pn(i/2)-1)/2*e.XM;t.beginPath(),n?(t.moveTo(e._t-s,e.ut),t.lineTo(e._t,e.ut-s),t.lineTo(e._t+s,e.ut),t.lineTo(e._t+r,e.ut),t.lineTo(e._t+r,e.ut+s),t.lineTo(e._t-r,e.ut+s),t.lineTo(e._t-r,e.ut)):(t.moveTo(e._t-s,e.ut),t.lineTo(e._t,e.ut+s),t.lineTo(e._t+s,e.ut),t.lineTo(e._t+r,e.ut),t.lineTo(e._t+r,e.ut-s),t.lineTo(e._t-r,e.ut-s),t.lineTo(e._t-r,e.ut)),t.fill()}function Ur(n,t,e,i,s,r){const h=(ii("arrowUp",i)-1)/2,o=(Pn(i/2)-1)/2;return s>=t-o-2&&s<=t+o+2&&r>=(n?e:e-h)-2&&r<=(n?e+h:e)+2?!0:(()=>{if(s<t-h-3||s>t+h+3||r<(n?e-h-3:e)||r>(n?e:e+h+3))return!1;const l=Math.abs(s-t);return Math.abs(r-e)+3>=l/2})()}class yp{constructor(){this.Yt=null,this.On=new Ni,this.W=-1,this.F="",this.Rp="",this.ZM="normal"}ht(t){this.Yt=t}Nn(t,e,i){this.W===t&&this.F===e||(this.W=t,this.F=e,this.Rp=Ri(t,e),this.On.In()),this.ZM=i}jn(t,e){if(this.Yt===null||this.Yt.lt===null)return null;for(let i=this.Yt.lt.from;i<this.Yt.lt.to;i++){const s=this.Yt.ot[i];if(s&&Mp(s,t,e))return{zOrder:"normal",externalId:s.Kn??""}}return null}draw(t){this.ZM!=="aboveSeries"&&t.useBitmapCoordinateSpace(e=>{this.et(e)})}drawBackground(t){this.ZM==="aboveSeries"&&t.useBitmapCoordinateSpace(e=>{this.et(e)})}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.Yt!==null&&this.Yt.lt!==null){t.textBaseline="middle",t.font=this.Rp;for(let s=this.Yt.lt.from;s<this.Yt.lt.to;s++){const r=this.Yt.ot[s];r.ri!==void 0&&(r.ri.Qi=this.On.Vi(t,r.ri.GM),r.ri.$t=this.W,r.ri._t=r._t-r.ri.Qi/2),_p(r,t,e,i)}}}}function _p(n,t,e,i){t.fillStyle=n.R,n.ri!==void 0&&function(s,r,h,o,l,a){s.save(),s.scale(l,a),s.fillText(r,h,o),s.restore()}(t,n.ri.GM,n.ri._t,n.ri.ut,e,i),function(s,r,h){if(s.zr!==0){switch(s.JM){case"arrowDown":return void Xr(!1,r,h,s.zr);case"arrowUp":return void Xr(!0,r,h,s.zr);case"circle":return void function(o,l,a){const u=(ii("circle",a)-1)/2;o.beginPath(),o.arc(l._t,l.ut,u*l.XM,0,2*Math.PI,!1),o.fill()}(r,h,s.zr);case"square":return void function(o,l,a){const u=ii("square",a),f=(u-1)*l.XM/2,p=l._t-f,g=l.ut-f;o.fillRect(p,g,u*l.XM,u*l.XM)}(r,h,s.zr)}s.JM}}(n,t,function(s,r,h){const o=Math.max(1,Math.floor(r))%2/2;return{_t:Math.round(s._t*r)+o,ut:s.ut*h,XM:r}}(n,e,i))}function Mp(n,t,e){return!(n.ri===void 0||!function(i,s,r,h,o,l){const a=h/2;return o>=i&&o<=i+r&&l>=s-a&&l<=s+a}(n.ri._t,n.ri.ut,n.ri.Qi,n.ri.$t,t,e))||function(i,s,r){if(i.zr===0)return!1;switch(i.JM){case"arrowDown":return Ur(!0,i._t,i.ut,i.zr,s,r);case"arrowUp":return Ur(!1,i._t,i.ut,i.zr,s,r);case"circle":return function(h,o,l,a,u){const f=2+ii("circle",l)/2,p=h-a,g=o-u;return Math.sqrt(p*p+g*g)<=f}(i._t,i.ut,i.zr,s,r);case"square":return function(h,o,l,a,u){const f=ii("square",l),p=(f-1)/2,g=h-p,v=o-p;return a>=g&&a<=g+f&&u>=v&&u<=v+f}(i._t,i.ut,i.zr,s,r)}}(n,t,e)}function Jr(n){return n==="atPriceTop"||n==="atPriceBottom"||n==="atPriceMiddle"}function xp(n,t,e,i,s,r,h,o){const l=function(v,b){if(Jr(b.position)&&b.price!==void 0)return b.price;if("value"in(M=v)&&typeof M.value=="number")return v.value;var M;if(function(S){return"open"in S&&"high"in S&&"low"in S&&"close"in S}(v)){if(b.position==="inBar")return v.close;if(b.position==="aboveBar")return v.high;if(b.position==="belowBar")return v.low}}(e,t);if(l===void 0)return;const a=Jr(t.position),u=o.timeScale(),f=Ne(t.size)?Math.max(t.size,0):1,p=Ao(u.options().barSpacing)*f,g=p/2;switch(n.zr=p,t.position){case"inBar":case"atPriceMiddle":return n.ut=w(h.priceToCoordinate(l)),void(n.ri!==void 0&&(n.ri.ut=n.ut+g+r+.6*s));case"aboveBar":case"atPriceTop":{const v=a?0:i.QM;return n.ut=w(h.priceToCoordinate(l))-g-v,n.ri!==void 0&&(n.ri.ut=n.ut-g-.6*s,i.QM+=1.2*s),void(a||(i.QM+=p+r))}case"belowBar":case"atPriceBottom":{const v=a?0:i.tb;return n.ut=w(h.priceToCoordinate(l))+g+v,n.ri!==void 0&&(n.ri.ut=n.ut+g+r+.6*s,i.tb+=1.2*s),void(a||(i.tb+=p+r))}}}class Sp{constructor(t,e,i){this.ib=[],this.xt=!0,this.sb=!0,this.Gt=new yp,this.ge=t,this.gp=e,this.Yt={ot:[],lt:null},this.ys=i}renderer(){if(!this.ge.options().visible)return null;this.xt&&this.nb();const t=this.gp.options().layout;return this.Gt.Nn(t.fontSize,t.fontFamily,this.ys.zOrder),this.Gt.ht(this.Yt),this.Gt}eb(t){this.ib=t,this.kt("data")}kt(t){this.xt=!0,t==="data"&&(this.sb=!0)}rb(t){this.xt=!0,this.ys=t}zOrder(){return this.ys.zOrder==="aboveSeries"?"top":this.ys.zOrder}nb(){const t=this.gp.timeScale(),e=this.ib;this.sb&&(this.Yt.ot=e.map(a=>({wt:a.time,_t:0,ut:0,zr:0,JM:a.shape,R:a.color,Kn:a.id,hb:a.hb,ri:void 0})),this.sb=!1);const i=this.gp.options().layout;this.Yt.lt=null;const s=t.getVisibleLogicalRange();if(s===null)return;const r=new De(Math.floor(s.from),Math.ceil(s.to));if(this.ge.data()[0]===null||this.Yt.ot.length===0)return;let h=NaN;const o=Lo(t.options().barSpacing),l={QM:o,tb:o};this.Yt.lt=Co(this.Yt.ot,r,!0);for(let a=this.Yt.lt.from;a<this.Yt.lt.to;a++){const u=e[a];u.time!==h&&(l.QM=o,l.tb=o,h=u.time);const f=this.Yt.ot[a];f._t=w(t.logicalToCoordinate(u.time)),u.text!==void 0&&u.text.length>0&&(f.ri={GM:u.text,_t:0,ut:0,Qi:0,$t:0});const p=this.ge.dataByIndex(u.time,0);p!==null&&xp(f,u,p,l,i.fontSize,o,this.ge,this.gp)}this.xt=!1}}function Zr(n){return{...bp,...n}}class Cp{constructor(t){this.sh=null,this.ib=[],this.ab=[],this.lb=null,this.ge=null,this.gp=null,this.ob=!0,this._b=null,this.ub=null,this.cb=null,this.fb=!0,this.ys=Zr(t)}attached(t){this.pb(),this.gp=t.chart,this.ge=t.series,this.sh=new Sp(this.ge,w(this.gp),this.ys),this.jM=t.requestUpdate,this.ge.subscribeDataChanged(e=>this.fg(e)),this.fb=!0,this.IM()}IM(){this.jM&&this.jM()}detached(){this.ge&&this.lb&&this.ge.unsubscribeDataChanged(this.lb),this.gp=null,this.ge=null,this.sh=null,this.lb=null}eb(t){this.fb=!0,this.ib=t,this.pb(),this.ob=!0,this.ub=null,this.IM()}mb(){return this.ib}paneViews(){return this.sh?[this.sh]:[]}updateAllViews(){this.wb()}hitTest(t,e){var i;return this.sh?((i=this.sh.renderer())==null?void 0:i.jn(t,e))??null:null}autoscaleInfo(t,e){if(this.sh){const i=this.gb();if(i)return{priceRange:null,margins:i}}return null}hr(t){this.ys=Zr({...this.ys,...t}),this.IM&&this.IM()}gb(){const t=w(this.gp).timeScale().options().barSpacing;if(this.ob||t!==this.cb){if(this.cb=t,this.ib.length>0){const e=Lo(t),i=1.5*Ao(t)+2*e,s=this.Mb();this._b={above:Qr(i,s.aboveBar,s.inBar),below:Qr(i,s.belowBar,s.inBar)}}else this._b=null;this.ob=!1}return this._b}Mb(){return this.ub===null&&(this.ub=this.ib.reduce((t,e)=>(t[e.position]||(t[e.position]=!0),t),{inBar:!1,aboveBar:!1,belowBar:!1,atPriceTop:!1,atPriceBottom:!1,atPriceMiddle:!1})),this.ub}pb(){var s;if(!this.fb||!this.gp||!this.ge)return;const t=this.gp.timeScale(),e=(s=this.ge)==null?void 0:s.data();if(t.getVisibleLogicalRange()==null||!this.ge||e.length===0)return void(this.ab=[]);const i=t.timeToIndex(w(e[0].time),!0);this.ab=this.ib.map((r,h)=>{const o=t.timeToIndex(r.time,!0),l=o<i?1:-1,a=w(this.ge).dataByIndex(o,l),u={time:t.timeToIndex(w(a).time,!1),position:r.position,shape:r.shape,color:r.color,id:r.id,hb:h,text:r.text,size:r.size,price:r.price,dw:r.time};if(r.position==="atPriceTop"||r.position==="atPriceBottom"||r.position==="atPriceMiddle"){if(r.price===void 0)throw new Error(`Price is required for position ${r.position}`);return{...u,position:r.position,price:r.price}}return{...u,position:r.position,price:r.price}}),this.fb=!1}wb(t){this.sh&&(this.pb(),this.sh.eb(this.ab),this.sh.rb(this.ys),this.sh.kt(t))}fg(t){this.fb=!0,this.IM()}}class Tp extends wp{constructor(t,e,i){super(t,e),i&&this.setMarkers(i)}setMarkers(t){this.ah.eb(t)}markers(){return this.ah.mb()}}function kp(n,t,e){const i=new Tp(n,new Cp({}));return t&&i.setMarkers(t),i}({...oo});const Ep="_spinner_qk7vc_1",zp="_rotate_qk7vc_1",Rp="_background_qk7vc_35",Np="_path_qk7vc_47",Ap={spinner:Ep,rotate:zp,background:Rp,path:Np},Lp=`<div class="spinner">\r
	<svg viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">\r
		<circle\r
			class="background"\r
			cx="25"\r
			cy="25"\r
			r="20"\r
			fill="none"\r
			stroke-width="4"\r
		/>\r
		<circle\r
			class="path"\r
			cx="25"\r
			cy="25"\r
			r="20"\r
			fill="none"\r
			stroke="currentColor"\r
			stroke-width="4"\r
			stroke-linecap="round"\r
		/>\r
	</svg>\r
</div>\r
`;var Pi;class Wn extends k{constructor(){super(...arguments);m(this,Pi)}render(){return this.element=E.htmlToElement(Lp,[],Ap),y(this,Pi,C(this.element)),this.element}hide(){c(this,Pi).css("display","none")}}Pi=new WeakMap,T(Wn,"componentName","Spinner");function $(n){return getComputedStyle(document.documentElement).getPropertyValue(n).trim()||null}const jr=()=>({autoSize:!0,layout:{background:{type:"solid",color:$("--color-bg-primary")||"#ffffff"},textColor:$("--color-text-primary")||"#292121",fontFamily:"system-ui, sans-serif",attributionLogo:!1},rightPriceScale:{scaleMargins:{top:.1,bottom:.05},borderVisible:!1,entireTextOnly:!0},crosshair:{mode:0,vertLine:{color:$("--color-chart-crosshair-line")||"#a5a5a5",style:3,labelBackgroundColor:$("--color-chart-crosshair-label")||"#2e2e2e"},horzLine:{color:$("--color-chart-crosshair-line")||"#a5a5a5",style:3,labelBackgroundColor:$("--color-chart-crosshair-label")||"#2e2e2e"}},grid:{vertLines:{color:$("--color-chart-grid")||"#edf0ee"},horzLines:{color:$("--color-chart-grid")||"#edf0ee"}},timeScale:{rightOffset:4,barSpacing:6,minBarSpacing:2,borderVisible:!1,rightBarStaysOnScroll:!0,tickMarkFormatter:n=>{const t=new Date(n*1e3),e=t.getUTCDate(),i=t.getUTCMonth(),s=t.getUTCFullYear(),r=t.getUTCHours(),h=t.getUTCMinutes();if(i===0&&e===1&&r===0&&h===0)return String(s);if(e===1&&r===0&&h===0)return t.toLocaleString("ru-RU",{month:"short"}).replace(".","").slice(0,3);if(r===0&&h===0)return String(e);const o=String(r).padStart(2,"0"),l=String(h).padStart(2,"0");return`${o}:${l}`}},localization:{timeFormatter:n=>{const t=new Date(n*1e3),e=t.toLocaleString("ru-RU",{weekday:"short"}).toLowerCase(),i=t.getUTCDate(),s=t.toLocaleString("ru-RU",{month:"short"}).replace(".","").slice(0,3),r=t.toLocaleString("ru-RU",{year:"2-digit"}),h=String(t.getUTCHours()).padStart(2,"0"),o=String(t.getUTCMinutes()).padStart(2,"0");return`${e} ${i} ${s} ${r}  ${h}:${o}`}}}),Bp=()=>({borderVisible:!1,upColor:$("--color-chart-up")||"#008984",downColor:$("--color-chart-down")||"#f23645",wickUpColor:$("--color-chart-up")||"#008984",wickDownColor:$("--color-chart-down")||"#f23645"}),Op=()=>({lastValueVisible:!1,priceLineVisible:!1,color:$("--color-chart-line")||"#3b6cb7",lineWidth:2,crosshairMarkerVisible:!1}),ps=1e3,Gr=50,Bo={lastValueVisible:!1,priceLineVisible:!1,lineWidth:3,crosshairMarkerVisible:!1};class Vp extends Es{async getKlines(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/chart/klines/${t}`,method:"GET",errorMessage:"Не удалось загрузить данные свечей"})}async getIndicators(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/chart/indicators/${t}`,method:"GET",errorMessage:"Не удалось загрузить данные индикаторов"})}async getMarkers(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/chart/markers/${t}`,method:"GET",errorMessage:"Не удалось загрузить маркеры сделок"})}async getAllChartData(t){this._validateRequired({contextId:t},"contextId is required");const[e,i,s]=await Promise.all([this.getKlines(t),this.getIndicators(t),this.getMarkers(t)]);return{klines:e,indicators:i,markers:s}}}const hn=new Vp,Pp="_chart_tu1f1_1",Dp={chart:Pp,"spinner-wrapper":"_spinner-wrapper_tu1f1_25","chart-canvas":"_chart-canvas_tu1f1_47"},Ip=`<div class="chart" data-ref="chart">\r
	<component-spinner></component-spinner>\r
	<component-ruler-tool></component-ruler-tool>\r
	<div class="chart-canvas" data-ref="chartCanvas"></div>\r
	<component-chart-info-panel></component-chart-info-panel>\r
	<component-indicators-info-panel></component-indicators-info-panel>\r
	<component-scroll-to-realtime-button></component-scroll-to-realtime-button>\r
</div>\r
`,$p="_meta_ddszq_21",Yp="_candlestick_ddszq_29",Fp="_red_ddszq_39",Wp="_green_ddszq_47",mi={"chart-info-panel":"_chart-info-panel_ddszq_1",meta:$p,candlestick:Yp,red:Fp,green:Wp},qp=`<div class="chart-info-panel" data-ref="chartInfoPanel">\r
	<div class="meta" data-ref="meta">\r
		<span data-field="symbol"></span> • <span data-field="exchange"></span> •\r
		<span data-field="market"></span> •\r
		<span data-field="interval"></span>\r
	</div>\r
	<div class="candlestick" data-ref="candlestick">\r
		<div>ОТКР <span data-field="open"></span></div>\r
		<div>МАКС <span data-field="high"></span></div>\r
		<div>МИН <span data-field="low"></span></div>\r
		<div>ЗАКР <span data-field="close"></span></div>\r
	</div>\r
</div>\r
`;var Ye,Di,Ii,gt,Vo,Po,Do,Io;class Oo extends k{constructor(){super(...arguments);m(this,gt);m(this,Ye);m(this,Di,new Map);m(this,Ii,new Map)}render(){return d(this,gt,Vo).call(this),d(this,gt,Po).call(this),this.element}update(e,i=!1){e&&(i&&d(this,gt,Do).call(this),d(this,gt,Io).call(this,e))}}Ye=new WeakMap,Di=new WeakMap,Ii=new WeakMap,gt=new WeakSet,Vo=function(){this.element=E.htmlToElement(qp,[],mi),y(this,Ye,C(this.element))},Po=function(){const e=c(this,Ye).find('[data-ref="meta"]').findAll("[data-field]"),i=c(this,Ye).find('[data-ref="candlestick"]').findAll("[data-field]");e.forEach(s=>{const r=s.data("field");c(this,Di).set(r,{element:s})}),i.forEach(s=>{const r=s.data("field");c(this,Ii).set(r,{element:s})})},Do=function(){const e=_.get("context");c(this,Di).forEach(({element:i},s)=>{i.text(e[s])})},Io=function(e){const i=e.close>=e.open,s=i?mi.green:mi.red,r=i?mi.red:mi.green;c(this,Ii).forEach(({element:h},o)=>{const l=h.text(),a=e[o];l!==String(a)&&h.text(a),h.hasClass(s)||h.addClass(s).removeClass(r)})},T(Oo,"componentName","ChartInfoPanel");const Hp={"indicators-info-panel":"_indicators-info-panel_7dp8v_1"},Qp=`<div class="indicators-info-panel"></div>\r
`;var Fe,We,oi,Yo,Fo;class $o extends k{constructor(){super(...arguments);m(this,oi);m(this,Fe);m(this,We,new Map)}render(){return this.element=E.htmlToElement(Qp,[],Hp),y(this,Fe,C(this.element)),this.element}update(e,i=!1){i&&(c(this,We).clear(),d(this,oi,Yo).call(this)),c(this,We).forEach(({element:s},r)=>{const h=e[r];if(!h)return;let{value:o,color:l}=h;l==="transparent"&&(o="∅",l="inherit");const a=s.text(),u=s.css("color");a!==String(o)&&s.text(o),u!==l&&s.css("color",l)})}}Fe=new WeakMap,We=new WeakMap,oi=new WeakSet,Yo=function(){const{indicatorOptions:e}=_.get("context"),i=d(this,oi,Fo).call(this,e);c(this,Fe).html(i),c(this,Fe).findAll("[data-field]").forEach(s=>{const r=s.data("field");c(this,We).set(r,{element:s})})},Fo=function(e){return Object.keys(e).map(i=>`
					<div>
						<span>${i}</span>
						<span data-field="${i}"></span>
					</div>
				`).join("")},T($o,"componentName","IndicatorsInfoPanel");const Xp="_info_156i3_25",Up="_arrow_156i3_95",Jp={"ruler-tool":"_ruler-tool_156i3_1",info:Xp,"price-diff":"_price-diff_156i3_59","line-x":"_line-x_156i3_71","line-y":"_line-y_156i3_73","arrow-right":"_arrow-right_156i3_95","arrow-left":"_arrow-left_156i3_111","arrow-up":"_arrow-up_156i3_157","arrow-down":"_arrow-down_156i3_173",arrow:Up},Zp=`<div\r
	class="ruler-tool"\r
	data-ref="rulerTool"\r
	data-active="false"\r
	data-trend="up"\r
>\r
	<div class="info">\r
		<div class="price-diff">\r
			<span data-field="price-abs"></span>\r
			<span data-field="price-pct"></span>\r
			<span data-field="price-ticks"></span>\r
		</div>\r
		<span data-field="bar-distance"></span>\r
	</div>\r
	<div class="line-x" data-ref="lineX" data-direction="right">\r
		<div class="arrow arrow-right"></div>\r
		<div class="arrow arrow-left"></div>\r
	</div>\r
	<div class="line-y" data-ref="lineY" data-direction="up">\r
		<div class="arrow arrow-up"></div>\r
		<div class="arrow arrow-down"></div>\r
	</div>\r
</div>\r
`;var I,Tt,me,qe,$i,Yi,He,Qe,Q,z,yi,qo,Ho,Qo,Xo,Uo,Jo,yn,Zo,jo,Go,Ko,_n,Mn,xn,Sn;class Wo extends k{constructor(){super(...arguments);m(this,z);m(this,I);m(this,Tt);m(this,me);m(this,qe);m(this,$i,null);m(this,Yi,null);m(this,He,!1);m(this,Qe,new Map);m(this,Q,{chartX:null,chartY:null,localX:null,localY:null})}render(){return d(this,z,qo).call(this),d(this,z,Ho).call(this),this.element}update({logical:e,point:i,sourceEvent:s,candlestickSeries:r}){c(this,He)&&(d(this,z,Go).call(this,{localX:s.localX,localY:s.localY}),d(this,z,Ko).call(this,{chartX:e,chartY:r.coordinateToPrice(i.y)}))}initialize(){c(this,z,yi)||d(this,z,Xo).call(this)}deactivate(){d(this,z,Uo).call(this),c(this,I).data("active","false"),y(this,He,!1)}}I=new WeakMap,Tt=new WeakMap,me=new WeakMap,qe=new WeakMap,$i=new WeakMap,Yi=new WeakMap,He=new WeakMap,Qe=new WeakMap,Q=new WeakMap,z=new WeakSet,yi=function(){return c(this,I).is("data-active")},qo=function(){this.element=E.htmlToElement(Zp,[],Jp),y(this,I,C(this.element)),y(this,Tt,c(this,I).find('[data-ref="lineX"]')),y(this,me,c(this,I).find('[data-ref="lineY"]'))},Ho=function(){y(this,qe,d(this,z,Jo).bind(this)),c(this,I).findAll("[data-field]").forEach(e=>{const i=e.data("field");c(this,Qe).set(i,{element:e})}),_.subscribe("context",d(this,z,yn).bind(this))},Qo=function(){c(this,z,yi)||(c(this,I).data("active","true"),y(this,He,!0))},Xo=function(){const e=_.get("chartApi");e&&e.subscribeClick(c(this,qe))},Uo=function(){const e=_.get("chartApi");e&&e.unsubscribeClick(c(this,qe))},Jo=function({logical:e,point:i,sourceEvent:s}){if(c(this,z,yi)){d(this,z,yn).call(this);return}const r=_.get("candlestickSeries");r&&d(this,z,Zo).call(this,{logical:e,point:i,sourceEvent:s,series:r})},yn=function(){c(this,z,yi)&&_.set("rulerActive",!1)},Zo=function({logical:e,point:i,sourceEvent:s,series:r}){const{minMove:h,precision:o}=_.get("context");y(this,$i,h),y(this,Yi,o),y(this,Q,{chartX:e,chartY:r.coordinateToPrice(i.y),localX:s.localX,localY:s.localY}),d(this,z,jo).call(this),d(this,z,Qo).call(this)},jo=function(){const e={"price-abs":d(this,z,_n).call(this,c(this,Q).chartY),"price-pct":d(this,z,Mn).call(this,c(this,Q).chartY),"price-ticks":d(this,z,xn).call(this,c(this,Q).chartY),"bar-distance":d(this,z,Sn).call(this,c(this,Q).chartX)};c(this,Qe).forEach(({element:i},s)=>{i.text(e[s])}),c(this,I).data("trend","up"),c(this,Tt).data("direction","right"),c(this,me).data("direction","up"),c(this,I).css("left",`${c(this,Q).localX}px`).css("top",`${c(this,Q).localY}px`).css("width","0px").css("height","0px")},Go=function({localX:e,localY:i}){const s=e-c(this,Q).localX,r=c(this,Q).localY-i;s>=0?(c(this,Tt).data("direction")==="left"&&c(this,Tt).data("direction","right"),c(this,I).css("width",`${s}px`)):(c(this,Tt).data("direction")==="right"&&c(this,Tt).data("direction","left"),c(this,I).css("left",`${e}px`).css("width",`${Math.abs(s)}px`)),r>=0?(c(this,I).data("trend")==="down"&&(c(this,I).data("trend","up"),c(this,me).data("direction","up")),c(this,I).css("top",`${i}px`).css("height",`${r}px`)):(c(this,I).data("trend")==="up"&&(c(this,I).data("trend","down"),c(this,me).data("direction","down")),c(this,I).css("height",`${Math.abs(r)}px`))},Ko=function({chartX:e,chartY:i}){const s={"price-abs":d(this,z,_n).call(this,i),"price-pct":d(this,z,Mn).call(this,i),"price-ticks":d(this,z,xn).call(this,i),"bar-distance":d(this,z,Sn).call(this,e)};c(this,Qe).forEach(({element:r},h)=>{r.text(s[h])})},_n=function(e){return(e-c(this,Q).chartY).toFixed(c(this,Yi))},Mn=function(e){return`(${((e/c(this,Q).chartY-1)*100).toFixed(2)}%)`},xn=function(e){return((e-c(this,Q).chartY)/c(this,$i)).toFixed(0)},Sn=function(e){return`Бары: ${(e-c(this,Q).chartX).toFixed(0)}`},T(Wo,"componentName","RulerTool");const jp={"scroll-to-realtime-button":"_scroll-to-realtime-button_z16kg_1"},Gp=`<button class="scroll-to-realtime-button" title="Прокрутить до текущего бара">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 18 18"\r
		width="18"\r
		height="18"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M7.45 3.5 12.48 9l-5.03 5.49 1.1 1.01L14.52 9 8.55 2.49 7.45 3.5Z"\r
		></path>\r
		<path\r
			fill="currentColor"\r
			d="m3.93 5.99 2.58 3-2.58 3.02 1.14.98 3.42-4-3.42-3.98L3.93 6Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Fi,Zt,el,il,sl;class tl extends k{constructor(){super(...arguments);m(this,Zt);m(this,Fi)}render(){return d(this,Zt,el).call(this),d(this,Zt,il).call(this),this.element}}Fi=new WeakMap,Zt=new WeakSet,el=function(){this.element=E.htmlToElement(Gp,[],jp),y(this,Fi,C(this.element))},il=function(){c(this,Fi).on("click",d(this,Zt,sl).bind(this))},sl=function(){const e=_.get("chartApi");e&&e.timeScale().scrollToRealTime()},T(tl,"componentName","ScrollToRealtimeButton");var Xe,X,Ue,Wi,rt,L,dt,x,rl,hl,ol,ll,al,cl,ul,dl,fl,pl,ml,gl,vl,wl,bl,yl,_l,Cn,Tn,Ml,vs,xl,Sl,Cl,Tl,kl,El,zl;class nl extends k{constructor(){super(...arguments);m(this,x);m(this,Xe);m(this,X);m(this,Ue,null);m(this,Wi,!1);m(this,rt,{candlesticks:null,indicators:null,markers:null});m(this,L,{candlestick:null,indicators:new Map,markers:null});m(this,dt,ps)}render(){return d(this,x,rl).call(this),d(this,x,hl).call(this),d(this,x,ol).call(this),this.element}set height(e){c(this,Xe).css("bottom",`${e}px`)}async update(e){await d(this,x,dl).call(this),c(this,Ue)!==e.id&&(y(this,Ue,e.id),d(this,x,gl).call(this),d(this,x,vl).call(this),d(this,x,Ml).call(this)),d(this,x,vs).call(this),d(this,x,Tl).call(this),c(this,Wi)||(y(this,Wi,!0),this.spinner.hide())}}Xe=new WeakMap,X=new WeakMap,Ue=new WeakMap,Wi=new WeakMap,rt=new WeakMap,L=new WeakMap,dt=new WeakMap,x=new WeakSet,rl=function(){this.spinner=new Wn,this.rulerTool=new Wo,this.chartInfoPanel=new Oo,this.indicatorsInfoPanel=new $o,this.scrollToRealtimeButton=new tl},hl=function(){this.element=E.htmlToElement(Ip,[this.spinner,this.rulerTool,this.chartInfoPanel,this.indicatorsInfoPanel,this.scrollToRealtimeButton],Dp),y(this,Xe,C(this.element))},ol=function(){d(this,x,ll).call(this),d(this,x,al).call(this),d(this,x,cl).call(this),d(this,x,ul).call(this)},ll=function(){const e=c(this,Xe).find('[data-ref="chartCanvas"]').element,i=jr();y(this,X,Eo(e,i))},al=function(){c(this,X).subscribeCrosshairMove(d(this,x,kl).bind(this)),c(this,X).timeScale().subscribeVisibleLogicalRangeChange(d(this,x,El).bind(this)),_.subscribe("context",this.update.bind(this)),_.subscribe("theme",d(this,x,yl).bind(this)),_.subscribe("selectedTradeTime",d(this,x,zl).bind(this))},cl=function(){_.set("rulerTool",this.rulerTool),_.set("chartApi",c(this,X))},ul=function(){const e=_.get("context");this.update(e)},dl=async function(){try{await Promise.all([d(this,x,fl).call(this),d(this,x,pl).call(this),d(this,x,ml).call(this)])}catch(e){console.error("Error loading chart data.",e)}},fl=async function(){c(this,rt).candlesticks=await hn.getKlines(_.get("context").id)},pl=async function(){c(this,rt).indicators=await hn.getIndicators(_.get("context").id)},ml=async function(){c(this,rt).markers=await hn.getMarkers(_.get("context").id)},gl=function(){const{candlestick:e,indicators:i}=c(this,L);e&&(c(this,X).removeSeries(e),c(this,L).candlestick=null),i.forEach(r=>c(this,X).removeSeries(r)),c(this,L).indicators.clear(),c(this,L).markers=null,_.get("drawings").forEach(r=>c(this,X).removeSeries(r)),_.set("drawings",[])},vl=function(){d(this,x,wl).call(this),d(this,x,bl).call(this),d(this,x,Cn).call(this),d(this,x,Tn).call(this)},wl=function(){c(this,L).candlestick=c(this,X).addSeries(vp),_.set("candlestickSeries",c(this,L).candlestick)},bl=function(){const{indicatorOptions:e}=_.get("context");Object.keys(e).forEach(i=>{const s=c(this,X).addSeries(bn);c(this,L).indicators.set(i,s)})},yl=function(){d(this,x,_l).call(this),d(this,x,Cn).call(this),d(this,x,Tn).call(this)},_l=function(){const e=jr();c(this,X).applyOptions(e)},Cn=function(){const{precision:e,minMove:i}=_.get("context"),s=Bp();c(this,L).candlestick.applyOptions({...s,priceFormat:{type:"price",precision:e,minMove:i}})},Tn=function(){const{indicatorOptions:e}=_.get("context"),i=Op();c(this,L).indicators.forEach((s,r)=>{s.applyOptions({...i,...e[r]})})},Ml=function(){const e=zt.getItem("drawings");if(!(e!=null&&e.trendlines))return;const i=e.trendlines[c(this,Ue)];if(!(i!=null&&i.length))return;const s=i.map(r=>{const h=c(this,X).addSeries(bn,Bo);return h.setData(r),h});_.set("drawings",s)},vs=function(){c(this,L).candlestick&&(d(this,x,xl).call(this),d(this,x,Sl).call(this),d(this,x,Cl).call(this))},xl=function(){c(this,L).candlestick.setData(c(this,rt).candlesticks.slice(-c(this,dt)))},Sl=function(){c(this,L).indicators.forEach((e,i)=>{const s=c(this,rt).indicators[i];e.setData(s.slice(-c(this,dt)))})},Cl=function(){if(!c(this,rt).markers)return;const e=c(this,L).candlestick.data()[0].time,i=c(this,rt).markers.filter(s=>s.time>=e);c(this,L).markers?c(this,L).markers.setMarkers(i):c(this,L).markers=kp(c(this,L).candlestick,i)},Tl=function(){const e=c(this,L).candlestick.data().at(-1),i=Object.fromEntries(Array.from(c(this,L).indicators,([s,r])=>[s,r.data().at(-1)]));this.chartInfoPanel.update(e,!0),this.indicatorsInfoPanel.update(i,!0)},kl=function({logical:e,point:i,seriesData:s,sourceEvent:r,time:h}){if(!i||!h)return;const o=s.get(c(this,L).candlestick),l=Object.fromEntries([...c(this,L).indicators].map(([a,u])=>[a,s.get(u)]));this.chartInfoPanel.update(o),this.indicatorsInfoPanel.update(l),this.rulerTool.update({logical:e,point:i,sourceEvent:r,candlestickSeries:c(this,L).candlestick})},El=function(e){if(e===null){y(this,dt,ps);return}c(this,dt)>=c(this,rt).candlesticks.length||e.from<50&&(y(this,dt,c(this,dt)+ps),d(this,x,vs).call(this))},zl=function(e){if(!e)return;const i=c(this,rt).candlesticks;let s=null;for(let o=0;o<i.length-1;o++){const l=i[o].time,a=i[o+1].time;if(e>=l&&e<a){s=o;break}}if(s===null)return;const r=i.length-s;r>c(this,dt)&&(y(this,dt,r+ps),d(this,x,vs).call(this));const h=c(this,X).timeScale().timeToIndex(i[s].time);c(this,X).timeScale().setVisibleLogicalRange({from:h-Gr,to:h+Gr})},T(nl,"componentName","Chart");const Kp={"report-header":"_report-header_1eimu_1","tab-buttons":"_tab-buttons_1eimu_21","size-buttons":"_size-buttons_1eimu_23"},tm=`<div class="report-header">\r
	<div class="tab-buttons">\r
		<component-overview-tab-button></component-overview-tab-button>\r
		<component-metrics-tab-button></component-metrics-tab-button>\r
		<component-trades-tab-button></component-trades-tab-button>\r
	</div>\r
	<div class="size-buttons">\r
		<component-toggle-visibility-button></component-toggle-visibility-button>\r
		<component-toggle-expansion-button></component-toggle-expansion-button>\r
	</div>\r
</div>\r
`,em={"metrics-tab-button":"_metrics-tab-button_lrbum_1"},im=`<button class="metrics-tab-button" data-active="false">\r
	Сводка показателей\r
</button>\r
`;var ge;class Rl extends k{constructor(){super(...arguments);m(this,ge)}render(){return this.element=E.htmlToElement(im,[],em),y(this,ge,C(this.element)),this.element}setOnClick(e){c(this,ge).click(e)}activate(){c(this,ge).data("active","true")}deactivate(){c(this,ge).data("active","false")}}ge=new WeakMap,T(Rl,"componentName","MetricsTabButton");const sm={"overview-tab-button":"_overview-tab-button_1uqxr_1"},nm=`<button class="overview-tab-button" data-active="true">Обзор</button>\r
`;var ve;class Nl extends k{constructor(){super(...arguments);m(this,ve)}render(){return this.element=E.htmlToElement(nm,[],sm),y(this,ve,C(this.element)),this.element}setOnClick(e){c(this,ve).click(e)}activate(){c(this,ve).data("active","true")}deactivate(){c(this,ve).data("active","false")}}ve=new WeakMap,T(Nl,"componentName","OverviewTabButton");const rm={"trades-tab-button":"_trades-tab-button_oanch_1"},hm=`<button class="trades-tab-button" data-active="false">Список сделок</button>\r
`;var we;class Al extends k{constructor(){super(...arguments);m(this,we)}render(){return this.element=E.htmlToElement(hm,[],rm),y(this,we,C(this.element)),this.element}setOnClick(e){c(this,we).click(e)}activate(){c(this,we).data("active","true")}deactivate(){c(this,we).data("active","false")}}we=new WeakMap,T(Al,"componentName","TradesTabButton");var qi,jt,Bl,Ol,Vl;class Ll extends k{constructor({toggleVisibilityButton:e,toggleExpansionButton:i}){super();m(this,jt);m(this,qi);this.toggleVisibilityButton=e,this.toggleExpansionButton=i}render(){return d(this,jt,Bl).call(this),d(this,jt,Ol).call(this),this.element}connectButtons(e){Object.entries(this.buttons).forEach(([i,s])=>{s.setOnClick(()=>{d(this,jt,Vl).call(this,i),e==null||e(i)})})}get minHeight(){return parseInt(c(this,qi).css("min-height"))}}qi=new WeakMap,jt=new WeakSet,Bl=function(){this.buttons={overview:new Nl,metrics:new Rl,trades:new Al}},Ol=function(){this.element=E.htmlToElement(tm,[this.buttons.overview,this.buttons.metrics,this.buttons.trades,this.toggleVisibilityButton,this.toggleExpansionButton],Kp),y(this,qi,C(this.element))},Vl=function(e){for(const[i,s]of Object.entries(this.buttons))i===e?s.activate():s.deactivate()},T(Ll,"componentName","ReportHeader");const Pl={visibility:{true:"Открыть панель",false:"Свернуть панель"},expansion:{true:"Восстановить панель",false:"Развернуть панель"}},om={"toggle-expansion-button":"_toggle-expansion-button_1fmm1_1","icon-collapsed":"_icon-collapsed_1fmm1_11","icon-expanded":"_icon-expanded_1fmm1_19"},lm=`<button\r
	class="toggle-expansion-button"\r
	data-active="false"\r
	title="Развернуть панель"\r
>\r
	<div class="icon-collapsed">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 28 28"\r
			width="28"\r
			height="28"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M19.32 6H8.68A2.68 2.68 0 0 0 6 8.68V11h1V8.68C7 7.75 7.75 7 8.68 7h10.64c.93 0 1.68.75 1.68 1.68V11h1V8.68C22 7.2 20.8 6 19.32 6ZM7 19.32c0 .93.75 1.68 1.68 1.68h10.64c.93 0 1.68-.75 1.68-1.68V17h1v2.32C22 20.8 20.8 22 19.32 22H8.68A2.68 2.68 0 0 1 6 19.32V17h1v2.32Z"\r
			></path>\r
		</svg>\r
	</div>\r
	<div class="icon-expanded">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 28 28"\r
			width="28"\r
			height="28"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M19.32 17H8.68A2.68 2.68 0 0 0 6 19.68V22h1v-2.32c0-.93.75-1.68 1.68-1.68h10.64c.93 0 1.68.75 1.68 1.68V22h1v-2.32C22 18.2 20.8 17 19.32 17ZM7 8.32C7 9.25 7.75 10 8.68 10h10.64c.93 0 1.68-.75 1.68-1.68V6h1v2.32C22 9.8 20.8 11 19.32 11H8.68A2.68 2.68 0 0 1 6 8.32V6h1v2.32Z"\r
			></path>\r
		</svg>\r
	</div>\r
</button>\r
`;var be,Gt,Il,$l,Yl;class Dl extends k{constructor({onClick:e}){super();m(this,Gt);m(this,be);this.onClick=e}get isActive(){return c(this,be).is("data-active")}render(){return d(this,Gt,Il).call(this),d(this,Gt,$l).call(this),this.element}toggleActiveState(){const e=String(!this.isActive);c(this,be).data("active",e).attr("title",Pl.expansion[e])}}be=new WeakMap,Gt=new WeakSet,Il=function(){this.element=E.htmlToElement(lm,[],om),y(this,be,C(this.element))},$l=function(){c(this,be).on("click",d(this,Gt,Yl).bind(this))},Yl=function(){var e;this.toggleActiveState(),(e=this.onClick)==null||e.call(this)},T(Dl,"componentName","ToggleExpansionButton");const am={"toggle-visibility-button":"_toggle-visibility-button_1pi6n_1","icon-visible":"_icon-visible_1pi6n_11","icon-hidden":"_icon-hidden_1pi6n_19"},cm=`<button\r
	class="toggle-visibility-button"\r
	data-active="false"\r
	title="Свернуть панель"\r
>\r
	<div class="icon-visible">\r
		<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
			<path fill="currentColor" d="M7 20h14v1H7z"></path>\r
		</svg>\r
	</div>\r
	<div class="icon-hidden">\r
		<svg xmlns="http://www.w3.org/2000/svg" width="19" height="12" fill="none">\r
			<path stroke="currentColor" d="M1 8l8.5-6.5L18 8"></path>\r
		</svg>\r
	</div>\r
</button>\r
`;var ye,Kt,Wl,ql,Hl;class Fl extends k{constructor({onClick:e}){super();m(this,Kt);m(this,ye);this.onClick=e}get isActive(){return c(this,ye).is("data-active")}render(){return d(this,Kt,Wl).call(this),d(this,Kt,ql).call(this),this.element}toggleActiveState(){const e=String(!this.isActive);c(this,ye).data("active",e).attr("title",Pl.visibility[e])}}ye=new WeakMap,Kt=new WeakSet,Wl=function(){this.element=E.htmlToElement(cm,[],am),y(this,ye,C(this.element))},ql=function(){c(this,ye).on("click",d(this,Kt,Hl).bind(this))},Hl=function(){var e;this.toggleActiveState(),(e=this.onClick)==null||e.call(this)},T(Fl,"componentName","ToggleVisibilityButton");const um="_report_d5blu_1",dm="_handle_d5blu_25",fm={report:um,handle:dm},pm=`<div class="report">\r
	<div class="handle" data-ref="handle"></div>\r
	<component-report-header></component-report-header>\r
	<component-report-content></component-report-content>\r
</div>\r
`,mm={"report-content":"_report-content_1plw8_1"},gm=`<div class="report-content">\r
	<component-overview-tab></component-overview-tab>\r
	<component-metrics-tab></component-metrics-tab>\r
	<component-trades-tab></component-trades-tab>\r
</div>\r
`;class vm extends Es{async getOverviewMetrics(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/overview/${t}/metrics`,method:"GET",errorMessage:"Не удалось загрузить метрики отчёта"})}async getOverviewEquity(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/overview/${t}/equity`,method:"GET",errorMessage:"Не удалось загрузить equity отчёта"})}async getMetrics(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/metrics/${t}`,method:"GET",errorMessage:"Не удалось загрузить метрики отчёта"})}async getTrades(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/trades/${t}`,method:"GET",errorMessage:"Не удалось загрузить сделки отчёта"})}}const Ms=new vm,wm="_table_1i8qs_13",bm="_header_1i8qs_29",ym="_row_1i8qs_41",_m="_cell_1i8qs_51",Mm="_items_1i8qs_81",xm={"metrics-tab":"_metrics-tab_1i8qs_1",table:wm,header:bm,row:ym,cell:_m,"align-end":"_align-end_1i8qs_65",items:Mm},Sm=`<div class="metrics-tab">\r
	<div class="table">\r
		<div class="header">\r
			<div class="row">\r
				<div class="cell">Показатель</div>\r
				<div class="cell align-end">Все сделки</div>\r
				<div class="cell align-end">Длинные сделки</div>\r
				<div class="cell align-end">Короткие сделки</div>\r
				<div class="cell align-end"></div>\r
			</div>\r
		</div>\r
		<div class="items" data-ref="metricsItems"></div>\r
	</div>\r
</div>\r
`,Cm="_cell_1pfav_23",Tm={"metrics-item":"_metrics-item_1pfav_1",cell:Cm,"align-end":"_align-end_1pfav_35","text-sm":"_text-sm_1pfav_43"},km=`<div class="metrics-item">\r
	<div class="cell">\r
		<span data-field="title.0"></span>\r
	</div>\r
	<div class="cell align-end">\r
		<span data-field="all.0"></span>\r
		<span data-field="all.1" class="text-sm"></span>\r
	</div>\r
	<div class="cell align-end">\r
		<span data-field="long.0"></span>\r
		<span data-field="long.1" class="text-sm"></span>\r
	</div>\r
	<div class="cell align-end">\r
		<span data-field="short.0"></span>\r
		<span data-field="short.1" class="text-sm"></span>\r
	</div>\r
	<div class="cell align-end"></div>\r
</div>\r
`;var Hi,Qi,li,Xl,Ul;class Ql extends k{constructor(){super(...arguments);m(this,li);m(this,Hi);m(this,Qi,new Map)}render(){return d(this,li,Xl).call(this),d(this,li,Ul).call(this),this.element}update(e){c(this,Qi).forEach(({element:i,group:s,index:r})=>{i.text(e[s][r])})}}Hi=new WeakMap,Qi=new WeakMap,li=new WeakSet,Xl=function(){this.element=E.htmlToElement(km,[],Tm),y(this,Hi,C(this.element))},Ul=function(){c(this,Hi).findAll("[data-field]").forEach(e=>{const i=e.data("field"),[s,r]=i.split(".");c(this,Qi).set(i,{element:e,group:s,index:Number(r)})})},T(Ql,"componentName","MetricsItem");var _e,Xi,ai,Zl,jl;class Jl extends k{constructor(){super(...arguments);m(this,ai);m(this,_e);m(this,Xi,new Map)}render(){return d(this,ai,Zl).call(this),d(this,ai,jl).call(this),this.element}async update(e){try{const i=await Ms.getMetrics(e.id),s=c(this,_e).find('[data-ref="metricsItems"]');i.forEach((r,h)=>{let o=c(this,Xi).get(h);o||(o=new Ql,c(this,Xi).set(h,o),s.append(o.render())),o.update(r)})}catch(i){console.error("Failed to update metrics.",i)}}hide(){c(this,_e).css("display","none")}show(){c(this,_e).css("display","flex")}}_e=new WeakMap,Xi=new WeakMap,ai=new WeakSet,Zl=function(){this.element=E.htmlToElement(Sm,[],xm),y(this,_e,C(this.element))},jl=function(){_.subscribe("context",this.update.bind(this)),this.update(_.get("context"))},T(Jl,"componentName","MetricsTab");const Em={"overview-tab":"_overview-tab_tngi4_1"},zm=`<div class="overview-tab">\r
	<component-spinner></component-spinner>\r
	<component-empty-state></component-empty-state>\r
	<component-overview-metrics></component-overview-metrics>\r
	<component-equity-curve></component-equity-curve>\r
</div>\r
`,Rm="_icon_dthzs_27",Nm={"empty-state":"_empty-state_dthzs_1",icon:Rm},Am=`<div class="empty-state">\r
	<div class="icon">\r
		<svg\r
			height="800px"\r
			width="800px"\r
			version="1.1"\r
			id="Layer_1"\r
			xmlns="http://www.w3.org/2000/svg"\r
			xmlns:xlink="http://www.w3.org/1999/xlink"\r
			viewBox="0 0 512 512"\r
			xml:space="preserve"\r
		>\r
			<path\r
				style="fill: #57c3d9"\r
				d="M456.344,511.991c-5.152,0-10.141-2.391-13.359-6.679l-36.728-48.972l-36.728,48.972\r
	c-6.304,8.413-20.413,8.413-26.717,0l-36.728-48.972l-36.728,48.972c-6.304,8.413-20.413,8.413-26.717,0l-36.728-48.972\r
	l-36.728,48.972c-6.304,8.413-20.413,8.413-26.717,0l-36.728-48.972l-36.728,48.972c-4.315,5.755-11.815,8.114-18.641,5.82\r
	c-6.815-2.272-11.413-8.652-11.413-15.837V217.04C38.96,97.363,136.328,0,256,0s217.04,97.363,217.04,217.04v278.256\r
	c0,7.185-4.598,13.566-11.413,15.837C459.888,511.714,458.105,511.991,456.344,511.991z"\r
			/>\r
			<path\r
				style="fill: #3db1cc"\r
				d="M269.358,505.312l36.728-48.972l36.728,48.972c6.304,8.413,20.413,8.413,26.717,0l36.728-48.972\r
	l36.728,48.972c3.218,4.288,8.206,6.679,13.359,6.679c1.761,0,3.544-0.277,5.282-0.858c6.815-2.272,11.413-8.652,11.413-15.837\r
	V217.04C473.04,97.363,375.672,0,256,0v511.622C261.103,511.622,266.206,509.518,269.358,505.312z"\r
			/>\r
			<path\r
				style="fill: #edf0f2"\r
				d="M172.523,300.517c-36.826,0-66.781-29.956-66.781-66.781s29.956-66.781,66.781-66.781\r
	s66.781,29.956,66.781,66.781S209.349,300.517,172.523,300.517z"\r
			/>\r
			<path\r
				style="fill: #dae1e6"\r
				d="M339.477,300.517c-36.826,0-66.781-29.956-66.781-66.781s29.956-66.781,66.781-66.781\r
	s66.781,29.956,66.781,66.781S376.302,300.517,339.477,300.517z"\r
			/>\r
			<circle style="fill: #736056" cx="189.214" cy="250.43" r="16.695" />\r
			<circle style="fill: #665247" cx="356.168" cy="250.43" r="16.695" />\r
		</svg>\r
	</div>\r
	<p>Данные по выбранной стратегии отсутствуют</p>\r
</div>\r
`;var Me;class Gl extends k{constructor(){super(...arguments);m(this,Me)}get isActive(){return c(this,Me).css("display")==="flex"}render(){return this.element=E.htmlToElement(Am,[],Nm),y(this,Me,C(this.element)),this.element}hide(){c(this,Me).css("display","none")}show(){c(this,Me).css("display","flex")}}Me=new WeakMap,T(Gl,"componentName","EmptyState");const Lm=()=>({autoSize:!0,layout:{background:{type:"solid",color:$("--color-bg-primary")||"#ffffff"},textColor:$("--color-text-primary")||"#292121",fontFamily:"system-ui, sans-serif",attributionLogo:!1},rightPriceScale:{scaleMargins:{top:.05,bottom:.05},borderVisible:!1,entireTextOnly:!0},crosshair:{vertLine:{color:$("--color-equity-curve-crosshair")||"#e8e8e8",style:0,labelVisible:!1},horzLine:{visible:!1,labelVisible:!1}},grid:{vertLines:{visible:!1},horzLines:{visible:!1}},timeScale:{maxBarSpacing:50,fixLeftEdge:!0,fixRightEdge:!0,lockVisibleTimeRangeOnResize:!0,borderVisible:!1,tickMarkFormatter:(n,t)=>{const e=new Date(n*1e3),i=String(e.getUTCFullYear()),s=e.toLocaleString("ru-RU",{month:"short"}).replace(".","").slice(0,3),r=String(e.getUTCDate());if(t===0)return String(i);if(t===1)return s;if(t===2)return r}}}),Bm=()=>({lastValueVisible:!1,priceLineVisible:!1,topColor:$("--color-equity-curve-area-top")||"#78CEFF",bottomColor:$("--color-equity-curve-area-bottom")||"#EBF5FB",lineColor:$("--color-equity-curve-line")||"#00A9FF",lineWidth:3,crosshairMarkerBorderColor:$("--color-equity-curve-marker")||"#ffffff",crosshairMarkerBorderWidth:3}),Om=100,Vm={weekday:"short",day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"UTC"},Pm=50,Dm=20,Im={"equity-curve":"_equity-curve_vfuql_1"},$m=`<div class="equity-curve">\r
	<component-equity-tooltip></component-equity-tooltip>\r
</div>\r
`,Ym={"equity-tooltip":"_equity-tooltip_htx0l_1","text-white":"_text-white_htx0l_39"},Fm=`<div class="equity-tooltip" data-active="false">\r
	<div>Сделка #<span data-field="deal"></span></div>\r
	<div class="text-white">Капитал: <span data-field="equity"></span></div>\r
	<div><span data-field="time"></span></div>\r
	<div>Нажмите, чтобы отобразить на графике</div>\r
</div>\r
`;var ft,Je,Ui,mt,ta,ea,ws;class Kl extends k{constructor(){super(...arguments);m(this,mt);m(this,ft);m(this,Je,!1);m(this,Ui,new Map)}get width(){return parseInt(c(this,ft).css("width"))}get height(){return parseInt(c(this,ft).css("height"))}get offsetX(){return Dm}get isActive(){return c(this,Je)}render(){return d(this,mt,ta).call(this),d(this,mt,ea).call(this),this.element}updateContent({deal:e,equity:i,timestamp:s}){const h=new Date(s*1e3).toLocaleString("ru-RU",Vm).replace(",","");d(this,mt,ws).call(this,"deal",`${e}`),d(this,mt,ws).call(this,"equity",`${i} USDT`),d(this,mt,ws).call(this,"time",h)}updatePosition({left:e,bottom:i}){c(this,ft).css("left",`${e}px`).css("bottom",`${i}px`)}activate(){c(this,ft).data("active","true"),y(this,Je,!0)}deactivate(){c(this,ft).data("active","false"),y(this,Je,!1)}}ft=new WeakMap,Je=new WeakMap,Ui=new WeakMap,mt=new WeakSet,ta=function(){this.element=E.htmlToElement(Fm,[],Ym),y(this,ft,C(this.element))},ea=function(){["deal","equity","time"].forEach(e=>{const i=c(this,ft).find(`[data-field="${e}"]`);c(this,Ui).set(e,i)})},ws=function(e,i){c(this,Ui).get(e).text(i)},T(Kl,"componentName","EquityTooltip");var Ze,pt,It,xe,Ji,N,sa,na,ra,ha,oa,kn,En,la,aa,ca,ua,da,fa,pa;class ia extends k{constructor(){super(...arguments);m(this,N);m(this,Ze);m(this,pt);m(this,It);m(this,xe,{});m(this,Ji,!1)}render(){return d(this,N,sa).call(this),d(this,N,na).call(this),d(this,N,ra).call(this),this.element}update(e){e.length&&(c(this,It).setData(e),c(this,pt).timeScale().fitContent())}hide(){c(this,Ze).css("display","none")}show(){c(this,Ze).css("display","block")}}Ze=new WeakMap,pt=new WeakMap,It=new WeakMap,xe=new WeakMap,Ji=new WeakMap,N=new WeakSet,sa=function(){this.equityTooltip=new Kl},na=function(){this.element=E.htmlToElement($m,[this.equityTooltip],Im),y(this,Ze,C(this.element))},ra=function(){d(this,N,ha).call(this),d(this,N,la).call(this)},ha=function(){y(this,pt,Eo(this.element)),y(this,It,c(this,pt).addSeries(fp)),d(this,N,kn).call(this),d(this,N,En).call(this)},oa=function(){d(this,N,kn).call(this),d(this,N,En).call(this)},kn=function(){const e=Lm();c(this,pt).applyOptions(e)},En=function(){const e=Bm();c(this,It).applyOptions(e)},la=function(){c(this,pt).subscribeClick(d(this,N,aa).bind(this)),c(this,pt).subscribeCrosshairMove(d(this,N,ca).bind(this)),c(this,pt).timeScale().subscribeVisibleLogicalRangeChange(d(this,N,fa).bind(this)),_.subscribe("theme",d(this,N,oa).bind(this))},aa=function({time:e}){_.set("selectedTradeTime",e)},ca=function(e){const{point:i,time:s,sourceEvent:r}=e;if(!i||!s||i.x<0||i.y<0){this.equityTooltip.deactivate();return}this.equityTooltip.isActive||(y(this,xe,d(this,N,pa).call(this)),this.equityTooltip.activate()),d(this,N,ua).call(this,e),r&&d(this,N,da).call(this,r)},ua=function(e){const{logical:i,seriesData:s}=e,r=s.get(c(this,It));r&&this.equityTooltip.updateContent({deal:i+1,equity:r.value,timestamp:r.time})},da=function(e){const{clientX:i,clientY:s}=e,{width:r,height:h,offsetX:o}=this.equityTooltip,l=c(this,xe).height-s-h/2;let a=i-c(this,xe).left-r-o;a<Pm&&(a=i-c(this,xe).left+o),this.equityTooltip.updatePosition({left:a,bottom:l})},fa=function(e){const i=e.to-e.from<=Om;i!==c(this,Ji)&&(y(this,Ji,i),c(this,It).applyOptions({pointMarkersVisible:i}))},pa=function(){return{left:this.element.getBoundingClientRect().left,height:window.innerHeight}},T(ia,"componentName","EquityCurve");const Wm="_cell_96plr_15",qm="_title_96plr_25",Hm="_values_96plr_33",Qm="_red_96plr_43",Xm="_green_96plr_51",gi={"overview-metrics":"_overview-metrics_96plr_1",cell:Wm,title:qm,values:Hm,red:Qm,green:Xm},Um=`<div class="overview-metrics">\r
	<div class="cell">\r
		<div class="title">Общие ПР/УБ</div>\r
		<div class="values">\r
			<span data-field="0"></span>\r
			<span data-field="1"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Фактор прибыли</div>\r
		<div class="values">\r
			<span data-field="2"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Макс. просадка средств</div>\r
		<div class="values">\r
			<span data-field="3"></span>\r
			<span data-field="4"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Средняя по сделке</div>\r
		<div class="values">\r
			<span data-field="5"></span>\r
			<span data-field="6"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Прибыльные сделки</div>\r
		<div class="values">\r
			<span data-field="7"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Всего сделок</div>\r
		<div class="values">\r
			<span data-field="8"></span>\r
		</div>\r
	</div>\r
</div>\r
`;var Ts,Zi,ji,vt,ma,ga,va,wa;const Ti=class Ti extends k{constructor(){super(...arguments);m(this,vt);m(this,Zi);m(this,ji,new Map)}render(){return d(this,vt,ma).call(this),d(this,vt,ga).call(this),this.element}update(e){parseInt(e[8])&&c(this,ji).forEach(({element:i,isProfitField:s},r)=>{const h=e[r];i.text(h),s&&d(this,vt,wa).call(this,i,h)})}};Ts=new WeakMap,Zi=new WeakMap,ji=new WeakMap,vt=new WeakSet,ma=function(){this.element=E.htmlToElement(Um,[],gi),y(this,Zi,C(this.element))},ga=function(){c(this,Zi).findAll("[data-field]").forEach(e=>{const i=Number(e.data("field")),s=d(this,vt,va).call(this,i);c(this,ji).set(i,{element:e,isProfitField:s})})},va=function(e){return c(Ti,Ts).includes(e)},wa=function(e,i){i.startsWith("-")?e.removeClass(gi.green).addClass(gi.red):e.removeClass(gi.red).addClass(gi.green)},T(Ti,"componentName","OverviewMetrics"),m(Ti,Ts,[0,1,5,6]);let zn=Ti;var je,Gi,te,ya,_a,Ma;class ba extends k{constructor(){super(...arguments);m(this,te);m(this,je);m(this,Gi,!1)}render(){return d(this,te,ya).call(this),d(this,te,_a).call(this),d(this,te,Ma).call(this),this.element}hide(){c(this,je).css("display","none")}show(){c(this,je).css("display","flex")}async update(e){try{const i=await Ms.getOverviewMetrics(e.id),s=await Ms.getOverviewEquity(e.id);this.overviewMetrics.update(i),this.equityCurve.update(s),s.length?this.emptyState.hide():this.emptyState.show(),c(this,Gi)||(y(this,Gi,!0),this.spinner.hide())}catch(i){console.error("Failed to update overview.",i)}}}je=new WeakMap,Gi=new WeakMap,te=new WeakSet,ya=function(){this.spinner=new Wn,this.emptyState=new Gl,this.overviewMetrics=new zn,this.equityCurve=new ia},_a=function(){this.element=E.htmlToElement(zm,[this.spinner,this.emptyState,this.overviewMetrics,this.equityCurve],Em),y(this,je,C(this.element))},Ma=function(){_.subscribe("context",this.update.bind(this)),this.update(_.get("context"))},T(ba,"componentName","OverviewTab");const Jm="_table_1n1pe_13",Zm="_header_1n1pe_29",jm="_row_1n1pe_41",Gm="_cell_1n1pe_51",Km="_items_1n1pe_99",tg={"trades-tab":"_trades-tab_1n1pe_1",table:Jm,header:Zm,row:jm,cell:Gm,"align-end":"_align-end_1n1pe_83",items:Km},eg=`<div class="trades-tab">\r
	<div class="table">\r
		<div class="header">\r
			<div class="row">\r
				<div class="cell">\r
					<component-toggle-sorting-button></component-toggle-sorting-button>\r
				</div>\r
				<div class="cell">Тип</div>\r
				<div class="cell">Сигнал</div>\r
				<div class="cell">Дата/Время</div>\r
				<div class="cell align-end">Цена</div>\r
				<div class="cell align-end">Количество</div>\r
				<div class="cell align-end">ПР/УБ</div>\r
				<div class="cell align-end">Совокупные ПР/УБ</div>\r
			</div>\r
		</div>\r
		<div class="items" data-ref="tradesItems"></div>\r
	</div>\r
</div>\r
`,ig={"toggle-sorting-button":"_toggle-sorting-button_7fiwl_1","icon-ascending":"_icon-ascending_7fiwl_21","icon-descending":"_icon-descending_7fiwl_29"},sg=`<button class="toggle-sorting-button" data-active="false">\r
	<span>№ Сделки</span>\r
	<span class="icon-ascending">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			width="16"\r
			height="16"\r
			fill="#6a6d78"\r
			class="bi bi-arrow-up"\r
			viewBox="0 0 16 16"\r
		>\r
			<path\r
				fill-rule="evenodd"\r
				d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5"\r
			/>\r
		</svg>\r
	</span>\r
	<span class="icon-descending">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			width="16"\r
			height="16"\r
			fill="#6a6d78"\r
			class="bi bi-arrow-down"\r
			viewBox="0 0 16 16"\r
		>\r
			<path\r
				fill-rule="evenodd"\r
				d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"\r
			/>\r
		</svg>\r
	</span>\r
</button>\r
`;var Se,ee,Sa,Ca,Ta;class xa extends k{constructor({onClick:e}){super();m(this,ee);m(this,Se);this.onClick=e}get isActive(){return c(this,Se).is("data-active")}render(){return d(this,ee,Sa).call(this),d(this,ee,Ca).call(this),this.element}toggleActiveState(){c(this,Se).data("active",String(!this.isActive))}}Se=new WeakMap,ee=new WeakSet,Sa=function(){this.element=E.htmlToElement(sg,[],ig),y(this,Se,C(this.element))},Ca=function(){c(this,Se).on("click",d(this,ee,Ta).bind(this))},Ta=function(){var e;this.toggleActiveState(),(e=this.onClick)==null||e.call(this)},T(xa,"componentName","ToggleSortingButton");const ng="_cell_s94hx_23",rg="_compact_s94hx_85",hg="_red_s94hx_101",og="_green_s94hx_109",vi={"trades-item":"_trades-item_s94hx_1",cell:ng,"border-bottom":"_border-bottom_s94hx_43","align-end":"_align-end_s94hx_69",compact:rg,"text-sm":"_text-sm_s94hx_93",red:hg,green:og},lg=`<div class="trades-item">\r
	<div class="cell">\r
		<div data-field="0"></div>\r
	</div>\r
	<div class="cell">\r
		<div data-field="1" class="border-bottom"></div>\r
		<div data-field="2"></div>\r
	</div>\r
	<div class="cell">\r
		<div data-field="3" class="border-bottom"></div>\r
		<div data-field="4"></div>\r
	</div>\r
	<div class="cell">\r
		<div data-field="5" class="border-bottom"></div>\r
		<div data-field="6"></div>\r
	</div>\r
	<div class="cell align-end">\r
		<div data-field="7" class="border-bottom"></div>\r
		<div data-field="8"></div>\r
	</div>\r
	<div class="cell align-end">\r
		<div data-field="9"></div>\r
	</div>\r
	<div class="cell align-end compact">\r
		<span data-field="10"></span>\r
		<span data-field="11" class="text-sm"></span>\r
	</div>\r
	<div class="cell align-end compact">\r
		<span data-field="12"></span>\r
		<span data-field="13" class="text-sm"></span>\r
	</div>\r
</div>\r
`;var ks,Ki,ts,wt,ka,Ea,za,Ra;const ki=class ki extends k{constructor(){super(...arguments);m(this,wt);m(this,Ki);m(this,ts,new Map)}render(){return d(this,wt,ka).call(this),d(this,wt,Ea).call(this),this.element}update(e){c(this,ts).forEach(({element:i,isProfitField:s},r)=>{const h=e[r];i.text(h),s&&d(this,wt,Ra).call(this,i,h)})}remove(){this.element.remove()}};ks=new WeakMap,Ki=new WeakMap,ts=new WeakMap,wt=new WeakSet,ka=function(){this.element=E.htmlToElement(lg,[],vi),y(this,Ki,C(this.element))},Ea=function(){c(this,Ki).findAll("[data-field]").forEach(e=>{const i=Number(e.data("field")),s=d(this,wt,za).call(this,i);c(this,ts).set(i,{element:e,isProfitField:s})})},za=function(e){return c(ki,ks).includes(e)},Ra=function(e,i){i.startsWith("-")?e.removeClass(vi.green).addClass(vi.red):e.removeClass(vi.red).addClass(vi.green)},T(ki,"componentName","TradesItem"),m(ki,ks,[10,11,12,13]);let Rn=ki;var Ce,it,Te,W,Aa,La,Ba,Oa,Nn,An,Va;class Na extends k{constructor(){super(...arguments);m(this,W);m(this,Ce);m(this,it,[]);m(this,Te,new Map)}render(){return d(this,W,Aa).call(this),d(this,W,La).call(this),d(this,W,Ba).call(this),this.element}async update(e){try{const i=await Ms.getTrades(e.id);y(this,it,[...i]),d(this,W,Oa).call(this),d(this,W,Nn).call(this)}catch(i){console.error("Failed to update trades.",i)}}handleSortingToggle(){c(this,it).length>0&&(d(this,W,An).call(this),d(this,W,Nn).call(this))}hide(){c(this,Ce).css("display","none")}show(){c(this,Ce).css("display","flex")}}Ce=new WeakMap,it=new WeakMap,Te=new WeakMap,W=new WeakSet,Aa=function(){this.toggleSortingButton=new xa({onClick:this.handleSortingToggle.bind(this)})},La=function(){this.element=E.htmlToElement(eg,[this.toggleSortingButton],tg),y(this,Ce,C(this.element))},Ba=function(){_.subscribe("context",this.update.bind(this)),this.update(_.get("context"))},Oa=function(){if(c(this,it).length<2)return;(this.toggleSortingButton.isActive?c(this,it)[0][0]<c(this,it)[1][0]:c(this,it)[0][0]>c(this,it)[1][0])&&d(this,W,An).call(this)},Nn=function(){const e=c(this,Ce).find('[data-ref="tradesItems"]');d(this,W,Va).call(this),c(this,it).forEach((i,s)=>{let r=c(this,Te).get(s);r||(r=new Rn,c(this,Te).set(s,r),e.append(r.render())),r.update(i)})},An=function(){c(this,it).reverse()},Va=function(){const e=new Set(c(this,it).map((i,s)=>s));c(this,Te).forEach((i,s)=>{e.has(s)||(i.remove(),c(this,Te).delete(s))})},T(Na,"componentName","TradesTab");var ci,Da,Ia;class Pa extends k{constructor(){super(...arguments);m(this,ci)}render(){return d(this,ci,Da).call(this),d(this,ci,Ia).call(this),this.element}showOnly(e){Object.entries(this.tabs).forEach(([i,s])=>{i===e?s.show():s.hide()})}}ci=new WeakSet,Da=function(){this.tabs={overview:new ba,metrics:new Jl,trades:new Na}},Ia=function(){this.element=E.htmlToElement(gm,[this.tabs.overview,this.tabs.metrics,this.tabs.trades],mm)},T(Pa,"componentName","ReportContent");var $t,bt,Ya,Fa,Wa,qa;class $a extends k{constructor({reportHeader:e,onMousedown:i}){super();m(this,bt);m(this,$t);this.reportHeader=e,this.onMousedown=i}get height(){return parseInt(c(this,$t).css("height"))}set height(e){c(this,$t).css("height",`${e}px`)}get minHeight(){const e=c(this,$t).find('[data-ref="handle"]').css("min-height"),i=this.reportHeader.minHeight;return parseInt(e)+i}render(){return d(this,bt,Ya).call(this),d(this,bt,Fa).call(this),d(this,bt,Wa).call(this),this.element}}$t=new WeakMap,bt=new WeakSet,Ya=function(){this.reportContent=new Pa},Fa=function(){this.element=E.htmlToElement(pm,[this.reportHeader,this.reportContent],fm),y(this,$t,C(this.element))},Wa=function(){c(this,$t).find('[data-ref="handle"]').on("mousedown",d(this,bt,qa).bind(this)),this.reportHeader.connectButtons(e=>{this.reportContent.showOnly(e)})},qa=function(e){var i;(i=this.onMousedown)==null||i.call(this,e.clientY)},T($a,"componentName","Report");var es,Ge,Yt,ke,Y,Qa,Xa,Ua,_i,Oe;class Ha extends k{constructor(){super(...arguments);m(this,Y);m(this,es);m(this,Ge);m(this,Yt);m(this,ke)}render(){return d(this,Y,Qa).call(this),d(this,Y,Xa).call(this),d(this,Y,Ua).call(this),this.element}handleVisibilityToggle(){this.toggleVisibilityButton.isActive?(this.toggleExpansionButton.isActive?this.toggleExpansionButton.toggleActiveState():d(this,Y,_i).call(this),d(this,Y,Oe).call(this,c(this,Yt))):d(this,Y,Oe).call(this,c(this,Ge))}handleExpansionToggle(){this.toggleExpansionButton.isActive?(this.toggleVisibilityButton.isActive?this.toggleVisibilityButton.toggleActiveState():d(this,Y,_i).call(this),d(this,Y,Oe).call(this,c(this,ke))):d(this,Y,Oe).call(this,c(this,Ge))}handleManualResize(e){d(this,Y,_i).call(this);const i=this.report.height;let s=this.toggleVisibilityButton.isActive,r=this.toggleExpansionButton.isActive;const h=l=>{const a=Math.max(c(this,Yt),i+e-l.clientY);d(this,Y,Oe).call(this,a),a===c(this,Yt)&&!s?(this.toggleVisibilityButton.toggleActiveState(),s=!s):s&&a>c(this,Yt)&&(this.toggleVisibilityButton.toggleActiveState(),s=!s),a>=c(this,ke)&&!r?(this.toggleExpansionButton.toggleActiveState(),r=!r):r&&a<c(this,ke)&&(this.toggleExpansionButton.toggleActiveState(),r=!r)},o=()=>{C(document).off("mousemove",h).off("mouseup",o).find("body").removeClass("resizing")};C(document).on("mousemove",h).on("mouseup",o).find("body").addClass("resizing")}}es=new WeakMap,Ge=new WeakMap,Yt=new WeakMap,ke=new WeakMap,Y=new WeakSet,Qa=function(){this.chart=new nl,this.toggleVisibilityButton=new Fl({onClick:this.handleVisibilityToggle.bind(this)}),this.toggleExpansionButton=new Dl({onClick:this.handleExpansionToggle.bind(this)}),this.reportHeader=new Ll({toggleVisibilityButton:this.toggleVisibilityButton,toggleExpansionButton:this.toggleExpansionButton}),this.report=new $a({reportHeader:this.reportHeader,onMousedown:this.handleManualResize.bind(this)})},Xa=function(){this.element=E.htmlToElement(Gu,[this.chart,this.report],ju),y(this,es,C(this.element))},Ua=function(){requestAnimationFrame(()=>d(this,Y,_i).call(this))},_i=function(){y(this,Ge,this.report.height),y(this,Yt,this.report.minHeight),y(this,ke,parseInt(c(this,es).css("height")))},Oe=function(e){this.chart.height=e,this.report.height=e},T(Ha,"componentName","Dashboard");const ag="_toolbox_1qvtw_1",cg={toolbox:ag},ug=`<div class="toolbox">\r
	<component-screenshot-button></component-screenshot-button>\r
	<component-full-screen-button></component-full-screen-button>\r
	<hr />\r
	<component-trendline-tool-button></component-trendline-tool-button>\r
	<component-ruler-tool-button></component-ruler-tool-button>\r
	<hr />\r
	<component-hide-drawings-button></component-hide-drawings-button>\r
	<component-clear-drawings-button></component-clear-drawings-button>\r
</div>\r
`,dg={"clear-drawings-button":"_clear-drawings-button_1x3ps_1"},fg=`<button class="clear-drawings-button" title="Удалить объекты рисования">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M18 7h5v1h-2.01l-1.33 14.64a1.5 1.5 0 0 1-1.5 1.36H9.84a1.5 1.5 0 0 1-1.49-1.36L7.01 8H5V7h5V6c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v1Zm-6-2a1 1 0 0 0-1 1v1h6V6a1 1 0 0 0-1-1h-4ZM8.02 8l1.32 14.54a.5.5 0 0 0 .5.46h8.33a.5.5 0 0 0 .5-.46L19.99 8H8.02Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var is,ot,Za,ja,Ga,Ka,tc;class Ja extends k{constructor(){super(...arguments);m(this,ot);m(this,is)}render(){return d(this,ot,Za).call(this),d(this,ot,ja).call(this),this.element}}is=new WeakMap,ot=new WeakSet,Za=function(){this.element=E.htmlToElement(fg,[],dg),y(this,is,C(this.element))},ja=function(){c(this,is).on("click",d(this,ot,Ga).bind(this))},Ga=function(){d(this,ot,Ka).call(this),d(this,ot,tc).call(this)},Ka=function(){const e=_.get("chartApi");if(!e)return;(_.get("drawings")||[]).forEach(s=>e.removeSeries(s)),_.set("drawings",[])},tc=function(){const e=zt.getItem("drawings");if(!e)return;const i=_.get("context").id,s=Object.fromEntries(Object.entries(e).map(([r,h])=>{const{[i]:o,...l}=h||{};return[r,l]}));zt.setItem("drawings",s)},T(Ja,"componentName","ClearDrawingsButton");const pg={"full-screen-button":"_full-screen-button_rj2mh_1"},mg=`<button class="full-screen-button" title="Полноэкранный режим">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M8.5 6A2.5 2.5 0 0 0 6 8.5V11h1V8.5C7 7.67 7.67 7 8.5 7H11V6H8.5zM6 17v2.5A2.5 2.5 0 0 0 8.5 22H11v-1H8.5A1.5 1.5 0 0 1 7 19.5V17H6zM19.5 7H17V6h2.5A2.5 2.5 0 0 1 22 8.5V11h-1V8.5c0-.83-.67-1.5-1.5-1.5zM22 19.5V17h-1v2.5c0 .83-.67 1.5-1.5 1.5H17v1h2.5a2.5 2.5 0 0 0 2.5-2.5z"\r
		></path>\r
	</svg>\r
</button>\r
`;var ss,ie,ic,sc,nc;class ec extends k{constructor(){super(...arguments);m(this,ie);m(this,ss)}render(){return d(this,ie,ic).call(this),d(this,ie,sc).call(this),this.element}}ss=new WeakMap,ie=new WeakSet,ic=function(){this.element=E.htmlToElement(mg,[],pg),y(this,ss,C(this.element))},sc=function(){c(this,ss).on("click",d(this,ie,nc).bind(this))},nc=function(){var s,r,h,o;const e=C('[data-ref="chart"]').element;if(!e)return;const i=((s=e.requestFullscreen)==null?void 0:s.bind(e))||((r=e.webkitRequestFullscreen)==null?void 0:r.bind(e))||((h=e.mozRequestFullScreen)==null?void 0:h.bind(e))||((o=e.msRequestFullscreen)==null?void 0:o.bind(e));i&&i()},T(ec,"componentName","FullScreenButton");const Kr={true:"Показать объекты рисования",false:"Скрыть объекты рисования"},gg={"hide-drawings-button":"_hide-drawings-button_a2i4m_1","icon-visible":"_icon-visible_a2i4m_11","icon-hidden":"_icon-hidden_a2i4m_19"},vg=`<button\r
	class="hide-drawings-button"\r
	data-active="false"\r
	title="Скрыть объекты рисования"\r
>\r
	<div class="icon-visible">\r
		<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
			<path\r
				fill="currentColor"\r
				fill-rule="evenodd"\r
				d="M5 10.76l-.41-.72-.03-.04.03-.04a15 15 0 012.09-2.9c1.47-1.6 3.6-3.12 6.32-3.12 2.73 0 4.85 1.53 6.33 3.12a15.01 15.01 0 012.08 2.9l.03.04-.03.04a15 15 0 01-2.09 2.9c-1.47 1.6-3.6 3.12-6.32 3.12-2.73 0-4.85-1.53-6.33-3.12a15 15 0 01-1.66-2.18zm17.45-.98L22 10l.45.22-.01.02a5.04 5.04 0 01-.15.28 16.01 16.01 0 01-2.23 3.1c-1.56 1.69-3.94 3.44-7.06 3.44-3.12 0-5.5-1.75-7.06-3.44a16 16 0 01-2.38-3.38v-.02h-.01L4 10l-.45-.22.01-.02a5.4 5.4 0 01.15-.28 16 16 0 012.23-3.1C7.5 4.69 9.88 2.94 13 2.94c3.12 0 5.5 1.75 7.06 3.44a16.01 16.01 0 012.38 3.38v.02h.01zM22 10l.45-.22.1.22-.1.22L22 10zM3.55 9.78L4 10l-.45.22-.1-.22.1-.22zm6.8.22A2.6 2.6 0 0113 7.44 2.6 2.6 0 0115.65 10 2.6 2.6 0 0113 12.56 2.6 2.6 0 0110.35 10zM13 6.44A3.6 3.6 0 009.35 10 3.6 3.6 0 0013 13.56c2 0 3.65-1.58 3.65-3.56A3.6 3.6 0 0013 6.44zm7.85 12l.8-.8.7.71-.79.8a.5.5 0 000 .7l.59.59c.2.2.5.2.7 0l1.8-1.8.7.71-1.79 1.8a1.5 1.5 0 01-2.12 0l-.59-.59a1.5 1.5 0 010-2.12zM16.5 21.5l-.35-.35a.5.5 0 00-.07.07l-1 1.5-1 1.5a.5.5 0 00.42.78h4a2.5 2.5 0 001.73-.77A2.5 2.5 0 0021 22.5a2.5 2.5 0 00-.77-1.73A2.5 2.5 0 0018.5 20a3.1 3.1 0 00-1.65.58 5.28 5.28 0 00-.69.55v.01h-.01l.35.36zm.39.32l-.97 1.46-.49.72h3.07c.34 0 .72-.17 1.02-.48.3-.3.48-.68.48-1.02 0-.34-.17-.72-.48-1.02-.3-.3-.68-.48-1.02-.48-.35 0-.75.18-1.1.42a4.27 4.27 0 00-.51.4z"\r
			></path>\r
		</svg>\r
	</div>\r
	<div class="icon-hidden">\r
		<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
			<path\r
				fill="currentColor"\r
				fill-rule="evenodd"\r
				d="M19.76 6.07l-.7.7a13.4 13.4 0 011.93 2.47c.19.3.33.55.42.72l.03.04-.03.04a15 15 0 01-2.09 2.9c-1.47 1.6-3.6 3.12-6.32 3.12-.98 0-1.88-.2-2.7-.52l-.77.76c1.03.47 2.18.76 3.47.76 3.12 0 5.5-1.75 7.06-3.44a16 16 0 002.38-3.38v-.02h.01L22 10l.45.22.1-.22-.1-.22L22 10l.45-.22-.01-.02a5.1 5.1 0 00-.15-.28 16 16 0 00-2.53-3.41zM6.24 13.93l.7-.7-.27-.29a15 15 0 01-2.08-2.9L4.56 10l.03-.04a15 15 0 012.09-2.9c1.47-1.6 3.6-3.12 6.32-3.12.98 0 1.88.2 2.7.52l.77-.76A8.32 8.32 0 0013 2.94c-3.12 0-5.5 1.75-7.06 3.44a16 16 0 00-2.38 3.38v.02h-.01L4 10l-.45-.22-.1.22.1.22L4 10l-.45.22.01.02a5.5 5.5 0 00.15.28 16 16 0 002.53 3.41zm6.09-.43a3.6 3.6 0 004.24-4.24l-.93.93a2.6 2.6 0 01-2.36 2.36l-.95.95zm-1.97-3.69l-.93.93a3.6 3.6 0 014.24-4.24l-.95.95a2.6 2.6 0 00-2.36 2.36zm11.29 7.84l-.8.79a1.5 1.5 0 000 2.12l.59.59a1.5 1.5 0 002.12 0l1.8-1.8-.71-.7-1.8 1.79a.5.5 0 01-.7 0l-.59-.59a.5.5 0 010-.7l.8-.8-.71-.7zm-5.5 3.5l.35.35-.35-.35.01-.02.02-.02.02-.02a4.68 4.68 0 01.65-.5c.4-.27 1-.59 1.65-.59.66 0 1.28.33 1.73.77.44.45.77 1.07.77 1.73a2.5 2.5 0 01-.77 1.73 2.5 2.5 0 01-1.73.77h-4a.5.5 0 01-.42-.78l1-1.5 1-1.5a.5.5 0 01.07-.07zm.74.67a3.46 3.46 0 01.51-.4c.35-.24.75-.42 1.1-.42.34 0 .72.17 1.02.48.3.3.48.68.48 1.02 0 .34-.17.72-.48 1.02-.3.3-.68.48-1.02.48h-3.07l.49-.72.97-1.46zM21.2 2.5L5.5 18.2l-.7-.7L20.5 1.8l.7.7z"\r
			></path>\r
		</svg>\r
	</div>\r
</button>\r
`;var Ft,F,bs,hc,oc,lc,ac,cc,Ln;class rc extends k{constructor({onActivate:e}){super();m(this,F);m(this,Ft);this.onActivate=e}render(){return d(this,F,hc).call(this),d(this,F,oc).call(this),this.element}deactivate(){c(this,F,bs)&&(c(this,Ft).data("active","false").attr("title",Kr.false),d(this,F,cc).call(this,_.get("drawings")))}}Ft=new WeakMap,F=new WeakSet,bs=function(){return c(this,Ft).is("data-active")},hc=function(){this.element=E.htmlToElement(vg,[],gg),y(this,Ft,C(this.element))},oc=function(){c(this,Ft).on("click",d(this,F,lc).bind(this)),_.subscribe("drawings",d(this,F,Ln).bind(this))},lc=function(){var e;c(this,F,bs)?this.deactivate():(d(this,F,ac).call(this),(e=this.onActivate)==null||e.call(this))},ac=function(){c(this,Ft).data("active","true").attr("title",Kr.true),d(this,F,Ln).call(this,_.get("drawings"))},cc=function(e){e!=null&&e.length&&e.forEach(i=>i.applyOptions({visible:!0}))},Ln=function(e){!c(this,F,bs)||!e.length||e.forEach(i=>i.applyOptions({visible:!1}))},T(rc,"componentName","HideDrawingsButton");const wg={"ruler-tool-button":"_ruler-tool-button_njj72_1"},bg=`<button class="ruler-tool-button" data-active="false" title="Линейка">\r
	<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
		<path\r
			fill="currentColor"\r
			d="M2 9.75a1.5 1.5 0 0 0-1.5 1.5v5.5a1.5 1.5 0 0 0 1.5 1.5h24a1.5 1.5 0 0 0 1.5-1.5v-5.5a1.5 1.5 0 0 0-1.5-1.5zm0 1h3v2.5h1v-2.5h3.25v3.9h1v-3.9h3.25v2.5h1v-2.5h3.25v3.9h1v-3.9H22v2.5h1v-2.5h3a.5.5 0 0 1 .5.5v5.5a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-5.5a.5.5 0 0 1 .5-.5z"\r
			transform="rotate(-45 14 14)"\r
		></path>\r
	</svg>\r
</button>\r
`;var Wt,G,Bn,dc,fc,pc,mc,gc;class uc extends k{constructor({onActivate:e}){super();m(this,G);m(this,Wt);this.onActivate=e}render(){return d(this,G,dc).call(this),d(this,G,fc).call(this),this.element}deactivate(){const e=_.get("rulerTool");!c(this,G,Bn)||!e||(c(this,Wt).data("active","false"),this.element.blur(),e.deactivate())}}Wt=new WeakMap,G=new WeakSet,Bn=function(){return c(this,Wt).is("data-active")},dc=function(){this.element=E.htmlToElement(bg,[],wg),y(this,Wt,C(this.element))},fc=function(){c(this,Wt).on("click",d(this,G,pc).bind(this)),_.subscribe("rulerActive",d(this,G,mc).bind(this))},pc=function(){var e;c(this,G,Bn)?this.deactivate():(d(this,G,gc).call(this),(e=this.onActivate)==null||e.call(this))},mc=function(e){e||this.deactivate()},gc=function(){const e=_.get("rulerTool");e&&(c(this,Wt).data("active","true"),e.initialize())},T(uc,"componentName","RulerToolButton");const yg={"screenshot-button":"_screenshot-button_ir7q9_1"},_g=`<button class="screenshot-button" title="Сделать снимок экрана">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		width="28"\r
		height="28"\r
		fill="currentColor"\r
	>\r
		<path\r
			fill-rule="evenodd"\r
			clip-rule="evenodd"\r
			d="M11.118 6a.5.5 0 0 0-.447.276L9.809 8H5.5A1.5 1.5 0 0 0 4 9.5v10A1.5 1.5 0 0 0 5.5 21h16a1.5 1.5 0 0 0 1.5-1.5v-10A1.5 1.5 0 0 0 21.5 8h-4.309l-.862-1.724A.5.5 0 0 0 15.882 6h-4.764zm-1.342-.17A1.5 1.5 0 0 1 11.118 5h4.764a1.5 1.5 0 0 1 1.342.83L17.809 7H21.5A2.5 2.5 0 0 1 24 9.5v10a2.5 2.5 0 0 1-2.5 2.5h-16A2.5 2.5 0 0 1 3 19.5v-10A2.5 2.5 0 0 1 5.5 7h3.691l.585-1.17z"\r
		></path>\r
		<path\r
			fill-rule="evenodd"\r
			clip-rule="evenodd"\r
			d="M13.5 18a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7zm0 1a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9z"\r
		></path>\r
	</svg>\r
</button>\r
`;var ns,yt,wc,bc,yc,_c;class vc extends k{constructor(){super(...arguments);m(this,yt);m(this,ns)}render(){return d(this,yt,wc).call(this),d(this,yt,bc).call(this),this.element}}ns=new WeakMap,yt=new WeakSet,wc=function(){this.element=E.htmlToElement(_g,[],yg),y(this,ns,C(this.element))},bc=function(){c(this,ns).on("click",d(this,yt,yc).bind(this))},yc=function(){const e=_.get("chartApi");e&&e.takeScreenshot().toBlob(d(this,yt,_c),"image/png",1)},_c=function(e){const i=URL.createObjectURL(e),s=window.open(i,"_blank");s&&(s.onload=()=>URL.revokeObjectURL(i))},T(vc,"componentName","ScreenshotButton");const Mg={"trendline-tool-button":"_trendline-tool-button_1havz_1"},xg=`<button class="trendline-tool-button" data-active="false" title="Линия тренда">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<g fill="currentColor" fill-rule="nonzero">\r
			<path d="M7.354 21.354l14-14-.707-.707-14 14z"></path>\r
			<path\r
				d="M22.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"\r
			></path>\r
		</g>\r
	</svg>\r
</button>\r
`;var qt,Ke,ht,D,On,xc,Sc,Cc,Tc,kc,Ec,zc,Rc;class Mc extends k{constructor({onActivate:e}){super();m(this,D);m(this,qt);m(this,Ke);m(this,ht,[]);this.onActivate=e}render(){return d(this,D,xc).call(this),d(this,D,Sc).call(this),this.element}deactivate(){c(this,D,On)&&(c(this,qt).data("active","false"),this.element.blur(),y(this,ht,[]),d(this,D,Ec).call(this))}}qt=new WeakMap,Ke=new WeakMap,ht=new WeakMap,D=new WeakSet,On=function(){return c(this,qt).is("data-active")},xc=function(){this.element=E.htmlToElement(xg,[],Mg),y(this,qt,C(this.element))},Sc=function(){c(this,qt).on("click",d(this,D,Cc).bind(this)),y(this,Ke,d(this,D,zc).bind(this)),_.subscribe("candlestickSeries",this.deactivate.bind(this))},Cc=function(){var e;c(this,D,On)?this.deactivate():(d(this,D,Tc).call(this),(e=this.onActivate)==null||e.call(this))},Tc=function(){c(this,qt).data("active","true"),d(this,D,kc).call(this),Qt.show("info","Выберите две точки на графике")},kc=function(){const e=_.get("chartApi");e&&e.subscribeClick(c(this,Ke))},Ec=function(){const e=_.get("chartApi");e&&e.unsubscribeClick(c(this,Ke))},zc=function({time:e,point:i}){const s=_.get("chartApi"),r=_.get("candlestickSeries");if(!s||!r)return;const h=e,o=r.coordinateToPrice(i.y);if(!h){Qt.show("warning","Нельзя построить линию за пределами графика"),this.deactivate();return}if(!c(this,ht).length){c(this,ht).push({time:h,value:o});return}if(h===c(this,ht)[0].time){Qt.show("warning","Нельзя построить вертикальную линию"),this.deactivate();return}const l={time:h,value:o};h>c(this,ht)[0].time?c(this,ht).push(l):c(this,ht).unshift(l);const a=s.addSeries(bn,Bo);a.setData(c(this,ht));const u=_.get("drawings");_.set("drawings",[a,...u]),d(this,D,Rc).call(this),this.deactivate()},Rc=function(){const e=_.get("context").id,i=zt.getItem("drawings")||{trendlines:{}};i.trendlines[e]=[c(this,ht),...i.trendlines[e]||[]],zt.setItem("drawings",i)},T(Mc,"componentName","TrendlineToolButton");var _t,Ac,Lc,Bc,Oc;class Nc extends k{constructor(){super(...arguments);m(this,_t)}render(){return d(this,_t,Ac).call(this),d(this,_t,Lc).call(this),d(this,_t,Bc).call(this),this.element}handleTrendlineToolActivate(){this.rulerToolButton.deactivate(),this.hideDrawingsButton.deactivate()}handleRulerToolActivate(){this.trendlineToolButton.deactivate()}handleHideDrawingsButtonActivate(){this.trendlineToolButton.deactivate()}}_t=new WeakSet,Ac=function(){this.trendlineToolButton=new Mc({onActivate:this.handleTrendlineToolActivate.bind(this)}),this.rulerToolButton=new uc({onActivate:this.handleRulerToolActivate.bind(this)}),this.hideDrawingsButton=new rc({onActivate:this.handleHideDrawingsButtonActivate.bind(this)})},Lc=function(){this.element=E.htmlToElement(ug,[vc,ec,this.trendlineToolButton,this.rulerToolButton,this.hideDrawingsButton,Ja],cg)},Bc=function(){document.addEventListener("keydown",d(this,_t,Oc).bind(this))},Oc=function(e){e.key==="Escape"&&(this.trendlineToolButton.deactivate(),this.rulerToolButton.deactivate())},T(Nc,"componentName","Toolbox");class Vc extends k{render(){return this.element=E.htmlToElement(ou,[Nc,Ha,so],hu),this.element}}T(Vc,"componentName","Layout");const Sg=`<div class="notification" data-ref="notification">\r
	<div class="content" data-field="content"></div>\r
</div>\r
`;class Pc extends k{render(){return this.element=E.htmlToElement(Sg,[],ms),this.element}}T(Pc,"componentName","Notification");class Cg{static async start(){try{const t=C("#app");this.renderNotificationShell(t),await this.initializeAppState(),this.startAutomationIfNeeded(),this.renderApp(t)}catch(t){this.handleFatalError(t)}}static renderNotificationShell(t){t.append(new Pc().render())}static async initializeAppState(){await su.initialize()}static renderApp(t){t.append(new Vc().render())}static startAutomationIfNeeded(){ah==="AUTOMATION"&&tu.start()}static handleFatalError(t){console.error("App initialization failed:",t),Qt.show("error","Не удалось запустить приложение")}}requestAnimationFrame(()=>{Cg.start()});
