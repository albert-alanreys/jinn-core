var Rg=Object.defineProperty;var Ia=r=>{throw TypeError(r)};var Lg=(r,t,e)=>t in r?Rg(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var N=(r,t,e)=>Lg(r,typeof t!="symbol"?t+"":t,e),Mh=(r,t,e)=>t.has(r)||Ia("Cannot "+e);var o=(r,t,e)=>(Mh(r,t,"read from private field"),e?e.call(r):t.get(r)),f=(r,t,e)=>t.has(r)?Ia("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),g=(r,t,e,i)=>(Mh(r,t,"write to private field"),i?i.call(r,e):t.set(r,e),e),a=(r,t,e)=>(Mh(r,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();class wn{constructor(t){if(typeof t=="string"){if(this.element=document.querySelector(t),!this.element)throw new Error(`No element found for the selector: "${t}"`)}else if(t instanceof Element||t instanceof Document)this.element=t;else throw new Error("The selector must be a string, HTMLElement, or Document")}find(t){const e=new wn(this.element.querySelector(t));if(e)return e;throw new Error(`No element found for the selector: "${t}"`)}findAll(t){const e=this.element.querySelectorAll(t);return Array.from(e).map(i=>new wn(i))}closest(t){const e=this.element.closest(t);return e?new wn(e):null}append(t){if(!(t instanceof HTMLElement))throw new Error("The provided childElement must be an instance of HTMLElement");return this.element.appendChild(t),this}prepend(t){if(!(t instanceof HTMLElement))throw new Error("The provided childElement must be an instance of HTMLElement");const e=this.element.firstChild;return e?this.element.insertBefore(t,e):this.element.appendChild(t),this}before(t){if(!(t instanceof HTMLElement))throw new Error("The provided newElement must be an instance of HTMLElement");const e=this.element.parentElement;if(!e)throw new Error("The current element does not have a parent element");return e.insertBefore(t,this.element),this}html(t){return typeof t>"u"?this.element.innerHTML:(this.element.innerHTML=t,this)}text(t){return typeof t>"u"?this.element.textContent:(this.element.textContent=t,this)}click(t){return this.element.addEventListener("click",t),this}on(t,e){if(typeof t!="string"||typeof e!="function")throw new Error("eventType must be a string and callback must be a function");return this.element.addEventListener(t,e),this}off(t,e){if(typeof t!="string")throw new Error("eventType must be a string");if(e)this.element.removeEventListener(t,e);else if(this.element instanceof Document){const i=()=>{};this.element.addEventListener(t,i),this.element.removeEventListener(t,i)}else{const i=this.element.cloneNode(!0);this.element.parentNode.replaceChild(i,this.element),this.element=i}return this}trigger(t,e={},i={}){if(typeof t!="string")throw new Error("Event name must be a string");const s=new CustomEvent(t,{detail:e,bubbles:i.bubbles??!0,cancelable:i.cancelable??!0,composed:i.composed??!1});return this.element.dispatchEvent(s)}input({onInput:t,...e}){if(this.element.tagName.toLowerCase()!=="input")throw new Error("Element must be an input");for(const[i,s]of Object.entries(e))this.element.setAttribute(i,s);return t&&this.element.addEventListener("input",t),this}css(t,e){if(typeof t=="string"&&typeof e>"u")return window.getComputedStyle(this.element).getPropertyValue(t);if(typeof t=="object")for(const[i,s]of Object.entries(t))this.element.style[i]=s;else if(typeof t=="string"&&e)this.element.style[t]=e;else throw new Error("Invalid arguments");return this}cursor(t){return this.element===document?document.body.style.cursor=t:this.element.style.cursor=t,this}addClass(t){if(Array.isArray(t))for(const e of t)this.element.classList.add(e);else if(typeof t=="string")this.element.classList.add(t);else throw new Error('The "classNames" parameter must be a string or an array of strings');return this}removeClass(t){if(Array.isArray(t))for(const e of t)this.element.classList.remove(e);else this.element.classList.remove(t);return this}hasClass(t){if(typeof t!="string")throw new Error("Class name must be a string");return this.element.classList.contains(t)}attr(t,e){if(typeof t!="string")throw new Error("Attribute name must be a string");return typeof e>"u"?this.element.getAttribute(t):(this.element.setAttribute(t,e),this)}data(t,e){if(typeof t!="string")throw new Error("Key must be a string");const i=`data-${t}`;return typeof e>"u"?this.element.getAttribute(i):(this.element.setAttribute(i,e),this)}is(t){if(typeof t!="string")throw new Error("Attribute name must be a string");const e=this.element.getAttribute(t);return e!==null&&e!=="false"}removeAttr(t){if(typeof t!="string")throw new Error("attrName must be a string");return this.element.removeAttribute(t),this}}const C=r=>new wn(r);var jr,Ll;class Dg{constructor(){f(this,jr);this.state={},this.subscribers=new Map}set(t,e){this.state[t]=e,a(this,jr,Ll).call(this,t,e)}get(t){return this.state[t]}subscribe(t,e){this.subscribers.has(t)||this.subscribers.set(t,new Set),this.subscribers.get(t).add(e)}unsubscribe(t,e){if(this.subscribers.has(t)){const i=this.subscribers.get(t);i.delete(e),i.size===0&&this.subscribers.delete(t)}}}jr=new WeakSet,Ll=function(t,e){var i;(i=this.subscribers.get(t))==null||i.forEach(s=>s(e))};const w=new Dg;var hi,rn;class $g{constructor(){f(this,hi)}getItem(t){if(!a(this,hi,rn).call(this))return console.warn("localStorage is not available."),null;const e=localStorage.getItem(t);if(e===null)return null;try{return JSON.parse(e)}catch(i){return console.error(`Failed to parse localStorage item: "${t}"`,i),null}}setItem(t,e){if(!a(this,hi,rn).call(this)){console.warn("localStorage is not available.");return}localStorage.setItem(t,JSON.stringify(e))}removeItem(t){if(!a(this,hi,rn).call(this)){console.warn("localStorage is not available.");return}localStorage.removeItem(t)}clear(){if(!a(this,hi,rn).call(this)){console.warn("localStorage is not available.");return}localStorage.clear()}}hi=new WeakSet,rn=function(){try{const t="__test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch{return!1}};const G=new $g,_={CANDLE_SERIES:"candleSeries",CHART_API:"chartApi",SELECTED_TIME:"selectedTime",RULER_ACTIVE:"rulerActive",RULER_TOOL:"rulerTool",STRATEGIES:"strategies",EXCHANGES:"exchanges",INTERVALS:"intervals",EXECUTION_CONTEXTS:"executionContexts",EXECUTION_CONTEXT:"executionContext",EXECUTION_ALERTS:"executionAlerts",OPTIMIZATION_CONTEXTS:"optimizationContexts",THEME:"theme"},j={OPTIMIZATION_CONFIGS:"optimizationConfigs",BACKTESTING_CONFIGS:"backtestingConfigs",TRADING_CONFIGS:"tradingConfigs",DRAWINGS:"drawings",THEME:"theme"};function Dl(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Expected a plain object");return Object.fromEntries(Object.entries(r).map(([t,e])=>[t.replace(/[A-Z]/g,i=>`_${i.toLowerCase()}`),e]))}const zg=typeof window.SERVER_URL=="string"&&!window.SERVER_URL.startsWith("{")?window.SERVER_URL:void 0;function Oa(r){if(typeof r=="string")return r;if(r!=null&&r.message){if(typeof r.message=="string")return r.message;if(Array.isArray(r.message))return r.message[0]}return r!=null&&r.type?r.type:typeof r=="object"?JSON.stringify(r):"Unknown error occurred"}async function Bg({path:r,method:t="GET",body:e=null,headers:i={}}){let s=!0,n=null,h=null;const l=`${zg}${r}`,c={method:t,headers:{"Content-Type":"application/json",...i}};e&&(c.body=JSON.stringify(e));try{const u=await fetch(l,c);if(u.ok)h=await u.json();else{const d=await u.json();n=Oa(d)}}catch(u){n=Oa(u)}finally{s=!1}return{isLoading:s,data:h,error:n}}const Fg="_notification_1wo9y_1",Vg="_visible_1wo9y_25",Yg="_content_1wo9y_33",Hg="_info_1wo9y_51",Ug="_success_1wo9y_59",Xg="_warning_1wo9y_67",Wg="_error_1wo9y_75",Lr={notification:Fg,"slide-up-fade":"_slide-up-fade_1wo9y_1",visible:Vg,content:Yg,info:Hg,success:Ug,warning:Xg,error:Wg};var ns,oi,Ln,Uh;class qg{constructor(){f(this,Ln);f(this,ns,[]);f(this,oi,!1)}show(t,e){if(!["info","success","warning","error"].includes(t))throw new Error('Invalid notification type: expected "success" or "error"');o(this,ns).push({type:t,message:e}),o(this,oi)||a(this,Ln,Uh).call(this)}}ns=new WeakMap,oi=new WeakMap,Ln=new WeakSet,Uh=function(){if(!o(this,ns).length||o(this,oi))return;const t=C('[data-ref="notification"]'),{type:e,message:i}=o(this,ns).shift(),s=Lr[e],n=parseFloat(t.css("animation-duration"))*1e3,h=n+100,l=n+500;t.find('[data-field="content"]').text(i),t.addClass(Lr.visible),t.addClass(s),g(this,oi,!0),setTimeout(()=>{t.removeClass(Lr.visible),t.removeClass(s),g(this,oi,!1)},h),setTimeout(()=>{a(this,Ln,Uh).call(this)},l)};const H=new qg;var Zr,Vs,$l,zl;class js{constructor(){f(this,Vs);f(this,Zr,"/api")}async _executeRequest({path:t,method:e,body:i,queryParams:s,errorMessage:n}){try{const{data:h,error:l}=await Bg({path:a(this,Vs,$l).call(this,t,s),method:e,body:i});if(l)throw new Error(l);return h}catch(h){throw a(this,Vs,zl).call(this,n),h}}_validateRequired(t,e){const i=Object.entries(t).filter(([s,n])=>!n).map(([s])=>s);if(i.length)throw new Error(e||`Missing required parameters: ${i.join(", ")}`)}}Zr=new WeakMap,Vs=new WeakSet,$l=function(t,e){let i=`${o(this,Zr)}${t}`;if(e){const s=new URLSearchParams;Object.entries(e).forEach(([n,h])=>{h!=null&&s.append(n,h.toString())}),i+=`?${s.toString()}`}return i},zl=function(t){try{t&&H.show("error",t)}catch(e){console.error("Notification display failed:",e)}};class Gg extends js{async getAll(){return this._executeRequest({path:"/contexts/execution",method:"GET",errorMessage:"Failed to load execution contexts"})}async get(t,e){this._validateRequired({contextId:t},"contextId is required");const i=e?Dl({updatedAfter:e}):void 0;return this._executeRequest({path:`/contexts/execution/${t}`,method:"GET",queryParams:i,errorMessage:"Failed to load execution context data"})}async add(t){return this._validateRequired({configs:t},"configs is required"),this._executeRequest({path:"/contexts/execution",method:"POST",body:t,errorMessage:"Failed to add execution contexts"})}async update(t,e,i){return this._validateRequired({contextId:t,param:e},"contextId and param are required"),this._executeRequest({path:`/contexts/execution/${t}`,method:"PATCH",body:{param:e,value:i},errorMessage:"Failed to update execution context parameter"})}async delete(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/contexts/execution/${t}`,method:"DELETE",errorMessage:"Failed to delete execution context"})}async getAllStatuses(){return this._executeRequest({path:"/contexts/execution/status",method:"GET",errorMessage:"Failed to load execution contexts statuses"})}async getStatus(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/contexts/execution/${t}/status`,method:"GET",errorMessage:"Failed to load execution context status"})}}const St=new Gg;var rs,Ht,se,Xh,Wh,Bl;class jg{constructor(){f(this,se);f(this,rs,!0);f(this,Ht,[])}get isVisible(){return o(this,rs)}async init(){const t=await St.getAllStatuses(),e=Object.entries(t).filter(([s,n])=>n==="READY").map(([s])=>s);this.getTypes().forEach(s=>{a(this,se,Bl).call(this,e,s)})}show(){o(this,Ht).length&&(o(this,Ht).forEach(t=>{t.applyOptions({visible:!0})}),g(this,rs,!0))}hide(){o(this,Ht).length&&(o(this,Ht).forEach(t=>{t.applyOptions({visible:!1})}),g(this,rs,!1))}get(t){var s;const e=a(this,se,Xh).call(this);return e?((s=(G.getItem(j.DRAWINGS)||{})[t])==null?void 0:s[e])||[]:[]}add(t,e){const i=this.get(t);this.set(t,[e,...i])}set(t,e){const i=a(this,se,Xh).call(this);if(!i)return;const s=G.getItem(j.DRAWINGS)||{};s[t]||(s[t]={}),s[t][i]=e,G.setItem(j.DRAWINGS,s)}clear(t=null){t?this.set(t,[]):this.getTypes().forEach(i=>this.set(i,[]))}getTypes(){const t=G.getItem(j.DRAWINGS)||{};return Object.keys(t)}renderSeries(t,e,i){const s=a(this,se,Wh).call(this);if(!s)return;const n=s.addSeries(t,e);n.setData(i),o(this,Ht).push(n)}removeAll(){const t=a(this,se,Wh).call(this);t&&(o(this,Ht).forEach(e=>t.removeSeries(e)),g(this,Ht,[]))}}rs=new WeakMap,Ht=new WeakMap,se=new WeakSet,Xh=function(){return w.get(_.EXECUTION_CONTEXT).id||null},Wh=function(){return w.get(_.CHART_API)||null},Bl=function(t,e){const i=G.getItem(j.DRAWINGS)||{},s=i[e]||{},n=Object.fromEntries(Object.entries(s).filter(([h])=>t.includes(h)));G.setItem(j.DRAWINGS,{...i,[e]:n})};const Nt=new jg;var Qr,ai,Dn,$n,xe,Hi;class Zg{constructor(){f(this,xe);f(this,Qr,"data-theme");f(this,ai,"light");f(this,Dn,"dark");f(this,$n,"auto")}get LIGHT(){return o(this,ai)}get DARK(){return o(this,Dn)}get AUTO(){return o(this,$n)}init(){const t=G.getItem(j.THEME)||o(this,ai);return a(this,xe,Hi).call(this,t),t}toggle(){const e=this.get()===this.LIGHT?this.DARK:this.LIGHT;return a(this,xe,Hi).call(this,e),e}get(){return w.get(_.THEME)||o(this,ai)}setLightTheme(){a(this,xe,Hi).call(this,o(this,ai))}setDarkTheme(){a(this,xe,Hi).call(this,o(this,Dn))}setAutoTheme(){a(this,xe,Hi).call(this,o(this,$n))}}Qr=new WeakMap,ai=new WeakMap,Dn=new WeakMap,$n=new WeakMap,xe=new WeakSet,Hi=function(t){document.documentElement.setAttribute(o(this,Qr),t),G.setItem(j.THEME,t),w.set(_.THEME,t)};const Dr=new Zg,Qg=100,Pa={status:{filled:"green",pending:"gray",cancelled:"red"},side:{buy:"green",sell:"red"}},Fl=1e3,qh=5e3;class Kg extends js{async get({limit:t,sinceId:e}={}){e&&this._validateRequired({sinceId:e},"sinceId is required");const i={};t&&(i.limit=t),e&&(i.sinceId=e);const s=Object.keys(i).length?Dl(i):void 0;return this._executeRequest({path:"/alerts",method:"GET",queryParams:s,errorMessage:"Failed to load alerts"})}async delete(t){return this._validateRequired({alertId:t},"alertId is required"),this._executeRequest({path:`/alerts/${t}`,method:"DELETE",errorMessage:"Failed to delete alert"})}}const Gh=new Kg;var Te,Se,nt,jh,Zh,Vl,Qh,Yl,Kh;class Jg{constructor(){f(this,nt);f(this,Te,null);f(this,Se,null)}init(){w.subscribe(_.EXECUTION_CONTEXT,a(this,nt,jh).bind(this)),w.subscribe(_.EXECUTION_CONTEXTS,a(this,nt,Zh).bind(this)),a(this,nt,jh).call(this,w.get(_.EXECUTION_CONTEXT)),a(this,nt,Zh).call(this,w.get(_.EXECUTION_CONTEXTS))}}Te=new WeakMap,Se=new WeakMap,nt=new WeakSet,jh=function(t){if(!t||!Object.keys(t).length){a(this,nt,Qh).call(this);return}t.isLive?a(this,nt,Vl).call(this):a(this,nt,Qh).call(this)},Zh=function(t){if(!t||!Object.keys(t).length){a(this,nt,Kh).call(this);return}Object.values(t).some(i=>i==null?void 0:i.isLive)?a(this,nt,Yl).call(this):a(this,nt,Kh).call(this)},Vl=function(){o(this,Te)===null&&g(this,Te,setInterval(async()=>{try{const t=w.get(_.CANDLE_SERIES),e=w.get(_.EXECUTION_CONTEXT);if(!e.id||!t)return;const i=await St.get(e.id,t.data().at(-1).time*1e3);if(Object.keys(i).length){const[[s,n]]=Object.entries(i);w.set(_.EXECUTION_CONTEXT,{id:s,...n})}}catch(t){console.error("Failed to fetch updated context.",t)}},qh))},Qh=function(){o(this,Te)!==null&&(clearInterval(o(this,Te)),g(this,Te,null))},Yl=function(){o(this,Se)===null&&g(this,Se,setInterval(async()=>{try{const t=w.get(_.EXECUTION_ALERTS)||[],e=t.length?t.at(-1).alertId:null,i=e?await Gh.get({sinceId:e}):await Gh.get({limit:Qg});i.length&&w.set(_.EXECUTION_ALERTS,i)}catch(t){console.error("Failed to fetch alerts.",t)}},qh))},Kh=function(){o(this,Se)!==null&&(clearInterval(o(this,Se)),g(this,Se,null))};const tv=new Jg;class O{render(){throw new Error("Render method must be implemented in the child class")}}var Ys,Hl,Ul;class ev{constructor(){f(this,Ys)}htmlToElement(t,e=[],i=null){const h=new DOMParser().parseFromString(t,"text/html").body.firstElementChild;return i&&a(this,Ys,Ul).call(this,h,i),a(this,Ys,Hl).call(this,h,e),h}}Ys=new WeakSet,Hl=function(t,e){const i=new Map,s=t.querySelectorAll("*");e.map(h=>h instanceof O?h:new h).forEach(h=>{const l=h.constructor.COMPONENT_NAME.toLowerCase();i.set(l,h)}),s.forEach(h=>{const c=h.tagName.toLowerCase().replace(/^component-/,"").replace(/-/g,""),u=i.get(c);if(u){const d=u.render();h.replaceWith(d)}})},Ul=function(t,e){if(!t||!e)return;const i=t.querySelectorAll("[class]");[t,...i].forEach(s=>{for(const[n,h]of Object.entries(e))s.classList.contains(n)&&s.classList.replace(n,h)})};const P=new ev,iv="_app_od8n2_1",sv={app:iv},nv=`<div class="app">\r
	<component-toolbox></component-toolbox>\r
	<component-dashboard></component-dashboard>\r
	<component-controller></component-controller>\r
	<component-notification></component-notification>\r
</div>\r
`,rv="_controller_1qyyi_1",hv={controller:rv},ov=`<div class="controller">\r
	<component-controller-content></component-controller-content>\r
	<component-controller-sidebar></component-controller-sidebar>\r
</div>\r
`,av={"controller-content":"_controller-content_1r5el_1"},lv=`<div class="controller-content">\r
	<component-strategies-tab></component-strategies-tab>\r
	<component-params-tab></component-params-tab>\r
	<component-alerts-tab></component-alerts-tab>\r
	<component-optimization-tab></component-optimization-tab>\r
	<component-backtesting-tab></component-backtesting-tab>\r
	<component-trading-tab></component-trading-tab>\r
	<component-theme></component-theme>\r
</div>\r
`,cv="_header_11wty_13",uv="_items_11wty_33",dv={"alerts-tab":"_alerts-tab_11wty_1",header:cv,items:uv},fv=`<div class="alerts-tab">\r
	<div class="header"><span>Live Trading Alerts</span></div>\r
	<div class="items" data-ref="alertsItems"></div>\r
</div>\r
`,pv={"delete-button":"_delete-button_5orrh_1"},mv=`<button class="delete-button" data-ref="deleteButton" title="">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 18 18"\r
		width="18"\r
		height="18"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M12 4h3v1h-1.04l-.88 9.64a1.5 1.5 0 0 1-1.5 1.36H6.42a1.5 1.5 0 0 1-1.5-1.36L4.05 5H3V4h3v-.5C6 2.67 6.67 2 7.5 2h3c.83 0 1.5.67 1.5 1.5V4ZM7.5 3a.5.5 0 0 0-.5.5V4h4v-.5a.5.5 0 0 0-.5-.5h-3ZM5.05 5l.87 9.55a.5.5 0 0 0 .5.45h5.17a.5.5 0 0 0 .5-.45L12.94 5h-7.9Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var zn;class Zs extends O{constructor({title:e}){super();f(this,zn);g(this,zn,e)}render(){return this.element=P.htmlToElement(mv,[],pv),C(this.element).attr("title",o(this,zn)),this.element}}zn=new WeakMap,N(Zs,"COMPONENT_NAME","DeleteButton");const gv={"open-button":"_open-button_174e9_1"},vv=`<button class="open-button" data-ref="openButton" title="">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
		fill="none"\r
	>\r
		<path\r
			fill="currentColor"\r
			fill-rule="evenodd"\r
			clip-rule="evenodd"\r
			d="M14 9.5a.5.5 0 0 0 1 0V7.02A6.5 6.5 0 0 1 20.98 13H18.5a.5.5 0 0 0 0 1h2.48A6.5 6.5 0 0 1 15 19.98V17.5a.5.5 0 0 0-1 0v2.48A6.5 6.5 0 0 1 8.02 14h2.48a.5.5 0 0 0 0-1H8.02A6.5 6.5 0 0 1 14 7.02V9.5zm1-3.48V4.5a.5.5 0 0 0-1 0v1.52A7.5 7.5 0 0 0 7.02 13H5.5a.5.5 0 0 0 0 1h1.52A7.5 7.5 0 0 0 14 20.98v1.52a.5.5 0 0 0 1 0v-1.52A7.5 7.5 0 0 0 21.98 14h1.52a.5.5 0 0 0 0-1h-1.52A7.5 7.5 0 0 0 15 6.02z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Bn;class ih extends O{constructor({title:e}){super();f(this,Bn);g(this,Bn,e)}render(){return this.element=P.htmlToElement(vv,[],gv),C(this.element).attr("title",o(this,Bn)),this.element}}Bn=new WeakMap,N(ih,"COMPONENT_NAME","OpenButton");const bv="_header_16bdh_11",wv="_details_16bdh_119",_v="_red_16bdh_145",yv="_green_16bdh_153",Ev="_gray_16bdh_161",ka={"alerts-item":"_alerts-item_16bdh_1",header:bv,"meta-info":"_meta-info_16bdh_29","strategy-name":"_strategy-name_16bdh_47","date-time":"_date-time_16bdh_59",details:wv,"field-row":"_field-row_16bdh_129",red:_v,green:yv,gray:Ev},Mv=`<div\r
	class="alerts-item"\r
	data-active="false"\r
	data-context-id=""\r
	data-alert-id=""\r
>\r
	<div class="header">\r
		<div class="meta-info">\r
			<span class="strategy-name" data-field="strategy"></span>\r
			<span class="date-time" data-field="time"></span>\r
		</div>\r
		<open-button></open-button>\r
		<delete-button></delete-button>\r
	</div>\r
	<div class="details">\r
		<div class="field-row">\r
			<span>Exchange</span><span data-field="exchange"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Type</span><span data-field="type"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Status</span><span data-field="status"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Side</span><span data-field="side"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Symbol</span><span data-field="symbol"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Quantity</span><span data-field="qty"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Price</span><span data-field="price"></span>\r
		</div>\r
	</div>\r
</div>\r
`;var li,Fn,Hs,Wl,ql;class Xl extends O{constructor(){super(...arguments);f(this,Hs);f(this,li,null);f(this,Fn,new Map)}render(){return a(this,Hs,Wl).call(this),a(this,Hs,ql).call(this),this.element}update(e){o(this,Fn).forEach((i,s)=>{o(this,li).data("context-id",e.contextId),o(this,li).data("alert-id",e.alertId);const n=e[s];if(i.text(n),Pa[s]){const h=ka[Pa[s][n]];h&&i.addClass(h)}})}remove(){this.element.remove()}}li=new WeakMap,Fn=new WeakMap,Hs=new WeakSet,Wl=function(){this.element=P.htmlToElement(Mv,[new ih({title:"Open Strategy"}),new Zs({title:"Delete Alert"})],ka),g(this,li,C(this.element))},ql=function(){o(this,li).findAll("[data-field]").forEach(e=>{const i=e.data("field");o(this,Fn).set(i,e)})},N(Xl,"COMPONENT_NAME","AlertsItem");var de,Vn,ci,Q,jl,Zl,Ql,Kl,Jl,tc,ec,Jh,ic;class Gl extends O{constructor(){super(...arguments);f(this,Q);f(this,de,null);f(this,Vn,null);f(this,ci,new Map)}get isActive(){return o(this,de).css("display")==="flex"}render(){return a(this,Q,jl).call(this),a(this,Q,Zl).call(this),this.element}show(){o(this,de).css("display","flex")}hide(){o(this,de).css("display","none")}}de=new WeakMap,Vn=new WeakMap,ci=new WeakMap,Q=new WeakSet,jl=function(){this.element=P.htmlToElement(fv,[],dv),g(this,de,C(this.element)),g(this,Vn,o(this,de).find('[data-ref="alertsItems"]'))},Zl=function(){a(this,Q,Ql).call(this),a(this,Q,Kl).call(this)},Ql=function(){(w.get(_.EXECUTION_ALERTS)||[]).forEach(i=>{a(this,Q,Jh).call(this,i.alertId,i)})},Kl=function(){o(this,de).click(a(this,Q,Jl).bind(this)),w.subscribe(_.EXECUTION_ALERTS,a(this,Q,ec).bind(this))},Jl=function(e){const i=C(e.target),s=i.closest("[data-alert-id]");if(!s)return;if(i.closest('[data-ref="openButton"]')){a(this,Q,tc).call(this,s.data("context-id"));return}if(i.closest('[data-ref="deleteButton"]')){a(this,Q,ic).call(this,s.data("alert-id"));return}const n=s.is("data-active");s.data("active",String(!n))},tc=function(e){const i=w.get(_.EXECUTION_CONTEXTS);if(!i[e]||w.get(_.EXECUTION_CONTEXT).id===e)return;const n=i[e];w.set(_.EXECUTION_CONTEXT,{id:e,...n})},ec=function(e){e.length&&e.forEach(i=>{o(this,ci).has(i.alertId)||a(this,Q,Jh).call(this,i.alertId,i)})},Jh=function(e,i){const s=new Xl;o(this,Vn).prepend(s.render()),o(this,ci).set(e,s),s.update(i)},ic=async function(e){try{await Gh.delete(e);const s=(w.get(_.EXECUTION_ALERTS)||[]).filter(h=>h.alertId!==e);w.set(_.EXECUTION_ALERTS,s);const n=o(this,ci).get(e);n&&(n.remove(),o(this,ci).delete(e))}catch(i){console.error("Failed to delete alert.",i)}},N(Gl,"COMPONENT_NAME","AlertsTab");const Cv={"add-config-button":"_add-config-button_ljgtp_1"},xv=`<button\r
	class="add-config-button"\r
	title="Add New Setting"\r
	data-ref="addConfigButton"\r
>\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M13.5 6a8.5 8.5 0 1 0 0 17 8.5 8.5 0 0 0 0-17zM4 14.5a9.5 9.5 0 1 1 19 0 9.5 9.5 0 0 1-19 0z"\r
		></path>\r
		<path fill="currentColor" d="M9 14h4v-4h1v4h4v1h-4v4h-1v-4H9v-1z"></path>\r
	</svg>\r
</button>\r
`;class sh extends O{render(){return this.element=P.htmlToElement(xv,[],Cv),this.element}}N(sh,"COMPONENT_NAME","AddConfigButton");const Tv={"clone-configs-button":"_clone-configs-button_18bpk_1"},Sv=`<button\r
	class="clone-configs-button"\r
	title="Clone All Settings"\r
	data-ref="cloneConfigsButton"\r
>\r
	<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
		<g fill="none" fill-rule="evenodd" stroke="currentColor">\r
			<path\r
				d="M13.111 18.5H10.5a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1h11a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1h-8.389z"\r
			></path>\r
			<path\r
				d="M18.5 20v1.5a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1H8"\r
			></path>\r
		</g>\r
	</svg>\r
</button>\r
`;class nh extends O{render(){return this.element=P.htmlToElement(Sv,[],Tv),this.element}}N(nh,"COMPONENT_NAME","CloneConfigsButton");const Nv={"delete-configs-button":"_delete-configs-button_ufjy9_1"},Iv=`<button\r
	class="delete-configs-button"\r
	title="Delete All Settings"\r
	data-ref="deleteConfigsButton"\r
>\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M18 7h5v1h-2.01l-1.33 14.64a1.5 1.5 0 0 1-1.5 1.36H9.84a1.5 1.5 0 0 1-1.49-1.36L7.01 8H5V7h5V6c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v1Zm-6-2a1 1 0 0 0-1 1v1h6V6a1 1 0 0 0-1-1h-4ZM8.02 8l1.32 14.54a.5.5 0 0 0 .5.46h8.33a.5.5 0 0 0 .5-.46L19.99 8H8.02Z"\r
		></path>\r
	</svg>\r
</button>\r
`;class rh extends O{render(){return this.element=P.htmlToElement(Iv,[],Nv),this.element}}N(rh,"COMPONENT_NAME","DeleteConfigsButton");const Ov={"export-configs-button":"_export-configs-button_17896_1"},Pv=`<button\r
	class="export-configs-button"\r
	title="Export All Settings"\r
	data-ref="exportConfigsButton"\r
>\r
	<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none">\r
		<path\r
			stroke="currentColor"\r
			d="M6.5 16v4.5a1 1 0 001 1h14a1 1 0 001-1V16M14.5 5V17m-4-3.5l4 4l4-4"\r
		></path>\r
	</svg>\r
</button>\r
`;class hh extends O{render(){return this.element=P.htmlToElement(Pv,[],Ov),this.element}}N(hh,"COMPONENT_NAME","ExportConfigsButton");const kv={"import-configs-button":"_import-configs-button_1ldac_1"},Av=`<button\r
	class="import-configs-button"\r
	title="Import Settings"\r
	data-ref="importConfigsButton"\r
>\r
	<input type="file" accept=".json,.txt,.config" data-ref="fileInput" />\r
	<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none">\r
		<path\r
			stroke="currentColor"\r
			d="M21.5 12v-4.5a1 1 0 00-1-1h-14a1 1 0 00-1 1V12M13.5 23V11m4 3.5l-4-4-4 4"\r
		></path>\r
	</svg>\r
</button>\r
`;var Yn,hs;class oh extends O{constructor(){super(...arguments);f(this,Yn,null);f(this,hs,null)}render(){return this.element=P.htmlToElement(Av,[],kv),g(this,Yn,C(this.element)),g(this,hs,o(this,Yn).find('[data-ref="fileInput"]')),this.element}clickOnInput(){o(this,hs).element.click()}resetInput(){o(this,hs).element.value=""}}Yn=new WeakMap,hs=new WeakMap,N(oh,"COMPONENT_NAME","ImportConfigsButton");const Rv={"run-configs-button":"_run-configs-button_ltwyy_1"},Lv=`<button\r
	class="run-configs-button"\r
	title="Run All Settings"\r
	data-ref="runConfigsButton"\r
>\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			fill-rule="evenodd"\r
			d="m10.997 6.93 7.834 6.628a.58.58 0 0 1 0 .88l-7.834 6.627c-.359.303-.897.04-.897-.44V7.37c0-.48.538-.743.897-.44Zm8.53 5.749a1.741 1.741 0 0 1 0 2.637l-7.834 6.628c-1.076.91-2.692.119-2.692-1.319V7.37c0-1.438 1.616-2.23 2.692-1.319l7.834 6.628Z"\r
		></path>\r
	</svg>\r
</button>\r
`;class ah extends O{render(){return this.element=P.htmlToElement(Lv,[],Rv),this.element}}N(ah,"COMPONENT_NAME","RunConfigsButton");const $={QUEUED:"QUEUED",CREATING:"CREATING",READY:"READY",FAILED:"FAILED"};function pa(r,t="configs.json"){if(!r||typeof r!="object"||Array.isArray(r))return console.warn("Export failed: Invalid configs object"),!1;try{const e=JSON.stringify(r,null,2),i=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(i),n=document.createElement("a");return n.href=s,n.download=t,n.style.display="none",document.body.appendChild(n),n.click(),setTimeout(()=>{document.body.removeChild(n),URL.revokeObjectURL(s)},100),!0}catch(e){return console.error("Failed to export configs:",e),!1}}function ma(r,t=[]){return!r||typeof r!="object"||Array.isArray(r)?!1:t.every(e=>e in r)}const Dv="_header_14ksy_13",$v="_items_14ksy_33",zv="_footer_14ksy_47",Bv={"backtesting-tab":"_backtesting-tab_14ksy_1",header:Dv,items:$v,footer:zv,"left-buttons":"_left-buttons_14ksy_65","right-buttons":"_right-buttons_14ksy_67"},Fv=`<div class="backtesting-tab">\r
	<div class="header"><span>Backtesting Settings</span></div>\r
	<div class="items" data-ref="configItems"></div>\r
	<div class="footer">\r
		<div class="left-buttons">\r
			<component-delete-configs-button></component-delete-configs-button>\r
			<component-import-configs-button></component-import-configs-button>\r
			<component-export-configs-button></component-export-configs-button>\r
		</div>\r
		<div class="right-buttons">\r
			<component-add-config-button></component-add-config-button>\r
			<component-clone-configs-button></component-clone-configs-button>\r
			<component-run-configs-button></component-run-configs-button>\r
		</div>\r
	</div>\r
</div>\r
`,Vv={"run-button":"_run-button_r4w3j_1"},Yv=`<button class="run-button" data-ref="runButton" title="">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 18 18"\r
		width="18"\r
		height="18"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M2 9a7 7 0 1 1 14 0A7 7 0 0 1 2 9zm7-8a8 8 0 1 0 0 16A8 8 0 0 0 9 1zM7.79 5.09A.5.5 0 0 0 7 5.5v7a.5.5 0 0 0 .79.41l5-3.5a.5.5 0 0 0 0-.82l-5-3.5zM11.63 9L8 11.54V6.46L11.63 9z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Hn;class lh extends O{constructor({title:e}){super();f(this,Hn);g(this,Hn,e)}render(){return this.element=P.htmlToElement(Yv,[],Vv),C(this.element).attr("title",o(this,Hn)),this.element}}Hn=new WeakMap,N(lh,"COMPONENT_NAME","RunButton");const Hv={"date-input":"_date-input_u2rdp_1"},Uv=`<div class="date-input" data-ref="dateInput">\r
	<input type="text" placeholder="yyyy-mm-dd" />\r
</div>\r
`;var Un,os,as,Xn,to;class On extends O{constructor(){super(...arguments);f(this,Xn);f(this,Un,null);f(this,os,null);f(this,as,"")}get value(){return o(this,os).element.value}render(){return this.element=P.htmlToElement(Uv,[],Hv),g(this,Un,C(this.element)),g(this,os,o(this,Un).find("input")),this.element}update(e){g(this,as,e),a(this,Xn,to).call(this)}isValid(){const e=this.value;if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;const s=new Date(e);return Number.isNaN(s.getTime())?!1:s.toISOString().slice(0,10)===e}commit(){g(this,as,this.value)}rollback(){a(this,Xn,to).call(this)}}Un=new WeakMap,os=new WeakMap,as=new WeakMap,Xn=new WeakSet,to=function(){o(this,os).element.value=o(this,as)},N(On,"COMPONENT_NAME","DateInput");const Xv="_trigger_j4xhq_11",Wv="_title_j4xhq_35",qv="_arrow_j4xhq_45",Gv="_options_j4xhq_89",jv={"select-input":"_select-input_j4xhq_1",trigger:Xv,title:Wv,arrow:qv,options:Gv},Zv=`<div class="select-input" data-ref="selectInput" data-active="false">\r
	<button type="button" class="trigger" data-ref="trigger">\r
		<span class="title" data-ref="value" data-value=""></span>\r
		<span class="arrow">\r
			<svg width="12" height="8" viewBox="0 0 12 8" fill="none">\r
				<path d="M6 8L0 0H12L6 8Z" fill="currentColor" />\r
			</svg>\r
		</span>\r
	</button>\r
	<ul class="options" data-ref="options"></ul>\r
</div>\r
`;var Ut,ls,cs,Ne,Ie,je,sc,nc,rc;class ee extends O{constructor({options:e=[]}={}){super();f(this,je);f(this,Ut,null);f(this,ls,null);f(this,cs,null);f(this,Ne,null);f(this,Ie);g(this,Ne,e)}get value(){return o(this,Ie)}get isActive(){return o(this,ls).data("active")}render(){return a(this,je,sc).call(this),a(this,je,rc).call(this),this.element}update(e){const i=o(this,Ne).find(s=>s===e);i&&(o(this,cs).data("value",i).text(i),g(this,Ie,e))}open(){o(this,Ut).data("active","true")}close(){o(this,Ut).data("active","false")}toggle(){const e=o(this,Ut).is("data-active");o(this,Ut).data("active",String(!e))}}Ut=new WeakMap,ls=new WeakMap,cs=new WeakMap,Ne=new WeakMap,Ie=new WeakMap,je=new WeakSet,sc=function(){this.element=P.htmlToElement(Zv,[],jv),g(this,Ut,C(this.element)),a(this,je,nc).call(this)},nc=function(){g(this,ls,o(this,Ut).find('[data-ref="options"]')),g(this,cs,o(this,Ut).find('[data-ref="value"]'));const e=o(this,Ne).map(i=>`<li data-value="${i}" data-ref="option">${i}</li>`).join("");o(this,ls).html(e)},rc=function(){o(this,Ne).length&&(g(this,Ie,o(this,Ne)[0]),o(this,cs).data("value",o(this,Ie)).text(o(this,Ie)))},N(ee,"COMPONENT_NAME","SelectInput");const Qv={"text-input":"_text-input_ui3e0_1"},Kv=`<div class="text-input">\r
	<input type="text" />\r
</div>\r
`;var Wn,ui,us,ds,ye,hc,oc,eo;class ch extends O{constructor({placeholder:e=""}={}){super();f(this,ye);f(this,Wn,null);f(this,ui,null);f(this,us,"");f(this,ds,"");g(this,ds,e)}get value(){return o(this,ui).element.value}render(){return a(this,ye,hc).call(this),a(this,ye,oc).call(this),this.element}update(e){g(this,us,e),a(this,ye,eo).call(this)}commit(e){g(this,us,e)}rollback(){a(this,ye,eo).call(this)}}Wn=new WeakMap,ui=new WeakMap,us=new WeakMap,ds=new WeakMap,ye=new WeakSet,hc=function(){return this.element=P.htmlToElement(Kv,[],Qv),g(this,Wn,C(this.element)),g(this,ui,o(this,Wn).find("input")),this.element},oc=function(){o(this,ds)&&o(this,ui).attr("placeholder",o(this,ds))},eo=function(){o(this,ui).element.value=o(this,us)||""},N(ch,"COMPONENT_NAME","TextInput");const Jv={"checkbox-input":"_checkbox-input_1j5bz_1"},t0=`<div class="checkbox-input">\r
	<input type="checkbox" />\r
</div>\r
`;var qn,fs,ps,Gn,io;class ac extends O{constructor(){super(...arguments);f(this,Gn);f(this,qn,null);f(this,fs,null);f(this,ps)}get value(){return o(this,fs).element.checked}render(){return this.element=P.htmlToElement(t0,[],Jv),g(this,qn,C(this.element)),g(this,fs,o(this,qn).find("input")),this.element}update(e){g(this,ps,e),a(this,Gn,io).call(this)}commit(){g(this,ps,this.value)}rollback(){a(this,Gn,io).call(this)}}qn=new WeakMap,fs=new WeakMap,ps=new WeakMap,Gn=new WeakSet,io=function(){o(this,fs).element.checked=!!o(this,ps)},N(ac,"COMPONENT_NAME","CheckboxInput");function e0(r){if(r===0)return 1;const t=r.toString();if(!t.includes("."))return 1;const i=t.split(".")[1].length;return Math.pow(10,-i)}const i0={"number-input":"_number-input_6lw4c_1","number-stepper":"_number-stepper_6lw4c_63","stepper-up":"_stepper-up_6lw4c_85","stepper-down":"_stepper-down_6lw4c_87"},s0=`<div class="number-input">\r
	<input type="number" />\r
	<div class="number-stepper" data-ref="numberStepper">\r
		<button\r
			class="stepper-up"\r
			type="button"\r
			tabindex="-1"\r
			data-ref="stepperUp"\r
		>\r
			<svg width="12" height="8" viewBox="0 0 12 8" fill="none">\r
				<path d="M6 0L12 8H0L6 0Z" fill="currentColor" />\r
			</svg>\r
		</button>\r
		<button\r
			class="stepper-down"\r
			type="button"\r
			tabindex="-1"\r
			data-ref="stepperDown"\r
		>\r
			<svg width="12" height="8" viewBox="0 0 12 8" fill="none">\r
				<path d="M6 8L0 0H12L6 8Z" fill="currentColor" />\r
			</svg>\r
		</button>\r
	</div>\r
</div>\r
`;var di,_t,fi,dt,cc,uc,so,dc,fc,no;class lc extends O{constructor(){super(...arguments);f(this,dt);f(this,di,null);f(this,_t,null);f(this,fi)}get value(){return o(this,_t).element.valueAsNumber}render(){return a(this,dt,cc).call(this),a(this,dt,uc).call(this),this.element}update(e){g(this,fi,e),a(this,dt,so).call(this)}isValid(){return/^-?\d+(\.\d+)?$/.test(this.value)}commit(){g(this,fi,this.value)}rollback(){a(this,dt,so).call(this)}}di=new WeakMap,_t=new WeakMap,fi=new WeakMap,dt=new WeakSet,cc=function(){this.element=P.htmlToElement(s0,[],i0),g(this,di,C(this.element)),g(this,_t,o(this,di).find("input"))},uc=function(){o(this,di).find('[data-ref="stepperUp"]').click(a(this,dt,dc).bind(this)),o(this,di).find('[data-ref="stepperDown"]').click(a(this,dt,fc).bind(this))},so=function(){o(this,_t).attr("step",e0(o(this,fi))),o(this,_t).element.value=o(this,fi)},dc=function(e){e.preventDefault(),e.stopPropagation();const i=o(this,_t).element.valueAsNumber||0,s=parseFloat(o(this,_t).attr("step"))||1,n=i+s;o(this,_t).element.value=n,a(this,dt,no).call(this)},fc=function(e){e.preventDefault(),e.stopPropagation();const i=o(this,_t).element.valueAsNumber||0,s=parseFloat(o(this,_t).attr("step"))||1,n=i-s;o(this,_t).element.value=n,a(this,dt,no).call(this)},no=function(){const e=new Event("change",{bubbles:!0});o(this,_t).element.dispatchEvent(e)},N(lc,"COMPONENT_NAME","NumberInput");const n0={"params-item":"_params-item_1mcy3_1"},r0=`<div class="params-item">\r
	<span data-field="title"></span>\r
</div>\r
`;var ms,yt,Us,pc,mc;class uh extends O{constructor(){super(...arguments);f(this,Us);f(this,ms,null);f(this,yt,null)}get value(){var e;return((e=o(this,yt))==null?void 0:e.value)??null}render(){return a(this,Us,pc).call(this),this.element}update(e,i,s){o(this,ms).find('[data-field="title"]').text(s),a(this,Us,mc).call(this,e,i)}remove(){this.element.remove()}isValid(){var e,i;return((i=(e=o(this,yt))==null?void 0:e.isValid)==null?void 0:i.call(e))??!0}commit(){var e;(e=o(this,yt))==null||e.commit()}rollback(){var e;(e=o(this,yt))==null||e.rollback()}}ms=new WeakMap,yt=new WeakMap,Us=new WeakSet,pc=function(){return this.element=P.htmlToElement(r0,[],n0),g(this,ms,C(this.element)),this.element},mc=function(e,i){if(o(this,yt)&&(o(this,yt).remove(),g(this,yt,null)),typeof i=="number")g(this,yt,new lc);else if(typeof i=="boolean")g(this,yt,new ac);else return;const s=o(this,yt).render();o(this,ms).append(s),C(s).find("input").data("param-id",e),o(this,yt).update(i)},N(uh,"COMPONENT_NAME","ParamsItem");const h0={"config-item":"_config-item_892mi_1","config-header":"_config-header_892mi_9","config-info":"_config-info_892mi_29","strategy-name":"_strategy-name_892mi_47","strategy-meta":"_strategy-meta_892mi_59","config-actions":"_config-actions_892mi_73","config-content":"_config-content_892mi_101","config-property":"_config-property_892mi_111","config-params":"_config-params_892mi_129"},o0=`<div\r
	class="config-item"\r
	data-ref="configItem"\r
	data-active="false"\r
	data-config-id=""\r
	data-status=""\r
>\r
	<div class="config-header" data-ref="configHeader">\r
		<div class="config-info">\r
			<div class="strategy-name" data-field="strategy"></div>\r
			<div class="strategy-meta">\r
				<span data-field="symbol"></span> •\r
				<span data-field="interval"></span> •\r
				<span data-field="exchange"></span>\r
			</div>\r
		</div>\r
		<div class="config-actions">\r
			<run-button></run-button>\r
			<open-button></open-button>\r
			<delete-button></delete-button>\r
		</div>\r
	</div>\r
	<div class="config-content">\r
		<div class="config-property">\r
			<span class="label">Strategy</span>\r
			<span class="value" data-ref="strategyInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Symbol</span>\r
			<span class="value" data-ref="symbolInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Interval</span>\r
			<span class="value" data-ref="intervalInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Exchange</span>\r
			<span class="value" data-ref="exchangeInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Start</span>\r
			<span class="value" data-ref="startInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">End</span>\r
			<span class="value" data-ref="endInput" data-key=""></span>\r
		</div>\r
		<div class="config-params" data-ref="paramsItems"></div>\r
	</div>\r
</div>\r
`;var Oe,J,Lt,pi,jn,rt,gs,A,gc,vc,bc,wc,ro,ho,_c,hn,yc,Ec,$r,oo,Mc,ao,Cc,xc;let a0=(Oe=class extends O{constructor({configId:e}){super();f(this,A);f(this,J,null);f(this,Lt,null);f(this,pi,new Map);f(this,jn,new Map);f(this,rt,{strategy:void 0,symbol:void 0,interval:void 0,exchange:void 0,start:void 0,end:void 0,params:null});f(this,gs);g(this,gs,e)}get config(){return{...o(this,rt),params:{...o(this,rt).params}}}get configId(){return o(this,gs)}render(){return a(this,A,gc).call(this),a(this,A,vc).call(this),a(this,A,bc).call(this),this.element}update(e){g(this,rt,{...e,params:{...e.params||{}}}),a(this,A,_c).call(this),a(this,A,$r).call(this),a(this,A,hn).call(this)}remove(){a(this,A,oo).call(this),this.element.remove()}toggle(){const e=o(this,J).data("active")==="true";o(this,J).data("active",String(!e))}setProcessing(){o(this,J).data("status","processing")}setSuccess(){o(this,J).data("status","success")}setError(){o(this,J).data("status","error")}clearStatus(){o(this,J).data("status","")}handleChange(e){const i=a(this,A,ao).call(this,e),s=C(e.target).data("param-id");if(s){a(this,A,Mc).call(this,s,e);return}if(!i)return;const n=o(this,Lt)[i],h=n.value;a(this,A,Cc).call(this,i)?(n.commit(h),a(this,A,ho).call(this,i,h),a(this,A,hn).call(this)):n.rollback()}handleClick(e){if(!C(e.target).closest('[data-ref="selectInput"]')){a(this,A,xc).call(this);return}const s=a(this,A,ao).call(this,e),n=o(this,Lt)[s];if(!n)return;const h=C(e.target).closest("[data-ref]"),l=h.data("ref");if(l==="value"||l==="trigger"){n.toggle();return}if(l==="option"){const c=h.data("value");n.update(c),n.close(),a(this,A,ho).call(this,s,c),a(this,A,hn).call(this)}}},J=new WeakMap,Lt=new WeakMap,pi=new WeakMap,jn=new WeakMap,rt=new WeakMap,gs=new WeakMap,A=new WeakSet,gc=function(){const e={strategies:w.get(_.STRATEGIES),exchanges:w.get(_.EXCHANGES),intervals:w.get(_.INTERVALS)};g(this,Lt,{strategy:new ee({options:Object.keys(e.strategies)}),symbol:new ch({placeholder:Oe.DEFAULT_SYMBOL}),interval:new ee({options:e.intervals}),exchange:new ee({options:e.exchanges}),start:new On,end:new On})},vc=function(){this.element=P.htmlToElement(o0,[new lh({title:"Run Setting"}),new ih({title:"Open Strategy"}),new Zs({title:"Delete Setting"})],h0),g(this,J,C(this.element))},bc=function(){o(this,J).data("config-id",o(this,gs)),a(this,A,yc).call(this),a(this,A,Ec).call(this),a(this,A,wc).call(this),a(this,A,$r).call(this),a(this,A,hn).call(this)},wc=function(){Object.keys(o(this,rt)).forEach(e=>{var i;e!=="params"&&(o(this,rt)[e]=((i=o(this,Lt)[e])==null?void 0:i.value)??null)}),a(this,A,ro).call(this)},ro=function(){const e=o(this,rt).strategy;if(!e)return;const s=w.get(_.STRATEGIES)[e];s&&s.params?o(this,rt).params={...s.params}:o(this,rt).params={}},ho=function(e,i){o(this,rt)[e]=i??null,e==="strategy"&&(a(this,A,ro).call(this),a(this,A,$r).call(this))},_c=function(){Object.entries(o(this,rt)).forEach(([e,i])=>{if(e==="params")return;const s=o(this,Lt)[e];s&&i!==null&&s.update(i)})},hn=function(){o(this,jn).forEach((e,i)=>{const s=o(this,rt)[i];i==="symbol"&&(!s||s==="")?e.text("[No Symbol]"):s&&e.text(s)})},yc=function(){o(this,J).findAll("[data-field]").forEach(e=>{const i=e.data("field");o(this,jn).set(i,e)})},Ec=function(){const e={strategy:o(this,J).find('[data-ref="strategyInput"]'),symbol:o(this,J).find('[data-ref="symbolInput"]'),interval:o(this,J).find('[data-ref="intervalInput"]'),exchange:o(this,J).find('[data-ref="exchangeInput"]'),start:o(this,J).find('[data-ref="startInput"]'),end:o(this,J).find('[data-ref="endInput"]')};Object.entries(e).forEach(([i,s])=>{s.append(o(this,Lt)[i].render()),s.data("key",i)})},$r=function(){a(this,A,oo).call(this);const e=o(this,rt).params||{},s=w.get(_.STRATEGIES)[o(this,rt).strategy],n=(s==null?void 0:s.paramLabels)||{};if(Object.keys(e).length){const h=o(this,J).find('[data-ref="paramsItems"]');Object.entries(e).forEach(([l,c])=>{const u=new uh,d=u.render();h.append(d),u.update(l,c,n[l]||l),o(this,pi).set(l,u)})}},oo=function(){o(this,pi).forEach(e=>e.remove()),o(this,pi).clear()},Mc=function(e){const i=o(this,pi).get(e);if(i)if(i.isValid()){const s=i.value;o(this,rt).params[e]=s,i.commit()}else i.rollback()},ao=function(e){const i=C(e.target).closest("[data-key]");return(i==null?void 0:i.data("key"))??null},Cc=function(e){var i,s;return((s=(i=o(this,Lt)[e]).isValid)==null?void 0:s.call(i))??!0},xc=function(){["strategy","exchange","interval"].forEach(e=>{o(this,Lt)[e].close()})},N(Oe,"COMPONENT_NAME","ConfigItem"),N(Oe,"DEFAULT_SYMBOL","BTCUSDT"),Oe);var Xt,Zn,mi,ft,vs,fe,Pe,x,Tc,Sc,Nc,Ic,Oc,Pc,kc,Ac,co,Rc,Lc,Dc,$c,uo,zc,Bc,Fc,Vc,fo,on,Ui,po,Yc,Hc,Uc,Xi,Xc,Wc,an,Wi;const Mn=class Mn extends O{constructor(){super(...arguments);f(this,x);f(this,Xt,null);f(this,Zn,null);f(this,mi,null);f(this,ft,new Map);f(this,vs,new Set);f(this,fe,new Set);f(this,Pe)}get isActive(){return o(this,Xt).css("display")==="flex"}render(){return a(this,x,Tc).call(this),a(this,x,Sc).call(this),a(this,x,Nc).call(this),this.element}show(){o(this,Xt).css("display","flex")}hide(){o(this,Xt).css("display","none")}};Xt=new WeakMap,Zn=new WeakMap,mi=new WeakMap,ft=new WeakMap,vs=new WeakMap,fe=new WeakMap,Pe=new WeakMap,x=new WeakSet,Tc=function(){g(this,mi,{delete:new rh,import:new oh,export:new hh,add:new sh,clone:new nh,run:new ah})},Sc=function(){this.element=P.htmlToElement(Fv,Object.values(o(this,mi)),Bv),g(this,Xt,C(this.element)),g(this,Zn,o(this,Xt).find('[data-ref="configItems"]'))},Nc=async function(){a(this,x,Yc).call(this),a(this,x,Ic).call(this),await a(this,x,Fc).call(this)},Ic=function(){o(this,Xt).on("change",a(this,x,Oc).bind(this)),o(this,Xt).on("click",a(this,x,Pc).bind(this)),w.subscribe(_.EXECUTION_CONTEXTS,a(this,x,kc).bind(this)),w.subscribe(_.OPTIMIZATION_CONTEXTS,a(this,x,Ac).bind(this))},Oc=function(e){if(C(e.target).closest("[data-ref]").data("ref")==="fileInput"){a(this,x,Hc).call(this,e.target.files);return}const s=a(this,x,po).call(this,e);s&&(s.handleChange(e),a(this,x,Xi).call(this,s.configId,s.config))},Pc=async function(e){const i=C(e.target).closest("[data-ref]");if(!i)return;const s=i.data("ref");if(s==="configItems")return;const n={runConfigsButton:()=>a(this,x,co).call(this),cloneConfigsButton:()=>a(this,x,Rc).call(this),addConfigButton:()=>a(this,x,Lc).call(this),exportConfigsButton:()=>a(this,x,Dc).call(this),importConfigsButton:()=>a(this,x,$c).call(this),deleteConfigsButton:()=>a(this,x,uo).call(this)};if(n[s]){n[s]();return}const h=a(this,x,po).call(this,e);if(!h)return;const l={configHeader:()=>h.toggle(),runButton:()=>a(this,x,co).call(this,[h.configId]),openButton:()=>a(this,x,Bc).call(this,h.configId),deleteButton:()=>a(this,x,uo).call(this,[h.configId])};l[s]?l[s]():(h.handleClick(e),a(this,x,Xi).call(this,h.configId,h.config))},kc=function(e){Array.from(o(this,vs)).forEach(i=>{if(!(i in e)){const s=o(this,ft).get(i);s&&s.clearStatus(),o(this,vs).delete(i)}}),Object.entries(e).forEach(([i,s])=>{s.isLive||o(this,vs).add(i)})},Ac=function(e){const i=G.getItem(j.BACKTESTING_CONFIGS)||{};Object.values(e).forEach(s=>{s.params.forEach(n=>{const h=crypto.randomUUID(),l={...s,params:n};i[h]=l,a(this,x,Ui).call(this,h,l)})}),G.setItem(j.BACKTESTING_CONFIGS,i)},co=async function(e){const i=e||Array.from(o(this,ft).keys());if(!i.length)return;const s={};i.forEach(n=>s[n]=o(this,ft).get(n).config);try{const{added:n}=await St.add(s);n.forEach(h=>{a(this,x,an).call(this,h,$.QUEUED),o(this,fe).add(h)}),n.length&&a(this,x,fo).call(this)}catch(n){console.error("Failed to run configs.",n)}},Rc=function(){Array.from(o(this,ft).values()).forEach(i=>{const s=crypto.randomUUID(),n={...i.config};a(this,x,Ui).call(this,s,n),a(this,x,Xi).call(this,s,n)})},Lc=function(){const e=crypto.randomUUID(),i=a(this,x,Ui).call(this,e);a(this,x,Xi).call(this,e,i.config)},Dc=function(){const e=a(this,x,Wi).call(this);if(!e||!Object.keys(e).length){H.show("info","No configs available to export");return}const s=`backtesting-configs_${new Date().toISOString().split("T")[0]}.json`;pa(e,s),H.show("success","Settings exported successfully")},$c=function(){o(this,mi).import.clickOnInput()},uo=function(e){const i=e||Array.from(o(this,ft).keys());i.length&&i.forEach(s=>a(this,x,Wc).call(this,s))},zc=async function(e){try{const i=w.get(_.EXECUTION_CONTEXTS),s=await St.get(e),n={...i,...s};w.set(_.EXECUTION_CONTEXTS,n),a(this,x,an).call(this,e,$.READY)}catch(i){console.error(`Failed to handle ready context ${e}.`,i)}},Bc=function(e){const i=w.get(_.EXECUTION_CONTEXTS);if(!i[e]){H.show("warning","Strategy not created or was deleted");return}if(w.get(_.EXECUTION_CONTEXT).id===e)return;const n=i[e];w.set(_.EXECUTION_CONTEXT,{id:e,...n})},Fc=async function(){try{const e=await St.getAllStatuses();await Promise.all(Object.entries(e).map(async([s,n])=>{a(this,x,an).call(this,s,n)})),Object.values(e).some(s=>[$.QUEUED,$.CREATING].includes(s))&&a(this,x,fo).call(this)}catch(e){console.error("Failed to sync statuses.",e)}},Vc=async function(){try{if(!o(this,fe).size){a(this,x,on).call(this);return}for(const e of Array.from(o(this,fe))){const{status:i}=await St.getStatus(e);i===$.READY?(await a(this,x,zc).call(this,e),o(this,fe).delete(e)):i===$.FAILED&&(a(this,x,an).call(this,e,$.FAILED),o(this,fe).delete(e))}o(this,fe).size||a(this,x,on).call(this)}catch(e){console.error("Polling failed.",e),a(this,x,on).call(this)}},fo=function(){o(this,Pe)||g(this,Pe,setInterval(()=>a(this,x,Vc).call(this),Fl))},on=function(){o(this,Pe)&&(clearInterval(o(this,Pe)),g(this,Pe,void 0))},Ui=function(e,i){const s=new a0({configId:e});return o(this,Zn).append(s.render()),o(this,ft).set(e,s),i&&s.update(i),s},po=function(e){const i=C(e.target).closest('[data-ref="configItem"]');if(!i)return null;const s=i.data("config-id");return o(this,ft).get(s)},Yc=function(){const e=a(this,x,Wi).call(this);Object.entries(e).forEach(([i,s])=>{a(this,x,Ui).call(this,i,s)})},Hc=function(e){if(!e||!e.length)return;const i=e[0],s=new FileReader;s.onload=n=>{try{const h=JSON.parse(n.target.result);a(this,x,Uc).call(this,h),o(this,mi).import.resetInput(),H.show("success","Settings imported successfully")}catch{H.show("error","The file you selected is not a valid JSON settings file")}},s.readAsText(i)},Uc=function(e){if(!e||typeof e!="object")return;const i=a(this,x,Wi).call(this);Object.entries(e).forEach(([s,n])=>{if(!ma(n,Mn.REQUIRED_KEYS))return;const l={...i[s]||{},...n},c=o(this,ft).get(s);c?c.update(l):a(this,x,Ui).call(this,s,l),a(this,x,Xi).call(this,s,l)})},Xi=function(e,i){const s=a(this,x,Wi).call(this);s[e]=i,G.setItem(j.BACKTESTING_CONFIGS,s)},Xc=function(e){const i=a(this,x,Wi).call(this);delete i[e],G.setItem(j.BACKTESTING_CONFIGS,i)},Wc=async function(e){const i=o(this,ft).get(e);i&&(i.remove(),o(this,ft).delete(e),a(this,x,Xc).call(this,e),o(this,ft).size||a(this,x,on).call(this))},an=function(e,i){const s=o(this,ft).get(e);s&&(s.clearStatus(),[$.QUEUED,$.CREATING].includes(i)?s.setProcessing():i===$.READY?s.setSuccess():i===$.FAILED&&s.setError())},Wi=function(){return G.getItem(j.BACKTESTING_CONFIGS)||{}},N(Mn,"COMPONENT_NAME","BacktestingTab"),N(Mn,"REQUIRED_KEYS",["strategy","symbol","interval","exchange","params","start","end"]);let lo=Mn;class l0 extends js{async getAll(){return this._executeRequest({path:"/contexts/optimization",method:"GET",errorMessage:"Failed to load optimization contexts"})}async get(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/contexts/optimization/${t}`,method:"GET",errorMessage:"Failed to load optimization context data"})}async add(t){return this._validateRequired({configs:t},"configs is required"),this._executeRequest({path:"/contexts/optimization",method:"POST",body:t,errorMessage:"Failed to add optimization contexts"})}async delete(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/contexts/optimization/${t}`,method:"DELETE",errorMessage:"Failed to delete optimization context"})}async getAllStatuses(){return this._executeRequest({path:"/contexts/optimization/status",method:"GET",errorMessage:"Failed to load optimization contexts statuses"})}async getStatus(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/contexts/optimization/${t}/status`,method:"GET",errorMessage:"Failed to load optimization context status"})}}const Vi=new l0,c0="_header_bij1z_13",u0="_items_bij1z_33",d0="_footer_bij1z_47",f0={"optimization-tab":"_optimization-tab_bij1z_1",header:c0,items:u0,footer:d0,"left-buttons":"_left-buttons_bij1z_65","right-buttons":"_right-buttons_bij1z_67"},p0=`<div class="optimization-tab">\r
	<div class="header"><span>Optimization Settings</span></div>\r
	<div class="items" data-ref="configItems"></div>\r
	<div class="footer">\r
		<div class="left-buttons">\r
			<component-delete-configs-button></component-delete-configs-button>\r
			<component-import-configs-button></component-import-configs-button>\r
			<component-export-configs-button></component-export-configs-button>\r
		</div>\r
		<div class="right-buttons">\r
			<component-add-config-button></component-add-config-button>\r
			<component-clone-configs-button></component-clone-configs-button>\r
			<component-run-configs-button></component-run-configs-button>\r
		</div>\r
	</div>\r
</div>\r
`,m0={"config-item":"_config-item_1kkx0_1","config-header":"_config-header_1kkx0_9","config-info":"_config-info_1kkx0_29","strategy-name":"_strategy-name_1kkx0_47","strategy-meta":"_strategy-meta_1kkx0_59","config-actions":"_config-actions_1kkx0_73","config-content":"_config-content_1kkx0_101","config-property":"_config-property_1kkx0_111"},g0=`<div\r
	class="config-item"\r
	data-ref="configItem"\r
	data-active="false"\r
	data-config-id=""\r
	data-status=""\r
>\r
	<div class="config-header" data-ref="configHeader">\r
		<div class="config-info">\r
			<div class="strategy-name" data-field="strategy"></div>\r
			<div class="strategy-meta">\r
				<span data-field="symbol"></span> •\r
				<span data-field="interval"></span> •\r
				<span data-field="exchange"></span>\r
			</div>\r
		</div>\r
		<div class="config-actions">\r
			<run-button></run-button>\r
			<delete-button></delete-button>\r
		</div>\r
	</div>\r
	<div class="config-content">\r
		<div class="config-property">\r
			<span class="label">Strategy</span>\r
			<span class="value" data-ref="strategyInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Symbol</span>\r
			<span class="value" data-ref="symbolInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Interval</span>\r
			<span class="value" data-ref="intervalInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Exchange</span>\r
			<span class="value" data-ref="exchangeInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Start</span>\r
			<span class="value" data-ref="startInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">End</span>\r
			<span class="value" data-ref="endInput" data-key=""></span>\r
		</div>\r
	</div>\r
</div>\r
`;var ke,st,Dt,Qn,Wt,bs,B,qc,Gc,jc,Zc,mo,Qc,ln,Kc,Jc,go,tu,eu;let v0=(ke=class extends O{constructor({configId:e}){super();f(this,B);f(this,st,null);f(this,Dt,null);f(this,Qn,new Map);f(this,Wt,{strategy:void 0,symbol:void 0,interval:void 0,exchange:void 0,start:void 0,end:void 0});f(this,bs);g(this,bs,e)}get config(){return{...o(this,Wt)}}get configId(){return o(this,bs)}render(){return a(this,B,qc).call(this),a(this,B,Gc).call(this),a(this,B,jc).call(this),this.element}update(e){g(this,Wt,{...e}),a(this,B,Qc).call(this),a(this,B,ln).call(this)}remove(){this.element.remove()}toggle(){const e=o(this,st).data("active")==="true";o(this,st).data("active",String(!e))}setProcessing(){o(this,st).data("status","processing")}setSuccess(){o(this,st).data("status","success")}setError(){o(this,st).data("status","error")}clearStatus(){o(this,st).data("status","")}handleChange(e){const i=a(this,B,go).call(this,e);if(!i)return;const s=o(this,Dt)[i],n=s.value;a(this,B,tu).call(this,i)?(s.commit(n),a(this,B,mo).call(this,i,n),a(this,B,ln).call(this)):s.rollback()}handleClick(e){if(!C(e.target).closest('[data-ref="selectInput"]')){a(this,B,eu).call(this);return}const s=a(this,B,go).call(this,e),n=o(this,Dt)[s];if(!n)return;const h=C(e.target).closest("[data-ref]"),l=h.data("ref");if(l==="value"||l==="trigger"){n.toggle();return}if(l==="option"){const c=h.data("value");n.update(c),n.close(),a(this,B,mo).call(this,s,c),a(this,B,ln).call(this)}}},st=new WeakMap,Dt=new WeakMap,Qn=new WeakMap,Wt=new WeakMap,bs=new WeakMap,B=new WeakSet,qc=function(){const e={strategies:w.get(_.STRATEGIES),exchanges:w.get(_.EXCHANGES),intervals:w.get(_.INTERVALS)};g(this,Dt,{strategy:new ee({options:Object.keys(e.strategies)}),symbol:new ch({placeholder:ke.DEFAULT_SYMBOL}),interval:new ee({options:e.intervals}),exchange:new ee({options:e.exchanges}),start:new On,end:new On})},Gc=function(){this.element=P.htmlToElement(g0,[new lh({title:"Run Setting"}),new Zs({title:"Delete Setting"})],m0),g(this,st,C(this.element))},jc=function(){o(this,st).data("config-id",o(this,bs)),a(this,B,Kc).call(this),a(this,B,Jc).call(this),a(this,B,Zc).call(this),a(this,B,ln).call(this)},Zc=function(){Object.keys(o(this,Wt)).forEach(e=>{var i;o(this,Wt)[e]=((i=o(this,Dt)[e])==null?void 0:i.value)??null})},mo=function(e,i){o(this,Wt)[e]=i??null},Qc=function(){Object.entries(o(this,Wt)).forEach(([e,i])=>{const s=o(this,Dt)[e];s&&i!==null&&s.update(i)})},ln=function(){o(this,Qn).forEach((e,i)=>{const s=o(this,Wt)[i];i==="symbol"&&(!s||s==="")?e.text("[No Symbol]"):s&&e.text(s)})},Kc=function(){o(this,st).findAll("[data-field]").forEach(e=>{const i=e.data("field");o(this,Qn).set(i,e)})},Jc=function(){const e={strategy:o(this,st).find('[data-ref="strategyInput"]'),symbol:o(this,st).find('[data-ref="symbolInput"]'),interval:o(this,st).find('[data-ref="intervalInput"]'),exchange:o(this,st).find('[data-ref="exchangeInput"]'),start:o(this,st).find('[data-ref="startInput"]'),end:o(this,st).find('[data-ref="endInput"]')};Object.entries(e).forEach(([i,s])=>{s.append(o(this,Dt)[i].render()),s.data("key",i)})},go=function(e){const i=C(e.target).closest("[data-key]");return(i==null?void 0:i.data("key"))??null},tu=function(e){var i,s;return((s=(i=o(this,Dt)[e]).isValid)==null?void 0:s.call(i))??!0},eu=function(){["strategy","exchange","interval"].forEach(e=>{o(this,Dt)[e].close()})},N(ke,"COMPONENT_NAME","ConfigItem"),N(ke,"DEFAULT_SYMBOL","BTCUSDT"),ke);var qt,Kn,gi,Et,Ae,S,iu,su,nu,ru,hu,ou,bo,au,lu,cu,uu,wo,_o,du,fu,yo,zr,cn,Eo,pu,mu,gu,qi,vu,bu,un,dn,Gi;const Cn=class Cn extends O{constructor(){super(...arguments);f(this,S);f(this,qt,null);f(this,Kn,null);f(this,gi,null);f(this,Et,new Map);f(this,Ae)}get isActive(){return o(this,qt).css("display")==="flex"}render(){return a(this,S,iu).call(this),a(this,S,su).call(this),a(this,S,nu).call(this),this.element}show(){o(this,qt).css("display","flex")}hide(){o(this,qt).css("display","none")}};qt=new WeakMap,Kn=new WeakMap,gi=new WeakMap,Et=new WeakMap,Ae=new WeakMap,S=new WeakSet,iu=function(){g(this,gi,{delete:new rh,import:new oh,export:new hh,add:new sh,clone:new nh,run:new ah})},su=function(){this.element=P.htmlToElement(p0,Object.values(o(this,gi)),f0),g(this,qt,C(this.element)),g(this,Kn,o(this,qt).find('[data-ref="configItems"]'))},nu=async function(){a(this,S,pu).call(this),a(this,S,ru).call(this),await a(this,S,du).call(this)},ru=function(){o(this,qt).on("change",a(this,S,hu).bind(this)),o(this,qt).on("click",a(this,S,ou).bind(this))},hu=function(e){if(C(e.target).closest("[data-ref]").data("ref")==="fileInput"){a(this,S,mu).call(this,e.target.files);return}const s=a(this,S,Eo).call(this,e);s&&(s.handleChange(e),a(this,S,qi).call(this,s.configId,s.config))},ou=async function(e){const i=C(e.target).closest("[data-ref]");if(!i)return;const s=i.data("ref");if(s==="configItems")return;const n={runConfigsButton:()=>a(this,S,bo).call(this),cloneConfigsButton:()=>a(this,S,au).call(this),addConfigButton:()=>a(this,S,lu).call(this),exportConfigsButton:()=>a(this,S,cu).call(this),importConfigsButton:()=>a(this,S,uu).call(this),deleteConfigsButton:()=>a(this,S,wo).call(this)};if(n[s]){n[s]();return}const h=a(this,S,Eo).call(this,e);if(!h)return;const l={configHeader:()=>h.toggle(),runButton:()=>a(this,S,bo).call(this,[h.configId]),deleteButton:()=>a(this,S,wo).call(this,[h.configId])};l[s]?l[s]():(h.handleClick(e),a(this,S,qi).call(this,h.configId,h.config))},bo=async function(e=null){const i=e||Array.from(o(this,Et).keys());if(!i.length)return;const s={};i.forEach(n=>s[n]=o(this,Et).get(n).config);try{const{added:n}=await Vi.add(s);n.forEach(h=>a(this,S,dn).call(this,h,$.QUEUED)),n.length&&a(this,S,yo).call(this)}catch(n){console.error("Failed to run configs.",n)}},au=function(){Array.from(o(this,Et).values()).forEach(i=>{const s=crypto.randomUUID(),n={...i.config};a(this,S,cn).call(this,s,n),a(this,S,qi).call(this,s,n)})},lu=function(){const e=crypto.randomUUID(),i=a(this,S,cn).call(this,e);a(this,S,qi).call(this,e,i.config)},cu=function(){const e=a(this,S,Gi).call(this);if(!e||!Object.keys(e).length){H.show("info","No configs available to export");return}const s=`optimization-configs_${new Date().toISOString().split("T")[0]}.json`;pa(e,s),H.show("success","Settings exported successfully")},uu=function(){o(this,gi).import.clickOnInput()},wo=function(e=null){const i=e||Array.from(o(this,Et).keys());i.length&&i.forEach(s=>a(this,S,bu).call(this,s))},_o=async function(e){try{const i=await Vi.get(e),s=Object.values(i)[0],h={...w.get(_.OPTIMIZATION_CONTEXTS)||{},[e]:s};w.set(_.OPTIMIZATION_CONTEXTS,h),a(this,S,dn).call(this,e,$.READY),a(this,S,un).call(this,e)}catch(i){console.error(`Failed to handle ready context ${e}.`,i)}},du=async function(){try{const e=await Vi.getAllStatuses();await Promise.all(Object.entries(e).map(async([s,n])=>{n!==$.READY&&a(this,S,dn).call(this,s,n),n===$.READY?await a(this,S,_o).call(this,s):n===$.FAILED&&a(this,S,un).call(this,s)})),Object.values(e).some(s=>[$.QUEUED,$.CREATING].includes(s))&&a(this,S,yo).call(this)}catch(e){console.error("Failed to sync statuses.",e)}},fu=async function(){try{const e=await Vi.getAllStatuses();for(const[s,n]of Object.entries(e))n===$.READY&&await a(this,S,_o).call(this,s),n===$.FAILED&&(a(this,S,dn).call(this,s,$.FAILED),a(this,S,un).call(this,s));Object.values(e).some(s=>[$.QUEUED,$.CREATING].includes(s))||a(this,S,zr).call(this)}catch(e){console.error("Polling failed.",e),a(this,S,zr).call(this)}},yo=function(){o(this,Ae)||g(this,Ae,setInterval(()=>a(this,S,fu).call(this),qh))},zr=function(){o(this,Ae)&&(clearInterval(o(this,Ae)),g(this,Ae,null))},cn=function(e,i=null){const s=new v0({configId:e});return o(this,Kn).append(s.render()),o(this,Et).set(e,s),i&&s.update(i),s},Eo=function(e){const i=C(e.target).closest('[data-ref="configItem"]');if(!i)return null;const s=i.data("config-id");return o(this,Et).get(s)},pu=function(){const e=a(this,S,Gi).call(this);Object.entries(e).forEach(([i,s])=>{a(this,S,cn).call(this,i,s)})},mu=function(e){if(!e||!e.length)return;const i=e[0],s=new FileReader;s.onload=n=>{try{const h=JSON.parse(n.target.result);a(this,S,gu).call(this,h),o(this,gi).import.resetInput(),H.show("success","Settings imported successfully")}catch{H.show("error","The file you selected is not a valid JSON settings file")}},s.readAsText(i)},gu=function(e){if(!e||typeof e!="object")return;const i=a(this,S,Gi).call(this);Object.entries(e).forEach(([s,n])=>{if(!ma(n,Cn.REQUIRED_KEYS))return;const l={...i[s]||{},...n},c=o(this,Et).get(s);c?c.update(l):a(this,S,cn).call(this,s,l),a(this,S,qi).call(this,s,l)})},qi=function(e,i){const s=a(this,S,Gi).call(this);s[e]=i,G.setItem(j.OPTIMIZATION_CONFIGS,s)},vu=function(e){const i=a(this,S,Gi).call(this);delete i[e],G.setItem(j.OPTIMIZATION_CONFIGS,i)},bu=async function(e){const i=o(this,Et).get(e);i&&(a(this,S,un).call(this,e),i.remove(),o(this,Et).delete(e),a(this,S,vu).call(this,e),o(this,Et).size||a(this,S,zr).call(this))},un=async function(e){try{(await Vi.getAll())[e]&&await Vi.delete(e)}catch(i){console.error(`Failed to delete context ${e}.`,i)}},dn=function(e,i){const s=o(this,Et).get(e);s&&(s.clearStatus(),[$.QUEUED,$.CREATING].includes(i)?s.setProcessing():i===$.READY?s.setSuccess():i===$.FAILED&&s.setError())},Gi=function(){return G.getItem(j.OPTIMIZATION_CONFIGS)||{}},N(Cn,"COMPONENT_NAME","OptimizationTab"),N(Cn,"REQUIRED_KEYS",["strategy","symbol","interval","exchange","start","end"]);let vo=Cn;const b0="_header_nemla_13",w0="_items_nemla_33",_0={"params-tab":"_params-tab_nemla_1",header:b0,items:w0},y0=`<div class="params-tab">\r
	<div class="header"><span>Strategy Parameters</span></div>\r
	<div class="items" data-ref="paramsItems"></div>\r
</div>\r
`;var pe,vi,Jn,bt,_u,yu,Eu,Mu,Mo,Cu;class wu extends O{constructor(){super(...arguments);f(this,bt);f(this,pe,null);f(this,vi,new Map);f(this,Jn)}get isActive(){return o(this,pe).css("display")==="flex"}render(){return a(this,bt,_u).call(this),a(this,bt,yu).call(this),this.element}show(){o(this,pe).css("display","flex")}hide(){o(this,pe).css("display","none")}}pe=new WeakMap,vi=new WeakMap,Jn=new WeakMap,bt=new WeakSet,_u=function(){this.element=P.htmlToElement(y0,[],_0),g(this,pe,C(this.element))},yu=function(){a(this,bt,Eu).call(this),a(this,bt,Mo).call(this,w.get(_.EXECUTION_CONTEXT))},Eu=function(){o(this,pe).on("change",a(this,bt,Mu).bind(this)),w.subscribe(_.EXECUTION_CONTEXT,a(this,bt,Mo).bind(this))},Mu=async function(e){const i=C(e.target).data("param-id"),s=o(this,vi).get(i);if(s.isValid()){const n=w.get(_.EXECUTION_CONTEXT),h=n.id,l=s.value;try{await St.update(h,i,l),w.set(_.EXECUTION_CONTEXT,{...n,params:{...n.params,[i]:l}}),s.commit()}catch(c){console.error("Failed to update strategy parameter.",c),s.rollback()}}else s.rollback()},Mo=function(e){if(o(this,Jn)!==e.id){if(a(this,bt,Cu).call(this),e.id){const i=o(this,pe).find('[data-ref="paramsItems"]'),h=w.get(_.STRATEGIES)[e.strategy].paramLabels||{};Object.entries(e.params).forEach(([l,c])=>{const u=new uh;i.append(u.render()),u.update(l,c,h[l]||l),o(this,vi).set(l,u)})}g(this,Jn,e.id)}},Cu=function(){o(this,vi).forEach(e=>e.remove()),o(this,vi).clear()},N(wu,"COMPONENT_NAME","ParamsTab");const E0="_header_vgi08_13",M0="_items_vgi08_33",C0={"strategies-tab":"_strategies-tab_vgi08_1",header:E0,items:M0},x0=`<div class="strategies-tab">\r
	<div class="header"><span>Active Strategies</span></div>\r
	<div class="items" data-ref="strategiesItems"></div>\r
</div>\r
`,T0="_content_ryfxe_21",S0={"strategies-item":"_strategies-item_ryfxe_1",content:T0,"strategy-header":"_strategy-header_ryfxe_39","strategy-name":"_strategy-name_ryfxe_51","status-dot":"_status-dot_ryfxe_63","strategy-meta":"_strategy-meta_ryfxe_115"},N0=`<div class="strategies-item" data-active="false" data-context-id="">\r
	<div class="content">\r
		<div class="strategy-header">\r
			<span class="strategy-name" data-field="strategy"></span>\r
			<span\r
				class="status-dot"\r
				data-active="false"\r
				data-ref="statusDot"\r
				title="Live Trading"\r
			>\r
			</span>\r
		</div>\r
		<div class="strategy-meta">\r
			<span data-field="symbol"></span> • <span data-field="interval"></span> •\r
			<span data-field="exchange"></span>\r
		</div>\r
	</div>\r
	<delete-button></delete-button>\r
</div>\r
`;var me,tr,Xs,xu,Tu;class Co extends O{constructor(){super(...arguments);f(this,Xs);f(this,me,null);f(this,tr,new Map)}render(){return a(this,Xs,xu).call(this),a(this,Xs,Tu).call(this),this.element}update(e,i){o(this,tr).forEach((s,n)=>{o(this,me).data("context-id",e),s.text(i[n]),i.isLive&&o(this,me).find('[data-ref="statusDot"]').data("active","true")})}remove(){this.element.remove()}activate(){o(this,me).data("active","true")}deactivate(){o(this,me).data("active","false")}}me=new WeakMap,tr=new WeakMap,Xs=new WeakSet,xu=function(){this.element=P.htmlToElement(N0,[new Zs({title:"Delete Strategy"})],S0),g(this,me,C(this.element))},Tu=function(){o(this,me).findAll("[data-field]").forEach(e=>{const i=e.data("field");o(this,tr).set(i,e)})},N(Co,"COMPONENT_NAME","StrategiesItem");var Gt,Mt,ht,U,Nu,Iu,Ou,Pu,ku,Au,Ru,Lu,Br,Du;class Su extends O{constructor(){super(...arguments);f(this,U);f(this,Gt,null);f(this,Mt,new Map);f(this,ht)}get isActive(){return o(this,Gt).css("display")==="flex"}render(){return a(this,U,Nu).call(this),a(this,U,Iu).call(this),this.element}show(){o(this,Gt).css("display","flex")}hide(){o(this,Gt).css("display","none")}}Gt=new WeakMap,Mt=new WeakMap,ht=new WeakMap,U=new WeakSet,Nu=function(){this.element=P.htmlToElement(x0,[],C0),g(this,Gt,C(this.element))},Iu=function(){const e=w.get(_.EXECUTION_CONTEXT);g(this,ht,e.id),a(this,U,Ou).call(this),a(this,U,Pu).call(this)},Ou=function(){const e=w.get(_.EXECUTION_CONTEXTS),i=o(this,Gt).find('[data-ref="strategiesItems"]');Object.keys(e).length&&(Object.entries(e).forEach(([s,n])=>{const h=new Co;o(this,Mt).set(s,h),i.append(h.render()),h.update(s,n)}),o(this,ht)&&o(this,Mt).has(o(this,ht))&&o(this,Mt).get(o(this,ht)).activate())},Pu=function(){o(this,Gt).click(a(this,U,ku).bind(this)),w.subscribe(_.EXECUTION_CONTEXT,a(this,U,Au).bind(this)),w.subscribe(_.EXECUTION_CONTEXTS,a(this,U,Ru).bind(this))},ku=function(e){const i=C(e.target),s=i.closest("[data-context-id]");if(!s)return;const n=s.data("context-id");i.closest('[data-ref="deleteButton"]')?a(this,U,Lu).call(this,n):a(this,U,Br).call(this,n)},Au=function(e){o(this,ht)!==e.id&&(o(this,ht)&&o(this,Mt).has(o(this,ht))&&o(this,Mt).get(o(this,ht)).deactivate(),e.id&&o(this,Mt).has(e.id)&&o(this,Mt).get(e.id).activate(),g(this,ht,e.id))},Ru=function(e){const i=o(this,Gt).find('[data-ref="strategiesItems"]');if(o(this,Mt).forEach((s,n)=>{e[n]||(s.remove(),o(this,Mt).delete(n))}),Object.entries(e).forEach(([s,n])=>{if(!o(this,Mt).has(s)){const h=new Co;o(this,Mt).set(s,h),i.append(h.render()),h.update(s,n)}}),!o(this,ht)&&Object.keys(e).length){const s=Object.keys(e)[0];a(this,U,Br).call(this,s)}},Lu=async function(e){try{await St.delete(e);const i=w.get(_.EXECUTION_CONTEXTS),{[e]:s,...n}=i;if(w.set(_.EXECUTION_CONTEXTS,n),e===o(this,ht)){const h=Object.keys(n);h.length?a(this,U,Br).call(this,h[0]):a(this,U,Du).call(this)}e===o(this,ht)&&(Nt.removeAll(),Nt.clear()),H.show("success","Strategy deleted successfully")}catch(i){H.show("error","Failed to delete strategy"),console.error(`Failed to delete context ${e}.`,i)}},Br=function(e){if(o(this,ht)===e)return;const i=w.get(_.EXECUTION_CONTEXTS)[e];w.set(_.EXECUTION_CONTEXT,{id:e,...i})},Du=function(){w.set(_.EXECUTION_CONTEXT,{}),g(this,ht,void 0)},N(Su,"COMPONENT_NAME","StrategiesTab");const I0="_header_1oz6m_13",O0="_items_1oz6m_33",P0="_footer_1oz6m_47",k0={"trading-tab":"_trading-tab_1oz6m_1",header:I0,items:O0,footer:P0,"left-buttons":"_left-buttons_1oz6m_65","right-buttons":"_right-buttons_1oz6m_67"},A0=`<div class="trading-tab">\r
	<div class="header"><span>Live Trading Settings</span></div>\r
	<div class="items" data-ref="configItems"></div>\r
	<div class="footer">\r
		<div class="left-buttons">\r
			<component-delete-configs-button></component-delete-configs-button>\r
			<component-import-configs-button></component-import-configs-button>\r
			<component-export-configs-button></component-export-configs-button>\r
		</div>\r
		<div class="right-buttons">\r
			<component-add-config-button></component-add-config-button>\r
			<component-clone-configs-button></component-clone-configs-button>\r
			<component-run-configs-button></component-run-configs-button>\r
		</div>\r
	</div>\r
</div>\r
`,R0={"config-item":"_config-item_892mi_1","config-header":"_config-header_892mi_9","config-info":"_config-info_892mi_29","strategy-name":"_strategy-name_892mi_47","strategy-meta":"_strategy-meta_892mi_59","config-actions":"_config-actions_892mi_73","config-content":"_config-content_892mi_101","config-property":"_config-property_892mi_111","config-params":"_config-params_892mi_129"},L0=`<div\r
	class="config-item"\r
	data-ref="configItem"\r
	data-active="false"\r
	data-config-id=""\r
	data-status=""\r
>\r
	<div class="config-header" data-ref="configHeader">\r
		<div class="config-info">\r
			<div class="strategy-name" data-field="strategy"></div>\r
			<div class="strategy-meta">\r
				<span data-field="symbol"></span> •\r
				<span data-field="interval"></span> •\r
				<span data-field="exchange"></span>\r
			</div>\r
		</div>\r
		<div class="config-actions">\r
			<run-button></run-button>\r
			<open-button></open-button>\r
			<delete-button></delete-button>\r
		</div>\r
	</div>\r
	<div class="config-content">\r
		<div class="config-property">\r
			<span class="label">Strategy</span>\r
			<span class="value" data-ref="strategyInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Symbol</span>\r
			<span class="value" data-ref="symbolInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Interval</span>\r
			<span class="value" data-ref="intervalInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Exchange</span>\r
			<span class="value" data-ref="exchangeInput" data-key=""></span>\r
		</div>\r
		<div class="config-params" data-ref="paramsItems"></div>\r
	</div>\r
</div>\r
`;var ot,$t,bi,er,at,ws,R,$u,zu,Bu,Fu,To,So,Vu,fn,Yu,Hu,Fr,No,Uu,Io,Xu,Wu;const xn=class xn extends O{constructor({configId:e}){super();f(this,R);f(this,ot,null);f(this,$t,null);f(this,bi,new Map);f(this,er,new Map);f(this,at,{strategy:void 0,symbol:void 0,interval:void 0,exchange:void 0,params:null});f(this,ws);g(this,ws,e)}get config(){return{...o(this,at),params:{...o(this,at).params}}}get configId(){return o(this,ws)}render(){return a(this,R,$u).call(this),a(this,R,zu).call(this),a(this,R,Bu).call(this),this.element}update(e){g(this,at,{...e,params:{...e.params||{}}}),a(this,R,Vu).call(this),a(this,R,Fr).call(this),a(this,R,fn).call(this)}remove(){a(this,R,No).call(this),this.element.remove()}toggle(){const e=o(this,ot).data("active")==="true";o(this,ot).data("active",String(!e))}setProcessing(){o(this,ot).data("status","processing")}setSuccess(){o(this,ot).data("status","success")}setError(){o(this,ot).data("status","error")}clearStatus(){o(this,ot).data("status","")}handleChange(e){const i=a(this,R,Io).call(this,e),s=C(e.target).data("param-id");if(s){a(this,R,Uu).call(this,s,e);return}if(!i)return;const n=o(this,$t)[i],h=n.value;a(this,R,Xu).call(this,i)?(n.commit(h),a(this,R,So).call(this,i,h),a(this,R,fn).call(this)):n.rollback()}handleClick(e){if(!C(e.target).closest('[data-ref="selectInput"]')){a(this,R,Wu).call(this);return}const s=a(this,R,Io).call(this,e),n=o(this,$t)[s];if(!n)return;const h=C(e.target).closest("[data-ref]"),l=h.data("ref");if(l==="value"||l==="trigger"){n.toggle();return}if(l==="option"){const c=h.data("value");n.update(c),n.close(),a(this,R,So).call(this,s,c),a(this,R,fn).call(this)}}};ot=new WeakMap,$t=new WeakMap,bi=new WeakMap,er=new WeakMap,at=new WeakMap,ws=new WeakMap,R=new WeakSet,$u=function(){const e={strategies:w.get(_.STRATEGIES),exchanges:w.get(_.EXCHANGES),intervals:w.get(_.INTERVALS)};g(this,$t,{strategy:new ee({options:Object.keys(e.strategies)}),symbol:new ch({placeholder:xn.DEFAULT_SYMBOL}),interval:new ee({options:e.intervals}),exchange:new ee({options:e.exchanges})})},zu=function(){this.element=P.htmlToElement(L0,[new lh({title:"Run Setting"}),new ih({title:"Open Strategy"}),new Zs({title:"Delete Setting"})],R0),g(this,ot,C(this.element))},Bu=function(){o(this,ot).data("config-id",o(this,ws)),a(this,R,Yu).call(this),a(this,R,Hu).call(this),a(this,R,Fu).call(this),a(this,R,Fr).call(this),a(this,R,fn).call(this)},Fu=function(){Object.keys(o(this,at)).forEach(e=>{var i;e!=="params"&&(o(this,at)[e]=((i=o(this,$t)[e])==null?void 0:i.value)??null)}),a(this,R,To).call(this)},To=function(){const e=o(this,at).strategy;if(!e)return;const s=w.get(_.STRATEGIES)[e];s&&s.params?o(this,at).params={...s.params}:o(this,at).params={}},So=function(e,i){o(this,at)[e]=i??null,e==="strategy"&&(a(this,R,To).call(this),a(this,R,Fr).call(this))},Vu=function(){Object.entries(o(this,at)).forEach(([e,i])=>{if(e==="params")return;const s=o(this,$t)[e];s&&i!==null&&s.update(i)})},fn=function(){o(this,er).forEach((e,i)=>{const s=o(this,at)[i];i==="symbol"&&(!s||s==="")?e.text("[No Symbol]"):s&&e.text(s)})},Yu=function(){o(this,ot).findAll("[data-field]").forEach(e=>{const i=e.data("field");o(this,er).set(i,e)})},Hu=function(){const e={strategy:o(this,ot).find('[data-ref="strategyInput"]'),symbol:o(this,ot).find('[data-ref="symbolInput"]'),interval:o(this,ot).find('[data-ref="intervalInput"]'),exchange:o(this,ot).find('[data-ref="exchangeInput"]')};Object.entries(e).forEach(([i,s])=>{s.append(o(this,$t)[i].render()),s.data("key",i)})},Fr=function(){a(this,R,No).call(this);const e=o(this,at).params||{},s=w.get(_.STRATEGIES)[o(this,at).strategy],n=(s==null?void 0:s.paramLabels)||{};if(Object.keys(e).length){const h=o(this,ot).find('[data-ref="paramsItems"]');Object.entries(e).forEach(([l,c])=>{const u=new uh,d=u.render();h.append(d),u.update(l,c,n[l]||l),o(this,bi).set(l,u)})}},No=function(){o(this,bi).forEach(e=>e.remove()),o(this,bi).clear()},Uu=function(e){const i=o(this,bi).get(e);if(i)if(i.isValid()){const s=i.value;o(this,at).params[e]=s,i.commit()}else i.rollback()},Io=function(e){const i=C(e.target).closest("[data-key]");return(i==null?void 0:i.data("key"))??null},Xu=function(e){var i,s;return((s=(i=o(this,$t)[e]).isValid)==null?void 0:s.call(i))??!0},Wu=function(){["strategy","exchange","interval"].forEach(e=>{o(this,$t)[e].close()})},N(xn,"COMPONENT_NAME","ConfigItem"),N(xn,"DEFAULT_SYMBOL","BTCUSDT");let xo=xn;var jt,ir,wi,pt,_s,ge,Re,T,qu,Gu,ju,Zu,Qu,Ku,Ju,td,Po,ed,id,sd,nd,ko,rd,hd,od,ad,Ao,pn,ji,Ro,ld,cd,ud,Zi,dd,fd,mn,Qi;const Tn=class Tn extends O{constructor(){super(...arguments);f(this,T);f(this,jt,null);f(this,ir,null);f(this,wi,null);f(this,pt,new Map);f(this,_s,new Set);f(this,ge,new Set);f(this,Re)}get isActive(){return o(this,jt).css("display")==="flex"}render(){return a(this,T,qu).call(this),a(this,T,Gu).call(this),a(this,T,ju).call(this),this.element}show(){o(this,jt).css("display","flex")}hide(){o(this,jt).css("display","none")}};jt=new WeakMap,ir=new WeakMap,wi=new WeakMap,pt=new WeakMap,_s=new WeakMap,ge=new WeakMap,Re=new WeakMap,T=new WeakSet,qu=function(){g(this,wi,{delete:new rh,import:new oh,export:new hh,add:new sh,clone:new nh,run:new ah})},Gu=function(){this.element=P.htmlToElement(A0,Object.values(o(this,wi)),k0),g(this,jt,C(this.element)),g(this,ir,o(this,jt).find('[data-ref="configItems"]'))},ju=async function(){a(this,T,ld).call(this),a(this,T,Zu).call(this),await a(this,T,od).call(this)},Zu=function(){o(this,jt).on("change",a(this,T,Qu).bind(this)),o(this,jt).on("click",a(this,T,Ku).bind(this)),w.subscribe(_.EXECUTION_CONTEXTS,a(this,T,Ju).bind(this)),w.subscribe(_.OPTIMIZATION_CONTEXTS,a(this,T,td).bind(this))},Qu=function(e){if(C(e.target).closest("[data-ref]").data("ref")==="fileInput"){a(this,T,cd).call(this,e.target.files);return}const s=a(this,T,Ro).call(this,e);s&&(s.handleChange(e),a(this,T,Zi).call(this,s.configId,s.config))},Ku=async function(e){const i=C(e.target).closest("[data-ref]");if(!i)return;const s=i.data("ref");if(s==="configItems")return;const n={runConfigsButton:()=>a(this,T,Po).call(this),cloneConfigsButton:()=>a(this,T,ed).call(this),addConfigButton:()=>a(this,T,id).call(this),exportConfigsButton:()=>a(this,T,sd).call(this),importConfigsButton:()=>a(this,T,nd).call(this),deleteConfigsButton:()=>a(this,T,ko).call(this)};if(n[s]){n[s]();return}const h=a(this,T,Ro).call(this,e);if(!h)return;const l={configHeader:()=>h.toggle(),runButton:()=>a(this,T,Po).call(this,[h.configId]),openButton:()=>a(this,T,hd).call(this,h.configId),deleteButton:()=>a(this,T,ko).call(this,[h.configId])};l[s]?l[s]():(h.handleClick(e),a(this,T,Zi).call(this,h.configId,h.config))},Ju=function(e){Array.from(o(this,_s)).forEach(i=>{if(!(i in e)){const s=o(this,pt).get(i);s&&s.clearStatus(),o(this,_s).delete(i)}}),Object.entries(e).forEach(([i,s])=>{s.isLive&&o(this,_s).add(i)})},td=function(e){const i=G.getItem(j.TRADING_CONFIGS)||{};Object.values(e).forEach(s=>{const{start:n,end:h,...l}=s;s.params.forEach(c=>{const u=crypto.randomUUID(),d={...l,params:c};i[u]=d,a(this,T,ji).call(this,u,d)})}),G.setItem(j.TRADING_CONFIGS,i)},Po=async function(e){const i=e||Array.from(o(this,pt).keys());if(!i.length)return;const s={};i.forEach(n=>s[n]=o(this,pt).get(n).config);try{const{added:n}=await St.add(s);n.forEach(h=>{a(this,T,mn).call(this,h,$.QUEUED),o(this,ge).add(h)}),n.length&&a(this,T,Ao).call(this)}catch(n){console.error("Failed to run configs.",n)}},ed=function(){Array.from(o(this,pt).values()).forEach(i=>{const s=crypto.randomUUID(),n={...i.config};a(this,T,ji).call(this,s,n),a(this,T,Zi).call(this,s,n)})},id=function(){const e=crypto.randomUUID(),i=a(this,T,ji).call(this,e);a(this,T,Zi).call(this,e,i.config)},sd=function(){const e=a(this,T,Qi).call(this);if(!e||!Object.keys(e).length){H.show("info","No configs available to export");return}const s=`trading-configs_${new Date().toISOString().split("T")[0]}.json`;pa(e,s),H.show("success","Settings exported successfully")},nd=function(){o(this,wi).import.clickOnInput()},ko=function(e){const i=e||Array.from(o(this,pt).keys());i.length&&i.forEach(s=>a(this,T,fd).call(this,s))},rd=async function(e){try{const i=w.get(_.EXECUTION_CONTEXTS),s=await St.get(e),n={...i,...s};w.set(_.EXECUTION_CONTEXTS,n),a(this,T,mn).call(this,e,$.READY)}catch(i){console.error(`Failed to handle ready context ${e}.`,i)}},hd=function(e){const i=w.get(_.EXECUTION_CONTEXTS);if(!i[e]){H.show("warning","Strategy not created or was deleted");return}if(w.get(_.EXECUTION_CONTEXT).id===e)return;const n=i[e];w.set(_.EXECUTION_CONTEXT,{id:e,...n})},od=async function(){try{const e=await St.getAllStatuses();await Promise.all(Object.entries(e).map(async([s,n])=>{a(this,T,mn).call(this,s,n)})),Object.values(e).some(s=>[$.QUEUED,$.CREATING].includes(s))&&a(this,T,Ao).call(this)}catch(e){console.error("Failed to sync statuses.",e)}},ad=async function(){try{if(!o(this,ge).size){a(this,T,pn).call(this);return}for(const e of Array.from(o(this,ge))){const{status:i}=await St.getStatus(e);i===$.READY?(await a(this,T,rd).call(this,e),o(this,ge).delete(e)):i===$.FAILED&&(a(this,T,mn).call(this,e,$.FAILED),o(this,ge).delete(e))}o(this,ge).size||a(this,T,pn).call(this)}catch(e){console.error("Polling failed.",e),a(this,T,pn).call(this)}},Ao=function(){o(this,Re)||g(this,Re,setInterval(()=>a(this,T,ad).call(this),Fl))},pn=function(){o(this,Re)&&(clearInterval(o(this,Re)),g(this,Re,void 0))},ji=function(e,i){const s=new xo({configId:e});return o(this,ir).append(s.render()),o(this,pt).set(e,s),i&&s.update(i),s},Ro=function(e){const i=C(e.target).closest('[data-ref="configItem"]');if(!i)return null;const s=i.data("config-id");return o(this,pt).get(s)},ld=function(){const e=a(this,T,Qi).call(this);Object.entries(e).forEach(([i,s])=>{a(this,T,ji).call(this,i,s)})},cd=function(e){if(!e||!e.length)return;const i=e[0],s=new FileReader;s.onload=n=>{try{const h=JSON.parse(n.target.result);a(this,T,ud).call(this,h),o(this,wi).import.resetInput(),H.show("success","Settings imported successfully")}catch{H.show("error","The file you selected is not a valid JSON settings file")}},s.readAsText(i)},ud=function(e){if(!e||typeof e!="object")return;const i=a(this,T,Qi).call(this);Object.entries(e).forEach(([s,n])=>{if(!ma(n,Tn.REQUIRED_KEYS))return;const l={...i[s]||{},...n},c=o(this,pt).get(s);c?c.update(l):a(this,T,ji).call(this,s,l),a(this,T,Zi).call(this,s,l)})},Zi=function(e,i){const s=a(this,T,Qi).call(this);s[e]=i,G.setItem(j.TRADING_CONFIGS,s)},dd=function(e){const i=a(this,T,Qi).call(this);delete i[e],G.setItem(j.TRADING_CONFIGS,i)},fd=async function(e){const i=o(this,pt).get(e);i&&(i.remove(),o(this,pt).delete(e),a(this,T,dd).call(this,e),o(this,pt).size||a(this,T,pn).call(this))},mn=function(e,i){const s=o(this,pt).get(e);s&&(s.clearStatus(),[$.QUEUED,$.CREATING].includes(i)?s.setProcessing():i===$.READY?s.setSuccess():i===$.FAILED&&s.setError())},Qi=function(){return G.getItem(j.TRADING_CONFIGS)||{}},N(Tn,"COMPONENT_NAME","TradingTab"),N(Tn,"REQUIRED_KEYS",["strategy","symbol","interval","exchange","params"]);let Oo=Tn;var _i,xt,md,gd,vd,bd,wd,_d;class pd extends O{constructor(){super(...arguments);f(this,xt);f(this,_i,null)}render(){return a(this,xt,gd).call(this),a(this,xt,vd).call(this),this.element}showOnly(e){if(this.tabs[e].isActive&&o(this,xt,md)){a(this,xt,wd).call(this);return}a(this,xt,bd).call(this),a(this,xt,_d).call(this,e)}}_i=new WeakMap,xt=new WeakSet,md=function(){return o(this,_i).css("display")==="flex"},gd=function(){this.tabs={strategies:new Su,params:new wu,alerts:new Gl,optimization:new vo,backtesting:new lo,trading:new Oo}},vd=function(){this.element=P.htmlToElement(lv,Object.values(this.tabs),av),g(this,_i,C(this.element))},bd=function(){o(this,_i).css("display","flex")},wd=function(){o(this,_i).css("display","none")},_d=function(e){for(const[i,s]of Object.entries(this.tabs))i===e?s.show():s.hide()},N(pd,"COMPONENT_NAME","ControllerContent");const D0={"controller-sidebar":"_controller-sidebar_guqof_1","buttons-group":"_buttons-group_guqof_15"},$0=`<div class="controller-sidebar">\r
	<div class="buttons-group">\r
		<component-strategies-tab-button></component-strategies-tab-button>\r
		<component-params-tab-button></component-params-tab-button>\r
		<component-alerts-tab-button></component-alerts-tab-button>\r
	</div>\r
	<hr />\r
	<div class="buttons-group">\r
		<component-optimization-tab-button></component-optimization-tab-button>\r
		<component-backtesting-tab-button></component-backtesting-tab-button>\r
		<component-trading-tab-button></component-trading-tab-button>\r
	</div>\r
	<div class="buttons-group">\r
		<component-theme-button></component-theme-button>\r
		<component-docs-button></component-docs-button>\r
	</div>\r
</div>\r
`,z0={"alerts-tab-button":"_alerts-tab-button_1tr6j_1"},B0=`<button class="alerts-tab-button" data-active="false">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 44 44"\r
		width="44"\r
		height="44"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M35 14.66 29.16 9l-.7.72 5.84 5.66.7-.72ZM9 14.66 14.84 9l.7.72-5.84 5.66-.7-.72ZM22 16v7h-5v1h6v-8h-1Z"\r
		></path>\r
		<path\r
			fill="currentColor"\r
			fill-rule="evenodd"\r
			d="M22 33a11 11 0 1 0 0-22 11 11 0 0 0 0 22Zm0-1a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Le;class yd extends O{constructor(){super(...arguments);f(this,Le,null)}get isActive(){return o(this,Le).is("data-active")}render(){return this.element=P.htmlToElement(B0,[],z0),g(this,Le,C(this.element)),this.element}setOnClick(e){o(this,Le).click(e)}activate(){o(this,Le).data("active","true")}deactivate(){o(this,Le).data("active","false")}}Le=new WeakMap,N(yd,"COMPONENT_NAME","AlertsTabButton");const F0={"backtesting-tab-button":"_backtesting-tab-button_hnp66_1"},V0=`<button class="backtesting-tab-button" data-active="false">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
		fill="none"\r
	>\r
		<path\r
			stroke="currentColor"\r
			d="M6 12l4.8-4.8a1 1 0 0 1 1.4 0l2.7 2.7a1 1 0 0 0 1.3.1L23 5"\r
		></path>\r
		<path\r
			fill="currentColor"\r
			fill-rule="evenodd"\r
			d="M19 12a1 1 0 0 0-1 1v4h-3v-1a1 1 0 0 0-1-1h-3a1 1 0 0 0-1 1v2H7a1 1 0 0 0-1 1v4h17V13a1 1 0 0 0-1-1h-3zm0 10h3v-9h-3v9zm-1 0v-4h-3v4h3zm-4-4.5V22h-3v-6h3v1.5zM10 22v-3H7v3h3z"\r
		></path>\r
	</svg>\r
</button>\r
`;var De;class Ed extends O{constructor(){super(...arguments);f(this,De,null)}get isActive(){return o(this,De).is("data-active")}render(){return this.element=P.htmlToElement(V0,[],F0),g(this,De,C(this.element)),this.element}setOnClick(e){o(this,De).click(e)}activate(){o(this,De).data("active","true")}deactivate(){o(this,De).data("active","false")}}De=new WeakMap,N(Ed,"COMPONENT_NAME","BacktestingTabButton");const Y0={"docs-button":"_docs-button_1a3p5_1"},H0=`<button class="docs-button">\r
	<a href="https://github.com/albert-alanreys/jinn-docs" target="_blank">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 28 28"\r
			width="28"\r
			height="28"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M14 3a11 11 0 1 1 0 22 11 11 0 0 1 0-22m0 1a10 10 0 1 0 0 20 10 10 0 0 0 0-20m0 14a1 1 0 1 1 0 2 1 1 0 0 1 0-2m.22-10a3.78 3.78 0 0 1 2.08 6.93l-1.06.7c-.46.3-.74.82-.74 1.37h-1c0-.89.45-1.72 1.19-2.2l1.06-.7A2.77 2.77 0 0 0 14.22 9H14a3 3 0 0 0-3 3h-1a4 4 0 0 1 4-4z"\r
			></path>\r
		</svg>\r
	</a>\r
</button>\r
`;class Md extends O{render(){return this.element=P.htmlToElement(H0,[],Y0),this.element}}N(Md,"COMPONENT_NAME","DocsButton");const U0={"optimization-tab-button":"_optimization-tab-button_13h0p_1"},X0=`<button class="optimization-tab-button" data-active="false">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
		fill="none"\r
	>\r
		<path\r
			stroke="currentColor"\r
			stroke-width=".91"\r
			d="M8 16h5v8l7-11h-5V4L8 16Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var $e;class Cd extends O{constructor(){super(...arguments);f(this,$e,null)}get isActive(){return o(this,$e).is("data-active")}render(){return this.element=P.htmlToElement(X0,[],U0),g(this,$e,C(this.element)),this.element}setOnClick(e){o(this,$e).click(e)}activate(){o(this,$e).data("active","true")}deactivate(){o(this,$e).data("active","false")}}$e=new WeakMap,N(Cd,"COMPONENT_NAME","OptimizationTabButton");const W0={"params-tab-button":"_params-tab-button_1xwfe_1"},q0=`<button class="params-tab-button" data-active="false">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
		fill="currentColor"\r
	>\r
		<path\r
			fill-rule="evenodd"\r
			d="M18 14a4 4 0 1 1-8 0 4 4 0 0 1 8 0Zm-1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"\r
		></path>\r
		<path\r
			fill-rule="evenodd"\r
			d="M8.5 5h11l5 9-5 9h-11l-5-9 5-9Zm-3.86 9L9.1 6h9.82l4.45 8-4.45 8H9.1l-4.45-8Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var ze;class xd extends O{constructor(){super(...arguments);f(this,ze,null)}get isActive(){return o(this,ze).is("data-active")}render(){return this.element=P.htmlToElement(q0,[],W0),g(this,ze,C(this.element)),this.element}setOnClick(e){o(this,ze).click(e)}activate(){o(this,ze).data("active","true")}deactivate(){o(this,ze).data("active","false")}}ze=new WeakMap,N(xd,"COMPONENT_NAME","ParamsTabButton");const G0={"strategies-tab-button":"_strategies-tab-button_bh98p_1"},j0=`<button class="strategies-tab-button" data-active="true">\r
	<span>\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 44 44"\r
			width="44"\r
			height="44"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M13 11h18a2 2 0 0 1 2 2v17a2 2 0 0 1-2 2H13a2 2 0 0 1-2-2V13c0-1.1.9-2 2-2Zm18-1H13a3 3 0 0 0-3 3v17a3 3 0 0 0 3 3h18a3 3 0 0 0 3-3V13a3 3 0 0 0-3-3Zm-2 11H15v1h14v-1Zm-14-5h14v1H15v-1Zm14 10H15v1h14v-1Z"\r
			></path>\r
		</svg>\r
	</span>\r
</button>\r
`;var Be;class Td extends O{constructor(){super(...arguments);f(this,Be,null)}get isActive(){return o(this,Be).is("data-active")}render(){return this.element=P.htmlToElement(j0,[],G0),g(this,Be,C(this.element)),this.element}setOnClick(e){o(this,Be).click(e)}activate(){o(this,Be).data("active","true")}deactivate(){o(this,Be).data("active","false")}}Be=new WeakMap,N(Td,"COMPONENT_NAME","StrategiesTabButton");const Z0={"theme-button":"_theme-button_19q0t_1"},Q0=`<button class="theme-button" data-active="false">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			fill-rule="evenodd"\r
			d="M19.67 6.44a8.27 8.27 0 0 0-3.57-1.39 9 9 0 1 0 .54 17.83 8.71 8.71 0 0 0 3.63-1.8c.38-.29.74-.6 1.07-.9 0 0-.55 0-1.35-.15-2.11-.38-5.96-1.68-5.96-6.03 0-4.32 3.5-5.92 5.46-6.47.76-.22 1.3-.28 1.3-.28a14.2 14.2 0 0 0-1.12-.8Zm-1.3.4a6.54 6.54 0 0 0-2.37-.8 8 8 0 1 0 .48 15.85c.79-.13 1.63-.54 2.44-1.07-.51-.13-1.07-.31-1.63-.56a7.46 7.46 0 0 1-2.9-2.14A6.44 6.44 0 0 1 13.03 14a7.13 7.13 0 0 1 3.9-6.5c.49-.28.99-.5 1.45-.66Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var ys,zt,Nd,Id,Od,Lo;class Sd extends O{constructor(){super(...arguments);f(this,zt);f(this,ys,null)}render(){return a(this,zt,Nd).call(this),a(this,zt,Id).call(this),this.element}}ys=new WeakMap,zt=new WeakSet,Nd=function(){this.element=P.htmlToElement(Q0,[],Z0),g(this,ys,C(this.element))},Id=function(){o(this,ys).on("click",a(this,zt,Od).bind(this)),a(this,zt,Lo).call(this)},Od=function(){Dr.toggle(),a(this,zt,Lo).call(this)},Lo=function(){const e=Dr.get()===Dr.DARK;o(this,ys).data("active",e.toString())},N(Sd,"COMPONENT_NAME","ThemeButton");const K0={"trading-tab-button":"_trading-tab-button_j6w11_1"},J0=`<button class="trading-tab-button" data-active="false">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M4.5 3C3.67 3 3 3.67 3 4.5v13c0 .83.67 1.5 1.5 1.5H13v3H7.5a.5.5 0 0 0 0 1h12a.5.5 0 1 0 0-1H14v-3h8.5c.83 0 1.5-.67 1.5-1.5v-13c0-.83-.67-1.5-1.5-1.5h-18ZM4 4.5c0-.28.22-.5.5-.5h18c.28 0 .5.22.5.5v13a.5.5 0 0 1-.5.5h-18a.5.5 0 0 1-.5-.5v-13Zm15.85 4.35a.5.5 0 1 0-.7-.7L15 12.29l-2.65-2.64a.5.5 0 0 0-.7 0l-4.5 4.5a.5.5 0 0 0 .7.7L12 10.71l2.65 2.64c.2.2.5.2.7 0l4.5-4.5Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Fe;class Pd extends O{constructor(){super(...arguments);f(this,Fe,null)}get isActive(){return o(this,Fe).is("data-active")}render(){return this.element=P.htmlToElement(J0,[],K0),g(this,Fe,C(this.element)),this.element}setOnClick(e){o(this,Fe).click(e)}activate(){o(this,Fe).data("active","true")}deactivate(){o(this,Fe).data("active","false")}}Fe=new WeakMap,N(Pd,"COMPONENT_NAME","TradingTabButton");var Ze,Ad,Rd,Ld;class kd extends O{constructor(){super(...arguments);f(this,Ze)}render(){return a(this,Ze,Ad).call(this),a(this,Ze,Rd).call(this),this.element}connectButtons(e){Object.entries(this.buttons).forEach(([i,s])=>{s.setOnClick(()=>{s.isActive?s.deactivate():a(this,Ze,Ld).call(this,i),e==null||e(i)})})}}Ze=new WeakSet,Ad=function(){this.buttons={strategies:new Td,params:new xd,alerts:new yd,optimization:new Cd,backtesting:new Ed,trading:new Pd}},Rd=function(){this.element=P.htmlToElement($0,[...Object.values(this.buttons),Sd,Md],D0)},Ld=function(e){for(const[i,s]of Object.entries(this.buttons))i===e?s.activate():s.deactivate()},N(kd,"COMPONENT_NAME","ControllerSidebar");var Qe,$d,zd,Bd;class Dd extends O{constructor(){super(...arguments);f(this,Qe)}render(){return a(this,Qe,$d).call(this),a(this,Qe,zd).call(this),a(this,Qe,Bd).call(this),this.element}}Qe=new WeakSet,$d=function(){this.controllerContent=new pd,this.controllerSidebar=new kd},zd=function(){this.element=P.htmlToElement(ov,[this.controllerContent,this.controllerSidebar],hv)},Bd=function(){this.controllerSidebar.connectButtons(e=>{this.controllerContent.showOnly(e)})},N(Dd,"COMPONENT_NAME","Controller");const t1="_dashboard_x3hjs_1",e1={dashboard:t1},i1=`<div class="dashboard">\r
	<component-chart-panel></component-chart-panel>\r
	<component-report-panel></component-report-panel>\r
</div>\r
`;function Y(r){var t=r.width,e=r.height;if(t<0)throw new Error("Negative width is not allowed for Size");if(e<0)throw new Error("Negative height is not allowed for Size");return{width:t,height:e}}function Li(r,t){return r.width===t.width&&r.height===t.height}var s1=(function(){function r(t){var e=this;this._resolutionListener=function(){return e._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return r.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(r.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),r.prototype.subscribe=function(t){var e=this,i={next:t};return this._observers.push(i),{unsubscribe:function(){e._observers=e._observers.filter(function(s){return s!==i})}}},r.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},r.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},r.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},r.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach(function(e){return e.next(t._window.devicePixelRatio)}),this._reinstallResolutionListener()},r})();function n1(r){return new s1(r)}var r1=(function(){function r(t,e,i){var s;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=Y({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=e??(function(n){return n}),this._allowResizeObserver=(s=i==null?void 0:i.allowResizeObserver)!==null&&s!==void 0?s:!0,this._chooseAndInitObserver()}return r.prototype.dispose=function(){var t,e;if(this._canvasElement===null)throw new Error("Object is disposed");(t=this._canvasElementResizeObserver)===null||t===void 0||t.disconnect(),this._canvasElementResizeObserver=null,(e=this._devicePixelRatioObservable)===null||e===void 0||e.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(r.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bitmapSize",{get:function(){return Y({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),r.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=Y(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},r.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},r.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(e){return e!==t})},Object.defineProperty(r.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),r.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},r.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(e){return e!==t})},r.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},r.prototype._resizeBitmap=function(t){var e=this.bitmapSize;Li(e,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(e,t))},r.prototype._emitBitmapSizeChanged=function(t,e){var i=this;this._bitmapSizeChangedListeners.forEach(function(s){return s.call(i,t,e)})},r.prototype._suggestNewBitmapSize=function(t){var e=this._suggestedBitmapSize,i=Y(this._transformBitmapSize(t,this._canvasElementClientSize)),s=Li(this.bitmapSize,i)?null:i;e===null&&s===null||e!==null&&s!==null&&Li(e,s)||(this._suggestedBitmapSize=s,this._emitSuggestedBitmapSizeChanged(e,s))},r.prototype._emitSuggestedBitmapSizeChanged=function(t,e){var i=this;this._suggestedBitmapSizeChangedListeners.forEach(function(s){return s.call(i,t,e)})},r.prototype._chooseAndInitObserver=function(){var t=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}o1().then(function(e){return e?t._initResizeObserver():t._initDevicePixelRatioObservable()})},r.prototype._initDevicePixelRatioObservable=function(){var t=this;if(this._canvasElement!==null){var e=Aa(this._canvasElement);if(e===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=n1(e),this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()}),this._invalidateBitmapSize()}},r.prototype._invalidateBitmapSize=function(){var t,e;if(this._canvasElement!==null){var i=Aa(this._canvasElement);if(i!==null){var s=(e=(t=this._devicePixelRatioObservable)===null||t===void 0?void 0:t.value)!==null&&e!==void 0?e:i.devicePixelRatio,n=this._canvasElement.getClientRects(),h=n[0]!==void 0?a1(n[0],s):Y({width:this._canvasElementClientSize.width*s,height:this._canvasElementClientSize.height*s});this._suggestNewBitmapSize(h)}}},r.prototype._initResizeObserver=function(){var t=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(e){var i=e.find(function(h){return h.target===t._canvasElement});if(!(!i||!i.devicePixelContentBoxSize||!i.devicePixelContentBoxSize[0])){var s=i.devicePixelContentBoxSize[0],n=Y({width:s.inlineSize,height:s.blockSize});t._suggestNewBitmapSize(n)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},r})();function h1(r,t){return new r1(r,t.transform,t.options)}function Aa(r){return r.ownerDocument.defaultView}function o1(){return new Promise(function(r){var t=new ResizeObserver(function(e){r(e.every(function(i){return"devicePixelContentBoxSize"in i})),t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function a1(r,t){return Y({width:Math.round(r.left*t+r.width*t)-Math.round(r.left*t),height:Math.round(r.top*t+r.height*t)-Math.round(r.top*t)})}var l1=(function(){function r(t,e,i){if(e.width===0||e.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=e,i.width===0||i.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=i,this._context=t}return r.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},r.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(r.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),r})();function Di(r,t){var e=r.canvasElementClientSize;if(e.width===0||e.height===0)return null;var i=r.bitmapSize;if(i.width===0||i.height===0)return null;var s=r.canvasElement.getContext("2d",t);return s===null?null:new l1(s,e,i)}/*!
 * @license
 * TradingView Lightweight Charts™ v5.0.8
 * Copyright (c) 2025 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const Fd={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var Ra,La;function $i(r,t){const e={0:[],1:[r.lineWidth,r.lineWidth],2:[2*r.lineWidth,2*r.lineWidth],3:[6*r.lineWidth,6*r.lineWidth],4:[r.lineWidth,4*r.lineWidth]}[t];r.setLineDash(e)}function Vd(r,t,e,i){r.beginPath();const s=r.lineWidth%2?.5:0;r.moveTo(e,t+s),r.lineTo(i,t+s),r.stroke()}function ct(r,t){if(!r)throw new Error("Assertion failed"+(t?": "+t:""))}function Ct(r){if(r===void 0)throw new Error("Value is undefined");return r}function E(r){if(r===null)throw new Error("Value is null");return r}function Ge(r){return E(Ct(r))}(function(r){r[r.Simple=0]="Simple",r[r.WithSteps=1]="WithSteps",r[r.Curved=2]="Curved"})(Ra||(Ra={})),(function(r){r[r.Solid=0]="Solid",r[r.Dotted=1]="Dotted",r[r.Dashed=2]="Dashed",r[r.LargeDashed=3]="LargeDashed",r[r.SparseDotted=4]="SparseDotted"})(La||(La={}));class Z{constructor(){this.t=[]}i(t,e,i){const s={h:t,l:e,o:i===!0};this.t.push(s)}_(t){const e=this.t.findIndex((i=>t===i.h));e>-1&&this.t.splice(e,1)}u(t){this.t=this.t.filter((e=>e.l!==t))}p(t,e,i){const s=[...this.t];this.t=this.t.filter((n=>!n.o)),s.forEach((n=>n.h(t,e,i)))}v(){return this.t.length>0}m(){this.t=[]}}function It(r,...t){for(const e of t)for(const i in e)e[i]!==void 0&&Object.prototype.hasOwnProperty.call(e,i)&&!["__proto__","constructor","prototype"].includes(i)&&(typeof e[i]!="object"||r[i]===void 0||Array.isArray(e[i])?r[i]=e[i]:It(r[i],e[i]));return r}function zi(r){return typeof r=="number"&&isFinite(r)}function Pn(r){return typeof r=="number"&&r%1==0}function Cr(r){return typeof r=="string"}function Sr(r){return typeof r=="boolean"}function we(r){const t=r;if(!t||typeof t!="object")return t;let e,i,s;for(i in e=Array.isArray(t)?[]:{},t)t.hasOwnProperty(i)&&(s=t[i],e[i]=s&&typeof s=="object"?we(s):s);return e}function c1(r){return r!==null}function kn(r){return r===null?void 0:r}const Yd="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function An(r,t,e){return t===void 0&&(t=Yd),`${e=e!==void 0?`${e} `:""}${r}px ${t}`}class u1{constructor(t){this.M={S:1,C:5,P:NaN,k:"",T:"",R:"",D:"",V:0,I:0,B:0,A:0,L:0},this.O=t}N(){const t=this.M,e=this.F(),i=this.W();return t.P===e&&t.T===i||(t.P=e,t.T=i,t.k=An(e,i),t.A=2.5/12*e,t.V=t.A,t.I=e/12*t.C,t.B=e/12*t.C,t.L=0),t.R=this.H(),t.D=this.U(),this.M}H(){return this.O.N().layout.textColor}U(){return this.O.$()}F(){return this.O.N().layout.fontSize}W(){return this.O.N().layout.fontFamily}}function Ch(r){return r<0?0:r>255?255:Math.round(r)||0}function Da(r){return .199*r[0]+.687*r[1]+.114*r[2]}class d1{constructor(t,e){this.q=new Map,this.Y=t,e&&(this.q=e)}j(t,e){if(t==="transparent")return t;const i=this.K(t),s=i[3];return`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${e*s})`}X(t){const e=this.K(t);return{Z:`rgb(${e[0]}, ${e[1]}, ${e[2]})`,G:Da(e)>160?"black":"white"}}J(t){return Da(this.K(t))}tt(t,e,i){const[s,n,h,l]=this.K(t),[c,u,d,p]=this.K(e),m=[Ch(s+i*(c-s)),Ch(n+i*(u-n)),Ch(h+i*(d-h)),(v=l+i*(p-l),v<=0||v>1?Math.min(Math.max(v,0),1):Math.round(1e4*v)/1e4)];var v;return`rgba(${m[0]}, ${m[1]}, ${m[2]}, ${m[3]})`}K(t){const e=this.q.get(t);if(e)return e;const i=(function(h){const l=document.createElement("div");l.style.display="none",document.body.appendChild(l),l.style.color=h;const c=window.getComputedStyle(l).color;return document.body.removeChild(l),c})(t),s=i.match(/^rgba?\s*\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d+))?\)$/);if(!s){if(this.Y.length)for(const h of this.Y){const l=h(t);if(l)return this.q.set(t,l),l}throw new Error(`Failed to parse color: ${t}`)}const n=[parseInt(s[1],10),parseInt(s[2],10),parseInt(s[3],10),s[4]?parseFloat(s[4]):1];return this.q.set(t,n),n}}class Hd{constructor(){this.it=[]}st(t){this.it=t}nt(t,e,i){this.it.forEach((s=>{s.nt(t,e,i)}))}}class Ee{nt(t,e,i){t.useBitmapCoordinateSpace((s=>this.et(s,e,i)))}}class f1 extends Ee{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.rt===null||this.rt.lt===null)return;const s=this.rt.lt,n=this.rt,h=Math.max(1,Math.floor(e))%2/2,l=c=>{t.beginPath();for(let u=s.to-1;u>=s.from;--u){const d=n.ot[u],p=Math.round(d._t*e)+h,m=d.ut*i,v=c*i+h;t.moveTo(p,m),t.arc(p,m,v,0,2*Math.PI)}t.fill()};n.ct>0&&(t.fillStyle=n.dt,l(n.ft+n.ct)),t.fillStyle=n.vt,l(n.ft)}}function p1(){return{ot:[{_t:0,ut:0,wt:0,gt:0}],vt:"",dt:"",ft:0,ct:0,lt:null}}const m1={from:0,to:1};class g1{constructor(t,e,i){this.Mt=new Hd,this.bt=[],this.St=[],this.xt=!0,this.O=t,this.Ct=e,this.Pt=i,this.Mt.st(this.bt)}kt(t){this.yt(),this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Mt}yt(){const t=this.Pt.Dt();t.length!==this.bt.length&&(this.St=t.map(p1),this.bt=this.St.map((e=>{const i=new f1;return i.ht(e),i})),this.Mt.st(this.bt))}Rt(){const t=this.Ct.N().mode===2||!this.Ct.Vt(),e=this.Pt.It(),i=this.Ct.Bt(),s=this.O.Et();this.yt(),e.forEach(((n,h)=>{const l=this.St[h],c=n.At(i),u=n.zt();!t&&c!==null&&n.Vt()&&u!==null?(l.vt=c.Lt,l.ft=c.ft,l.ct=c.Ot,l.ot[0].gt=c.gt,l.ot[0].ut=n.Ft().Nt(c.gt,u.Wt),l.dt=c.Ht??this.O.Ut(l.ot[0].ut/n.Ft().$t()),l.ot[0].wt=i,l.ot[0]._t=s.qt(i),l.lt=m1):l.lt=null}))}}class v1 extends Ee{constructor(t){super(),this.Yt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.Yt===null)return;const n=this.Yt.jt.Vt,h=this.Yt.Kt.Vt;if(!n&&!h)return;const l=Math.round(this.Yt._t*i),c=Math.round(this.Yt.ut*s);t.lineCap="butt",n&&l>=0&&(t.lineWidth=Math.floor(this.Yt.jt.ct*i),t.strokeStyle=this.Yt.jt.R,t.fillStyle=this.Yt.jt.R,$i(t,this.Yt.jt.Xt),(function(u,d,p,m){u.beginPath();const v=u.lineWidth%2?.5:0;u.moveTo(d+v,p),u.lineTo(d+v,m),u.stroke()})(t,l,0,e.height)),h&&c>=0&&(t.lineWidth=Math.floor(this.Yt.Kt.ct*s),t.strokeStyle=this.Yt.Kt.R,t.fillStyle=this.Yt.Kt.R,$i(t,this.Yt.Kt.Xt),Vd(t,c,0,e.width))}}class b1{constructor(t,e){this.xt=!0,this.Zt={jt:{ct:1,Xt:0,R:"",Vt:!1},Kt:{ct:1,Xt:0,R:"",Vt:!1},_t:0,ut:0},this.Gt=new v1(this.Zt),this.Jt=t,this.Pt=e}kt(){this.xt=!0}Tt(t){return this.xt&&(this.Rt(),this.xt=!1),this.Gt}Rt(){const t=this.Jt.Vt(),e=this.Pt.Qt().N().crosshair,i=this.Zt;if(e.mode===2)return i.Kt.Vt=!1,void(i.jt.Vt=!1);i.Kt.Vt=t&&this.Jt.ti(this.Pt),i.jt.Vt=t&&this.Jt.ii(),i.Kt.ct=e.horzLine.width,i.Kt.Xt=e.horzLine.style,i.Kt.R=e.horzLine.color,i.jt.ct=e.vertLine.width,i.jt.Xt=e.vertLine.style,i.jt.R=e.vertLine.color,i._t=this.Jt.si(),i.ut=this.Jt.ni()}}function w1(r,t,e,i,s,n){r.fillRect(t+n,e,i-2*n,n),r.fillRect(t+n,e+s-n,i-2*n,n),r.fillRect(t,e,n,s),r.fillRect(t+i-n,e,n,s)}function dh(r,t,e,i,s,n){r.save(),r.globalCompositeOperation="copy",r.fillStyle=n,r.fillRect(t,e,i,s),r.restore()}function $a(r,t,e,i,s,n){r.beginPath(),r.roundRect?r.roundRect(t,e,i,s,n):(r.lineTo(t+i-n[1],e),n[1]!==0&&r.arcTo(t+i,e,t+i,e+n[1],n[1]),r.lineTo(t+i,e+s-n[2]),n[2]!==0&&r.arcTo(t+i,e+s,t+i-n[2],e+s,n[2]),r.lineTo(t+n[3],e+s),n[3]!==0&&r.arcTo(t,e+s,t,e+s-n[3],n[3]),r.lineTo(t,e+n[0]),n[0]!==0&&r.arcTo(t,e,t+n[0],e,n[0]))}function za(r,t,e,i,s,n,h=0,l=[0,0,0,0],c=""){if(r.save(),!h||!c||c===n)return $a(r,t,e,i,s,l),r.fillStyle=n,r.fill(),void r.restore();const u=h/2;var d;$a(r,t+u,e+u,i-h,s-h,(d=-u,l.map((p=>p===0?p:p+d)))),n!=="transparent"&&(r.fillStyle=n,r.fill()),c!=="transparent"&&(r.lineWidth=h,r.strokeStyle=c,r.closePath(),r.stroke()),r.restore()}function Ud(r,t,e,i,s,n,h){r.save(),r.globalCompositeOperation="copy";const l=r.createLinearGradient(0,0,0,s);l.addColorStop(0,n),l.addColorStop(1,h),r.fillStyle=l,r.fillRect(t,e,i,s),r.restore()}class Ba{constructor(t,e){this.ht(t,e)}ht(t,e){this.Yt=t,this.ei=e}$t(t,e){return this.Yt.Vt?t.P+t.A+t.V:0}nt(t,e,i,s){if(!this.Yt.Vt||this.Yt.ri.length===0)return;const n=this.Yt.R,h=this.ei.Z,l=t.useBitmapCoordinateSpace((c=>{const u=c.context;u.font=e.k;const d=this.hi(c,e,i,s),p=d.ai;return d.li?za(u,p.oi,p._i,p.ui,p.ci,h,p.di,[p.ft,0,0,p.ft],h):za(u,p.fi,p._i,p.ui,p.ci,h,p.di,[0,p.ft,p.ft,0],h),this.Yt.pi&&(u.fillStyle=n,u.fillRect(p.fi,p.mi,p.wi-p.fi,p.gi)),this.Yt.Mi&&(u.fillStyle=e.D,u.fillRect(d.li?p.bi-p.di:0,p._i,p.di,p.Si-p._i)),d}));t.useMediaCoordinateSpace((({context:c})=>{const u=l.xi;c.font=e.k,c.textAlign=l.li?"right":"left",c.textBaseline="middle",c.fillStyle=n,c.fillText(this.Yt.ri,u.Ci,(u._i+u.Si)/2+u.Pi)}))}hi(t,e,i,s){const{context:n,bitmapSize:h,mediaSize:l,horizontalPixelRatio:c,verticalPixelRatio:u}=t,d=this.Yt.pi||!this.Yt.ki?e.C:0,p=this.Yt.yi?e.S:0,m=e.A+this.ei.Ti,v=e.V+this.ei.Ri,b=e.I,M=e.B,I=this.Yt.ri,k=e.P,D=i.Di(n,I),X=Math.ceil(i.Vi(n,I)),W=k+m+v,Tt=e.S+b+M+X+d,Rt=Math.max(1,Math.floor(u));let kt=Math.round(W*u);kt%2!=Rt%2&&(kt+=1);const ce=p>0?Math.max(1,Math.floor(p*c)):0,Me=Math.round(Tt*c),Qs=Math.round(d*c),Ag=this.ei.Ii??this.ei.Bi,Ta=Math.round(Ag*u)-Math.floor(.5*u),wh=Math.floor(Ta+Rt/2-kt/2),Sa=wh+kt,Tr=s==="right",Na=Tr?l.width-p:p,Ks=Tr?h.width-ce:ce;let _h,yh,Eh;return Tr?(_h=Ks-Me,yh=Ks-Qs,Eh=Na-d-b-p):(_h=Ks+Me,yh=Ks+Qs,Eh=Na+d+b),{li:Tr,ai:{_i:wh,mi:Ta,Si:Sa,ui:Me,ci:kt,ft:2*c,di:ce,oi:_h,fi:Ks,wi:yh,gi:Rt,bi:h.width},xi:{_i:wh/u,Si:Sa/u,Ci:Eh,Pi:D}}}}class fh{constructor(t){this.Ei={Bi:0,Z:"#000",Ri:0,Ti:0},this.Ai={ri:"",Vt:!1,pi:!0,ki:!1,Ht:"",R:"#FFF",Mi:!1,yi:!1},this.zi={ri:"",Vt:!1,pi:!1,ki:!0,Ht:"",R:"#FFF",Mi:!0,yi:!0},this.xt=!0,this.Li=new(t||Ba)(this.Ai,this.Ei),this.Oi=new(t||Ba)(this.zi,this.Ei)}ri(){return this.Ni(),this.Ai.ri}Bi(){return this.Ni(),this.Ei.Bi}kt(){this.xt=!0}$t(t,e=!1){return Math.max(this.Li.$t(t,e),this.Oi.$t(t,e))}Fi(){return this.Ei.Ii||0}Wi(t){this.Ei.Ii=t}Hi(){return this.Ni(),this.Ai.Vt||this.zi.Vt}Ui(){return this.Ni(),this.Ai.Vt}Tt(t){return this.Ni(),this.Ai.pi=this.Ai.pi&&t.N().ticksVisible,this.zi.pi=this.zi.pi&&t.N().ticksVisible,this.Li.ht(this.Ai,this.Ei),this.Oi.ht(this.zi,this.Ei),this.Li}$i(){return this.Ni(),this.Li.ht(this.Ai,this.Ei),this.Oi.ht(this.zi,this.Ei),this.Oi}Ni(){this.xt&&(this.Ai.pi=!0,this.zi.pi=!1,this.qi(this.Ai,this.zi,this.Ei))}}class _1 extends fh{constructor(t,e,i){super(),this.Jt=t,this.Yi=e,this.ji=i}qi(t,e,i){if(t.Vt=!1,this.Jt.N().mode===2)return;const s=this.Jt.N().horzLine;if(!s.labelVisible)return;const n=this.Yi.zt();if(!this.Jt.Vt()||this.Yi.Ki()||n===null)return;const h=this.Yi.Xi().X(s.labelBackgroundColor);i.Z=h.Z,t.R=h.G;const l=2/12*this.Yi.P();i.Ti=l,i.Ri=l;const c=this.ji(this.Yi);i.Bi=c.Bi,t.ri=this.Yi.Zi(c.gt,n),t.Vt=!0}}const y1=/[1-9]/g;class Xd{constructor(){this.Yt=null}ht(t){this.Yt=t}nt(t,e){if(this.Yt===null||this.Yt.Vt===!1||this.Yt.ri.length===0)return;const i=t.useMediaCoordinateSpace((({context:m})=>(m.font=e.k,Math.round(e.Gi.Vi(m,E(this.Yt).ri,y1)))));if(i<=0)return;const s=e.Ji,n=i+2*s,h=n/2,l=this.Yt.Qi;let c=this.Yt.Bi,u=Math.floor(c-h)+.5;u<0?(c+=Math.abs(0-u),u=Math.floor(c-h)+.5):u+n>l&&(c-=Math.abs(l-(u+n)),u=Math.floor(c-h)+.5);const d=u+n,p=Math.ceil(0+e.S+e.C+e.A+e.P+e.V);t.useBitmapCoordinateSpace((({context:m,horizontalPixelRatio:v,verticalPixelRatio:b})=>{const M=E(this.Yt);m.fillStyle=M.Z;const I=Math.round(u*v),k=Math.round(0*b),D=Math.round(d*v),X=Math.round(p*b),W=Math.round(2*v);if(m.beginPath(),m.moveTo(I,k),m.lineTo(I,X-W),m.arcTo(I,X,I+W,X,W),m.lineTo(D-W,X),m.arcTo(D,X,D,X-W,W),m.lineTo(D,k),m.fill(),M.pi){const Tt=Math.round(M.Bi*v),Rt=k,kt=Math.round((Rt+e.C)*b);m.fillStyle=M.R;const ce=Math.max(1,Math.floor(v)),Me=Math.floor(.5*v);m.fillRect(Tt-Me,Rt,ce,kt-Rt)}})),t.useMediaCoordinateSpace((({context:m})=>{const v=E(this.Yt),b=0+e.S+e.C+e.A+e.P/2;m.font=e.k,m.textAlign="left",m.textBaseline="middle",m.fillStyle=v.R;const M=e.Gi.Di(m,"Apr0");m.translate(u+s,b+M),m.fillText(v.ri,0,0)}))}}class E1{constructor(t,e,i){this.xt=!0,this.Gt=new Xd,this.Zt={Vt:!1,Z:"#4c525e",R:"white",ri:"",Qi:0,Bi:NaN,pi:!0},this.Ct=t,this.ts=e,this.ji=i}kt(){this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Gt.ht(this.Zt),this.Gt}Rt(){const t=this.Zt;if(t.Vt=!1,this.Ct.N().mode===2)return;const e=this.Ct.N().vertLine;if(!e.labelVisible)return;const i=this.ts.Et();if(i.Ki())return;t.Qi=i.Qi();const s=this.ji();if(s===null)return;t.Bi=s.Bi;const n=i.ss(this.Ct.Bt());t.ri=i.ns(E(n)),t.Vt=!0;const h=this.ts.Xi().X(e.labelBackgroundColor);t.Z=h.Z,t.R=h.G,t.pi=i.N().ticksVisible}}class Wd{constructor(){this.es=null,this.rs=0}hs(){return this.rs}ls(t){this.rs=t}Ft(){return this.es}_s(t){this.es=t}us(t){return[]}cs(){return[]}Vt(){return!0}}var Fa;(function(r){r[r.Normal=0]="Normal",r[r.Magnet=1]="Magnet",r[r.Hidden=2]="Hidden",r[r.MagnetOHLC=3]="MagnetOHLC"})(Fa||(Fa={}));class M1 extends Wd{constructor(t,e){super(),this.Pt=null,this.ds=NaN,this.fs=0,this.ps=!1,this.vs=new Map,this.ws=!1,this.gs=new WeakMap,this.Ms=new WeakMap,this.bs=NaN,this.Ss=NaN,this.xs=NaN,this.Cs=NaN,this.ts=t,this.Ps=e,this.ks=((s,n)=>h=>{const l=n(),c=s();if(h===E(this.Pt).ys())return{gt:c,Bi:l};{const u=E(h.zt());return{gt:h.Ts(l,u),Bi:l}}})((()=>this.ds),(()=>this.Ss));const i=((s,n)=>()=>{const h=this.ts.Et().Rs(s()),l=n();return h&&Number.isFinite(l)?{wt:h,Bi:l}:null})((()=>this.fs),(()=>this.si()));this.Ds=new E1(this,t,i)}N(){return this.Ps}Vs(t,e){this.xs=t,this.Cs=e}Is(){this.xs=NaN,this.Cs=NaN}Bs(){return this.xs}Es(){return this.Cs}As(t,e,i){this.ws||(this.ws=!0),this.ps=!0,this.zs(t,e,i)}Bt(){return this.fs}si(){return this.bs}ni(){return this.Ss}Vt(){return this.ps}Ls(){this.ps=!1,this.Os(),this.ds=NaN,this.bs=NaN,this.Ss=NaN,this.Pt=null,this.Is(),this.Ns()}Fs(t){let e=this.gs.get(t);e||(e=new b1(this,t),this.gs.set(t,e));let i=this.Ms.get(t);return i||(i=new g1(this.ts,this,t),this.Ms.set(t,i)),[e,i]}ti(t){return t===this.Pt&&this.Ps.horzLine.visible}ii(){return this.Ps.vertLine.visible}Ws(t,e){this.ps&&this.Pt===t||this.vs.clear();const i=[];return this.Pt===t&&i.push(this.Hs(this.vs,e,this.ks)),i}cs(){return this.ps?[this.Ds]:[]}Us(){return this.Pt}Ns(){this.ts.$s().forEach((t=>{var e,i;(e=this.gs.get(t))==null||e.kt(),(i=this.Ms.get(t))==null||i.kt()})),this.vs.forEach((t=>t.kt())),this.Ds.kt()}qs(t){return t&&!t.ys().Ki()?t.ys():null}zs(t,e,i){this.Ys(t,e,i)&&this.Ns()}Ys(t,e,i){const s=this.bs,n=this.Ss,h=this.ds,l=this.fs,c=this.Pt,u=this.qs(i);this.fs=t,this.bs=isNaN(t)?NaN:this.ts.Et().qt(t),this.Pt=i;const d=u!==null?u.zt():null;return u!==null&&d!==null?(this.ds=e,this.Ss=u.Nt(e,d)):(this.ds=NaN,this.Ss=NaN),s!==this.bs||n!==this.Ss||l!==this.fs||h!==this.ds||c!==this.Pt}Os(){const t=this.ts.js().map((i=>i.Xs().Ks())).filter(c1),e=t.length===0?null:Math.max(...t);this.fs=e!==null?e:NaN}Hs(t,e,i){let s=t.get(e);return s===void 0&&(s=new _1(this,e,i),t.set(e,s)),s}}function ph(r){return r==="left"||r==="right"}class lt{constructor(t){this.Zs=new Map,this.Gs=[],this.Js=t}Qs(t,e){const i=(function(s,n){return s===void 0?n:{tn:Math.max(s.tn,n.tn),sn:s.sn||n.sn}})(this.Zs.get(t),e);this.Zs.set(t,i)}nn(){return this.Js}en(t){const e=this.Zs.get(t);return e===void 0?{tn:this.Js}:{tn:Math.max(this.Js,e.tn),sn:e.sn}}rn(){this.hn(),this.Gs=[{an:0}]}ln(t){this.hn(),this.Gs=[{an:1,Wt:t}]}_n(t){this.un(),this.Gs.push({an:5,Wt:t})}hn(){this.un(),this.Gs.push({an:6})}cn(){this.hn(),this.Gs=[{an:4}]}dn(t){this.hn(),this.Gs.push({an:2,Wt:t})}fn(t){this.hn(),this.Gs.push({an:3,Wt:t})}pn(){return this.Gs}vn(t){for(const e of t.Gs)this.mn(e);this.Js=Math.max(this.Js,t.Js),t.Zs.forEach(((e,i)=>{this.Qs(i,e)}))}static wn(){return new lt(2)}static gn(){return new lt(3)}mn(t){switch(t.an){case 0:this.rn();break;case 1:this.ln(t.Wt);break;case 2:this.dn(t.Wt);break;case 3:this.fn(t.Wt);break;case 4:this.cn();break;case 5:this._n(t.Wt);break;case 6:this.un()}}un(){const t=this.Gs.findIndex((e=>e.an===5));t!==-1&&this.Gs.splice(t,1)}}class qd{formatTickmarks(t){return t.map((e=>this.format(e)))}}const Va=".";function _e(r,t){if(!zi(r))return"n/a";if(!Pn(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return t===0?r.toString():("0000000000000000"+r.toString()).slice(-t)}class mh extends qd{constructor(t,e){if(super(),e||(e=1),zi(t)&&Pn(t)||(t=100),t<0)throw new TypeError("invalid base");this.Yi=t,this.Mn=e,this.bn()}format(t){const e=t<0?"−":"";return t=Math.abs(t),e+this.Sn(t)}bn(){if(this.xn=0,this.Yi>0&&this.Mn>0){let t=this.Yi;for(;t>1;)t/=10,this.xn++}}Sn(t){const e=this.Yi/this.Mn;let i=Math.floor(t),s="";const n=this.xn!==void 0?this.xn:NaN;if(e>1){let h=+(Math.round(t*e)-i*e).toFixed(this.xn);h>=e&&(h-=e,i+=1),s=Va+_e(+h.toFixed(this.xn)*this.Mn,n)}else i=Math.round(i*e)/e,n>0&&(s=Va+_e(0,n));return i.toFixed(0)+s}}class Gd extends mh{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class C1 extends qd{constructor(t){super(),this.Cn=t}format(t){let e="";return t<0&&(e="-",t=-t),t<995?e+this.Pn(t):t<999995?e+this.Pn(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this.Pn(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.Pn(t/1e9)+"B")}Pn(t){let e;const i=Math.pow(10,this.Cn);return e=(t=Math.round(t*i)/i)>=1e-15&&t<1?t.toFixed(this.Cn).replace(/\.?0+$/,""):String(t),e.replace(/(\.[1-9]*)0+$/,((s,n)=>n))}}const x1=/[2-9]/g;class Rn{constructor(t=50){this.kn=0,this.yn=1,this.Tn=1,this.Rn={},this.Dn=new Map,this.Vn=t}In(){this.kn=0,this.Dn.clear(),this.yn=1,this.Tn=1,this.Rn={}}Vi(t,e,i){return this.Bn(t,e,i).width}Di(t,e,i){const s=this.Bn(t,e,i);return((s.actualBoundingBoxAscent||0)-(s.actualBoundingBoxDescent||0))/2}Bn(t,e,i){const s=i||x1,n=String(e).replace(s,"0");if(this.Dn.has(n))return Ct(this.Dn.get(n)).En;if(this.kn===this.Vn){const l=this.Rn[this.Tn];delete this.Rn[this.Tn],this.Dn.delete(l),this.Tn++,this.kn--}t.save(),t.textBaseline="middle";const h=t.measureText(n);return t.restore(),h.width===0&&e.length||(this.Dn.set(n,{En:h,An:this.yn}),this.Rn[this.yn]=n,this.kn++,this.yn++),h}}class T1{constructor(t){this.zn=null,this.M=null,this.Ln="right",this.On=t}Nn(t,e,i){this.zn=t,this.M=e,this.Ln=i}nt(t){this.M!==null&&this.zn!==null&&this.zn.nt(t,this.M,this.On,this.Ln)}}class jd{constructor(t,e,i){this.Fn=t,this.On=new Rn(50),this.Wn=e,this.O=i,this.F=-1,this.Gt=new T1(this.On)}Tt(){const t=this.O.Hn(this.Wn);if(t===null)return null;const e=t.Un(this.Wn)?t.$n():this.Wn.Ft();if(e===null)return null;const i=t.qn(e);if(i==="overlay")return null;const s=this.O.Yn();return s.P!==this.F&&(this.F=s.P,this.On.In()),this.Gt.Nn(this.Fn.$i(),s,i),this.Gt}}class S1 extends Ee{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}jn(t,e){var h;if(!((h=this.Yt)!=null&&h.Vt))return null;const{ut:i,ct:s,Kn:n}=this.Yt;return e>=i-s-7&&e<=i+s+7?{Xn:this.Yt,Kn:n}:null}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.Yt===null||this.Yt.Vt===!1)return;const n=Math.round(this.Yt.ut*s);n<0||n>e.height||(t.lineCap="butt",t.strokeStyle=this.Yt.R,t.lineWidth=Math.floor(this.Yt.ct*i),$i(t,this.Yt.Xt),Vd(t,n,0,e.width))}}class ga{constructor(t){this.Zn={ut:0,R:"rgba(0, 0, 0, 0)",ct:1,Xt:0,Vt:!1},this.Gn=new S1,this.xt=!0,this.Jn=t,this.Qn=t.Qt(),this.Gn.ht(this.Zn)}kt(){this.xt=!0}Tt(){return this.Jn.Vt()?(this.xt&&(this.te(),this.xt=!1),this.Gn):null}}class N1 extends ga{constructor(t){super(t)}te(){this.Zn.Vt=!1;const t=this.Jn.Ft(),e=t.ie().ie;if(e!==2&&e!==3)return;const i=this.Jn.N();if(!i.baseLineVisible||!this.Jn.Vt())return;const s=this.Jn.zt();s!==null&&(this.Zn.Vt=!0,this.Zn.ut=t.Nt(s.Wt,s.Wt),this.Zn.R=i.baseLineColor,this.Zn.ct=i.baseLineWidth,this.Zn.Xt=i.baseLineStyle)}}class I1 extends Ee{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}se(){return this.Yt}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){const s=this.Yt;if(s===null)return;const n=Math.max(1,Math.floor(e)),h=n%2/2,l=Math.round(s.ne.x*e)+h,c=s.ne.y*i;t.fillStyle=s.ee,t.beginPath();const u=Math.max(2,1.5*s.re)*e;t.arc(l,c,u,0,2*Math.PI,!1),t.fill(),t.fillStyle=s.he,t.beginPath(),t.arc(l,c,s.ft*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=n,t.strokeStyle=s.ae,t.beginPath(),t.arc(l,c,s.ft*e+n/2,0,2*Math.PI,!1),t.stroke()}}const O1=[{le:0,oe:.25,_e:4,ue:10,ce:.25,de:0,fe:.4,pe:.8},{le:.25,oe:.525,_e:10,ue:14,ce:0,de:0,fe:.8,pe:0},{le:.525,oe:1,_e:14,ue:14,ce:0,de:0,fe:0,pe:0}];class P1{constructor(t){this.Gt=new I1,this.xt=!0,this.ve=!0,this.me=performance.now(),this.we=this.me-1,this.ge=t}Me(){this.we=this.me-1,this.kt()}be(){if(this.kt(),this.ge.N().lastPriceAnimation===2){const t=performance.now(),e=this.we-t;if(e>0)return void(e<650&&(this.we+=2600));this.me=t,this.we=t+2600}}kt(){this.xt=!0}Se(){this.ve=!0}Vt(){return this.ge.N().lastPriceAnimation!==0}xe(){switch(this.ge.N().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.we}}Tt(){return this.xt?(this.Rt(),this.xt=!1,this.ve=!1):this.ve&&(this.Ce(),this.ve=!1),this.Gt}Rt(){this.Gt.ht(null);const t=this.ge.Qt().Et(),e=t.Pe(),i=this.ge.zt();if(e===null||i===null)return;const s=this.ge.ke(!0);if(s.ye||!e.Te(s.Re))return;const n={x:t.qt(s.Re),y:this.ge.Ft().Nt(s.gt,i.Wt)},h=s.R,l=this.ge.N().lineWidth,c=this.De(this.Ve(),h);this.Gt.ht({ee:h,re:l,he:c.he,ae:c.ae,ft:c.ft,ne:n})}Ce(){const t=this.Gt.se();if(t!==null){const e=this.De(this.Ve(),t.ee);t.he=e.he,t.ae=e.ae,t.ft=e.ft}}Ve(){return this.xe()?performance.now()-this.me:2599}Ie(t,e,i,s){const n=i+(s-i)*e;return this.ge.Qt().Xi().j(t,n)}De(t,e){const i=t%2600/2600;let s;for(const u of O1)if(i>=u.le&&i<=u.oe){s=u;break}ct(s!==void 0,"Last price animation internal logic error");const n=(i-s.le)/(s.oe-s.le);return{he:this.Ie(e,n,s.ce,s.de),ae:this.Ie(e,n,s.fe,s.pe),ft:(h=n,l=s._e,c=s.ue,l+(c-l)*h)};var h,l,c}}class k1 extends ga{constructor(t){super(t)}te(){const t=this.Zn;t.Vt=!1;const e=this.Jn.N();if(!e.priceLineVisible||!this.Jn.Vt())return;const i=this.Jn.ke(e.priceLineSource===0);i.ye||(t.Vt=!0,t.ut=i.Bi,t.R=this.Jn.Be(i.R),t.ct=e.priceLineWidth,t.Xt=e.priceLineStyle)}}class A1 extends fh{constructor(t){super(),this.Jt=t}qi(t,e,i){t.Vt=!1,e.Vt=!1;const s=this.Jt;if(!s.Vt())return;const n=s.N(),h=n.lastValueVisible,l=s.Ee()!=="",c=n.seriesLastValueMode===0,u=s.ke(!1);if(u.ye)return;h&&(t.ri=this.Ae(u,h,c),t.Vt=t.ri.length!==0),(l||c)&&(e.ri=this.ze(u,h,l,c),e.Vt=e.ri.length>0);const d=s.Be(u.R),p=this.Jt.Qt().Xi().X(d);i.Z=p.Z,i.Bi=u.Bi,e.Ht=s.Qt().Ut(u.Bi/s.Ft().$t()),t.Ht=d,t.R=p.G,e.R=p.G}ze(t,e,i,s){let n="";const h=this.Jt.Ee();return i&&h.length!==0&&(n+=`${h} `),e&&s&&(n+=this.Jt.Ft().Le()?t.Oe:t.Ne),n.trim()}Ae(t,e,i){return e?i?this.Jt.Ft().Le()?t.Ne:t.Oe:t.ri:""}}function Ya(r,t,e,i){const s=Number.isFinite(t),n=Number.isFinite(e);return s&&n?r(t,e):s||n?s?t:e:i}class vt{constructor(t,e){this.Fe=t,this.We=e}He(t){return t!==null&&this.Fe===t.Fe&&this.We===t.We}Ue(){return new vt(this.Fe,this.We)}$e(){return this.Fe}qe(){return this.We}Ye(){return this.We-this.Fe}Ki(){return this.We===this.Fe||Number.isNaN(this.We)||Number.isNaN(this.Fe)}vn(t){return t===null?this:new vt(Ya(Math.min,this.$e(),t.$e(),-1/0),Ya(Math.max,this.qe(),t.qe(),1/0))}je(t){if(!zi(t)||this.We-this.Fe===0)return;const e=.5*(this.We+this.Fe);let i=this.We-e,s=this.Fe-e;i*=t,s*=t,this.We=e+i,this.Fe=e+s}Ke(t){zi(t)&&(this.We+=t,this.Fe+=t)}Xe(){return{minValue:this.Fe,maxValue:this.We}}static Ze(t){return t===null?null:new vt(t.minValue,t.maxValue)}}class qr{constructor(t,e){this.Ge=t,this.Je=e||null}Qe(){return this.Ge}tr(){return this.Je}Xe(){return{priceRange:this.Ge===null?null:this.Ge.Xe(),margins:this.Je||void 0}}static Ze(t){return t===null?null:new qr(vt.Ze(t.priceRange),t.margins)}}class R1 extends ga{constructor(t,e){super(t),this.ir=e}te(){const t=this.Zn;t.Vt=!1;const e=this.ir.N();if(!this.Jn.Vt()||!e.lineVisible)return;const i=this.ir.sr();i!==null&&(t.Vt=!0,t.ut=i,t.R=e.color,t.ct=e.lineWidth,t.Xt=e.lineStyle,t.Kn=this.ir.N().id)}}class L1 extends fh{constructor(t,e){super(),this.ge=t,this.ir=e}qi(t,e,i){t.Vt=!1,e.Vt=!1;const s=this.ir.N(),n=s.axisLabelVisible,h=s.title!=="",l=this.ge;if(!n||!l.Vt())return;const c=this.ir.sr();if(c===null)return;h&&(e.ri=s.title,e.Vt=!0),e.Ht=l.Qt().Ut(c/l.Ft().$t()),t.ri=this.nr(s.price),t.Vt=!0;const u=this.ge.Qt().Xi().X(s.axisLabelColor||s.color);i.Z=u.Z;const d=s.axisLabelTextColor||u.G;t.R=d,e.R=d,i.Bi=c}nr(t){const e=this.ge.zt();return e===null?"":this.ge.Ft().Zi(t,e.Wt)}}class D1{constructor(t,e){this.ge=t,this.Ps=e,this.er=new R1(t,this),this.Fn=new L1(t,this),this.rr=new jd(this.Fn,t,t.Qt())}hr(t){It(this.Ps,t),this.kt(),this.ge.Qt().ar()}N(){return this.Ps}lr(){return this.er}_r(){return this.rr}ur(){return this.Fn}kt(){this.er.kt(),this.Fn.kt()}sr(){const t=this.ge,e=t.Ft();if(t.Qt().Et().Ki()||e.Ki())return null;const i=t.zt();return i===null?null:e.Nt(this.Ps.price,i.Wt)}}class $1 extends Wd{constructor(t){super(),this.ts=t}Qt(){return this.ts}}const z1={Bar:(r,t,e,i)=>{const s=t.upColor,n=t.downColor,h=E(r(e,i)),l=Ge(h.Wt[0])<=Ge(h.Wt[3]);return{cr:h.R??(l?s:n)}},Candlestick:(r,t,e,i)=>{const s=t.upColor,n=t.downColor,h=t.borderUpColor,l=t.borderDownColor,c=t.wickUpColor,u=t.wickDownColor,d=E(r(e,i)),p=Ge(d.Wt[0])<=Ge(d.Wt[3]);return{cr:d.R??(p?s:n),dr:d.Ht??(p?h:l),pr:d.vr??(p?c:u)}},Custom:(r,t,e,i)=>({cr:E(r(e,i)).R??t.color}),Area:(r,t,e,i)=>{const s=E(r(e,i));return{cr:s.vt??t.lineColor,vt:s.vt??t.lineColor,mr:s.mr??t.topColor,wr:s.wr??t.bottomColor}},Baseline:(r,t,e,i)=>{const s=E(r(e,i));return{cr:s.Wt[3]>=t.baseValue.price?t.topLineColor:t.bottomLineColor,gr:s.gr??t.topLineColor,Mr:s.Mr??t.bottomLineColor,br:s.br??t.topFillColor1,Sr:s.Sr??t.topFillColor2,Cr:s.Cr??t.bottomFillColor1,Pr:s.Pr??t.bottomFillColor2}},Line:(r,t,e,i)=>{const s=E(r(e,i));return{cr:s.R??t.color,vt:s.R??t.color}},Histogram:(r,t,e,i)=>({cr:E(r(e,i)).R??t.color})};class B1{constructor(t){this.kr=(e,i)=>i!==void 0?i.Wt:this.ge.Xs().yr(e),this.ge=t,this.Tr=z1[t.Rr()]}Dr(t,e){return this.Tr(this.kr,this.ge.N(),t,e)}}function Zd(r,t,e,i,s=0,n=t.length){let h=n-s;for(;0<h;){const l=h>>1,c=s+l;i(t[c],e)===r?(s=c+1,h-=l+1):h=l}return s}const zs=Zd.bind(null,!0),Qd=Zd.bind(null,!1);var Ha;(function(r){r[r.NearestLeft=-1]="NearestLeft",r[r.None=0]="None",r[r.NearestRight=1]="NearestRight"})(Ha||(Ha={}));const Ce=30;class F1{constructor(){this.Vr=[],this.Ir=new Map,this.Br=new Map,this.Er=[]}Ar(){return this.zr()>0?this.Vr[this.Vr.length-1]:null}Lr(){return this.zr()>0?this.Or(0):null}Ks(){return this.zr()>0?this.Or(this.Vr.length-1):null}zr(){return this.Vr.length}Ki(){return this.zr()===0}Te(t){return this.Nr(t,0)!==null}yr(t){return this.Fr(t)}Fr(t,e=0){const i=this.Nr(t,e);return i===null?null:{...this.Wr(i),Re:this.Or(i)}}Hr(){return this.Vr}Ur(t,e,i){if(this.Ki())return null;let s=null;for(const n of i)s=Nr(s,this.$r(t,e,n));return s}ht(t){this.Br.clear(),this.Ir.clear(),this.Vr=t,this.Er=t.map((e=>e.Re))}qr(){return this.Er}Or(t){return this.Vr[t].Re}Wr(t){return this.Vr[t]}Nr(t,e){const i=this.Yr(t);if(i===null&&e!==0)switch(e){case-1:return this.jr(t);case 1:return this.Kr(t);default:throw new TypeError("Unknown search mode")}return i}jr(t){let e=this.Xr(t);return e>0&&(e-=1),e!==this.Vr.length&&this.Or(e)<t?e:null}Kr(t){const e=this.Zr(t);return e!==this.Vr.length&&t<this.Or(e)?e:null}Yr(t){const e=this.Xr(t);return e===this.Vr.length||t<this.Vr[e].Re?null:e}Xr(t){return zs(this.Vr,t,((e,i)=>e.Re<i))}Zr(t){return Qd(this.Vr,t,((e,i)=>e.Re>i))}Gr(t,e,i){let s=null;for(let n=t;n<e;n++){const h=this.Vr[n].Wt[i];Number.isNaN(h)||(s===null?s={Jr:h,Qr:h}:(h<s.Jr&&(s.Jr=h),h>s.Qr&&(s.Qr=h)))}return s}$r(t,e,i){if(this.Ki())return null;let s=null;const n=E(this.Lr()),h=E(this.Ks()),l=Math.max(t,n),c=Math.min(e,h),u=Math.ceil(l/Ce)*Ce,d=Math.max(u,Math.floor(c/Ce)*Ce);{const m=this.Xr(l),v=this.Zr(Math.min(c,u,e));s=Nr(s,this.Gr(m,v,i))}let p=this.Ir.get(i);p===void 0&&(p=new Map,this.Ir.set(i,p));for(let m=Math.max(u+1,l);m<d;m+=Ce){const v=Math.floor(m/Ce);let b=p.get(v);if(b===void 0){const M=this.Xr(v*Ce),I=this.Zr((v+1)*Ce-1);b=this.Gr(M,I,i),p.set(v,b)}s=Nr(s,b)}{const m=this.Xr(d),v=this.Zr(c);s=Nr(s,this.Gr(m,v,i))}return s}}function Nr(r,t){return r===null?t:t===null?r:{Jr:Math.min(r.Jr,t.Jr),Qr:Math.max(r.Qr,t.Qr)}}class V1{constructor(t){this.th=t}nt(t,e,i){this.th.draw(t)}ih(t,e,i){var s,n;(n=(s=this.th).drawBackground)==null||n.call(s,t)}}class Y1{constructor(t){this.Dn=null,this.sh=t}Tt(){var i;const t=this.sh.renderer();if(t===null)return null;if(((i=this.Dn)==null?void 0:i.nh)===t)return this.Dn.eh;const e=new V1(t);return this.Dn={nh:t,eh:e},e}rh(){var t,e;return((e=(t=this.sh).zOrder)==null?void 0:e.call(t))??"normal"}}class Kd{constructor(t){this.hh=null,this.ah=t}oh(){return this.ah}Ns(){var t,e;(e=(t=this.ah).updateAllViews)==null||e.call(t)}Fs(){var i,s,n;const t=((s=(i=this.ah).paneViews)==null?void 0:s.call(i))??[];if(((n=this.hh)==null?void 0:n.nh)===t)return this.hh.eh;const e=t.map((h=>new Y1(h)));return this.hh={nh:t,eh:e},e}jn(t,e){var i,s;return((s=(i=this.ah).hitTest)==null?void 0:s.call(i,t,e))??null}}let H1=class extends Kd{us(){return[]}};class U1{constructor(t){this.th=t}nt(t,e,i){this.th.draw(t)}ih(t,e,i){var s,n;(n=(s=this.th).drawBackground)==null||n.call(s,t)}}class Ua{constructor(t){this.Dn=null,this.sh=t}Tt(){var i;const t=this.sh.renderer();if(t===null)return null;if(((i=this.Dn)==null?void 0:i.nh)===t)return this.Dn.eh;const e=new U1(t);return this.Dn={nh:t,eh:e},e}rh(){var t,e;return((e=(t=this.sh).zOrder)==null?void 0:e.call(t))??"normal"}}function Jd(r){var t,e,i;return{ri:r.text(),Bi:r.coordinate(),Ii:(t=r.fixedCoordinate)==null?void 0:t.call(r),R:r.textColor(),Z:r.backColor(),Vt:((e=r.visible)==null?void 0:e.call(r))??!0,pi:((i=r.tickVisible)==null?void 0:i.call(r))??!0}}class X1{constructor(t,e){this.Gt=new Xd,this._h=t,this.uh=e}Tt(){return this.Gt.ht({Qi:this.uh.Qi(),...Jd(this._h)}),this.Gt}}class W1 extends fh{constructor(t,e){super(),this._h=t,this.Yi=e}qi(t,e,i){const s=Jd(this._h);i.Z=s.Z,t.R=s.R;const n=2/12*this.Yi.P();i.Ti=n,i.Ri=n,i.Bi=s.Bi,i.Ii=s.Ii,t.ri=s.ri,t.Vt=s.Vt,t.pi=s.pi}}class q1 extends Kd{constructor(t,e){super(t),this.dh=null,this.fh=null,this.ph=null,this.mh=null,this.ge=e}cs(){var s,n,h;const t=((n=(s=this.ah).timeAxisViews)==null?void 0:n.call(s))??[];if(((h=this.dh)==null?void 0:h.nh)===t)return this.dh.eh;const e=this.ge.Qt().Et(),i=t.map((l=>new X1(l,e)));return this.dh={nh:t,eh:i},i}Ws(){var s,n,h;const t=((n=(s=this.ah).priceAxisViews)==null?void 0:n.call(s))??[];if(((h=this.fh)==null?void 0:h.nh)===t)return this.fh.eh;const e=this.ge.Ft(),i=t.map((l=>new W1(l,e)));return this.fh={nh:t,eh:i},i}wh(){var i,s,n;const t=((s=(i=this.ah).priceAxisPaneViews)==null?void 0:s.call(i))??[];if(((n=this.ph)==null?void 0:n.nh)===t)return this.ph.eh;const e=t.map((h=>new Ua(h)));return this.ph={nh:t,eh:e},e}gh(){var i,s,n;const t=((s=(i=this.ah).timeAxisPaneViews)==null?void 0:s.call(i))??[];if(((n=this.mh)==null?void 0:n.nh)===t)return this.mh.eh;const e=t.map((h=>new Ua(h)));return this.mh={nh:t,eh:e},e}Mh(t,e){var i,s;return((s=(i=this.ah).autoscaleInfo)==null?void 0:s.call(i,t,e))??null}}function xh(r,t,e,i){r.forEach((s=>{t(s).forEach((n=>{n.rh()===e&&i.push(n)}))}))}function Th(r){return r.Fs()}function G1(r){return r.wh()}function j1(r){return r.gh()}const Z1=["Area","Line","Baseline"];class gh extends $1{constructor(t,e,i,s,n){super(t),this.Yt=new F1,this.er=new k1(this),this.bh=[],this.Sh=new N1(this),this.xh=null,this.Ch=null,this.Ph=null,this.kh=[],this.Ps=i,this.yh=e;const h=new A1(this);this.vs=[h],this.rr=new jd(h,this,t),Z1.includes(this.yh)&&(this.xh=new P1(this)),this.Th(),this.sh=s(this,this.Qt(),n)}m(){this.Ph!==null&&clearTimeout(this.Ph)}Be(t){return this.Ps.priceLineColor||t}ke(t){const e={ye:!0},i=this.Ft();if(this.Qt().Et().Ki()||i.Ki()||this.Yt.Ki())return e;const s=this.Qt().Et().Pe(),n=this.zt();if(s===null||n===null)return e;let h,l;if(t){const p=this.Yt.Ar();if(p===null)return e;h=p,l=p.Re}else{const p=this.Yt.Fr(s.bi(),-1);if(p===null||(h=this.Yt.yr(p.Re),h===null))return e;l=p.Re}const c=h.Wt[3],u=this.Rh().Dr(l,{Wt:h}),d=i.Nt(c,n.Wt);return{ye:!1,gt:c,ri:i.Zi(c,n.Wt),Oe:i.Dh(c),Ne:i.Vh(c,n.Wt),R:u.cr,Bi:d,Re:l}}Rh(){return this.Ch!==null||(this.Ch=new B1(this)),this.Ch}N(){return this.Ps}hr(t){const e=t.priceScaleId;e!==void 0&&e!==this.Ps.priceScaleId&&this.Qt().Ih(this,e),It(this.Ps,t),t.priceFormat!==void 0&&(this.Th(),this.Qt().Bh()),this.Qt().Eh(this),this.Qt().Ah(),this.sh.kt("options")}ht(t,e){this.Yt.ht(t),this.sh.kt("data"),this.xh!==null&&(e&&e.zh?this.xh.be():t.length===0&&this.xh.Me());const i=this.Qt().Hn(this);this.Qt().Lh(i),this.Qt().Eh(this),this.Qt().Ah(),this.Qt().ar()}Oh(t){const e=new D1(this,t);return this.bh.push(e),this.Qt().Eh(this),e}Nh(t){const e=this.bh.indexOf(t);e!==-1&&this.bh.splice(e,1),this.Qt().Eh(this)}Fh(){return this.bh}Rr(){return this.yh}zt(){const t=this.Wh();return t===null?null:{Wt:t.Wt[3],Hh:t.wt}}Wh(){const t=this.Qt().Et().Pe();if(t===null)return null;const e=t.Uh();return this.Yt.Fr(e,1)}Xs(){return this.Yt}$h(t){const e=this.Yt.yr(t);return e===null?null:this.yh==="Bar"||this.yh==="Candlestick"||this.yh==="Custom"?{qh:e.Wt[0],Yh:e.Wt[1],jh:e.Wt[2],Kh:e.Wt[3]}:e.Wt[3]}Xh(t){const e=[];xh(this.kh,Th,"top",e);const i=this.xh;return i!==null&&i.Vt()&&(this.Ph===null&&i.xe()&&(this.Ph=setTimeout((()=>{this.Ph=null,this.Qt().Zh()}),0)),i.Se(),e.unshift(i)),e}Fs(){const t=[];this.Gh()||t.push(this.Sh),t.push(this.sh,this.er);const e=this.bh.map((i=>i.lr()));return t.push(...e),xh(this.kh,Th,"normal",t),t}Jh(){return this.Qh(Th,"bottom")}ta(t){return this.Qh(G1,t)}ia(t){return this.Qh(j1,t)}sa(t,e){return this.kh.map((i=>i.jn(t,e))).filter((i=>i!==null))}us(){return[this.rr,...this.bh.map((t=>t._r()))]}Ws(t,e){if(e!==this.es&&!this.Gh())return[];const i=[...this.vs];for(const s of this.bh)i.push(s.ur());return this.kh.forEach((s=>{i.push(...s.Ws())})),i}cs(){const t=[];return this.kh.forEach((e=>{t.push(...e.cs())})),t}Mh(t,e){if(this.Ps.autoscaleInfoProvider!==void 0){const i=this.Ps.autoscaleInfoProvider((()=>{const s=this.na(t,e);return s===null?null:s.Xe()}));return qr.Ze(i)}return this.na(t,e)}ea(){return this.Ps.priceFormat.minMove}ra(){return this.ha}Ns(){var t;this.sh.kt();for(const e of this.vs)e.kt();for(const e of this.bh)e.kt();this.er.kt(),this.Sh.kt(),(t=this.xh)==null||t.kt(),this.kh.forEach((e=>e.Ns()))}Ft(){return E(super.Ft())}At(t){if(!((this.yh==="Line"||this.yh==="Area"||this.yh==="Baseline")&&this.Ps.crosshairMarkerVisible))return null;const e=this.Yt.yr(t);return e===null?null:{gt:e.Wt[3],ft:this.aa(),Ht:this.la(),Ot:this.oa(),Lt:this._a(t)}}Ee(){return this.Ps.title}Vt(){return this.Ps.visible}ua(t){this.kh.push(new q1(t,this))}ca(t){this.kh=this.kh.filter((e=>e.oh()!==t))}da(){if(this.yh==="Custom")return t=>this.sh.fa(t)}pa(){if(this.yh==="Custom")return t=>this.sh.va(t)}ma(){return this.Yt.qr()}Gh(){return!ph(this.Ft().wa())}na(t,e){if(!Pn(t)||!Pn(e)||this.Yt.Ki())return null;const i=this.yh==="Line"||this.yh==="Area"||this.yh==="Baseline"||this.yh==="Histogram"?[3]:[2,1],s=this.Yt.Ur(t,e,i);let n=s!==null?new vt(s.Jr,s.Qr):null,h=null;if(this.Rr()==="Histogram"){const l=this.Ps.base,c=new vt(l,l);n=n!==null?n.vn(c):c}return this.kh.forEach((l=>{const c=l.Mh(t,e);if(c!=null&&c.priceRange){const u=new vt(c.priceRange.minValue,c.priceRange.maxValue);n=n!==null?n.vn(u):u}c!=null&&c.margins&&(h=c.margins)})),new qr(n,h)}aa(){switch(this.yh){case"Line":case"Area":case"Baseline":return this.Ps.crosshairMarkerRadius}return 0}la(){switch(this.yh){case"Line":case"Area":case"Baseline":{const t=this.Ps.crosshairMarkerBorderColor;if(t.length!==0)return t}}return null}oa(){switch(this.yh){case"Line":case"Area":case"Baseline":return this.Ps.crosshairMarkerBorderWidth}return 0}_a(t){switch(this.yh){case"Line":case"Area":case"Baseline":{const e=this.Ps.crosshairMarkerBackgroundColor;if(e.length!==0)return e}}return this.Rh().Dr(t).cr}Th(){switch(this.Ps.priceFormat.type){case"custom":{const t=this.Ps.priceFormat.formatter;this.ha={format:t,formatTickmarks:this.Ps.priceFormat.tickmarksFormatter??(e=>e.map(t))};break}case"volume":this.ha=new C1(this.Ps.priceFormat.precision);break;case"percent":this.ha=new Gd(this.Ps.priceFormat.precision);break;default:{const t=Math.pow(10,this.Ps.priceFormat.precision);this.ha=new mh(t,this.Ps.priceFormat.minMove*t)}}this.es!==null&&this.es.ga()}Qh(t,e){const i=[];return xh(this.kh,t,e,i),i}}const Q1=[3],K1=[0,1,2,3];class J1{constructor(t){this.Ps=t}Ma(t,e,i){let s=t;if(this.Ps.mode===0)return s;const n=i.ys(),h=n.zt();if(h===null)return s;const l=n.Nt(t,h),c=i.ba().filter((d=>d instanceof gh)).reduce(((d,p)=>{if(i.Un(p)||!p.Vt())return d;const m=p.Ft(),v=p.Xs();if(m.Ki()||!v.Te(e))return d;const b=v.yr(e);if(b===null)return d;const M=Ge(p.zt()),I=this.Ps.mode===3?K1:Q1;return d.concat(I.map((k=>m.Nt(b.Wt[k],M.Wt))))}),[]);if(c.length===0)return s;c.sort(((d,p)=>Math.abs(d-l)-Math.abs(p-l)));const u=c[0];return s=n.Ts(u,h),s}}function es(r,t,e){return Math.min(Math.max(r,t),e)}function Ir(r,t,e){return t-r<=e}function va(r){const t=Math.ceil(r);return t%2==0?t-1:t}class tb extends Ee{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.Yt===null)return;const n=Math.max(1,Math.floor(i));t.lineWidth=n,(function(h,l){h.save(),h.lineWidth%2&&h.translate(.5,.5),l(),h.restore()})(t,(()=>{const h=E(this.Yt);if(h.Sa){t.strokeStyle=h.xa,$i(t,h.Ca),t.beginPath();for(const l of h.Pa){const c=Math.round(l.ka*i);t.moveTo(c,-n),t.lineTo(c,e.height+n)}t.stroke()}if(h.ya){t.strokeStyle=h.Ta,$i(t,h.Ra),t.beginPath();for(const l of h.Da){const c=Math.round(l.ka*s);t.moveTo(-n,c),t.lineTo(e.width+n,c)}t.stroke()}}))}}class eb{constructor(t){this.Gt=new tb,this.xt=!0,this.Pt=t}kt(){this.xt=!0}Tt(){if(this.xt){const t=this.Pt.Qt().N().grid,e={ya:t.horzLines.visible,Sa:t.vertLines.visible,Ta:t.horzLines.color,xa:t.vertLines.color,Ra:t.horzLines.style,Ca:t.vertLines.style,Da:this.Pt.ys().Va(),Pa:(this.Pt.Qt().Et().Va()||[]).map((i=>({ka:i.coord})))};this.Gt.ht(e),this.xt=!1}return this.Gt}}class ib{constructor(t){this.sh=new eb(t)}lr(){return this.sh}}const Sh={Ia:4,Ba:1e-4};function ts(r,t){const e=100*(r-t)/t;return t<0?-e:e}function sb(r,t){const e=ts(r.$e(),t),i=ts(r.qe(),t);return new vt(e,i)}function _n(r,t){const e=100*(r-t)/t+100;return t<0?-e:e}function nb(r,t){const e=_n(r.$e(),t),i=_n(r.qe(),t);return new vt(e,i)}function Gr(r,t){const e=Math.abs(r);if(e<1e-15)return 0;const i=Math.log10(e+t.Ba)+t.Ia;return r<0?-i:i}function yn(r,t){const e=Math.abs(r);if(e<1e-15)return 0;const i=Math.pow(10,e-t.Ia)-t.Ba;return r<0?-i:i}function Js(r,t){if(r===null)return null;const e=Gr(r.$e(),t),i=Gr(r.qe(),t);return new vt(e,i)}function gn(r,t){if(r===null)return null;const e=yn(r.$e(),t),i=yn(r.qe(),t);return new vt(e,i)}function Nh(r){if(r===null)return Sh;const t=Math.abs(r.qe()-r.$e());if(t>=1||t<1e-15)return Sh;const e=Math.ceil(Math.abs(Math.log10(t))),i=Sh.Ia+e;return{Ia:i,Ba:1/Math.pow(10,i)}}class Ih{constructor(t,e){if(this.Ea=t,this.Aa=e,(function(i){if(i<0)return!1;for(let s=i;s>1;s/=10)if(s%10!=0)return!1;return!0})(this.Ea))this.za=[2,2.5,2];else{this.za=[];for(let i=this.Ea;i!==1;){if(i%2==0)this.za.push(2),i/=2;else{if(i%5!=0)throw new Error("unexpected base");this.za.push(2,2.5),i/=5}if(this.za.length>100)throw new Error("something wrong with base")}}}La(t,e,i){const s=this.Ea===0?0:1/this.Ea;let n=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-e)))),h=0,l=this.Aa[0];for(;;){const p=Ir(n,s,1e-14)&&n>s+1e-14,m=Ir(n,i*l,1e-14),v=Ir(n,1,1e-14);if(!(p&&m&&v))break;n/=l,l=this.Aa[++h%this.Aa.length]}if(n<=s+1e-14&&(n=s),n=Math.max(1,n),this.za.length>0&&(c=n,u=1,d=1e-14,Math.abs(c-u)<d))for(h=0,l=this.za[0];Ir(n,i*l,1e-14)&&n>s+1e-14;)n/=l,l=this.za[++h%this.za.length];var c,u,d;return n}}class Xa{constructor(t,e,i,s){this.Oa=[],this.Yi=t,this.Ea=e,this.Na=i,this.Fa=s}La(t,e){if(t<e)throw new Error("high < low");const i=this.Yi.$t(),s=(t-e)*this.Wa()/i,n=new Ih(this.Ea,[2,2.5,2]),h=new Ih(this.Ea,[2,2,2.5]),l=new Ih(this.Ea,[2.5,2,2]),c=[];return c.push(n.La(t,e,s),h.La(t,e,s),l.La(t,e,s)),(function(u){if(u.length<1)throw Error("array is empty");let d=u[0];for(let p=1;p<u.length;++p)u[p]<d&&(d=u[p]);return d})(c)}Ha(){const t=this.Yi,e=t.zt();if(e===null)return void(this.Oa=[]);const i=t.$t(),s=this.Na(i-1,e),n=this.Na(0,e),h=this.Yi.N().entireTextOnly?this.Ua()/2:0,l=h,c=i-1-h,u=Math.max(s,n),d=Math.min(s,n);if(u===d)return void(this.Oa=[]);const p=this.La(u,d);if(this.$a(e,p,u,d,l,c),t.qa()&&this.Ya(p,d,u)){const b=this.Yi.ja();this.Ka(e,p,l,c,b,2*b)}const m=this.Oa.map((b=>b.Xa)),v=this.Yi.Za(m);for(let b=0;b<this.Oa.length;b++)this.Oa[b].Ga=v[b]}Va(){return this.Oa}Ua(){return this.Yi.P()}Wa(){return Math.ceil(2.5*this.Ua())}$a(t,e,i,s,n,h){const l=this.Oa,c=this.Yi;let u=i%e;u+=u<0?e:0;const d=i>=s?1:-1;let p=null,m=0;for(let v=i-u;v>s;v-=e){const b=this.Fa(v,t,!0);p!==null&&Math.abs(b-p)<this.Wa()||b<n||b>h||(m<l.length?(l[m].ka=b,l[m].Ga=c.Ja(v),l[m].Xa=v):l.push({ka:b,Ga:c.Ja(v),Xa:v}),m++,p=b,c.Qa()&&(e=this.La(v*d,s)))}l.length=m}Ka(t,e,i,s,n,h){const l=this.Oa,c=this.tl(t,i,n,h),u=this.tl(t,s,-h,-n),d=this.Fa(0,t,!0)-this.Fa(e,t,!0);l.length>0&&l[0].ka-c.ka<d/2&&l.shift(),l.length>0&&u.ka-l[l.length-1].ka<d/2&&l.pop(),l.unshift(c),l.push(u)}tl(t,e,i,s){const n=(i+s)/2,h=this.Na(e+i,t),l=this.Na(e+s,t),c=Math.min(h,l),u=Math.max(h,l),d=Math.max(.1,this.La(u,c)),p=this.Na(e+n,t),m=p-p%d,v=this.Fa(m,t,!0);return{Ga:this.Yi.Ja(m),ka:v,Xa:m}}Ya(t,e,i){let s=Ge(this.Yi.Qe());return this.Yi.Qa()&&(s=gn(s,this.Yi.il())),s.$e()-e<t&&i-s.qe()<t}}function tf(r){return r.slice().sort(((t,e)=>E(t.hs())-E(e.hs())))}var Wa;(function(r){r[r.Normal=0]="Normal",r[r.Logarithmic=1]="Logarithmic",r[r.Percentage=2]="Percentage",r[r.IndexedTo100=3]="IndexedTo100"})(Wa||(Wa={}));const qa=new Gd,Ga=new mh(100,1);class rb{constructor(t,e,i,s,n){this.sl=0,this.nl=null,this.Ge=null,this.el=null,this.rl={hl:!1,al:null},this.ll=!1,this.ol=0,this._l=0,this.ul=new Z,this.cl=new Z,this.dl=[],this.fl=null,this.pl=null,this.vl=null,this.ml=null,this.wl=null,this.ha=Ga,this.gl=Nh(null),this.Ml=t,this.Ps=e,this.bl=i,this.Sl=s,this.xl=n,this.Cl=new Xa(this,100,this.Pl.bind(this),this.kl.bind(this))}wa(){return this.Ml}N(){return this.Ps}hr(t){if(It(this.Ps,t),this.ga(),t.mode!==void 0&&this.yl({ie:t.mode}),t.scaleMargins!==void 0){const e=Ct(t.scaleMargins.top),i=Ct(t.scaleMargins.bottom);if(e<0||e>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${e}`);if(i<0||i>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${i}`);if(e+i>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${e+i}`);this.Tl(),this.vl=null}}Rl(){return this.Ps.autoScale}Dl(){return this.ll}Qa(){return this.Ps.mode===1}Le(){return this.Ps.mode===2}Vl(){return this.Ps.mode===3}il(){return this.gl}ie(){return{sn:this.Ps.autoScale,Il:this.Ps.invertScale,ie:this.Ps.mode}}yl(t){const e=this.ie();let i=null;t.sn!==void 0&&(this.Ps.autoScale=t.sn),t.ie!==void 0&&(this.Ps.mode=t.ie,t.ie!==2&&t.ie!==3||(this.Ps.autoScale=!0),this.rl.hl=!1),e.ie===1&&t.ie!==e.ie&&((function(n,h){if(n===null)return!1;const l=yn(n.$e(),h),c=yn(n.qe(),h);return isFinite(l)&&isFinite(c)})(this.Ge,this.gl)?(i=gn(this.Ge,this.gl),i!==null&&this.Bl(i)):this.Ps.autoScale=!0),t.ie===1&&t.ie!==e.ie&&(i=Js(this.Ge,this.gl),i!==null&&this.Bl(i));const s=e.ie!==this.Ps.mode;s&&(e.ie===2||this.Le())&&this.ga(),s&&(e.ie===3||this.Vl())&&this.ga(),t.Il!==void 0&&e.Il!==t.Il&&(this.Ps.invertScale=t.Il,this.El()),this.cl.p(e,this.ie())}Al(){return this.cl}P(){return this.bl.fontSize}$t(){return this.sl}zl(t){this.sl!==t&&(this.sl=t,this.Tl(),this.vl=null)}Ll(){if(this.nl)return this.nl;const t=this.$t()-this.Ol()-this.Nl();return this.nl=t,t}Qe(){return this.Fl(),this.Ge}Bl(t,e){const i=this.Ge;(e||i===null&&t!==null||i!==null&&!i.He(t))&&(this.vl=null,this.Ge=t)}Wl(t){this.Bl(t),this.Hl(t!==null)}Ki(){return this.Fl(),this.sl===0||!this.Ge||this.Ge.Ki()}Ul(t){return this.Il()?t:this.$t()-1-t}Nt(t,e){return this.Le()?t=ts(t,e):this.Vl()&&(t=_n(t,e)),this.kl(t,e)}$l(t,e,i){this.Fl();const s=this.Nl(),n=E(this.Qe()),h=n.$e(),l=n.qe(),c=this.Ll()-1,u=this.Il(),d=c/(l-h),p=i===void 0?0:i.from,m=i===void 0?t.length:i.to,v=this.ql();for(let b=p;b<m;b++){const M=t[b],I=M.gt;if(isNaN(I))continue;let k=I;v!==null&&(k=v(M.gt,e));const D=s+d*(k-h),X=u?D:this.sl-1-D;M.ut=X}}Yl(t,e,i){this.Fl();const s=this.Nl(),n=E(this.Qe()),h=n.$e(),l=n.qe(),c=this.Ll()-1,u=this.Il(),d=c/(l-h),p=i===void 0?0:i.from,m=i===void 0?t.length:i.to,v=this.ql();for(let b=p;b<m;b++){const M=t[b];let I=M.qh,k=M.Yh,D=M.jh,X=M.Kh;v!==null&&(I=v(M.qh,e),k=v(M.Yh,e),D=v(M.jh,e),X=v(M.Kh,e));let W=s+d*(I-h),Tt=u?W:this.sl-1-W;M.jl=Tt,W=s+d*(k-h),Tt=u?W:this.sl-1-W,M.Kl=Tt,W=s+d*(D-h),Tt=u?W:this.sl-1-W,M.Xl=Tt,W=s+d*(X-h),Tt=u?W:this.sl-1-W,M.Zl=Tt}}Ts(t,e){const i=this.Pl(t,e);return this.Gl(i,e)}Gl(t,e){let i=t;return this.Le()?i=(function(s,n){return n<0&&(s=-s),s/100*n+n})(i,e):this.Vl()&&(i=(function(s,n){return s-=100,n<0&&(s=-s),s/100*n+n})(i,e)),i}ba(){return this.dl}Dt(){return this.pl||(this.pl=tf(this.dl)),this.pl}Jl(t){this.dl.indexOf(t)===-1&&(this.dl.push(t),this.ga(),this.Ql())}io(t){const e=this.dl.indexOf(t);if(e===-1)throw new Error("source is not attached to scale");this.dl.splice(e,1),this.dl.length===0&&(this.yl({sn:!0}),this.Bl(null)),this.ga(),this.Ql()}zt(){let t=null;for(const e of this.dl){const i=e.zt();i!==null&&(t===null||i.Hh<t.Hh)&&(t=i)}return t===null?null:t.Wt}Il(){return this.Ps.invertScale}Va(){const t=this.zt()===null;if(this.vl!==null&&(t||this.vl.so===t))return this.vl.Va;this.Cl.Ha();const e=this.Cl.Va();return this.vl={Va:e,so:t},this.ul.p(),e}no(){return this.ul}eo(t){this.Le()||this.Vl()||this.ml===null&&this.el===null&&(this.Ki()||(this.ml=this.sl-t,this.el=E(this.Qe()).Ue()))}ro(t){if(this.Le()||this.Vl()||this.ml===null)return;this.yl({sn:!1}),(t=this.sl-t)<0&&(t=0);let e=(this.ml+.2*(this.sl-1))/(t+.2*(this.sl-1));const i=E(this.el).Ue();e=Math.max(e,.1),i.je(e),this.Bl(i)}ho(){this.Le()||this.Vl()||(this.ml=null,this.el=null)}ao(t){this.Rl()||this.wl===null&&this.el===null&&(this.Ki()||(this.wl=t,this.el=E(this.Qe()).Ue()))}lo(t){if(this.Rl()||this.wl===null)return;const e=E(this.Qe()).Ye()/(this.Ll()-1);let i=t-this.wl;this.Il()&&(i*=-1);const s=i*e,n=E(this.el).Ue();n.Ke(s),this.Bl(n,!0),this.vl=null}oo(){this.Rl()||this.wl!==null&&(this.wl=null,this.el=null)}ra(){return this.ha||this.ga(),this.ha}Zi(t,e){switch(this.Ps.mode){case 2:return this._o(ts(t,e));case 3:return this.ra().format(_n(t,e));default:return this.nr(t)}}Ja(t){switch(this.Ps.mode){case 2:return this._o(t);case 3:return this.ra().format(t);default:return this.nr(t)}}Za(t){switch(this.Ps.mode){case 2:return this.uo(t);case 3:return this.ra().formatTickmarks(t);default:return this.co(t)}}Dh(t){return this.nr(t,E(this.fl).ra())}Vh(t,e){return t=ts(t,e),this._o(t,qa)}do(){return this.dl}fo(t){this.rl={al:t,hl:!1}}Ns(){this.dl.forEach((t=>t.Ns()))}qa(){return this.Ps.ensureEdgeTickMarksVisible&&this.Rl()}ja(){return this.P()/2}ga(){this.vl=null;let t=1/0;this.fl=null;for(const i of this.dl)i.hs()<t&&(t=i.hs(),this.fl=i);let e=100;this.fl!==null&&(e=Math.round(1/this.fl.ea())),this.ha=Ga,this.Le()?(this.ha=qa,e=100):this.Vl()?(this.ha=new mh(100,1),e=100):this.fl!==null&&(this.ha=this.fl.ra()),this.Cl=new Xa(this,e,this.Pl.bind(this),this.kl.bind(this)),this.Cl.Ha()}Ql(){this.pl=null}Xi(){return this.xl}Hl(t){this.ll=t}Ol(){return this.Il()?this.Ps.scaleMargins.bottom*this.$t()+this._l:this.Ps.scaleMargins.top*this.$t()+this.ol}Nl(){return this.Il()?this.Ps.scaleMargins.top*this.$t()+this.ol:this.Ps.scaleMargins.bottom*this.$t()+this._l}Fl(){this.rl.hl||(this.rl.hl=!0,this.po())}Tl(){this.nl=null}kl(t,e){if(this.Fl(),this.Ki())return 0;t=this.Qa()&&t?Gr(t,this.gl):t;const i=E(this.Qe()),s=this.Nl()+(this.Ll()-1)*(t-i.$e())/i.Ye();return this.Ul(s)}Pl(t,e){if(this.Fl(),this.Ki())return 0;const i=this.Ul(t),s=E(this.Qe()),n=s.$e()+s.Ye()*((i-this.Nl())/(this.Ll()-1));return this.Qa()?yn(n,this.gl):n}El(){this.vl=null,this.Cl.Ha()}po(){if(this.Dl()&&!this.Rl())return;const t=this.rl.al;if(t===null)return;let e=null;const i=this.do();let s=0,n=0;for(const c of i){if(!c.Vt())continue;const u=c.zt();if(u===null)continue;const d=c.Mh(t.Uh(),t.bi());let p=d&&d.Qe();if(p!==null){switch(this.Ps.mode){case 1:p=Js(p,this.gl);break;case 2:p=sb(p,u.Wt);break;case 3:p=nb(p,u.Wt)}if(e=e===null?p:e.vn(E(p)),d!==null){const m=d.tr();m!==null&&(s=Math.max(s,m.above),n=Math.max(n,m.below))}}}if(this.qa()&&(s=Math.max(s,this.ja()),n=Math.max(n,this.ja())),s===this.ol&&n===this._l||(this.ol=s,this._l=n,this.vl=null,this.Tl()),e!==null){if(e.$e()===e.qe()){const c=this.fl,u=5*(c===null||this.Le()||this.Vl()?1:c.ea());this.Qa()&&(e=gn(e,this.gl)),e=new vt(e.$e()-u,e.qe()+u),this.Qa()&&(e=Js(e,this.gl))}if(this.Qa()){const c=gn(e,this.gl),u=Nh(c);if(h=u,l=this.gl,h.Ia!==l.Ia||h.Ba!==l.Ba){const d=this.el!==null?gn(this.el,this.gl):null;this.gl=u,e=Js(c,u),d!==null&&(this.el=Js(d,u))}}this.Bl(e)}else this.Ge===null&&(this.Bl(new vt(-.5,.5)),this.gl=Nh(null));var h,l}ql(){return this.Le()?ts:this.Vl()?_n:this.Qa()?t=>Gr(t,this.gl):null}vo(t,e,i){return e===void 0?(i===void 0&&(i=this.ra()),i.format(t)):e(t)}mo(t,e,i){return e===void 0?(i===void 0&&(i=this.ra()),i.formatTickmarks(t)):e(t)}nr(t,e){return this.vo(t,this.Sl.priceFormatter,e)}co(t,e){const i=this.Sl.priceFormatter;return this.mo(t,this.Sl.tickmarksPriceFormatter??(i?s=>s.map(i):void 0),e)}_o(t,e){return this.vo(t,this.Sl.percentageFormatter,e)}uo(t,e){const i=this.Sl.percentageFormatter;return this.mo(t,this.Sl.tickmarksPercentageFormatter??(i?s=>s.map(i):void 0),e)}}function ja(r){return r instanceof gh}class Za{constructor(t,e){this.dl=[],this.wo=new Map,this.sl=0,this.Mo=0,this.bo=1,this.pl=null,this.So=!1,this.xo=new Z,this.kh=[],this.uh=t,this.ts=e,this.Co=new ib(this);const i=e.N();this.Po=this.ko("left",i.leftPriceScale),this.yo=this.ko("right",i.rightPriceScale),this.Po.Al().i(this.To.bind(this,this.Po),this),this.yo.Al().i(this.To.bind(this,this.yo),this),this.Ro(i)}Ro(t){if(t.leftPriceScale&&this.Po.hr(t.leftPriceScale),t.rightPriceScale&&this.yo.hr(t.rightPriceScale),t.localization&&(this.Po.ga(),this.yo.ga()),t.overlayPriceScales){const e=Array.from(this.wo.values());for(const i of e){const s=E(i[0].Ft());s.hr(t.overlayPriceScales),t.localization&&s.ga()}}}Do(t){switch(t){case"left":return this.Po;case"right":return this.yo}return this.wo.has(t)?Ct(this.wo.get(t))[0].Ft():null}m(){this.Qt().Vo().u(this),this.Po.Al().u(this),this.yo.Al().u(this),this.dl.forEach((t=>{t.m&&t.m()})),this.kh=this.kh.filter((t=>{const e=t.oh();return e.detached&&e.detached(),!1})),this.xo.p()}Io(){return this.bo}Bo(t){this.bo=t}Qt(){return this.ts}Qi(){return this.Mo}$t(){return this.sl}Eo(t){this.Mo=t,this.Ao()}zl(t){this.sl=t,this.Po.zl(t),this.yo.zl(t),this.dl.forEach((e=>{if(this.Un(e)){const i=e.Ft();i!==null&&i.zl(t)}})),this.Ao()}zo(t){this.So=t}Lo(){return this.So}Oo(){return this.dl.filter(ja)}ba(){return this.dl}Un(t){const e=t.Ft();return e===null||this.Po!==e&&this.yo!==e}Jl(t,e,i){this.No(t,e,i?t.hs():this.dl.length)}io(t,e){const i=this.dl.indexOf(t);ct(i!==-1,"removeDataSource: invalid data source"),this.dl.splice(i,1),e||this.dl.forEach(((h,l)=>h.ls(l)));const s=E(t.Ft()).wa();if(this.wo.has(s)){const h=Ct(this.wo.get(s)),l=h.indexOf(t);l!==-1&&(h.splice(l,1),h.length===0&&this.wo.delete(s))}const n=t.Ft();n&&n.ba().indexOf(t)>=0&&(n.io(t),this.Fo(n)),this.pl=null}qn(t){return t===this.Po?"left":t===this.yo?"right":"overlay"}Wo(){return this.Po}Ho(){return this.yo}Uo(t,e){t.eo(e)}$o(t,e){t.ro(e),this.Ao()}qo(t){t.ho()}Yo(t,e){t.ao(e)}jo(t,e){t.lo(e),this.Ao()}Ko(t){t.oo()}Ao(){this.dl.forEach((t=>{t.Ns()}))}ys(){let t=null;return this.ts.N().rightPriceScale.visible&&this.yo.ba().length!==0?t=this.yo:this.ts.N().leftPriceScale.visible&&this.Po.ba().length!==0?t=this.Po:this.dl.length!==0&&(t=this.dl[0].Ft()),t===null&&(t=this.yo),t}$n(){let t=null;return this.ts.N().rightPriceScale.visible?t=this.yo:this.ts.N().leftPriceScale.visible&&(t=this.Po),t}Fo(t){t!==null&&t.Rl()&&this.Xo(t)}Zo(t){const e=this.uh.Pe();t.yl({sn:!0}),e!==null&&t.fo(e),this.Ao()}Go(){this.Xo(this.Po),this.Xo(this.yo)}Jo(){this.Fo(this.Po),this.Fo(this.yo),this.dl.forEach((t=>{this.Un(t)&&this.Fo(t.Ft())})),this.Ao(),this.ts.ar()}Dt(){return this.pl===null&&(this.pl=tf(this.dl)),this.pl}Qo(t,e){e=es(e,0,this.dl.length-1);const i=this.dl.indexOf(t);ct(i!==-1,"setSeriesOrder: invalid data source"),this.dl.splice(i,1),this.dl.splice(e,0,t),this.dl.forEach(((s,n)=>s.ls(n))),this.pl=null;for(const s of[this.Po,this.yo])s.Ql(),s.ga();this.ts.ar()}It(){return this.Dt().filter(ja)}t_(){return this.xo}i_(){return this.Co}ua(t){this.kh.push(new H1(t))}ca(t){this.kh=this.kh.filter((e=>e.oh()!==t)),t.detached&&t.detached(),this.ts.ar()}s_(){return this.kh}sa(t,e){return this.kh.map((i=>i.jn(t,e))).filter((i=>i!==null))}Xo(t){const e=t.do();if(e&&e.length>0&&!this.uh.Ki()){const i=this.uh.Pe();i!==null&&t.fo(i)}t.Ns()}No(t,e,i){let s=this.Do(e);if(s===null&&(s=this.ko(e,this.ts.N().overlayPriceScales)),this.dl.splice(i,0,t),!ph(e)){const n=this.wo.get(e)||[];n.push(t),this.wo.set(e,n)}t.ls(i),s.Jl(t),t._s(s),this.Fo(s),this.pl=null}To(t,e,i){e.ie!==i.ie&&this.Xo(t)}ko(t,e){const i={visible:!0,autoScale:!0,...we(e)},s=new rb(t,i,this.ts.N().layout,this.ts.N().localization,this.ts.Xi());return s.zl(this.$t()),s}}function Or(r){return{n_:r.n_,e_:{Kn:r.r_.externalId},h_:r.r_.cursorStyle}}function hb(r,t,e,i){for(const s of r){const n=s.Tt(i);if(n!==null&&n.jn){const h=n.jn(t,e);if(h!==null)return{a_:s,e_:h}}}return null}function ob(r){return r.Fs!==void 0}function ef(r,t,e){const i=[r,...r.Dt()],s=(function(n,h,l){var m;let c,u;for(const v of n){const b=((m=v.sa)==null?void 0:m.call(v,h,l))??[];for(const M of b)d=M.zOrder,p=c==null?void 0:c.zOrder,(!p||d==="top"&&p!=="top"||d==="normal"&&p==="bottom")&&(c=M,u=v)}var d,p;return c&&u?{r_:c,n_:u}:null})(i,t,e);if((s==null?void 0:s.r_.zOrder)==="top")return Or(s);for(const n of i){if(s&&s.n_===n&&s.r_.zOrder!=="bottom"&&!s.r_.isBackground)return Or(s);if(ob(n)){const h=hb(n.Fs(r),t,e,r);if(h!==null)return{n_:n,a_:h.a_,e_:h.e_}}if(s&&s.n_===n&&s.r_.zOrder!=="bottom"&&s.r_.isBackground)return Or(s)}return s!=null&&s.r_?Or(s):null}class ab{constructor(t,e,i=50){this.kn=0,this.yn=1,this.Tn=1,this.Dn=new Map,this.Rn=new Map,this.l_=t,this.o_=e,this.Vn=i}__(t){const e=t.time,i=this.o_.cacheKey(e),s=this.Dn.get(i);if(s!==void 0)return s.u_;if(this.kn===this.Vn){const h=this.Rn.get(this.Tn);this.Rn.delete(this.Tn),this.Dn.delete(Ct(h)),this.Tn++,this.kn--}const n=this.l_(t);return this.Dn.set(i,{u_:n,An:this.yn}),this.Rn.set(this.yn,i),this.kn++,this.yn++,n}}class is{constructor(t,e){ct(t<=e,"right should be >= left"),this.c_=t,this.d_=e}Uh(){return this.c_}bi(){return this.d_}f_(){return this.d_-this.c_+1}Te(t){return this.c_<=t&&t<=this.d_}He(t){return this.c_===t.Uh()&&this.d_===t.bi()}}function Qa(r,t){return r===null||t===null?r===t:r.He(t)}class lb{constructor(){this.p_=new Map,this.Dn=null,this.v_=!1}m_(t){this.v_=t,this.Dn=null}w_(t,e){this.g_(e),this.Dn=null;for(let i=e;i<t.length;++i){const s=t[i];let n=this.p_.get(s.timeWeight);n===void 0&&(n=[],this.p_.set(s.timeWeight,n)),n.push({index:i,time:s.time,weight:s.timeWeight,originalTime:s.originalTime})}}M_(t,e,i,s,n){const h=Math.ceil(e/t);return this.Dn!==null&&this.Dn.b_===h&&n===this.Dn.S_&&i===this.Dn.x_||(this.Dn={S_:n,x_:i,Va:this.C_(h,i,s),b_:h}),this.Dn.Va}g_(t){if(t===0)return void this.p_.clear();const e=[];this.p_.forEach(((i,s)=>{t<=i[0].index?e.push(s):i.splice(zs(i,t,(n=>n.index<t)),1/0)}));for(const i of e)this.p_.delete(i)}C_(t,e,i){let s=[];const n=h=>!e||i.has(h.index);for(const h of Array.from(this.p_.keys()).sort(((l,c)=>c-l))){if(!this.p_.get(h))continue;const l=s;s=[];const c=l.length;let u=0;const d=Ct(this.p_.get(h)),p=d.length;let m=1/0,v=-1/0;for(let b=0;b<p;b++){const M=d[b],I=M.index;for(;u<c;){const k=l[u],D=k.index;if(!(D<I&&n(k))){m=D;break}u++,s.push(k),v=D,m=1/0}if(m-I>=t&&I-v>=t&&n(M))s.push(M),v=I;else if(this.v_)return l}for(;u<c;u++)n(l[u])&&s.push(l[u])}return s}}class ss{constructor(t){this.P_=t}k_(){return this.P_===null?null:new is(Math.floor(this.P_.Uh()),Math.ceil(this.P_.bi()))}y_(){return this.P_}static T_(){return new ss(null)}}function cb(r,t){return r.weight>t.weight?r:t}class ub{constructor(t,e,i,s){this.Mo=0,this.R_=null,this.D_=[],this.wl=null,this.ml=null,this.V_=new lb,this.I_=new Map,this.B_=ss.T_(),this.E_=!0,this.A_=new Z,this.z_=new Z,this.L_=new Z,this.O_=null,this.N_=null,this.F_=new Map,this.W_=-1,this.H_=[],this.Ps=e,this.Sl=i,this.U_=e.rightOffset,this.q_=e.barSpacing,this.ts=t,this.o_=s,this.Y_(),this.V_.m_(e.uniformDistribution),this.j_()}N(){return this.Ps}K_(t){It(this.Sl,t),this.X_(),this.Y_()}hr(t,e){It(this.Ps,t),this.Ps.fixLeftEdge&&this.Z_(),this.Ps.fixRightEdge&&this.G_(),t.barSpacing!==void 0&&this.ts.dn(t.barSpacing),t.rightOffset!==void 0&&this.ts.fn(t.rightOffset),t.minBarSpacing===void 0&&t.maxBarSpacing===void 0||this.ts.dn(t.barSpacing??this.q_),t.ignoreWhitespaceIndices!==void 0&&t.ignoreWhitespaceIndices!==this.Ps.ignoreWhitespaceIndices&&this.j_(),this.X_(),this.Y_(),this.L_.p()}Rs(t){var e;return((e=this.D_[t])==null?void 0:e.time)??null}ss(t){return this.D_[t]??null}J_(t,e){if(this.D_.length<1)return null;if(this.o_.key(t)>this.o_.key(this.D_[this.D_.length-1].time))return e?this.D_.length-1:null;const i=zs(this.D_,this.o_.key(t),((s,n)=>this.o_.key(s.time)<n));return this.o_.key(t)<this.o_.key(this.D_[i].time)?e?i:null:i}Ki(){return this.Mo===0||this.D_.length===0||this.R_===null}Q_(){return this.D_.length>0}Pe(){return this.tu(),this.B_.k_()}iu(){return this.tu(),this.B_.y_()}su(){const t=this.Pe();if(t===null)return null;const e={from:t.Uh(),to:t.bi()};return this.nu(e)}nu(t){const e=Math.round(t.from),i=Math.round(t.to),s=E(this.eu()),n=E(this.ru());return{from:E(this.ss(Math.max(s,e))),to:E(this.ss(Math.min(n,i)))}}hu(t){return{from:E(this.J_(t.from,!0)),to:E(this.J_(t.to,!0))}}Qi(){return this.Mo}Eo(t){if(!isFinite(t)||t<=0||this.Mo===t)return;const e=this.iu(),i=this.Mo;if(this.Mo=t,this.E_=!0,this.Ps.lockVisibleTimeRangeOnResize&&i!==0){const s=this.q_*t/i;this.q_=s}if(this.Ps.fixLeftEdge&&e!==null&&e.Uh()<=0){const s=i-t;this.U_-=Math.round(s/this.q_)+1,this.E_=!0}this.au(),this.lu()}qt(t){if(this.Ki()||!Pn(t))return 0;const e=this.ou()+this.U_-t;return this.Mo-(e+.5)*this.q_-1}_u(t,e){const i=this.ou(),s=e===void 0?0:e.from,n=e===void 0?t.length:e.to;for(let h=s;h<n;h++){const l=t[h].wt,c=i+this.U_-l,u=this.Mo-(c+.5)*this.q_-1;t[h]._t=u}}uu(t,e){const i=Math.ceil(this.cu(t));return e&&this.Ps.ignoreWhitespaceIndices&&!this.du(i)?this.fu(i):i}fn(t){this.E_=!0,this.U_=t,this.lu(),this.ts.pu(),this.ts.ar()}vu(){return this.q_}dn(t){this.mu(t),this.lu(),this.ts.pu(),this.ts.ar()}wu(){return this.U_}Va(){if(this.Ki())return null;if(this.N_!==null)return this.N_;const t=this.q_,e=5*(this.ts.N().layout.fontSize+4)/8*(this.Ps.tickMarkMaxCharacterLength||8),i=Math.round(e/t),s=E(this.Pe()),n=Math.max(s.Uh(),s.Uh()-i),h=Math.max(s.bi(),s.bi()-i),l=this.V_.M_(t,e,this.Ps.ignoreWhitespaceIndices,this.F_,this.W_),c=this.eu()+i,u=this.ru()-i,d=this.gu(),p=this.Ps.fixLeftEdge||d,m=this.Ps.fixRightEdge||d;let v=0;for(const b of l){if(!(n<=b.index&&b.index<=h))continue;let M;v<this.H_.length?(M=this.H_[v],M.coord=this.qt(b.index),M.label=this.Mu(b),M.weight=b.weight):(M={needAlignCoordinate:!1,coord:this.qt(b.index),label:this.Mu(b),weight:b.weight},this.H_.push(M)),this.q_>e/2&&!d?M.needAlignCoordinate=!1:M.needAlignCoordinate=p&&b.index<=c||m&&b.index>=u,v++}return this.H_.length=v,this.N_=this.H_,this.H_}bu(){this.E_=!0,this.dn(this.Ps.barSpacing),this.fn(this.Ps.rightOffset)}Su(t){this.E_=!0,this.R_=t,this.lu(),this.Z_()}xu(t,e){const i=this.cu(t),s=this.vu(),n=s+e*(s/10);this.dn(n),this.Ps.rightBarStaysOnScroll||this.fn(this.wu()+(i-this.cu(t)))}eo(t){this.wl&&this.oo(),this.ml===null&&this.O_===null&&(this.Ki()||(this.ml=t,this.Cu()))}ro(t){if(this.O_===null)return;const e=es(this.Mo-t,0,this.Mo),i=es(this.Mo-E(this.ml),0,this.Mo);e!==0&&i!==0&&this.dn(this.O_.vu*e/i)}ho(){this.ml!==null&&(this.ml=null,this.Pu())}ao(t){this.wl===null&&this.O_===null&&(this.Ki()||(this.wl=t,this.Cu()))}lo(t){if(this.wl===null)return;const e=(this.wl-t)/this.vu();this.U_=E(this.O_).wu+e,this.E_=!0,this.lu()}oo(){this.wl!==null&&(this.wl=null,this.Pu())}ku(){this.yu(this.Ps.rightOffset)}yu(t,e=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const i=this.U_,s=performance.now();this.ts._n({Tu:n=>(n-s)/e>=1,Ru:n=>{const h=(n-s)/e;return h>=1?t:i+(t-i)*h}})}kt(t,e){this.E_=!0,this.D_=t,this.V_.w_(t,e),this.lu()}Du(){return this.A_}Vu(){return this.z_}Iu(){return this.L_}ou(){return this.R_||0}Bu(t){const e=t.f_();this.mu(this.Mo/e),this.U_=t.bi()-this.ou(),this.lu(),this.E_=!0,this.ts.pu(),this.ts.ar()}Eu(){const t=this.eu(),e=this.ru();t!==null&&e!==null&&this.Bu(new is(t,e+this.Ps.rightOffset))}Au(t){const e=new is(t.from,t.to);this.Bu(e)}ns(t){return this.Sl.timeFormatter!==void 0?this.Sl.timeFormatter(t.originalTime):this.o_.formatHorzItem(t.time)}j_(){if(!this.Ps.ignoreWhitespaceIndices)return;this.F_.clear();const t=this.ts.js();for(const e of t)for(const i of e.ma())this.F_.set(i,!0);this.W_++}gu(){const t=this.ts.N().handleScroll,e=this.ts.N().handleScale;return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||e.axisDoubleClickReset.time||e.axisPressedMouseMove.time||e.mouseWheel||e.pinch)}eu(){return this.D_.length===0?null:0}ru(){return this.D_.length===0?null:this.D_.length-1}zu(t){return(this.Mo-1-t)/this.q_}cu(t){const e=this.zu(t),i=this.ou()+this.U_-e;return Math.round(1e6*i)/1e6}mu(t){const e=this.q_;this.q_=t,this.au(),e!==this.q_&&(this.E_=!0,this.Lu())}tu(){if(!this.E_)return;if(this.E_=!1,this.Ki())return void this.Ou(ss.T_());const t=this.ou(),e=this.Mo/this.q_,i=this.U_+t,s=new is(i-e+1,i);this.Ou(new ss(s))}au(){const t=es(this.q_,this.Nu(),this.Fu());this.q_!==t&&(this.q_=t,this.E_=!0)}Fu(){return this.Ps.maxBarSpacing>0?this.Ps.maxBarSpacing:.5*this.Mo}Nu(){return this.Ps.fixLeftEdge&&this.Ps.fixRightEdge&&this.D_.length!==0?this.Mo/this.D_.length:this.Ps.minBarSpacing}lu(){const t=this.Wu();t!==null&&this.U_<t&&(this.U_=t,this.E_=!0);const e=this.Hu();this.U_>e&&(this.U_=e,this.E_=!0)}Wu(){const t=this.eu(),e=this.R_;return t===null||e===null?null:t-e-1+(this.Ps.fixLeftEdge?this.Mo/this.q_:Math.min(2,this.D_.length))}Hu(){return this.Ps.fixRightEdge?0:this.Mo/this.q_-Math.min(2,this.D_.length)}Cu(){this.O_={vu:this.vu(),wu:this.wu()}}Pu(){this.O_=null}Mu(t){let e=this.I_.get(t.weight);return e===void 0&&(e=new ab((i=>this.Uu(i)),this.o_),this.I_.set(t.weight,e)),e.__(t)}Uu(t){return this.o_.formatTickmark(t,this.Sl)}Ou(t){const e=this.B_;this.B_=t,Qa(e.k_(),this.B_.k_())||this.A_.p(),Qa(e.y_(),this.B_.y_())||this.z_.p(),this.Lu()}Lu(){this.N_=null}X_(){this.Lu(),this.I_.clear()}Y_(){this.o_.updateFormatter(this.Sl)}Z_(){if(!this.Ps.fixLeftEdge)return;const t=this.eu();if(t===null)return;const e=this.Pe();if(e===null)return;const i=e.Uh()-t;if(i<0){const s=this.U_-i-1;this.fn(s)}this.au()}G_(){this.lu(),this.au()}du(t){return!this.Ps.ignoreWhitespaceIndices||this.F_.get(t)||!1}fu(t){const e=(function*(s){const n=Math.round(s),h=n<s;let l=1;for(;;)h?(yield n+l,yield n-l):(yield n-l,yield n+l),l++})(t),i=this.ru();for(;i;){const s=e.next().value;if(this.F_.get(s))return s;if(s<0||s>i)break}return t}}var Ka,Ja,tl,el,il;(function(r){r[r.OnTouchEnd=0]="OnTouchEnd",r[r.OnNextTap=1]="OnNextTap"})(Ka||(Ka={}));class db{constructor(t,e,i){this.$u=[],this.qu=[],this.Mo=0,this.Yu=null,this.ju=new Z,this.Ku=new Z,this.Xu=null,this.Zu=t,this.Ps=e,this.o_=i,this.xl=new d1(this.Ps.layout.colorParsers),this.Gu=new u1(this),this.uh=new ub(this,e.timeScale,this.Ps.localization,i),this.Ct=new M1(this,e.crosshair),this.Ju=new J1(e.crosshair),e.addDefaultPane&&(this.Qu(0),this.$u[0].Bo(2)),this.tc=this.sc(0),this.nc=this.sc(1)}Bh(){this.ec(lt.gn())}ar(){this.ec(lt.wn())}Zh(){this.ec(new lt(1))}Eh(t){const e=this.rc(t);this.ec(e)}hc(){return this.Yu}ac(t){var i,s,n,h;if(((i=this.Yu)==null?void 0:i.n_)===(t==null?void 0:t.n_)&&((n=(s=this.Yu)==null?void 0:s.e_)==null?void 0:n.Kn)===((h=t==null?void 0:t.e_)==null?void 0:h.Kn))return;const e=this.Yu;this.Yu=t,e!==null&&this.Eh(e.n_),t!==null&&t.n_!==(e==null?void 0:e.n_)&&this.Eh(t.n_)}N(){return this.Ps}hr(t){It(this.Ps,t),this.$u.forEach((e=>e.Ro(t))),t.timeScale!==void 0&&this.uh.hr(t.timeScale),t.localization!==void 0&&this.uh.K_(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.ju.p(),this.tc=this.sc(0),this.nc=this.sc(1),this.Bh()}lc(t,e,i=0){const s=this.$u[i];if(s===void 0)return;if(t==="left")return It(this.Ps,{leftPriceScale:e}),s.Ro({leftPriceScale:e}),this.ju.p(),void this.Bh();if(t==="right")return It(this.Ps,{rightPriceScale:e}),s.Ro({rightPriceScale:e}),this.ju.p(),void this.Bh();const n=this.oc(t,i);n!==null&&(n.Ft.hr(e),this.ju.p())}oc(t,e){const i=this.$u[e];if(i===void 0)return null;const s=i.Do(t);return s!==null?{Us:i,Ft:s}:null}Et(){return this.uh}$s(){return this.$u}_c(){return this.Ct}uc(){return this.Ku}cc(t,e){t.zl(e),this.pu()}Eo(t){this.Mo=t,this.uh.Eo(this.Mo),this.$u.forEach((e=>e.Eo(t))),this.pu()}dc(t){this.$u.length!==1&&(ct(t>=0&&t<this.$u.length,"Invalid pane index"),this.$u.splice(t,1),this.Bh())}fc(t,e){if(this.$u.length<2)return;ct(t>=0&&t<this.$u.length,"Invalid pane index");const i=this.$u[t],s=this.$u.reduce(((p,m)=>p+m.Io()),0),n=this.$u.reduce(((p,m)=>p+m.$t()),0),h=n-30*(this.$u.length-1);e=Math.min(h,Math.max(30,e));const l=s/n,c=i.$t();i.Bo(e*l);let u=e-c,d=this.$u.length-1;for(const p of this.$u)if(p!==i){const m=Math.min(h,Math.max(30,p.$t()-u/d));u-=p.$t()-m,d-=1;const v=m*l;p.Bo(v)}this.Bh()}vc(t,e){ct(t>=0&&t<this.$u.length&&e>=0&&e<this.$u.length,"Invalid pane index");const i=this.$u[t],s=this.$u[e];this.$u[t]=s,this.$u[e]=i,this.Bh()}mc(t,e){if(ct(t>=0&&t<this.$u.length&&e>=0&&e<this.$u.length,"Invalid pane index"),t===e)return;const[i]=this.$u.splice(t,1);this.$u.splice(e,0,i),this.Bh()}Uo(t,e,i){t.Uo(e,i)}$o(t,e,i){t.$o(e,i),this.Ah(),this.ec(this.wc(t,2))}qo(t,e){t.qo(e),this.ec(this.wc(t,2))}Yo(t,e,i){e.Rl()||t.Yo(e,i)}jo(t,e,i){e.Rl()||(t.jo(e,i),this.Ah(),this.ec(this.wc(t,2)))}Ko(t,e){e.Rl()||(t.Ko(e),this.ec(this.wc(t,2)))}Zo(t,e){t.Zo(e),this.ec(this.wc(t,2))}gc(t){this.uh.eo(t)}Mc(t,e){const i=this.Et();if(i.Ki()||e===0)return;const s=i.Qi();t=Math.max(1,Math.min(t,s)),i.xu(t,e),this.pu()}bc(t){this.Sc(0),this.xc(t),this.Cc()}Pc(t){this.uh.ro(t),this.pu()}kc(){this.uh.ho(),this.ar()}Sc(t){this.uh.ao(t)}xc(t){this.uh.lo(t),this.pu()}Cc(){this.uh.oo(),this.ar()}js(){return this.qu}yc(t,e,i,s,n){this.Ct.Vs(t,e);let h=NaN,l=this.uh.uu(t,!0);const c=this.uh.Pe();c!==null&&(l=Math.min(Math.max(c.Uh(),l),c.bi()));const u=s.ys(),d=u.zt();if(d!==null&&(h=u.Ts(e,d)),h=this.Ju.Ma(h,l,s),this.Ct.As(l,h,s),this.Zh(),!n){const p=ef(s,t,e);this.ac(p&&{n_:p.n_,e_:p.e_,h_:p.h_||null}),this.Ku.p(this.Ct.Bt(),{x:t,y:e},i)}}Tc(t,e,i){const s=i.ys(),n=s.zt(),h=s.Nt(t,E(n)),l=this.uh.J_(e,!0),c=this.uh.qt(E(l));this.yc(c,h,null,i,!0)}Rc(t){this._c().Ls(),this.Zh(),t||this.Ku.p(null,null,null)}Ah(){const t=this.Ct.Us();if(t!==null){const e=this.Ct.Bs(),i=this.Ct.Es();this.yc(e,i,null,t)}this.Ct.Ns()}Dc(t,e,i){const s=this.uh.Rs(0);e!==void 0&&i!==void 0&&this.uh.kt(e,i);const n=this.uh.Rs(0),h=this.uh.ou(),l=this.uh.Pe();if(l!==null&&s!==null&&n!==null){const c=l.Te(h),u=this.o_.key(s)>this.o_.key(n),d=t!==null&&t>h&&!u,p=this.uh.N().allowShiftVisibleRangeOnWhitespaceReplacement,m=c&&(i!==void 0||p)&&this.uh.N().shiftVisibleRangeOnNewBar;if(d&&!m){const v=t-h;this.uh.fn(this.uh.wu()-v)}}this.uh.Su(t)}Lh(t){t!==null&&t.Jo()}Hn(t){if((function(i){return i instanceof Za})(t))return t;const e=this.$u.find((i=>i.Dt().includes(t)));return e===void 0?null:e}pu(){this.$u.forEach((t=>t.Jo())),this.Ah()}m(){this.$u.forEach((t=>t.m())),this.$u.length=0,this.Ps.localization.priceFormatter=void 0,this.Ps.localization.percentageFormatter=void 0,this.Ps.localization.timeFormatter=void 0}Vc(){return this.Gu}Yn(){return this.Gu.N()}Vo(){return this.ju}Ic(t,e){const i=this.Qu(e);this.Bc(t,i),this.qu.push(t),this.qu.length===1?this.Bh():this.ar()}Ec(t){const e=this.Hn(t),i=this.qu.indexOf(t);ct(i!==-1,"Series not found");const s=E(e);this.qu.splice(i,1),s.io(t),t.m&&t.m(),this.uh.j_(),this.Ac(s)}Ih(t,e){const i=E(this.Hn(t));i.io(t,!0),i.Jl(t,e,!0)}Eu(){const t=lt.wn();t.rn(),this.ec(t)}zc(t){const e=lt.wn();e.ln(t),this.ec(e)}cn(){const t=lt.wn();t.cn(),this.ec(t)}dn(t){const e=lt.wn();e.dn(t),this.ec(e)}fn(t){const e=lt.wn();e.fn(t),this.ec(e)}_n(t){const e=lt.wn();e._n(t),this.ec(e)}hn(){const t=lt.wn();t.hn(),this.ec(t)}Lc(){return this.Ps.rightPriceScale.visible?"right":"left"}Oc(t,e){if(ct(e>=0,"Index should be greater or equal to 0"),e===this.Nc(t))return;const i=E(this.Hn(t));i.io(t);const s=this.Qu(e);this.Bc(t,s),i.ba().length===0&&this.Ac(i),this.Bh()}Fc(){return this.nc}$(){return this.tc}Ut(t){const e=this.nc,i=this.tc;if(e===i)return e;if(t=Math.max(0,Math.min(100,Math.round(100*t))),this.Xu===null||this.Xu.mr!==i||this.Xu.wr!==e)this.Xu={mr:i,wr:e,Wc:new Map};else{const n=this.Xu.Wc.get(t);if(n!==void 0)return n}const s=this.xl.tt(i,e,t/100);return this.Xu.Wc.set(t,s),s}Hc(t){return this.$u.indexOf(t)}Xi(){return this.xl}Uc(){return this.$c()}$c(t){const e=new Za(this.uh,this);this.$u.push(e);const i=t??this.$u.length-1,s=lt.gn();return s.Qs(i,{tn:0,sn:!0}),this.ec(s),e}Qu(t){return ct(t>=0,"Index should be greater or equal to 0"),(t=Math.min(this.$u.length,t))<this.$u.length?this.$u[t]:this.$c(t)}Nc(t){return this.$u.findIndex((e=>e.Oo().includes(t)))}wc(t,e){const i=new lt(e);if(t!==null){const s=this.$u.indexOf(t);i.Qs(s,{tn:e})}return i}rc(t,e){return e===void 0&&(e=2),this.wc(this.Hn(t),e)}ec(t){this.Zu&&this.Zu(t),this.$u.forEach((e=>e.i_().lr().kt()))}Bc(t,e){const i=t.N().priceScaleId,s=i!==void 0?i:this.Lc();e.Jl(t,s),ph(s)||t.hr(t.N())}sc(t){const e=this.Ps.layout;return e.background.type==="gradient"?t===0?e.background.topColor:e.background.bottomColor:e.background.color}Ac(t){!t.Lo()&&t.ba().length===0&&this.$u.length>1&&this.$u.splice(this.Hc(t),1)}}function Do(r){return!zi(r)&&!Cr(r)}function sf(r){return zi(r)}(function(r){r[r.Disabled=0]="Disabled",r[r.Continuous=1]="Continuous",r[r.OnDataUpdate=2]="OnDataUpdate"})(Ja||(Ja={})),(function(r){r[r.LastBar=0]="LastBar",r[r.LastVisible=1]="LastVisible"})(tl||(tl={})),(function(r){r.Solid="solid",r.VerticalGradient="gradient"})(el||(el={})),(function(r){r[r.Year=0]="Year",r[r.Month=1]="Month",r[r.DayOfMonth=2]="DayOfMonth",r[r.Time=3]="Time",r[r.TimeWithSeconds=4]="TimeWithSeconds"})(il||(il={}));const sl=r=>r.getUTCFullYear();function fb(r,t,e){return t.replace(/yyyy/g,(i=>_e(sl(i),4))(r)).replace(/yy/g,(i=>_e(sl(i)%100,2))(r)).replace(/MMMM/g,((i,s)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(s,{month:"long"}))(r,e)).replace(/MMM/g,((i,s)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(s,{month:"short"}))(r,e)).replace(/MM/g,(i=>_e((s=>s.getUTCMonth()+1)(i),2))(r)).replace(/dd/g,(i=>_e((s=>s.getUTCDate())(i),2))(r))}class nf{constructor(t="yyyy-MM-dd",e="default"){this.qc=t,this.Yc=e}__(t){return fb(t,this.qc,this.Yc)}}class pb{constructor(t){this.jc=t||"%h:%m:%s"}__(t){return this.jc.replace("%h",_e(t.getUTCHours(),2)).replace("%m",_e(t.getUTCMinutes(),2)).replace("%s",_e(t.getUTCSeconds(),2))}}const mb={Kc:"yyyy-MM-dd",Xc:"%h:%m:%s",Zc:" ",Gc:"default"};class gb{constructor(t={}){const e={...mb,...t};this.Jc=new nf(e.Kc,e.Gc),this.Qc=new pb(e.Xc),this.td=e.Zc}__(t){return`${this.Jc.__(t)}${this.td}${this.Qc.__(t)}`}}function Pr(r){return 60*r*60*1e3}function Oh(r){return 60*r*1e3}const kr=[{sd:(nl=1,1e3*nl),nd:10},{sd:Oh(1),nd:20},{sd:Oh(5),nd:21},{sd:Oh(30),nd:22},{sd:Pr(1),nd:30},{sd:Pr(3),nd:31},{sd:Pr(6),nd:32},{sd:Pr(12),nd:33}];var nl;function rl(r,t){if(r.getUTCFullYear()!==t.getUTCFullYear())return 70;if(r.getUTCMonth()!==t.getUTCMonth())return 60;if(r.getUTCDate()!==t.getUTCDate())return 50;for(let e=kr.length-1;e>=0;--e)if(Math.floor(t.getTime()/kr[e].sd)!==Math.floor(r.getTime()/kr[e].sd))return kr[e].nd;return 0}function Ph(r){let t=r;if(Cr(r)&&(t=ba(r)),!Do(t))throw new Error("time must be of type BusinessDay");const e=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{ed:Math.round(e.getTime()/1e3),rd:t}}function hl(r){if(!sf(r))throw new Error("time must be of type isUTCTimestamp");return{ed:r}}function ba(r){const t=new Date(r);if(isNaN(t.getTime()))throw new Error(`Invalid date string=${r}, expected format=yyyy-mm-dd`);return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function ol(r){Cr(r.time)&&(r.time=ba(r.time))}class al{options(){return this.Ps}setOptions(t){this.Ps=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?(function(e){e.forEach(ol)})(t):ol(t)}createConverterToInternalObj(t){return E((function(e){return e.length===0?null:Do(e[0].time)||Cr(e[0].time)?Ph:hl})(t))}key(t){return typeof t=="object"&&"ed"in t?t.ed:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){const e=t;return e.rd===void 0?new Date(1e3*e.ed).getTime():new Date(Date.UTC(e.rd.year,e.rd.month-1,e.rd.day)).getTime()}convertHorzItemToInternal(t){return sf(e=t)?hl(e):Do(e)?Ph(e):Ph(ba(e));var e}updateFormatter(t){if(!this.Ps)return;const e=t.dateFormat;this.Ps.timeScale.timeVisible?this.hd=new gb({Kc:e,Xc:this.Ps.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",Zc:"   ",Gc:t.locale}):this.hd=new nf(e,t.locale)}formatHorzItem(t){const e=t;return this.hd.__(new Date(1e3*e.ed))}formatTickmark(t,e){const i=(function(n,h,l){switch(n){case 0:case 10:return h?l?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return h?3:2;case 50:return 2;case 60:return 1;case 70:return 0}})(t.weight,this.Ps.timeScale.timeVisible,this.Ps.timeScale.secondsVisible),s=this.Ps.timeScale;if(s.tickMarkFormatter!==void 0){const n=s.tickMarkFormatter(t.originalTime,i,e.locale);if(n!==null)return n}return(function(n,h,l){const c={};switch(h){case 0:c.year="numeric";break;case 1:c.month="short";break;case 2:c.day="numeric";break;case 3:c.hour12=!1,c.hour="2-digit",c.minute="2-digit";break;case 4:c.hour12=!1,c.hour="2-digit",c.minute="2-digit",c.second="2-digit"}const u=n.rd===void 0?new Date(1e3*n.ed):new Date(Date.UTC(n.rd.year,n.rd.month-1,n.rd.day));return new Date(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate(),u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()).toLocaleString(l,c)})(t.time,i,e.locale)}maxTickMarkWeight(t){let e=t.reduce(cb,t[0]).weight;return e>30&&e<50&&(e=30),e}fillWeightsForPoints(t,e){(function(i,s=0){if(i.length===0)return;let n=s===0?null:i[s-1].time.ed,h=n!==null?new Date(1e3*n):null,l=0;for(let c=s;c<i.length;++c){const u=i[c],d=new Date(1e3*u.time.ed);h!==null&&(u.timeWeight=rl(d,h)),l+=u.time.ed-(n||u.time.ed),n=u.time.ed,h=d}if(s===0&&i.length>1){const c=Math.ceil(l/(i.length-1)),u=new Date(1e3*(i[0].time.ed-c));i[0].timeWeight=rl(new Date(1e3*i[0].time.ed),u)}})(t,e)}static ad(t){return It({localization:{dateFormat:"dd MMM 'yy"}},t??{})}}const Bs=typeof window<"u";function ll(){return!!Bs&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function kh(){return!!Bs&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function $o(r){return r+r%2}function vb(r){Bs&&window.chrome!==void 0&&r.addEventListener("mousedown",(t=>{if(t.button===1)return t.preventDefault(),!1}))}class vh{constructor(t,e,i){this.ld=0,this.od=null,this._d={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.ud=0,this.dd=null,this.fd={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.pd=null,this.vd=!1,this.md=null,this.wd=null,this.gd=!1,this.Md=!1,this.bd=!1,this.Sd=null,this.xd=null,this.Cd=null,this.Pd=null,this.kd=null,this.yd=null,this.Td=null,this.Rd=0,this.Dd=!1,this.Vd=!1,this.Id=!1,this.Bd=0,this.Ed=null,this.Ad=!kh(),this.zd=s=>{this.Ld(s)},this.Od=s=>{if(this.Nd(s)){const n=this.Fd(s);if(++this.ud,this.dd&&this.ud>1){const{Wd:h}=this.Hd(Yt(s),this.fd);h<30&&!this.bd&&this.Ud(n,this.qd.$d),this.Yd()}}else{const n=this.Fd(s);if(++this.ld,this.od&&this.ld>1){const{Wd:h}=this.Hd(Yt(s),this._d);h<5&&!this.Md&&this.jd(n,this.qd.Kd),this.Xd()}}},this.Zd=t,this.qd=e,this.Ps=i,this.Gd()}m(){this.Sd!==null&&(this.Sd(),this.Sd=null),this.xd!==null&&(this.xd(),this.xd=null),this.Pd!==null&&(this.Pd(),this.Pd=null),this.kd!==null&&(this.kd(),this.kd=null),this.yd!==null&&(this.yd(),this.yd=null),this.Cd!==null&&(this.Cd(),this.Cd=null),this.Jd(),this.Xd()}Qd(t){this.Pd&&this.Pd();const e=this.tf.bind(this);if(this.Pd=()=>{this.Zd.removeEventListener("mousemove",e)},this.Zd.addEventListener("mousemove",e),this.Nd(t))return;const i=this.Fd(t);this.jd(i,this.qd.if),this.Ad=!0}Xd(){this.od!==null&&clearTimeout(this.od),this.ld=0,this.od=null,this._d={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}Yd(){this.dd!==null&&clearTimeout(this.dd),this.ud=0,this.dd=null,this.fd={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}tf(t){if(this.Id||this.wd!==null||this.Nd(t))return;const e=this.Fd(t);this.jd(e,this.qd.sf),this.Ad=!0}nf(t){const e=Ah(t.changedTouches,E(this.Ed));if(e===null||(this.Bd=Ar(t),this.Td!==null)||this.Vd)return;this.Dd=!0;const i=this.Hd(Yt(e),E(this.wd)),{ef:s,rf:n,Wd:h}=i;if(this.gd||!(h<5)){if(!this.gd){const l=.5*s,c=n>=l&&!this.Ps.hf(),u=l>n&&!this.Ps.af();c||u||(this.Vd=!0),this.gd=!0,this.bd=!0,this.Jd(),this.Yd()}if(!this.Vd){const l=this.Fd(t,e);this.Ud(l,this.qd.lf),Yi(t)}}}_f(t){if(t.button!==0)return;const e=this.Hd(Yt(t),E(this.md)),{Wd:i}=e;if(i>=5&&(this.Md=!0,this.Xd()),this.Md){const s=this.Fd(t);this.jd(s,this.qd.uf)}}Hd(t,e){const i=Math.abs(e._t-t._t),s=Math.abs(e.ut-t.ut);return{ef:i,rf:s,Wd:i+s}}cf(t){let e=Ah(t.changedTouches,E(this.Ed));if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e===null)return;this.Ed=null,this.Bd=Ar(t),this.Jd(),this.wd=null,this.yd&&(this.yd(),this.yd=null);const i=this.Fd(t,e);if(this.Ud(i,this.qd.df),++this.ud,this.dd&&this.ud>1){const{Wd:s}=this.Hd(Yt(e),this.fd);s<30&&!this.bd&&this.Ud(i,this.qd.$d),this.Yd()}else this.bd||(this.Ud(i,this.qd.ff),this.qd.ff&&Yi(t));this.ud===0&&Yi(t),t.touches.length===0&&this.vd&&(this.vd=!1,Yi(t))}Ld(t){if(t.button!==0)return;const e=this.Fd(t);if(this.md=null,this.Id=!1,this.kd&&(this.kd(),this.kd=null),ll()&&this.Zd.ownerDocument.documentElement.removeEventListener("mouseleave",this.zd),!this.Nd(t))if(this.jd(e,this.qd.pf),++this.ld,this.od&&this.ld>1){const{Wd:i}=this.Hd(Yt(t),this._d);i<5&&!this.Md&&this.jd(e,this.qd.Kd),this.Xd()}else this.Md||this.jd(e,this.qd.vf)}Jd(){this.pd!==null&&(clearTimeout(this.pd),this.pd=null)}mf(t){if(this.Ed!==null)return;const e=t.changedTouches[0];this.Ed=e.identifier,this.Bd=Ar(t);const i=this.Zd.ownerDocument.documentElement;this.bd=!1,this.gd=!1,this.Vd=!1,this.wd=Yt(e),this.yd&&(this.yd(),this.yd=null);{const n=this.nf.bind(this),h=this.cf.bind(this);this.yd=()=>{i.removeEventListener("touchmove",n),i.removeEventListener("touchend",h)},i.addEventListener("touchmove",n,{passive:!1}),i.addEventListener("touchend",h,{passive:!1}),this.Jd(),this.pd=setTimeout(this.wf.bind(this,t),240)}const s=this.Fd(t,e);this.Ud(s,this.qd.gf),this.dd||(this.ud=0,this.dd=setTimeout(this.Yd.bind(this),500),this.fd=Yt(e))}Mf(t){if(t.button!==0)return;const e=this.Zd.ownerDocument.documentElement;ll()&&e.addEventListener("mouseleave",this.zd),this.Md=!1,this.md=Yt(t),this.kd&&(this.kd(),this.kd=null);{const s=this._f.bind(this),n=this.Ld.bind(this);this.kd=()=>{e.removeEventListener("mousemove",s),e.removeEventListener("mouseup",n)},e.addEventListener("mousemove",s),e.addEventListener("mouseup",n)}if(this.Id=!0,this.Nd(t))return;const i=this.Fd(t);this.jd(i,this.qd.bf),this.od||(this.ld=0,this.od=setTimeout(this.Xd.bind(this),500),this._d=Yt(t))}Gd(){this.Zd.addEventListener("mouseenter",this.Qd.bind(this)),this.Zd.addEventListener("touchcancel",this.Jd.bind(this));{const t=this.Zd.ownerDocument,e=i=>{this.qd.Sf&&(i.composed&&this.Zd.contains(i.composedPath()[0])||i.target&&this.Zd.contains(i.target)||this.qd.Sf())};this.xd=()=>{t.removeEventListener("touchstart",e)},this.Sd=()=>{t.removeEventListener("mousedown",e)},t.addEventListener("mousedown",e),t.addEventListener("touchstart",e,{passive:!0})}kh()&&(this.Cd=()=>{this.Zd.removeEventListener("dblclick",this.Od)},this.Zd.addEventListener("dblclick",this.Od)),this.Zd.addEventListener("mouseleave",this.xf.bind(this)),this.Zd.addEventListener("touchstart",this.mf.bind(this),{passive:!0}),vb(this.Zd),this.Zd.addEventListener("mousedown",this.Mf.bind(this)),this.Cf(),this.Zd.addEventListener("touchmove",(()=>{}),{passive:!1})}Cf(){this.qd.Pf===void 0&&this.qd.kf===void 0&&this.qd.yf===void 0||(this.Zd.addEventListener("touchstart",(t=>this.Tf(t.touches)),{passive:!0}),this.Zd.addEventListener("touchmove",(t=>{if(t.touches.length===2&&this.Td!==null&&this.qd.kf!==void 0){const e=cl(t.touches[0],t.touches[1])/this.Rd;this.qd.kf(this.Td,e),Yi(t)}}),{passive:!1}),this.Zd.addEventListener("touchend",(t=>{this.Tf(t.touches)})))}Tf(t){t.length===1&&(this.Dd=!1),t.length!==2||this.Dd||this.vd?this.Rf():this.Df(t)}Df(t){const e=this.Zd.getBoundingClientRect()||{left:0,top:0};this.Td={_t:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,ut:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.Rd=cl(t[0],t[1]),this.qd.Pf!==void 0&&this.qd.Pf(),this.Jd()}Rf(){this.Td!==null&&(this.Td=null,this.qd.yf!==void 0&&this.qd.yf())}xf(t){if(this.Pd&&this.Pd(),this.Nd(t)||!this.Ad)return;const e=this.Fd(t);this.jd(e,this.qd.Vf),this.Ad=!kh()}wf(t){const e=Ah(t.touches,E(this.Ed));if(e===null)return;const i=this.Fd(t,e);this.Ud(i,this.qd.If),this.bd=!0,this.vd=!0}Nd(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents!==void 0?t.sourceCapabilities.firesTouchEvents:Ar(t)<this.Bd+500}Ud(t,e){e&&e.call(this.qd,t)}jd(t,e){e&&e.call(this.qd,t)}Fd(t,e){const i=e||t,s=this.Zd.getBoundingClientRect()||{left:0,top:0};return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-s.left,localY:i.clientY-s.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,Bf:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",Ef:t.type,Af:i.target,a_:t.view,zf:()=>{t.type!=="touchstart"&&Yi(t)}}}}function cl(r,t){const e=r.clientX-t.clientX,i=r.clientY-t.clientY;return Math.sqrt(e*e+i*i)}function Yi(r){r.cancelable&&r.preventDefault()}function Yt(r){return{_t:r.pageX,ut:r.pageY}}function Ar(r){return r.timeStamp||performance.now()}function Ah(r,t){for(let e=0;e<r.length;++e)if(r[e].identifier===t)return r[e];return null}class bb{constructor(t,e,i){this.Lf=null,this.Of=null,this.Nf=!0,this.Ff=null,this.Wf=t,this.Hf=t.Uf()[e],this.$f=t.Uf()[i],this.qf=document.createElement("tr"),this.qf.style.height="1px",this.Yf=document.createElement("td"),this.Yf.style.position="relative",this.Yf.style.padding="0",this.Yf.style.margin="0",this.Yf.setAttribute("colspan","3"),this.jf(),this.qf.appendChild(this.Yf),this.Nf=this.Wf.N().layout.panes.enableResize,this.Nf?this.Kf():(this.Lf=null,this.Of=null)}m(){this.Of!==null&&this.Of.m()}Xf(){return this.qf}Zf(){return Y({width:this.Hf.Zf().width,height:1})}Gf(){return Y({width:this.Hf.Gf().width,height:1*window.devicePixelRatio})}Jf(t,e,i){const s=this.Gf();t.fillStyle=this.Wf.N().layout.panes.separatorColor,t.fillRect(e,i,s.width,s.height)}kt(){this.jf(),this.Wf.N().layout.panes.enableResize!==this.Nf&&(this.Nf=this.Wf.N().layout.panes.enableResize,this.Nf?this.Kf():(this.Lf!==null&&(this.Yf.removeChild(this.Lf.Qf),this.Yf.removeChild(this.Lf.tp),this.Lf=null),this.Of!==null&&(this.Of.m(),this.Of=null)))}Kf(){const t=document.createElement("div"),e=t.style;e.position="fixed",e.display="none",e.zIndex="49",e.top="0",e.left="0",e.width="100%",e.height="100%",e.cursor="row-resize",this.Yf.appendChild(t);const i=document.createElement("div"),s=i.style;s.position="absolute",s.zIndex="50",s.top="-4px",s.height="9px",s.width="100%",s.backgroundColor="",s.cursor="row-resize",this.Yf.appendChild(i);const n={if:this.ip.bind(this),Vf:this.sp.bind(this),bf:this.np.bind(this),gf:this.np.bind(this),uf:this.ep.bind(this),lf:this.ep.bind(this),pf:this.rp.bind(this),df:this.rp.bind(this)};this.Of=new vh(i,n,{hf:()=>!1,af:()=>!0}),this.Lf={tp:i,Qf:t}}jf(){this.Yf.style.background=this.Wf.N().layout.panes.separatorColor}ip(t){this.Lf!==null&&(this.Lf.tp.style.backgroundColor=this.Wf.N().layout.panes.separatorHoverColor)}sp(t){this.Lf!==null&&this.Ff===null&&(this.Lf.tp.style.backgroundColor="")}np(t){if(this.Lf===null)return;const e=this.Hf.hp().Io()+this.$f.hp().Io(),i=e/(this.Hf.Zf().height+this.$f.Zf().height),s=30*i;e<=2*s||(this.Ff={ap:t.pageY,lp:this.Hf.hp().Io(),op:e-s,_p:e,up:i,cp:s},this.Lf.Qf.style.display="block")}ep(t){const e=this.Ff;if(e===null)return;const i=(t.pageY-e.ap)*e.up,s=es(e.lp+i,e.cp,e.op);this.Hf.hp().Bo(s),this.$f.hp().Bo(e._p-s),this.Wf.Qt().Bh()}rp(t){this.Ff!==null&&this.Lf!==null&&(this.Ff=null,this.Lf.Qf.style.display="none")}}function Rh(r,t){return r.dp-t.dp}function Lh(r,t,e){const i=(r.dp-t.dp)/(r.wt-t.wt);return Math.sign(i)*Math.min(Math.abs(i),e)}class wb{constructor(t,e,i,s){this.fp=null,this.pp=null,this.vp=null,this.mp=null,this.wp=null,this.gp=0,this.Mp=0,this.bp=t,this.Sp=e,this.xp=i,this.Mn=s}Cp(t,e){if(this.fp!==null){if(this.fp.wt===e)return void(this.fp.dp=t);if(Math.abs(this.fp.dp-t)<this.Mn)return}this.mp=this.vp,this.vp=this.pp,this.pp=this.fp,this.fp={wt:e,dp:t}}le(t,e){if(this.fp===null||this.pp===null||e-this.fp.wt>50)return;let i=0;const s=Lh(this.fp,this.pp,this.Sp),n=Rh(this.fp,this.pp),h=[s],l=[n];if(i+=n,this.vp!==null){const u=Lh(this.pp,this.vp,this.Sp);if(Math.sign(u)===Math.sign(s)){const d=Rh(this.pp,this.vp);if(h.push(u),l.push(d),i+=d,this.mp!==null){const p=Lh(this.vp,this.mp,this.Sp);if(Math.sign(p)===Math.sign(s)){const m=Rh(this.vp,this.mp);h.push(p),l.push(m),i+=m}}}}let c=0;for(let u=0;u<h.length;++u)c+=l[u]/i*h[u];Math.abs(c)<this.bp||(this.wp={dp:t,wt:e},this.Mp=c,this.gp=(function(u,d){const p=Math.log(d);return Math.log(1*p/-u)/p})(Math.abs(c),this.xp))}Ru(t){const e=E(this.wp),i=t-e.wt;return e.dp+this.Mp*(Math.pow(this.xp,i)-1)/Math.log(this.xp)}Tu(t){return this.wp===null||this.Pp(t)===this.gp}Pp(t){const e=t-E(this.wp).wt;return Math.min(e,this.gp)}}class _b{constructor(t,e){this.kp=void 0,this.yp=void 0,this.Tp=void 0,this.ps=!1,this.Rp=t,this.Dp=e,this.Vp()}kt(){this.Vp()}Ip(){this.kp&&this.Rp.removeChild(this.kp),this.yp&&this.Rp.removeChild(this.yp),this.kp=void 0,this.yp=void 0}Bp(){return this.ps!==this.Ep()||this.Tp!==this.Ap()}Ap(){return this.Dp.Qt().Xi().J(this.Dp.N().layout.textColor)>160?"dark":"light"}Ep(){return this.Dp.N().layout.attributionLogo}zp(){const t=new URL(location.href);return t.hostname?"&utm_source="+t.hostname+t.pathname:""}Vp(){this.Bp()&&(this.Ip(),this.ps=this.Ep(),this.ps&&(this.Tp=this.Ap(),this.yp=document.createElement("style"),this.yp.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.kp=document.createElement("a"),this.kp.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.zp()}`,this.kp.title="Charting by TradingView",this.kp.id="tv-attr-logo",this.kp.target="_blank",this.kp.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.kp.toggleAttribute("data-dark",this.Tp==="dark"),this.Rp.appendChild(this.yp),this.Rp.appendChild(this.kp)))}}function Bi(r,t){const e=E(r.ownerDocument).createElement("canvas");r.appendChild(e);const i=h1(e,{options:{allowResizeObserver:!0},transform:(s,n)=>({width:Math.max(s.width,n.width),height:Math.max(s.height,n.height)})});return i.resizeCanvasElement(t),i}function Fi(r){var t;r.width=1,r.height=1,(t=r.getContext("2d"))==null||t.clearRect(0,0,1,1)}function zo(r,t,e,i){r.ih&&r.ih(t,e,i)}function Vr(r,t,e,i){r.nt(t,e,i)}function Bo(r,t,e,i){const s=r(e,i);for(const n of s){const h=n.Tt(i);h!==null&&t(h)}}function Dh(r,t){return e=>{var i,s;return(function(n){return n.Ft!==void 0})(e)?(((i=e.Ft())==null?void 0:i.wa())??"")!==t?[]:((s=e.ta)==null?void 0:s.call(e,r))??[]:[]}}function ul(r,t,e,i){if(!r.length)return;let s=0;const n=r[0].$t(i,!0);let h=t===1?e/2-(r[0].Fi()-n/2):r[0].Fi()-n/2-e/2;h=Math.max(0,h);for(let l=1;l<r.length;l++){const c=r[l],u=r[l-1],d=u.$t(i,!1),p=c.Fi(),m=u.Fi();if(t===1?p>m-d:p<m+d){const v=m-d*t;c.Wi(v);const b=v-t*d/2;if((t===1?b<0:b>e)&&h>0){const M=t===1?-1-b:b-e,I=Math.min(M,h);for(let k=s;k<r.length;k++)r[k].Wi(r[k].Fi()+t*I);h-=I}}else s=l,h=t===1?m-d-p:p-(m+d)}}class dl{constructor(t,e,i,s){this.Yi=null,this.Lp=null,this.Op=!1,this.Np=new Rn(200),this.Fp=null,this.Wp=0,this.Hp=!1,this.Up=()=>{this.Hp||this.Pt.$p().Qt().ar()},this.qp=()=>{this.Hp||this.Pt.$p().Qt().ar()},this.Pt=t,this.Ps=e,this.bl=e.layout,this.Gu=i,this.Yp=s==="left",this.jp=Dh("normal",s),this.Kp=Dh("top",s),this.Xp=Dh("bottom",s),this.Yf=document.createElement("div"),this.Yf.style.height="100%",this.Yf.style.overflow="hidden",this.Yf.style.width="25px",this.Yf.style.left="0",this.Yf.style.position="relative",this.Zp=Bi(this.Yf,Y({width:16,height:16})),this.Zp.subscribeSuggestedBitmapSizeChanged(this.Up);const n=this.Zp.canvasElement;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Gp=Bi(this.Yf,Y({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.qp);const h=this.Gp.canvasElement;h.style.position="absolute",h.style.zIndex="2",h.style.left="0",h.style.top="0";const l={bf:this.np.bind(this),gf:this.np.bind(this),uf:this.ep.bind(this),lf:this.ep.bind(this),Sf:this.Jp.bind(this),pf:this.rp.bind(this),df:this.rp.bind(this),Kd:this.Qp.bind(this),$d:this.Qp.bind(this),if:this.tv.bind(this),Vf:this.sp.bind(this)};this.Of=new vh(this.Gp.canvasElement,l,{hf:()=>!this.Ps.handleScroll.vertTouchDrag,af:()=>!0})}m(){this.Of.m(),this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.qp),Fi(this.Gp.canvasElement),this.Gp.dispose(),this.Zp.unsubscribeSuggestedBitmapSizeChanged(this.Up),Fi(this.Zp.canvasElement),this.Zp.dispose(),this.Yi!==null&&this.Yi.no().u(this),this.Yi=null}Xf(){return this.Yf}P(){return this.bl.fontSize}iv(){const t=this.Gu.N();return this.Fp!==t.k&&(this.Np.In(),this.Fp=t.k),t}sv(){if(this.Yi===null)return 0;let t=0;const e=this.iv(),i=E(this.Zp.canvasElement.getContext("2d",{colorSpace:this.Pt.$p().N().layout.colorSpace}));i.save();const s=this.Yi.Va();i.font=this.nv(),s.length>0&&(t=Math.max(this.Np.Vi(i,s[0].Ga),this.Np.Vi(i,s[s.length-1].Ga)));const n=this.ev();for(let u=n.length;u--;){const d=this.Np.Vi(i,n[u].ri());d>t&&(t=d)}const h=this.Yi.zt();if(h!==null&&this.Lp!==null&&(l=this.Ps.crosshair).mode!==2&&l.horzLine.visible&&l.horzLine.labelVisible){const u=this.Yi.Ts(1,h),d=this.Yi.Ts(this.Lp.height-2,h);t=Math.max(t,this.Np.Vi(i,this.Yi.Zi(Math.floor(Math.min(u,d))+.11111111111111,h)),this.Np.Vi(i,this.Yi.Zi(Math.ceil(Math.max(u,d))-.11111111111111,h)))}var l;i.restore();const c=t||34;return $o(Math.ceil(e.S+e.C+e.I+e.B+5+c))}rv(t){this.Lp!==null&&Li(this.Lp,t)||(this.Lp=t,this.Hp=!0,this.Zp.resizeCanvasElement(t),this.Gp.resizeCanvasElement(t),this.Hp=!1,this.Yf.style.width=`${t.width}px`,this.Yf.style.height=`${t.height}px`)}hv(){return E(this.Lp).width}_s(t){this.Yi!==t&&(this.Yi!==null&&this.Yi.no().u(this),this.Yi=t,t.no().i(this.ul.bind(this),this))}Ft(){return this.Yi}In(){const t=this.Pt.hp();this.Pt.$p().Qt().Zo(t,E(this.Ft()))}av(t){if(this.Lp===null)return;const e={colorSpace:this.Pt.$p().N().layout.colorSpace};if(t!==1){this.lv(),this.Zp.applySuggestedBitmapSize();const s=Di(this.Zp,e);s!==null&&(s.useBitmapCoordinateSpace((n=>{this.ov(n),this._v(n)})),this.Pt.uv(s,this.Xp),this.cv(s),this.Pt.uv(s,this.jp),this.dv(s))}this.Gp.applySuggestedBitmapSize();const i=Di(this.Gp,e);i!==null&&(i.useBitmapCoordinateSpace((({context:s,bitmapSize:n})=>{s.clearRect(0,0,n.width,n.height)})),this.fv(i),this.Pt.uv(i,this.Kp))}Gf(){return this.Zp.bitmapSize}Jf(t,e,i){const s=this.Gf();s.width>0&&s.height>0&&t.drawImage(this.Zp.canvasElement,e,i)}kt(){var t;(t=this.Yi)==null||t.Va()}np(t){if(this.Yi===null||this.Yi.Ki()||!this.Ps.handleScale.axisPressedMouseMove.price)return;const e=this.Pt.$p().Qt(),i=this.Pt.hp();this.Op=!0,e.Uo(i,this.Yi,t.localY)}ep(t){if(this.Yi===null||!this.Ps.handleScale.axisPressedMouseMove.price)return;const e=this.Pt.$p().Qt(),i=this.Pt.hp(),s=this.Yi;e.$o(i,s,t.localY)}Jp(){if(this.Yi===null||!this.Ps.handleScale.axisPressedMouseMove.price)return;const t=this.Pt.$p().Qt(),e=this.Pt.hp(),i=this.Yi;this.Op&&(this.Op=!1,t.qo(e,i))}rp(t){if(this.Yi===null||!this.Ps.handleScale.axisPressedMouseMove.price)return;const e=this.Pt.$p().Qt(),i=this.Pt.hp();this.Op=!1,e.qo(i,this.Yi)}Qp(t){this.Ps.handleScale.axisDoubleClickReset.price&&this.In()}tv(t){this.Yi!==null&&(!this.Pt.$p().Qt().N().handleScale.axisPressedMouseMove.price||this.Yi.Le()||this.Yi.Vl()||this.pv(1))}sp(t){this.pv(0)}ev(){const t=[],e=this.Yi===null?void 0:this.Yi;return(i=>{for(let s=0;s<i.length;++s){const n=i[s].Ws(this.Pt.hp(),e);for(let h=0;h<n.length;h++)t.push(n[h])}})(this.Pt.hp().Dt()),t}ov({context:t,bitmapSize:e}){const{width:i,height:s}=e,n=this.Pt.hp().Qt(),h=n.$(),l=n.Fc();h===l?dh(t,0,0,i,s,h):Ud(t,0,0,i,s,h,l)}_v({context:t,bitmapSize:e,horizontalPixelRatio:i}){if(this.Lp===null||this.Yi===null||!this.Yi.N().borderVisible)return;t.fillStyle=this.Yi.N().borderColor;const s=Math.max(1,Math.floor(this.iv().S*i));let n;n=this.Yp?e.width-s:0,t.fillRect(n,0,s,e.height)}cv(t){if(this.Lp===null||this.Yi===null)return;const e=this.Yi.Va(),i=this.Yi.N(),s=this.iv(),n=this.Yp?this.Lp.width-s.C:0;i.borderVisible&&i.ticksVisible&&t.useBitmapCoordinateSpace((({context:h,horizontalPixelRatio:l,verticalPixelRatio:c})=>{h.fillStyle=i.borderColor;const u=Math.max(1,Math.floor(c)),d=Math.floor(.5*c),p=Math.round(s.C*l);h.beginPath();for(const m of e)h.rect(Math.floor(n*l),Math.round(m.ka*c)-d,p,u);h.fill()})),t.useMediaCoordinateSpace((({context:h})=>{h.font=this.nv(),h.fillStyle=i.textColor??this.bl.textColor,h.textAlign=this.Yp?"right":"left",h.textBaseline="middle";const l=this.Yp?Math.round(n-s.I):Math.round(n+s.C+s.I),c=e.map((u=>this.Np.Di(h,u.Ga)));for(let u=e.length;u--;){const d=e[u];h.fillText(d.Ga,l,d.ka+c[u])}}))}lv(){if(this.Lp===null||this.Yi===null)return;let t=this.Lp.height/2;const e=[],i=this.Yi.Dt().slice(),s=this.Pt.hp(),n=this.iv();this.Yi===s.$n()&&this.Pt.hp().Dt().forEach((c=>{s.Un(c)&&i.push(c)}));const h=this.Yi.ba()[0],l=this.Yi;i.forEach((c=>{const u=c.Ws(s,l);u.forEach((d=>{d.Wi(null),d.Hi()&&e.push(d)})),h===c&&u.length>0&&(t=u[0].Bi())})),e.forEach((c=>c.Wi(c.Bi()))),this.Yi.N().alignLabels&&this.vv(e,n,t)}vv(t,e,i){if(this.Lp===null)return;const s=t.filter((h=>h.Bi()<=i)),n=t.filter((h=>h.Bi()>i));s.sort(((h,l)=>l.Bi()-h.Bi())),s.length&&n.length&&n.push(s[0]),n.sort(((h,l)=>h.Bi()-l.Bi()));for(const h of t){const l=Math.floor(h.$t(e)/2),c=h.Bi();c>-l&&c<l&&h.Wi(l),c>this.Lp.height-l&&c<this.Lp.height+l&&h.Wi(this.Lp.height-l)}ul(s,1,this.Lp.height,e),ul(n,-1,this.Lp.height,e)}dv(t){if(this.Lp===null)return;const e=this.ev(),i=this.iv(),s=this.Yp?"right":"left";e.forEach((n=>{n.Ui()&&n.Tt(E(this.Yi)).nt(t,i,this.Np,s)}))}fv(t){if(this.Lp===null||this.Yi===null)return;const e=this.Pt.$p().Qt(),i=[],s=this.Pt.hp(),n=e._c().Ws(s,this.Yi);n.length&&i.push(n);const h=this.iv(),l=this.Yp?"right":"left";i.forEach((c=>{c.forEach((u=>{u.Tt(E(this.Yi)).nt(t,h,this.Np,l)}))}))}pv(t){this.Yf.style.cursor=t===1?"ns-resize":"default"}ul(){const t=this.sv();this.Wp<t&&this.Pt.$p().Qt().Bh(),this.Wp=t}nv(){return An(this.bl.fontSize,this.bl.fontFamily)}}function yb(r,t){var e;return((e=r.Jh)==null?void 0:e.call(r,t))??[]}function fl(r,t){var e;return((e=r.Fs)==null?void 0:e.call(r,t))??[]}function pl(r,t){var e;return((e=r.us)==null?void 0:e.call(r,t))??[]}function Eb(r,t){var e;return((e=r.Xh)==null?void 0:e.call(r,t))??[]}class wa{constructor(t,e){this.Lp=Y({width:0,height:0}),this.mv=null,this.wv=null,this.gv=null,this.Mv=null,this.bv=!1,this.Sv=new Z,this.xv=new Z,this.Cv=0,this.Pv=!1,this.kv=null,this.yv=!1,this.Tv=null,this.Rv=null,this.Hp=!1,this.Up=()=>{this.Hp||this.Dv===null||this.ts().ar()},this.qp=()=>{this.Hp||this.Dv===null||this.ts().ar()},this.Dp=t,this.Dv=e,this.Dv.t_().i(this.Vv.bind(this),this,!0),this.Iv=document.createElement("td"),this.Iv.style.padding="0",this.Iv.style.position="relative";const i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.position="relative",i.style.overflow="hidden",this.Bv=document.createElement("td"),this.Bv.style.padding="0",this.Ev=document.createElement("td"),this.Ev.style.padding="0",this.Iv.appendChild(i),this.Zp=Bi(i,Y({width:16,height:16})),this.Zp.subscribeSuggestedBitmapSizeChanged(this.Up);const s=this.Zp.canvasElement;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.Gp=Bi(i,Y({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.qp);const n=this.Gp.canvasElement;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0",this.qf=document.createElement("tr"),this.qf.appendChild(this.Bv),this.qf.appendChild(this.Iv),this.qf.appendChild(this.Ev),this.Av(),this.Of=new vh(this.Gp.canvasElement,this,{hf:()=>this.kv===null&&!this.Dp.N().handleScroll.vertTouchDrag,af:()=>this.kv===null&&!this.Dp.N().handleScroll.horzTouchDrag})}m(){this.mv!==null&&this.mv.m(),this.wv!==null&&this.wv.m(),this.gv=null,this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.qp),Fi(this.Gp.canvasElement),this.Gp.dispose(),this.Zp.unsubscribeSuggestedBitmapSizeChanged(this.Up),Fi(this.Zp.canvasElement),this.Zp.dispose(),this.Dv!==null&&(this.Dv.t_().u(this),this.Dv.m()),this.Of.m()}hp(){return E(this.Dv)}zv(t){var e;this.Dv!==null&&this.Dv.t_().u(this),this.Dv=t,this.Dv!==null&&this.Dv.t_().i(wa.prototype.Vv.bind(this),this,!0),this.Av(),this.Dp.Uf().indexOf(this)===this.Dp.Uf().length-1?(this.gv=this.gv??new _b(this.Iv,this.Dp),this.gv.kt()):((e=this.gv)==null||e.Ip(),this.gv=null)}$p(){return this.Dp}Xf(){return this.qf}Av(){if(this.Dv!==null&&(this.Lv(),this.ts().js().length!==0)){if(this.mv!==null){const t=this.Dv.Wo();this.mv._s(E(t))}if(this.wv!==null){const t=this.Dv.Ho();this.wv._s(E(t))}}}Ov(){this.mv!==null&&this.mv.kt(),this.wv!==null&&this.wv.kt()}Io(){return this.Dv!==null?this.Dv.Io():0}Bo(t){this.Dv&&this.Dv.Bo(t)}if(t){if(!this.Dv)return;this.Nv();const e=t.localX,i=t.localY;this.Fv(e,i,t)}bf(t){this.Nv(),this.Wv(),this.Fv(t.localX,t.localY,t)}sf(t){if(!this.Dv)return;this.Nv();const e=t.localX,i=t.localY;this.Fv(e,i,t)}vf(t){this.Dv!==null&&(this.Nv(),this.Hv(t))}Kd(t){this.Dv!==null&&this.Uv(this.xv,t)}$d(t){this.Kd(t)}uf(t){this.Nv(),this.$v(t),this.Fv(t.localX,t.localY,t)}pf(t){this.Dv!==null&&(this.Nv(),this.Pv=!1,this.qv(t))}ff(t){this.Dv!==null&&this.Hv(t)}If(t){if(this.Pv=!0,this.kv===null){const e={x:t.localX,y:t.localY};this.Yv(e,e,t)}}Vf(t){this.Dv!==null&&(this.Nv(),this.Dv.Qt().ac(null),this.jv())}Kv(){return this.Sv}Xv(){return this.xv}Pf(){this.Cv=1,this.ts().hn()}kf(t,e){if(!this.Dp.N().handleScale.pinch)return;const i=5*(e-this.Cv);this.Cv=e,this.ts().Mc(t._t,i)}gf(t){this.Pv=!1,this.yv=this.kv!==null,this.Wv();const e=this.ts()._c();this.kv!==null&&e.Vt()&&(this.Tv={x:e.si(),y:e.ni()},this.kv={x:t.localX,y:t.localY})}lf(t){if(this.Dv===null)return;const e=t.localX,i=t.localY;if(this.kv===null)this.$v(t);else{this.yv=!1;const s=E(this.Tv),n=s.x+(e-this.kv.x),h=s.y+(i-this.kv.y);this.Fv(n,h,t)}}df(t){this.$p().N().trackingMode.exitMode===0&&(this.yv=!0),this.Zv(),this.qv(t)}jn(t,e){const i=this.Dv;return i===null?null:ef(i,t,e)}Gv(t,e){E(e==="left"?this.mv:this.wv).rv(Y({width:t,height:this.Lp.height}))}Zf(){return this.Lp}rv(t){Li(this.Lp,t)||(this.Lp=t,this.Hp=!0,this.Zp.resizeCanvasElement(t),this.Gp.resizeCanvasElement(t),this.Hp=!1,this.Iv.style.width=t.width+"px",this.Iv.style.height=t.height+"px")}Jv(){const t=E(this.Dv);t.Fo(t.Wo()),t.Fo(t.Ho());for(const e of t.ba())if(t.Un(e)){const i=e.Ft();i!==null&&t.Fo(i),e.Ns()}for(const e of t.s_())e.Ns()}Gf(){return this.Zp.bitmapSize}Jf(t,e,i){const s=this.Gf();s.width>0&&s.height>0&&t.drawImage(this.Zp.canvasElement,e,i)}av(t){if(t===0||this.Dv===null)return;t>1&&this.Jv(),this.mv!==null&&this.mv.av(t),this.wv!==null&&this.wv.av(t);const e={colorSpace:this.Dp.N().layout.colorSpace};if(t!==1){this.Zp.applySuggestedBitmapSize();const s=Di(this.Zp,e);s!==null&&(s.useBitmapCoordinateSpace((n=>{this.ov(n)})),this.Dv&&(this.Qv(s,yb),this.tm(s),this.Qv(s,fl),this.Qv(s,pl)))}this.Gp.applySuggestedBitmapSize();const i=Di(this.Gp,e);i!==null&&(i.useBitmapCoordinateSpace((({context:s,bitmapSize:n})=>{s.clearRect(0,0,n.width,n.height)})),this.im(i),this.Qv(i,Eb),this.Qv(i,pl))}sm(){return this.mv}nm(){return this.wv}uv(t,e){this.Qv(t,e)}Vv(){this.Dv!==null&&this.Dv.t_().u(this),this.Dv=null}Hv(t){this.Uv(this.Sv,t)}Uv(t,e){const i=e.localX,s=e.localY;t.v()&&t.p(this.ts().Et().uu(i),{x:i,y:s},e)}ov({context:t,bitmapSize:e}){const{width:i,height:s}=e,n=this.ts(),h=n.$(),l=n.Fc();h===l?dh(t,0,0,i,s,l):Ud(t,0,0,i,s,h,l)}tm(t){const e=E(this.Dv),i=e.i_().lr().Tt(e);i!==null&&i.nt(t,!1)}im(t){this.rm(t,fl,Vr,this.ts()._c())}Qv(t,e){const i=E(this.Dv),s=i.Dt(),n=i.s_();for(const h of n)this.rm(t,e,zo,h);for(const h of s)this.rm(t,e,zo,h);for(const h of n)this.rm(t,e,Vr,h);for(const h of s)this.rm(t,e,Vr,h)}rm(t,e,i,s){const n=E(this.Dv),h=n.Qt().hc(),l=h!==null&&h.n_===s,c=h!==null&&l&&h.e_!==void 0?h.e_.Xn:void 0;Bo(e,(u=>i(u,t,l,c)),s,n)}Lv(){if(this.Dv===null)return;const t=this.Dp,e=this.Dv.Wo().N().visible,i=this.Dv.Ho().N().visible;e||this.mv===null||(this.Bv.removeChild(this.mv.Xf()),this.mv.m(),this.mv=null),i||this.wv===null||(this.Ev.removeChild(this.wv.Xf()),this.wv.m(),this.wv=null);const s=t.Qt().Vc();e&&this.mv===null&&(this.mv=new dl(this,t.N(),s,"left"),this.Bv.appendChild(this.mv.Xf())),i&&this.wv===null&&(this.wv=new dl(this,t.N(),s,"right"),this.Ev.appendChild(this.wv.Xf()))}hm(t){return t.Bf&&this.Pv||this.kv!==null}am(t){return Math.max(0,Math.min(t,this.Lp.width-1))}lm(t){return Math.max(0,Math.min(t,this.Lp.height-1))}Fv(t,e,i){this.ts().yc(this.am(t),this.lm(e),i,E(this.Dv))}jv(){this.ts().Rc()}Zv(){this.yv&&(this.kv=null,this.jv())}Yv(t,e,i){this.kv=t,this.yv=!1,this.Fv(e.x,e.y,i);const s=this.ts()._c();this.Tv={x:s.si(),y:s.ni()}}ts(){return this.Dp.Qt()}qv(t){if(!this.bv)return;const e=this.ts(),i=this.hp();if(e.Ko(i,i.ys()),this.Mv=null,this.bv=!1,e.Cc(),this.Rv!==null){const s=performance.now(),n=e.Et();this.Rv.le(n.wu(),s),this.Rv.Tu(s)||e._n(this.Rv)}}Nv(){this.kv=null}Wv(){if(this.Dv){if(this.ts().hn(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)E(document.activeElement).blur();else{const t=document.getSelection();t!==null&&t.removeAllRanges()}!this.Dv.ys().Ki()&&this.ts().Et().Ki()}}$v(t){if(this.Dv===null)return;const e=this.ts(),i=e.Et();if(i.Ki())return;const s=this.Dp.N(),n=s.handleScroll,h=s.kineticScroll;if((!n.pressedMouseMove||t.Bf)&&(!n.horzTouchDrag&&!n.vertTouchDrag||!t.Bf))return;const l=this.Dv.ys(),c=performance.now();if(this.Mv!==null||this.hm(t)||(this.Mv={x:t.clientX,y:t.clientY,ed:c,om:t.localX,_m:t.localY}),this.Mv!==null&&!this.bv&&(this.Mv.x!==t.clientX||this.Mv.y!==t.clientY)){if(t.Bf&&h.touch||!t.Bf&&h.mouse){const u=i.vu();this.Rv=new wb(.2/u,7/u,.997,15/u),this.Rv.Cp(i.wu(),this.Mv.ed)}else this.Rv=null;l.Ki()||e.Yo(this.Dv,l,t.localY),e.Sc(t.localX),this.bv=!0}this.bv&&(l.Ki()||e.jo(this.Dv,l,t.localY),e.xc(t.localX),this.Rv!==null&&this.Rv.Cp(i.wu(),c))}}class ml{constructor(t,e,i,s,n){this.xt=!0,this.Lp=Y({width:0,height:0}),this.Up=()=>this.av(3),this.Yp=t==="left",this.Gu=i.Vc,this.Ps=e,this.um=s,this.dm=n,this.Yf=document.createElement("div"),this.Yf.style.width="25px",this.Yf.style.height="100%",this.Yf.style.overflow="hidden",this.Zp=Bi(this.Yf,Y({width:16,height:16})),this.Zp.subscribeSuggestedBitmapSizeChanged(this.Up)}m(){this.Zp.unsubscribeSuggestedBitmapSizeChanged(this.Up),Fi(this.Zp.canvasElement),this.Zp.dispose()}Xf(){return this.Yf}Zf(){return this.Lp}rv(t){Li(this.Lp,t)||(this.Lp=t,this.Zp.resizeCanvasElement(t),this.Yf.style.width=`${t.width}px`,this.Yf.style.height=`${t.height}px`,this.xt=!0)}av(t){if(t<3&&!this.xt||this.Lp.width===0||this.Lp.height===0)return;this.xt=!1,this.Zp.applySuggestedBitmapSize();const e=Di(this.Zp,{colorSpace:this.Ps.layout.colorSpace});e!==null&&e.useBitmapCoordinateSpace((i=>{this.ov(i),this._v(i)}))}Gf(){return this.Zp.bitmapSize}Jf(t,e,i){const s=this.Gf();s.width>0&&s.height>0&&t.drawImage(this.Zp.canvasElement,e,i)}_v({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(!this.um())return;t.fillStyle=this.Ps.timeScale.borderColor;const n=Math.floor(this.Gu.N().S*i),h=Math.floor(this.Gu.N().S*s),l=this.Yp?e.width-n:0;t.fillRect(l,0,n,h)}ov({context:t,bitmapSize:e}){dh(t,0,0,e.width,e.height,this.dm())}}function _a(r){return t=>{var e;return((e=t.ia)==null?void 0:e.call(t,r))??[]}}const Mb=_a("normal"),Cb=_a("top"),xb=_a("bottom");class Tb{constructor(t,e){this.fm=null,this.pm=null,this.M=null,this.vm=!1,this.Lp=Y({width:0,height:0}),this.wm=new Z,this.Np=new Rn(5),this.Hp=!1,this.Up=()=>{this.Hp||this.Dp.Qt().ar()},this.qp=()=>{this.Hp||this.Dp.Qt().ar()},this.Dp=t,this.o_=e,this.Ps=t.N().layout,this.kp=document.createElement("tr"),this.gm=document.createElement("td"),this.gm.style.padding="0",this.Mm=document.createElement("td"),this.Mm.style.padding="0",this.Yf=document.createElement("td"),this.Yf.style.height="25px",this.Yf.style.padding="0",this.bm=document.createElement("div"),this.bm.style.width="100%",this.bm.style.height="100%",this.bm.style.position="relative",this.bm.style.overflow="hidden",this.Yf.appendChild(this.bm),this.Zp=Bi(this.bm,Y({width:16,height:16})),this.Zp.subscribeSuggestedBitmapSizeChanged(this.Up);const i=this.Zp.canvasElement;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.Gp=Bi(this.bm,Y({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.qp);const s=this.Gp.canvasElement;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this.kp.appendChild(this.gm),this.kp.appendChild(this.Yf),this.kp.appendChild(this.Mm),this.Sm(),this.Dp.Qt().Vo().i(this.Sm.bind(this),this),this.Of=new vh(this.Gp.canvasElement,this,{hf:()=>!0,af:()=>!this.Dp.N().handleScroll.horzTouchDrag})}m(){this.Of.m(),this.fm!==null&&this.fm.m(),this.pm!==null&&this.pm.m(),this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.qp),Fi(this.Gp.canvasElement),this.Gp.dispose(),this.Zp.unsubscribeSuggestedBitmapSizeChanged(this.Up),Fi(this.Zp.canvasElement),this.Zp.dispose()}Xf(){return this.kp}xm(){return this.fm}Cm(){return this.pm}bf(t){if(this.vm)return;this.vm=!0;const e=this.Dp.Qt();!e.Et().Ki()&&this.Dp.N().handleScale.axisPressedMouseMove.time&&e.gc(t.localX)}gf(t){this.bf(t)}Sf(){const t=this.Dp.Qt();!t.Et().Ki()&&this.vm&&(this.vm=!1,this.Dp.N().handleScale.axisPressedMouseMove.time&&t.kc())}uf(t){const e=this.Dp.Qt();!e.Et().Ki()&&this.Dp.N().handleScale.axisPressedMouseMove.time&&e.Pc(t.localX)}lf(t){this.uf(t)}pf(){this.vm=!1;const t=this.Dp.Qt();t.Et().Ki()&&!this.Dp.N().handleScale.axisPressedMouseMove.time||t.kc()}df(){this.pf()}Kd(){this.Dp.N().handleScale.axisDoubleClickReset.time&&this.Dp.Qt().cn()}$d(){this.Kd()}if(){this.Dp.Qt().N().handleScale.axisPressedMouseMove.time&&this.pv(1)}Vf(){this.pv(0)}Zf(){return this.Lp}Pm(){return this.wm}km(t,e,i){Li(this.Lp,t)||(this.Lp=t,this.Hp=!0,this.Zp.resizeCanvasElement(t),this.Gp.resizeCanvasElement(t),this.Hp=!1,this.Yf.style.width=`${t.width}px`,this.Yf.style.height=`${t.height}px`,this.wm.p(t)),this.fm!==null&&this.fm.rv(Y({width:e,height:t.height})),this.pm!==null&&this.pm.rv(Y({width:i,height:t.height}))}ym(){const t=this.Tm();return Math.ceil(t.S+t.C+t.P+t.A+t.V+t.Rm)}kt(){this.Dp.Qt().Et().Va()}Gf(){return this.Zp.bitmapSize}Jf(t,e,i){const s=this.Gf();s.width>0&&s.height>0&&t.drawImage(this.Zp.canvasElement,e,i)}av(t){if(t===0)return;const e={colorSpace:this.Ps.colorSpace};if(t!==1){this.Zp.applySuggestedBitmapSize();const s=Di(this.Zp,e);s!==null&&(s.useBitmapCoordinateSpace((n=>{this.ov(n),this._v(n),this.Dm(s,xb)})),this.cv(s),this.Dm(s,Mb)),this.fm!==null&&this.fm.av(t),this.pm!==null&&this.pm.av(t)}this.Gp.applySuggestedBitmapSize();const i=Di(this.Gp,e);i!==null&&(i.useBitmapCoordinateSpace((({context:s,bitmapSize:n})=>{s.clearRect(0,0,n.width,n.height)})),this.Vm([...this.Dp.Qt().js(),this.Dp.Qt()._c()],i),this.Dm(i,Cb))}Dm(t,e){const i=this.Dp.Qt().js();for(const s of i)Bo(e,(n=>zo(n,t,!1,void 0)),s,void 0);for(const s of i)Bo(e,(n=>Vr(n,t,!1,void 0)),s,void 0)}ov({context:t,bitmapSize:e}){dh(t,0,0,e.width,e.height,this.Dp.Qt().Fc())}_v({context:t,bitmapSize:e,verticalPixelRatio:i}){if(this.Dp.N().timeScale.borderVisible){t.fillStyle=this.Im();const s=Math.max(1,Math.floor(this.Tm().S*i));t.fillRect(0,0,e.width,s)}}cv(t){const e=this.Dp.Qt().Et(),i=e.Va();if(!i||i.length===0)return;const s=this.o_.maxTickMarkWeight(i),n=this.Tm(),h=e.N();h.borderVisible&&h.ticksVisible&&t.useBitmapCoordinateSpace((({context:l,horizontalPixelRatio:c,verticalPixelRatio:u})=>{l.strokeStyle=this.Im(),l.fillStyle=this.Im();const d=Math.max(1,Math.floor(c)),p=Math.floor(.5*c);l.beginPath();const m=Math.round(n.C*u);for(let v=i.length;v--;){const b=Math.round(i[v].coord*c);l.rect(b-p,0,d,m)}l.fill()})),t.useMediaCoordinateSpace((({context:l})=>{const c=n.S+n.C+n.A+n.P/2;l.textAlign="center",l.textBaseline="middle",l.fillStyle=this.H(),l.font=this.nv();for(const u of i)if(u.weight<s){const d=u.needAlignCoordinate?this.Bm(l,u.coord,u.label):u.coord;l.fillText(u.label,d,c)}this.Dp.N().timeScale.allowBoldLabels&&(l.font=this.Em());for(const u of i)if(u.weight>=s){const d=u.needAlignCoordinate?this.Bm(l,u.coord,u.label):u.coord;l.fillText(u.label,d,c)}}))}Bm(t,e,i){const s=this.Np.Vi(t,i),n=s/2,h=Math.floor(e-n)+.5;return h<0?e+=Math.abs(0-h):h+s>this.Lp.width&&(e-=Math.abs(this.Lp.width-(h+s))),e}Vm(t,e){const i=this.Tm();for(const s of t)for(const n of s.cs())n.Tt().nt(e,i)}Im(){return this.Dp.N().timeScale.borderColor}H(){return this.Ps.textColor}F(){return this.Ps.fontSize}nv(){return An(this.F(),this.Ps.fontFamily)}Em(){return An(this.F(),this.Ps.fontFamily,"bold")}Tm(){this.M===null&&(this.M={S:1,L:NaN,A:NaN,V:NaN,Ji:NaN,C:5,P:NaN,k:"",Gi:new Rn,Rm:0});const t=this.M,e=this.nv();if(t.k!==e){const i=this.F();t.P=i,t.k=e,t.A=3*i/12,t.V=3*i/12,t.Ji=9*i/12,t.L=0,t.Rm=4*i/12,t.Gi.In()}return this.M}pv(t){this.Yf.style.cursor=t===1?"ew-resize":"default"}Sm(){const t=this.Dp.Qt(),e=t.N();e.leftPriceScale.visible||this.fm===null||(this.gm.removeChild(this.fm.Xf()),this.fm.m(),this.fm=null),e.rightPriceScale.visible||this.pm===null||(this.Mm.removeChild(this.pm.Xf()),this.pm.m(),this.pm=null);const i={Vc:this.Dp.Qt().Vc()},s=()=>e.leftPriceScale.borderVisible&&t.Et().N().borderVisible,n=()=>t.Fc();e.leftPriceScale.visible&&this.fm===null&&(this.fm=new ml("left",e,i,s,n),this.gm.appendChild(this.fm.Xf())),e.rightPriceScale.visible&&this.pm===null&&(this.pm=new ml("right",e,i,s,n),this.Mm.appendChild(this.pm.Xf()))}}var Rl;const Sb=!!Bs&&!!navigator.userAgentData&&navigator.userAgentData.brands.some((r=>r.brand.includes("Chromium")))&&!!Bs&&((Rl=navigator==null?void 0:navigator.userAgentData)!=null&&Rl.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);class Nb{constructor(t,e,i){var s;this.Am=[],this.zm=[],this.Lm=0,this.sl=0,this.Mo=0,this.Om=0,this.Nm=0,this.Fm=null,this.Wm=!1,this.Sv=new Z,this.xv=new Z,this.Ku=new Z,this.Hm=null,this.Um=null,this.Rp=t,this.Ps=e,this.o_=i,this.kp=document.createElement("div"),this.kp.classList.add("tv-lightweight-charts"),this.kp.style.overflow="hidden",this.kp.style.direction="ltr",this.kp.style.width="100%",this.kp.style.height="100%",(s=this.kp).style.userSelect="none",s.style.webkitUserSelect="none",s.style.msUserSelect="none",s.style.MozUserSelect="none",s.style.webkitTapHighlightColor="transparent",this.$m=document.createElement("table"),this.$m.setAttribute("cellspacing","0"),this.kp.appendChild(this.$m),this.qm=this.Ym.bind(this),$h(this.Ps)&&this.jm(!0),this.ts=new db(this.Zu.bind(this),this.Ps,i),this.Qt().uc().i(this.Km.bind(this),this),this.Xm=new Tb(this,this.o_),this.$m.appendChild(this.Xm.Xf());const n=e.autoSize&&this.Zm();let h=this.Ps.width,l=this.Ps.height;if(n||h===0||l===0){const c=t.getBoundingClientRect();h=h||c.width,l=l||c.height}this.Gm(h,l),this.Jm(),t.appendChild(this.kp),this.Qm(),this.ts.Et().Iu().i(this.ts.Bh.bind(this.ts),this),this.ts.Vo().i(this.ts.Bh.bind(this.ts),this)}Qt(){return this.ts}N(){return this.Ps}Uf(){return this.Am}tw(){return this.Xm}m(){this.jm(!1),this.Lm!==0&&window.cancelAnimationFrame(this.Lm),this.ts.uc().u(this),this.ts.Et().Iu().u(this),this.ts.Vo().u(this),this.ts.m();for(const t of this.Am)this.$m.removeChild(t.Xf()),t.Kv().u(this),t.Xv().u(this),t.m();this.Am=[];for(const t of this.zm)this.iw(t);this.zm=[],E(this.Xm).m(),this.kp.parentElement!==null&&this.kp.parentElement.removeChild(this.kp),this.Ku.m(),this.Sv.m(),this.xv.m(),this.sw()}Gm(t,e,i=!1){if(this.sl===e&&this.Mo===t)return;const s=(function(l){const c=Math.floor(l.width),u=Math.floor(l.height);return Y({width:c-c%2,height:u-u%2})})(Y({width:t,height:e}));this.sl=s.height,this.Mo=s.width;const n=this.sl+"px",h=this.Mo+"px";E(this.kp).style.height=n,E(this.kp).style.width=h,this.$m.style.height=n,this.$m.style.width=h,i?this.nw(lt.gn(),performance.now()):this.ts.Bh()}av(t){t===void 0&&(t=lt.gn());for(let e=0;e<this.Am.length;e++)this.Am[e].av(t.en(e).tn);this.Ps.timeScale.visible&&this.Xm.av(t.nn())}hr(t){var s;const e=$h(this.Ps);this.ts.hr(t);const i=$h(this.Ps);i!==e&&this.jm(i),(s=t.layout)!=null&&s.panes&&this.ew(),this.Qm(),this.rw(t)}Kv(){return this.Sv}Xv(){return this.xv}uc(){return this.Ku}hw(){this.Fm!==null&&(this.nw(this.Fm,performance.now()),this.Fm=null);const t=this.aw(null),e=document.createElement("canvas");e.width=t.width,e.height=t.height;const i=E(e.getContext("2d"));return this.aw(i),e}lw(t){return t==="left"&&!this.ow()||t==="right"&&!this._w()||this.Am.length===0?0:E(t==="left"?this.Am[0].sm():this.Am[0].nm()).hv()}uw(){return this.Ps.autoSize&&this.Hm!==null}tp(){return this.kp}cw(t){this.Um=t,this.Um?this.tp().style.setProperty("cursor",t):this.tp().style.removeProperty("cursor")}dw(){return this.Um}fw(t){return Ct(this.Am[t]).Zf()}ew(){this.zm.forEach((t=>{t.kt()}))}rw(t){(t.autoSize!==void 0||!this.Hm||t.width===void 0&&t.height===void 0)&&(t.autoSize&&!this.Hm&&this.Zm(),t.autoSize===!1&&this.Hm!==null&&this.sw(),t.autoSize||t.width===void 0&&t.height===void 0||this.Gm(t.width||this.Mo,t.height||this.sl))}aw(t){let e=0,i=0;const s=this.Am[0],n=(l,c)=>{let u=0;for(let d=0;d<this.Am.length;d++){const p=this.Am[d],m=E(l==="left"?p.sm():p.nm()),v=m.Gf();if(t!==null&&m.Jf(t,c,u),u+=v.height,d<this.Am.length-1){const b=this.zm[d],M=b.Gf();t!==null&&b.Jf(t,c,u),u+=M.height}}};this.ow()&&(n("left",0),e+=E(s.sm()).Gf().width);for(let l=0;l<this.Am.length;l++){const c=this.Am[l],u=c.Gf();if(t!==null&&c.Jf(t,e,i),i+=u.height,l<this.Am.length-1){const d=this.zm[l],p=d.Gf();t!==null&&d.Jf(t,e,i),i+=p.height}}e+=s.Gf().width,this._w()&&(n("right",e),e+=E(s.nm()).Gf().width);const h=(l,c,u)=>{E(l==="left"?this.Xm.xm():this.Xm.Cm()).Jf(E(t),c,u)};if(this.Ps.timeScale.visible){const l=this.Xm.Gf();if(t!==null){let c=0;this.ow()&&(h("left",c,i),c=E(s.sm()).Gf().width),this.Xm.Jf(t,c,i),c+=l.width,this._w()&&h("right",c,i)}i+=l.height}return Y({width:e,height:i})}pw(){let t=0,e=0,i=0;for(const I of this.Am)this.ow()&&(e=Math.max(e,E(I.sm()).sv(),this.Ps.leftPriceScale.minimumWidth)),this._w()&&(i=Math.max(i,E(I.nm()).sv(),this.Ps.rightPriceScale.minimumWidth)),t+=I.Io();e=$o(e),i=$o(i);const s=this.Mo,n=this.sl,h=Math.max(s-e-i,0),l=1*this.zm.length,c=this.Ps.timeScale.visible;let u=c?Math.max(this.Xm.ym(),this.Ps.timeScale.minimumHeight):0;var d;u=(d=u)+d%2;const p=l+u,m=n<p?0:n-p,v=m/t;let b=0;const M=window.devicePixelRatio||1;for(let I=0;I<this.Am.length;++I){const k=this.Am[I];k.zv(this.ts.$s()[I]);let D=0,X=0;X=I===this.Am.length-1?Math.ceil((m-b)*M)/M:Math.round(k.Io()*v*M)/M,D=Math.max(X,2),b+=D,k.rv(Y({width:h,height:D})),this.ow()&&k.Gv(e,"left"),this._w()&&k.Gv(i,"right"),k.hp()&&this.ts.cc(k.hp(),D)}this.Xm.km(Y({width:c?h:0,height:u}),c?e:0,c?i:0),this.ts.Eo(h),this.Om!==e&&(this.Om=e),this.Nm!==i&&(this.Nm=i)}jm(t){t?this.kp.addEventListener("wheel",this.qm,{passive:!1}):this.kp.removeEventListener("wheel",this.qm)}mw(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return Sb?1/window.devicePixelRatio:1}Ym(t){if(!(t.deltaX!==0&&this.Ps.handleScroll.mouseWheel||t.deltaY!==0&&this.Ps.handleScale.mouseWheel))return;const e=this.mw(t),i=e*t.deltaX/100,s=-e*t.deltaY/100;if(t.cancelable&&t.preventDefault(),s!==0&&this.Ps.handleScale.mouseWheel){const n=Math.sign(s)*Math.min(1,Math.abs(s)),h=t.clientX-this.kp.getBoundingClientRect().left;this.Qt().Mc(h,n)}i!==0&&this.Ps.handleScroll.mouseWheel&&this.Qt().bc(-80*i)}nw(t,e){var s;const i=t.nn();i===3&&this.ww(),i!==3&&i!==2||(this.gw(t),this.Mw(t,e),this.Xm.kt(),this.Am.forEach((n=>{n.Ov()})),((s=this.Fm)==null?void 0:s.nn())===3&&(this.Fm.vn(t),this.ww(),this.gw(this.Fm),this.Mw(this.Fm,e),t=this.Fm,this.Fm=null)),this.av(t)}Mw(t,e){for(const i of t.pn())this.mn(i,e)}gw(t){const e=this.ts.$s();for(let i=0;i<e.length;i++)t.en(i).sn&&e[i].Go()}mn(t,e){const i=this.ts.Et();switch(t.an){case 0:i.Eu();break;case 1:i.Au(t.Wt);break;case 2:i.dn(t.Wt);break;case 3:i.fn(t.Wt);break;case 4:i.bu();break;case 5:t.Wt.Tu(e)||i.fn(t.Wt.Ru(e))}}Zu(t){this.Fm!==null?this.Fm.vn(t):this.Fm=t,this.Wm||(this.Wm=!0,this.Lm=window.requestAnimationFrame((e=>{if(this.Wm=!1,this.Lm=0,this.Fm!==null){const i=this.Fm;this.Fm=null,this.nw(i,e);for(const s of i.pn())if(s.an===5&&!s.Wt.Tu(e)){this.Qt()._n(s.Wt);break}}})))}ww(){this.Jm()}iw(t){this.$m.removeChild(t.Xf()),t.m()}Jm(){const t=this.ts.$s(),e=t.length,i=this.Am.length;for(let s=e;s<i;s++){const n=Ct(this.Am.pop());this.$m.removeChild(n.Xf()),n.Kv().u(this),n.Xv().u(this),n.m();const h=this.zm.pop();h!==void 0&&this.iw(h)}for(let s=i;s<e;s++){const n=new wa(this,t[s]);if(n.Kv().i(this.bw.bind(this,n),this),n.Xv().i(this.Sw.bind(this,n),this),this.Am.push(n),s>0){const h=new bb(this,s-1,s);this.zm.push(h),this.$m.insertBefore(h.Xf(),this.Xm.Xf())}this.$m.insertBefore(n.Xf(),this.Xm.Xf())}for(let s=0;s<e;s++){const n=t[s],h=this.Am[s];h.hp()!==n?h.zv(n):h.Av()}this.Qm(),this.pw()}xw(t,e,i,s){var p;const n=new Map;t!==null&&this.ts.js().forEach((m=>{const v=m.Xs().Fr(t);v!==null&&n.set(m,v)}));let h;if(t!==null){const m=(p=this.ts.Et().ss(t))==null?void 0:p.originalTime;m!==void 0&&(h=m)}const l=this.Qt().hc(),c=l!==null&&l.n_ instanceof gh?l.n_:void 0,u=l!==null&&l.e_!==void 0?l.e_.Kn:void 0,d=this.Cw(s);return{Pw:h,Re:t??void 0,kw:e??void 0,yw:d!==-1?d:void 0,Tw:c,Rw:n,Dw:u,Vw:i??void 0}}Cw(t){let e=-1;if(t)e=this.Am.indexOf(t);else{const i=this.Qt()._c().Us();i!==null&&(e=this.Qt().$s().indexOf(i))}return e}bw(t,e,i,s){this.Sv.p((()=>this.xw(e,i,s,t)))}Sw(t,e,i,s){this.xv.p((()=>this.xw(e,i,s,t)))}Km(t,e,i){var s;this.cw(((s=this.Qt().hc())==null?void 0:s.h_)??null),this.Ku.p((()=>this.xw(t,e,i)))}Qm(){const t=this.Ps.timeScale.visible?"":"none";this.Xm.Xf().style.display=t}ow(){return this.Am[0].hp().Wo().N().visible}_w(){return this.Am[0].hp().Ho().N().visible}Zm(){return"ResizeObserver"in window&&(this.Hm=new ResizeObserver((t=>{const e=t[t.length-1];e&&this.Gm(e.contentRect.width,e.contentRect.height)})),this.Hm.observe(this.Rp,{box:"border-box"}),!0)}sw(){this.Hm!==null&&this.Hm.disconnect(),this.Hm=null}}function $h(r){return!!(r.handleScroll.mouseWheel||r.handleScale.mouseWheel)}function Ib(r){return r.open===void 0&&r.value===void 0}function Ob(r){return(function(t){return t.open!==void 0})(r)||(function(t){return t.value!==void 0})(r)}function gl(r,t,e,i){const s=e.value,n={Re:t,wt:r,Wt:[s,s,s,s],Pw:i};return e.color!==void 0&&(n.R=e.color),n}function Pb(r,t,e,i){const s=e.value,n={Re:t,wt:r,Wt:[s,s,s,s],Pw:i};return e.lineColor!==void 0&&(n.vt=e.lineColor),e.topColor!==void 0&&(n.mr=e.topColor),e.bottomColor!==void 0&&(n.wr=e.bottomColor),n}function kb(r,t,e,i){const s=e.value,n={Re:t,wt:r,Wt:[s,s,s,s],Pw:i};return e.topLineColor!==void 0&&(n.gr=e.topLineColor),e.bottomLineColor!==void 0&&(n.Mr=e.bottomLineColor),e.topFillColor1!==void 0&&(n.br=e.topFillColor1),e.topFillColor2!==void 0&&(n.Sr=e.topFillColor2),e.bottomFillColor1!==void 0&&(n.Cr=e.bottomFillColor1),e.bottomFillColor2!==void 0&&(n.Pr=e.bottomFillColor2),n}function Ab(r,t,e,i){const s={Re:t,wt:r,Wt:[e.open,e.high,e.low,e.close],Pw:i};return e.color!==void 0&&(s.R=e.color),s}function Rb(r,t,e,i){const s={Re:t,wt:r,Wt:[e.open,e.high,e.low,e.close],Pw:i};return e.color!==void 0&&(s.R=e.color),e.borderColor!==void 0&&(s.Ht=e.borderColor),e.wickColor!==void 0&&(s.vr=e.wickColor),s}function Lb(r,t,e,i,s){const n=Ct(s)(e),h=Math.max(...n),l=Math.min(...n),c=n[n.length-1],u=[c,h,l,c],{time:d,color:p,...m}=e;return{Re:t,wt:r,Wt:u,Pw:i,se:m,R:p}}function tn(r){return r.Wt!==void 0}function vl(r,t){return t.customValues!==void 0&&(r.Iw=t.customValues),r}function ri(r){return(t,e,i,s,n,h)=>(function(l,c){return c?c(l):Ib(l)})(i,h)?vl({wt:t,Re:e,Pw:s},i):vl(r(t,e,i,s,n),i)}function bl(r){return{Candlestick:ri(Rb),Bar:ri(Ab),Area:ri(Pb),Baseline:ri(kb),Histogram:ri(gl),Line:ri(gl),Custom:ri(Lb)}[r]}function wl(r){return{Re:0,Bw:new Map,Hh:r}}function _l(r,t){if(r!==void 0&&r.length!==0)return{Ew:t.key(r[0].wt),Aw:t.key(r[r.length-1].wt)}}function yl(r){let t;return r.forEach((e=>{t===void 0&&(t=e.Pw)})),Ct(t)}class Db{constructor(t){this.zw=new Map,this.Lw=new Map,this.Ow=new Map,this.Nw=[],this.o_=t}m(){this.zw.clear(),this.Lw.clear(),this.Ow.clear(),this.Nw=[]}Fw(t,e){let i=this.zw.size!==0,s=!1;const n=this.Lw.get(t);if(n!==void 0)if(this.Lw.size===1)i=!1,s=!0,this.zw.clear();else for(const c of this.Nw)c.pointData.Bw.delete(t)&&(s=!0);let h=[];if(e.length!==0){const c=e.map((v=>v.time)),u=this.o_.createConverterToInternalObj(e),d=bl(t.Rr()),p=t.da(),m=t.pa();h=e.map(((v,b)=>{const M=u(v.time),I=this.o_.key(M);let k=this.zw.get(I);k===void 0&&(k=wl(M),this.zw.set(I,k),s=!0);const D=d(M,k.Re,v,c[b],p,m);return k.Bw.set(t,D),D}))}i&&this.Ww(),this.Hw(t,h);let l=-1;if(s){const c=[];this.zw.forEach((u=>{c.push({timeWeight:0,time:u.Hh,pointData:u,originalTime:yl(u.Bw)})})),c.sort(((u,d)=>this.o_.key(u.time)-this.o_.key(d.time))),l=this.Uw(c)}return this.$w(t,l,(function(c,u,d){const p=_l(c,d),m=_l(u,d);if(p!==void 0&&m!==void 0)return{qw:!1,zh:p.Aw>=m.Aw&&p.Ew>=m.Ew}})(this.Lw.get(t),n,this.o_))}Ec(t){return this.Fw(t,[])}Yw(t,e,i){const s=e;(function(I){I.Pw===void 0&&(I.Pw=I.time)})(s),this.o_.preprocessData(e);const n=this.o_.createConverterToInternalObj([e])(e.time),h=this.Ow.get(t);if(!i&&h!==void 0&&this.o_.key(n)<this.o_.key(h))throw new Error(`Cannot update oldest data, last time=${h}, new time=${n}`);let l=this.zw.get(this.o_.key(n));if(i&&l===void 0)throw new Error("Cannot update non-existing data point when historicalUpdate is true");const c=l===void 0;l===void 0&&(l=wl(n),this.zw.set(this.o_.key(n),l));const u=bl(t.Rr()),d=t.da(),p=t.pa(),m=u(n,l.Re,e,s.Pw,d,p);l.Bw.set(t,m),i?this.jw(t,m,l.Re):this.Kw(t,m);const v={zh:tn(m),qw:i};if(!c)return this.$w(t,-1,v);const b={timeWeight:0,time:l.Hh,pointData:l,originalTime:yl(l.Bw)},M=zs(this.Nw,this.o_.key(b.time),((I,k)=>this.o_.key(I.time)<k));this.Nw.splice(M,0,b);for(let I=M;I<this.Nw.length;++I)zh(this.Nw[I].pointData,I);return this.o_.fillWeightsForPoints(this.Nw,M),this.$w(t,M,v)}Kw(t,e){let i=this.Lw.get(t);i===void 0&&(i=[],this.Lw.set(t,i));const s=i.length!==0?i[i.length-1]:null;s===null||this.o_.key(e.wt)>this.o_.key(s.wt)?tn(e)&&i.push(e):tn(e)?i[i.length-1]=e:i.splice(-1,1),this.Ow.set(t,e.wt)}jw(t,e,i){const s=this.Lw.get(t);if(s===void 0)return;const n=zs(s,i,((h,l)=>h.Re<l));tn(e)?s[n]=e:s.splice(n,1)}Hw(t,e){e.length!==0?(this.Lw.set(t,e.filter(tn)),this.Ow.set(t,e[e.length-1].wt)):(this.Lw.delete(t),this.Ow.delete(t))}Ww(){for(const t of this.Nw)t.pointData.Bw.size===0&&this.zw.delete(this.o_.key(t.time))}Uw(t){let e=-1;for(let i=0;i<this.Nw.length&&i<t.length;++i){const s=this.Nw[i],n=t[i];if(this.o_.key(s.time)!==this.o_.key(n.time)){e=i;break}n.timeWeight=s.timeWeight,zh(n.pointData,i)}if(e===-1&&this.Nw.length!==t.length&&(e=Math.min(this.Nw.length,t.length)),e===-1)return-1;for(let i=e;i<t.length;++i)zh(t[i].pointData,i);return this.o_.fillWeightsForPoints(t,e),this.Nw=t,e}Xw(){if(this.Lw.size===0)return null;let t=0;return this.Lw.forEach((e=>{e.length!==0&&(t=Math.max(t,e[e.length-1].Re))})),t}$w(t,e,i){const s={Oo:new Map,Et:{ou:this.Xw()}};if(e!==-1)this.Lw.forEach(((n,h)=>{s.Oo.set(h,{se:n,Zw:h===t?i:void 0})})),this.Lw.has(t)||s.Oo.set(t,{se:[],Zw:i}),s.Et.Gw=this.Nw,s.Et.Jw=e;else{const n=this.Lw.get(t);s.Oo.set(t,{se:n||[],Zw:i})}return s}}function zh(r,t){r.Re=t,r.Bw.forEach((e=>{e.Re=t}))}function $b(r,t){return r.wt<t}function zb(r,t){return t<r.wt}function rf(r,t,e){const i=t.Uh(),s=t.bi(),n=zs(r,i,$b),h=Qd(r,s,zb);if(!e)return{from:n,to:h};let l=n,c=h;return n>0&&n<r.length&&r[n].wt>=i&&(l=n-1),h>0&&h<r.length&&r[h-1].wt<=s&&(c=h+1),{from:l,to:c}}class ya{constructor(t,e,i){this.Qw=!0,this.tg=!0,this.ig=!0,this.sg=[],this.ng=null,this.Jn=t,this.Qn=e,this.eg=i}kt(t){this.Qw=!0,t==="data"&&(this.tg=!0),t==="options"&&(this.ig=!0)}Tt(){return this.Jn.Vt()?(this.rg(),this.ng===null?null:this.hg):null}ag(){this.sg=this.sg.map((t=>({...t,...this.Jn.Rh().Dr(t.wt)})))}lg(){this.ng=null}rg(){this.tg&&(this.og(),this.tg=!1),this.ig&&(this.ag(),this.ig=!1),this.Qw&&(this._g(),this.Qw=!1)}_g(){const t=this.Jn.Ft(),e=this.Qn.Et();if(this.lg(),e.Ki()||t.Ki())return;const i=e.Pe();if(i===null||this.Jn.Xs().zr()===0)return;const s=this.Jn.zt();s!==null&&(this.ng=rf(this.sg,i,this.eg),this.ug(t,e,s.Wt),this.cg())}}class Bb{constructor(t,e){this.dg=t,this.Yi=e}nt(t,e,i){this.dg.draw(t,this.Yi,e,i)}}class Fb extends ya{constructor(t,e,i){super(t,e,!1),this.sh=i,this.hg=new Bb(this.sh.renderer(),(s=>{const n=t.zt();return n===null?null:t.Ft().Nt(s,n.Wt)}))}fa(t){return this.sh.priceValueBuilder(t)}va(t){return this.sh.isWhitespace(t)}og(){const t=this.Jn.Rh();this.sg=this.Jn.Xs().Hr().map((e=>({wt:e.Re,_t:NaN,...t.Dr(e.Re),fg:e.se})))}ug(t,e){e._u(this.sg,kn(this.ng))}cg(){this.sh.update({bars:this.sg.map(Vb),barSpacing:this.Qn.Et().vu(),visibleRange:this.ng},this.Jn.N())}}function Vb(r){return{x:r._t,time:r.wt,originalData:r.fg,barColor:r.cr}}const Yb={color:"#2196f3"},Hb=(r,t,e)=>{const i=Ge(e);return new Fb(r,t,i)};function Ea(r){const t={value:r.Wt[3],time:r.Pw};return r.Iw!==void 0&&(t.customValues=r.Iw),t}function El(r){const t=Ea(r);return r.R!==void 0&&(t.color=r.R),t}function Ub(r){const t=Ea(r);return r.vt!==void 0&&(t.lineColor=r.vt),r.mr!==void 0&&(t.topColor=r.mr),r.wr!==void 0&&(t.bottomColor=r.wr),t}function Xb(r){const t=Ea(r);return r.gr!==void 0&&(t.topLineColor=r.gr),r.Mr!==void 0&&(t.bottomLineColor=r.Mr),r.br!==void 0&&(t.topFillColor1=r.br),r.Sr!==void 0&&(t.topFillColor2=r.Sr),r.Cr!==void 0&&(t.bottomFillColor1=r.Cr),r.Pr!==void 0&&(t.bottomFillColor2=r.Pr),t}function hf(r){const t={open:r.Wt[0],high:r.Wt[1],low:r.Wt[2],close:r.Wt[3],time:r.Pw};return r.Iw!==void 0&&(t.customValues=r.Iw),t}function Wb(r){const t=hf(r);return r.R!==void 0&&(t.color=r.R),t}function qb(r){const t=hf(r),{R:e,Ht:i,vr:s}=r;return e!==void 0&&(t.color=e),i!==void 0&&(t.borderColor=i),s!==void 0&&(t.wickColor=s),t}function Fo(r){return{Area:Ub,Line:El,Baseline:Xb,Histogram:El,Bar:Wb,Candlestick:qb,Custom:Gb}[r]}function Gb(r){const t=r.Pw;return{...r.se,time:t}}const jb={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},Zb={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},Qb={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:Yd,panes:{enableResize:!0,separatorColor:"#E0E3EB",separatorHoverColor:"rgba(178, 181, 189, 0.2)"},attributionLogo:!0,colorSpace:"srgb",colorParsers:[]},Bh={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0,ensureEdgeTickMarksVisible:!1},Kb={rightOffset:0,barSpacing:6,minBarSpacing:.5,maxBarSpacing:0,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0,ignoreWhitespaceIndices:!1};function Ml(){return{addDefaultPane:!0,width:0,height:0,autoSize:!1,layout:Qb,crosshair:jb,grid:Zb,overlayPriceScales:{...Bh},leftPriceScale:{...Bh,visible:!1},rightPriceScale:{...Bh,visible:!0},timeScale:Kb,localization:{locale:Bs?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class of{constructor(t,e,i){this.Wf=t,this.pg=e,this.vg=i??0}applyOptions(t){this.Wf.Qt().lc(this.pg,t,this.vg)}options(){return this.Yi().N()}width(){return ph(this.pg)?this.Wf.lw(this.pg):0}setVisibleRange(t){this.setAutoScale(!1),this.Yi().Wl(new vt(t.from,t.to))}getVisibleRange(){const t=this.Yi().Qe();return t===null?null:{from:t.$e(),to:t.qe()}}setAutoScale(t){this.applyOptions({autoScale:t})}Yi(){return E(this.Wf.Qt().oc(this.pg,this.vg)).Ft}}class Jb{constructor(t,e,i,s){this.Wf=t,this.Pt=i,this.mg=e,this.wg=s}getHeight(){return this.Pt.$t()}setHeight(t){const e=this.Wf.Qt(),i=e.Hc(this.Pt);e.fc(i,t)}getStretchFactor(){return this.Pt.Io()}setStretchFactor(t){this.Pt.Bo(t),this.Wf.Qt().Bh()}paneIndex(){return this.Wf.Qt().Hc(this.Pt)}moveTo(t){const e=this.paneIndex();e!==t&&(ct(t>=0&&t<this.Wf.Uf().length,"Invalid pane index"),this.Wf.Qt().mc(e,t))}getSeries(){return this.Pt.Oo().map((t=>this.mg(t)))??[]}getHTMLElement(){const t=this.Wf.Uf();return t&&t.length!==0&&t[this.paneIndex()]?t[this.paneIndex()].Xf():null}attachPrimitive(t){this.Pt.ua(t),t.attached&&t.attached({chart:this.wg,requestUpdate:()=>this.Pt.Qt().Bh()})}detachPrimitive(t){this.Pt.ca(t)}priceScale(t){if(this.Pt.Do(t)===null)throw new Error(`Cannot find price scale with id: ${t}`);return new of(this.Wf,t,this.paneIndex())}setPreserveEmptyPane(t){this.Pt.zo(t)}preserveEmptyPane(){return this.Pt.Lo()}addCustomSeries(t,e={},i=0){return this.wg.addCustomSeries(t,e,i)}addSeries(t,e={}){return this.wg.addSeries(t,e,this.paneIndex())}}const tw={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class Cl{constructor(t){this.ir=t}applyOptions(t){this.ir.hr(t)}options(){return this.ir.N()}gg(){return this.ir}}class ew{constructor(t,e,i,s,n,h){this.Mg=new Z,this.Jn=t,this.bg=e,this.Sg=i,this.o_=n,this.wg=s,this.xg=h}m(){this.Mg.m()}priceFormatter(){return this.Jn.ra()}priceToCoordinate(t){const e=this.Jn.zt();return e===null?null:this.Jn.Ft().Nt(t,e.Wt)}coordinateToPrice(t){const e=this.Jn.zt();return e===null?null:this.Jn.Ft().Ts(t,e.Wt)}barsInLogicalRange(t){if(t===null)return null;const e=new ss(new is(t.from,t.to)).k_(),i=this.Jn.Xs();if(i.Ki())return null;const s=i.Fr(e.Uh(),1),n=i.Fr(e.bi(),-1),h=E(i.Lr()),l=E(i.Ks());if(s!==null&&n!==null&&s.Re>n.Re)return{barsBefore:t.from-h,barsAfter:l-t.to};const c={barsBefore:s===null||s.Re===h?t.from-h:s.Re-h,barsAfter:n===null||n.Re===l?l-t.to:l-n.Re};return s!==null&&n!==null&&(c.from=s.Pw,c.to=n.Pw),c}setData(t){this.o_,this.Jn.Rr(),this.bg.Cg(this.Jn,t),this.Pg("full")}update(t,e=!1){this.Jn.Rr(),this.bg.kg(this.Jn,t,e),this.Pg("update")}dataByIndex(t,e){const i=this.Jn.Xs().Fr(t,e);return i===null?null:Fo(this.seriesType())(i)}data(){const t=Fo(this.seriesType());return this.Jn.Xs().Hr().map((e=>t(e)))}subscribeDataChanged(t){this.Mg.i(t)}unsubscribeDataChanged(t){this.Mg._(t)}applyOptions(t){this.Jn.hr(t)}options(){return we(this.Jn.N())}priceScale(){return this.Sg.priceScale(this.Jn.Ft().wa(),this.getPane().paneIndex())}createPriceLine(t){const e=It(we(tw),t),i=this.Jn.Oh(e);return new Cl(i)}removePriceLine(t){this.Jn.Nh(t.gg())}priceLines(){return this.Jn.Fh().map((t=>new Cl(t)))}seriesType(){return this.Jn.Rr()}attachPrimitive(t){this.Jn.ua(t),t.attached&&t.attached({chart:this.wg,series:this,requestUpdate:()=>this.Jn.Qt().Bh(),horzScaleBehavior:this.o_})}detachPrimitive(t){this.Jn.ca(t),t.detached&&t.detached(),this.Jn.Qt().Bh()}getPane(){const t=this.Jn,e=E(this.Jn.Qt().Hn(t));return this.xg(e)}moveToPane(t){this.Jn.Qt().Oc(this.Jn,t)}seriesOrder(){const t=this.Jn.Qt().Hn(this.Jn);return t===null?-1:t.Oo().indexOf(this.Jn)}setSeriesOrder(t){const e=this.Jn.Qt().Hn(this.Jn);e!==null&&e.Qo(this.Jn,t)}Pg(t){this.Mg.v()&&this.Mg.p(t)}}class iw{constructor(t,e,i){this.yg=new Z,this.z_=new Z,this.wm=new Z,this.ts=t,this.uh=t.Et(),this.Xm=e,this.uh.Du().i(this.Tg.bind(this)),this.uh.Vu().i(this.Rg.bind(this)),this.Xm.Pm().i(this.Dg.bind(this)),this.o_=i}m(){this.uh.Du().u(this),this.uh.Vu().u(this),this.Xm.Pm().u(this),this.yg.m(),this.z_.m(),this.wm.m()}scrollPosition(){return this.uh.wu()}scrollToPosition(t,e){e?this.uh.yu(t,1e3):this.ts.fn(t)}scrollToRealTime(){this.uh.ku()}getVisibleRange(){const t=this.uh.su();return t===null?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){const e={from:this.o_.convertHorzItemToInternal(t.from),to:this.o_.convertHorzItemToInternal(t.to)},i=this.uh.hu(e);this.ts.zc(i)}getVisibleLogicalRange(){const t=this.uh.iu();return t===null?null:{from:t.Uh(),to:t.bi()}}setVisibleLogicalRange(t){ct(t.from<=t.to,"The from index cannot be after the to index."),this.ts.zc(t)}resetTimeScale(){this.ts.cn()}fitContent(){this.ts.Eu()}logicalToCoordinate(t){const e=this.ts.Et();return e.Ki()?null:e.qt(t)}coordinateToLogical(t){return this.uh.Ki()?null:this.uh.uu(t)}timeToIndex(t,e){const i=this.o_.convertHorzItemToInternal(t);return this.uh.J_(i,e)}timeToCoordinate(t){const e=this.timeToIndex(t,!1);return e===null?null:this.uh.qt(e)}coordinateToTime(t){const e=this.ts.Et(),i=e.uu(t),s=e.ss(i);return s===null?null:s.originalTime}width(){return this.Xm.Zf().width}height(){return this.Xm.Zf().height}subscribeVisibleTimeRangeChange(t){this.yg.i(t)}unsubscribeVisibleTimeRangeChange(t){this.yg._(t)}subscribeVisibleLogicalRangeChange(t){this.z_.i(t)}unsubscribeVisibleLogicalRangeChange(t){this.z_._(t)}subscribeSizeChange(t){this.wm.i(t)}unsubscribeSizeChange(t){this.wm._(t)}applyOptions(t){this.uh.hr(t)}options(){return{...we(this.uh.N()),barSpacing:this.uh.vu()}}Tg(){this.yg.v()&&this.yg.p(this.getVisibleRange())}Rg(){this.z_.v()&&this.z_.p(this.getVisibleLogicalRange())}Dg(t){this.wm.p(t.width,t.height)}}function sw(r){if(r===void 0||r.type==="custom")return;const t=r;t.minMove!==void 0&&t.precision===void 0&&(t.precision=(function(e){if(e>=1)return 0;let i=0;for(;i<8;i++){const s=Math.round(e);if(Math.abs(s-e)<1e-8)return i;e*=10}return i})(t.minMove))}function xl(r){return(function(t){if(Sr(t.handleScale)){const i=t.handleScale;t.handleScale={axisDoubleClickReset:{time:i,price:i},axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(t.handleScale!==void 0){const{axisPressedMouseMove:i,axisDoubleClickReset:s}=t.handleScale;Sr(i)&&(t.handleScale.axisPressedMouseMove={time:i,price:i}),Sr(s)&&(t.handleScale.axisDoubleClickReset={time:s,price:s})}const e=t.handleScroll;Sr(e)&&(t.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e})})(r),r}class nw{constructor(t,e,i){this.Vg=new Map,this.Ig=new Map,this.Bg=new Z,this.Eg=new Z,this.Ag=new Z,this.$u=new WeakMap,this.zg=new Db(e);const s=i===void 0?we(Ml()):It(we(Ml()),xl(i));this.Lg=e,this.Wf=new Nb(t,s,e),this.Wf.Kv().i((h=>{this.Bg.v()&&this.Bg.p(this.Og(h()))}),this),this.Wf.Xv().i((h=>{this.Eg.v()&&this.Eg.p(this.Og(h()))}),this),this.Wf.uc().i((h=>{this.Ag.v()&&this.Ag.p(this.Og(h()))}),this);const n=this.Wf.Qt();this.Ng=new iw(n,this.Wf.tw(),this.Lg)}remove(){this.Wf.Kv().u(this),this.Wf.Xv().u(this),this.Wf.uc().u(this),this.Ng.m(),this.Wf.m(),this.Vg.clear(),this.Ig.clear(),this.Bg.m(),this.Eg.m(),this.Ag.m(),this.zg.m()}resize(t,e,i){this.autoSizeActive()||this.Wf.Gm(t,e,i)}addCustomSeries(t,e={},i=0){const s=(n=>({type:"Custom",isBuiltIn:!1,defaultOptions:{...Yb,...n.defaultOptions()},Fg:Hb,Wg:n}))(Ge(t));return this.Hg(s,e,i)}addSeries(t,e={},i=0){return this.Hg(t,e,i)}removeSeries(t){const e=Ct(this.Vg.get(t)),i=this.zg.Ec(e);this.Wf.Qt().Ec(e),this.Ug(i),this.Vg.delete(t),this.Ig.delete(e)}Cg(t,e){this.Ug(this.zg.Fw(t,e))}kg(t,e,i){this.Ug(this.zg.Yw(t,e,i))}subscribeClick(t){this.Bg.i(t)}unsubscribeClick(t){this.Bg._(t)}subscribeCrosshairMove(t){this.Ag.i(t)}unsubscribeCrosshairMove(t){this.Ag._(t)}subscribeDblClick(t){this.Eg.i(t)}unsubscribeDblClick(t){this.Eg._(t)}priceScale(t,e=0){return new of(this.Wf,t,e)}timeScale(){return this.Ng}applyOptions(t){this.Wf.hr(xl(t))}options(){return this.Wf.N()}takeScreenshot(){return this.Wf.hw()}addPane(t=!1){const e=this.Wf.Qt().Uc();return e.zo(t),this.$g(e)}removePane(t){this.Wf.Qt().dc(t)}swapPanes(t,e){this.Wf.Qt().vc(t,e)}autoSizeActive(){return this.Wf.uw()}chartElement(){return this.Wf.tp()}panes(){return this.Wf.Qt().$s().map((t=>this.$g(t)))}paneSize(t=0){const e=this.Wf.fw(t);return{height:e.height,width:e.width}}setCrosshairPosition(t,e,i){const s=this.Vg.get(i);if(s===void 0)return;const n=this.Wf.Qt().Hn(s);n!==null&&this.Wf.Qt().Tc(t,e,n)}clearCrosshairPosition(){this.Wf.Qt().Rc(!0)}horzBehaviour(){return this.Lg}Hg(t,e={},i=0){ct(t.Fg!==void 0),sw(e.priceFormat),t.type==="Candlestick"&&(function(c){c.borderColor!==void 0&&(c.borderUpColor=c.borderColor,c.borderDownColor=c.borderColor),c.wickColor!==void 0&&(c.wickUpColor=c.wickColor,c.wickDownColor=c.wickColor)})(e);const s=It(we(Fd),we(t.defaultOptions),e),n=t.Fg,h=new gh(this.Wf.Qt(),t.type,s,n,t.Wg);this.Wf.Qt().Ic(h,i);const l=new ew(h,this,this,this,this.Lg,(c=>this.$g(c)));return this.Vg.set(l,h),this.Ig.set(h,l),l}Ug(t){const e=this.Wf.Qt();e.Dc(t.Et.ou,t.Et.Gw,t.Et.Jw),t.Oo.forEach(((i,s)=>s.ht(i.se,i.Zw))),e.Et().j_(),e.pu()}qg(t){return Ct(this.Ig.get(t))}Og(t){const e=new Map;t.Rw.forEach(((s,n)=>{const h=n.Rr(),l=Fo(h)(s);if(h!=="Custom")ct(Ob(l));else{const c=n.pa();ct(!c||c(l)===!1)}e.set(this.qg(n),l)}));const i=t.Tw!==void 0&&this.Ig.has(t.Tw)?this.qg(t.Tw):void 0;return{time:t.Pw,logical:t.Re,point:t.kw,paneIndex:t.yw,hoveredSeries:i,hoveredObjectId:t.Dw,seriesData:e,sourceEvent:t.Vw}}$g(t){let e=this.$u.get(t);return e||(e=new Jb(this.Wf,(i=>this.qg(i)),t,this),this.$u.set(t,e)),e}}function rw(r){if(Cr(r)){const t=document.getElementById(r);return ct(t!==null,`Cannot find element in DOM with id=${r}`),t}return r}function hw(r,t,e){const i=rw(r),s=new nw(i,t,e);return t.setOptions(s.options()),s}function af(r,t){return hw(r,new al,al.ad(t))}class Ma extends ya{constructor(t,e){super(t,e,!0)}ug(t,e,i){e._u(this.sg,kn(this.ng)),t.$l(this.sg,i,kn(this.ng))}Yg(t,e){return{wt:t,gt:e,_t:NaN,ut:NaN}}og(){const t=this.Jn.Rh();this.sg=this.Jn.Xs().Hr().map((e=>{const i=e.Wt[3];return this.jg(e.Re,i,t)}))}}function lf(r,t,e,i,s,n,h){if(t.length===0||i.from>=t.length||i.to<=0)return;const{context:l,horizontalPixelRatio:c,verticalPixelRatio:u}=r,d=t[i.from];let p=n(r,d),m=d;if(i.to-i.from<2){const v=s/2;l.beginPath();const b={_t:d._t-v,ut:d.ut},M={_t:d._t+v,ut:d.ut};l.moveTo(b._t*c,b.ut*u),l.lineTo(M._t*c,M.ut*u),h(r,p,b,M)}else{const v=(M,I)=>{h(r,p,m,I),l.beginPath(),p=M,m=I};let b=m;l.beginPath(),l.moveTo(d._t*c,d.ut*u);for(let M=i.from+1;M<i.to;++M){b=t[M];const I=n(r,b);switch(e){case 0:l.lineTo(b._t*c,b.ut*u);break;case 1:l.lineTo(b._t*c,t[M-1].ut*u),I!==p&&(v(I,b),l.lineTo(b._t*c,t[M-1].ut*u)),l.lineTo(b._t*c,b.ut*u);break;case 2:{const[k,D]=ow(t,M-1,M);l.bezierCurveTo(k._t*c,k.ut*u,D._t*c,D.ut*u,b._t*c,b.ut*u);break}}e!==1&&I!==p&&(v(I,b),l.moveTo(b._t*c,b.ut*u))}(m!==b||m===b&&e===1)&&h(r,p,m,b)}}const Tl=6;function Fh(r,t){return{_t:r._t-t._t,ut:r.ut-t.ut}}function Sl(r,t){return{_t:r._t/t,ut:r.ut/t}}function ow(r,t,e){const i=Math.max(0,t-1),s=Math.min(r.length-1,e+1);var n,h;return[(n=r[t],h=Sl(Fh(r[e],r[i]),Tl),{_t:n._t+h._t,ut:n.ut+h.ut}),Fh(r[e],Sl(Fh(r[s],r[t]),Tl))]}function aw(r,t){const e=r.context;e.strokeStyle=t,e.stroke()}class lw extends Ee{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et(t){if(this.rt===null)return;const{ot:e,lt:i,Kg:s,Xg:n,ct:h,Xt:l,Zg:c}=this.rt;if(i===null)return;const u=t.context;u.lineCap="butt",u.lineWidth=h*t.verticalPixelRatio,$i(u,l),u.lineJoin="round";const d=this.Gg.bind(this);n!==void 0&&lf(t,e,n,i,s,d,aw),c&&(function(p,m,v,b,M){if(b.to-b.from<=0)return;const{horizontalPixelRatio:I,verticalPixelRatio:k,context:D}=p;let X=null;const W=Math.max(1,Math.floor(I))%2/2,Tt=v*k+W;for(let Rt=b.to-1;Rt>=b.from;--Rt){const kt=m[Rt];if(kt){const ce=M(p,kt);ce!==X&&(D.beginPath(),X!==null&&D.fill(),D.fillStyle=ce,X=ce);const Me=Math.round(kt._t*I)+W,Qs=kt.ut*k;D.moveTo(Me,Qs),D.arc(Me,Qs,Tt,0,2*Math.PI)}}D.fill()})(t,e,c,i,d)}}class cf extends lw{Gg(t,e){return e.vt}}class cw extends Ma{constructor(){super(...arguments),this.hg=new cf}jg(t,e,i){return{...this.Yg(t,e),...i.Dr(t)}}cg(){const t=this.Jn.N(),e={ot:this.sg,Xt:t.lineStyle,Xg:t.lineVisible?t.lineType:void 0,ct:t.lineWidth,Zg:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0,lt:this.ng,Kg:this.Qn.Et().vu()};this.hg.ht(e)}}const Vo={type:"Line",isBuiltIn:!0,defaultOptions:{color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Fg:(r,t)=>new cw(r,t)};function uw(r,t,e,i,s){const{context:n,horizontalPixelRatio:h,verticalPixelRatio:l}=t;n.lineTo(s._t*h,r*l),n.lineTo(i._t*h,r*l),n.closePath(),n.fillStyle=e,n.fill()}class dw extends Ee{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et(t){if(this.rt===null)return;const{ot:e,lt:i,Kg:s,ct:n,Xt:h,Xg:l}=this.rt,c=this.rt.eM??(this.rt.rM?0:t.mediaSize.height);if(i===null)return;const u=t.context;u.lineCap="butt",u.lineJoin="round",u.lineWidth=n,$i(u,h),u.lineWidth=1,lf(t,e,l,i,s,this.hM.bind(this),uw.bind(null,c))}}class fw{aM(t,e){const i=this.lM,{oM:s,_M:n,uM:h,cM:l,eM:c,dM:u,fM:d}=e;if(this.pM===void 0||i===void 0||i.oM!==s||i._M!==n||i.uM!==h||i.cM!==l||i.eM!==c||i.dM!==u||i.fM!==d){const{verticalPixelRatio:p}=t,m=c||u>0?p:1,v=u*m,b=d===t.bitmapSize.height?d:d*m,M=(c??0)*m,I=t.context.createLinearGradient(0,v,0,b);if(I.addColorStop(0,s),c!=null){const k=es((M-v)/(b-v),0,1);I.addColorStop(k,n),I.addColorStop(k,h)}I.addColorStop(1,l),this.pM=I,this.lM=e}return this.pM}}class pw extends dw{constructor(){super(...arguments),this.vM=new fw}hM(t,e){var i;return this.vM.aM(t,{oM:e.mr,_M:"",uM:"",cM:e.wr,dM:((i=this.rt)==null?void 0:i.dM)??0,fM:t.bitmapSize.height})}}class mw extends Ma{constructor(t,e){super(t,e),this.hg=new Hd,this.MM=new pw,this.bM=new cf,this.hg.st([this.MM,this.bM])}jg(t,e,i){return{...this.Yg(t,e),...i.Dr(t)}}cg(){const t=this.Jn.N();if(this.ng===null||this.sg.length===0)return;let e;if(t.relativeGradient){e=this.sg[this.ng.from].ut;for(let i=this.ng.from;i<this.ng.to;i++){const s=this.sg[i];s.ut<e&&(e=s.ut)}}this.MM.ht({Xg:t.lineType,ot:this.sg,Xt:t.lineStyle,ct:t.lineWidth,eM:null,dM:e,rM:t.invertFilledArea,lt:this.ng,Kg:this.Qn.Et().vu()}),this.bM.ht({Xg:t.lineVisible?t.lineType:void 0,ot:this.sg,Xt:t.lineStyle,ct:t.lineWidth,lt:this.ng,Kg:this.Qn.Et().vu(),Zg:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0})}}const gw={type:"Area",isBuiltIn:!0,defaultOptions:{topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,relativeGradient:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Fg:(r,t)=>new mw(r,t)};class vw extends ya{constructor(t,e){super(t,e,!1)}ug(t,e,i){e._u(this.sg,kn(this.ng)),t.Yl(this.sg,i,kn(this.ng))}yM(t,e,i){return{wt:t,qh:e.Wt[0],Yh:e.Wt[1],jh:e.Wt[2],Kh:e.Wt[3],_t:NaN,jl:NaN,Kl:NaN,Xl:NaN,Zl:NaN}}og(){const t=this.Jn.Rh();this.sg=this.Jn.Xs().Hr().map((e=>this.jg(e.Re,e,t)))}}class bw extends Ee{constructor(){super(...arguments),this.Yt=null,this.SM=0}ht(t){this.Yt=t}et(t){if(this.Yt===null||this.Yt.Xs.length===0||this.Yt.lt===null)return;const{horizontalPixelRatio:e}=t;this.SM=(function(n,h){if(n>=2.5&&n<=4)return Math.floor(3*h);const l=1-.2*Math.atan(Math.max(4,n)-4)/(.5*Math.PI),c=Math.floor(n*l*h),u=Math.floor(n*h),d=Math.min(c,u);return Math.max(Math.floor(h),d)})(this.Yt.vu,e),this.SM>=2&&Math.floor(e)%2!=this.SM%2&&this.SM--;const i=this.Yt.Xs;this.Yt.TM&&this.RM(t,i,this.Yt.lt),this.Yt.Mi&&this._v(t,i,this.Yt.lt);const s=this.DM(e);(!this.Yt.Mi||this.SM>2*s)&&this.VM(t,i,this.Yt.lt)}RM(t,e,i){if(this.Yt===null)return;const{context:s,horizontalPixelRatio:n,verticalPixelRatio:h}=t;let l="",c=Math.min(Math.floor(n),Math.floor(this.Yt.vu*n));c=Math.max(Math.floor(n),Math.min(c,this.SM));const u=Math.floor(.5*c);let d=null;for(let p=i.from;p<i.to;p++){const m=e[p];m.pr!==l&&(s.fillStyle=m.pr,l=m.pr);const v=Math.round(Math.min(m.jl,m.Zl)*h),b=Math.round(Math.max(m.jl,m.Zl)*h),M=Math.round(m.Kl*h),I=Math.round(m.Xl*h);let k=Math.round(n*m._t)-u;const D=k+c-1;d!==null&&(k=Math.max(d+1,k),k=Math.min(k,D));const X=D-k+1;s.fillRect(k,M,X,v-M),s.fillRect(k,b+1,X,I-b),d=D}}DM(t){let e=Math.floor(1*t);this.SM<=2*e&&(e=Math.floor(.5*(this.SM-1)));const i=Math.max(Math.floor(t),e);return this.SM<=2*i?Math.max(Math.floor(t),Math.floor(1*t)):i}_v(t,e,i){if(this.Yt===null)return;const{context:s,horizontalPixelRatio:n,verticalPixelRatio:h}=t;let l="";const c=this.DM(n);let u=null;for(let d=i.from;d<i.to;d++){const p=e[d];p.dr!==l&&(s.fillStyle=p.dr,l=p.dr);let m=Math.round(p._t*n)-Math.floor(.5*this.SM);const v=m+this.SM-1,b=Math.round(Math.min(p.jl,p.Zl)*h),M=Math.round(Math.max(p.jl,p.Zl)*h);if(u!==null&&(m=Math.max(u+1,m),m=Math.min(m,v)),this.Yt.vu*n>2*c)w1(s,m,b,v-m+1,M-b+1,c);else{const I=v-m+1;s.fillRect(m,b,I,M-b+1)}u=v}}VM(t,e,i){if(this.Yt===null)return;const{context:s,horizontalPixelRatio:n,verticalPixelRatio:h}=t;let l="";const c=this.DM(n);for(let u=i.from;u<i.to;u++){const d=e[u];let p=Math.round(Math.min(d.jl,d.Zl)*h),m=Math.round(Math.max(d.jl,d.Zl)*h),v=Math.round(d._t*n)-Math.floor(.5*this.SM),b=v+this.SM-1;if(d.cr!==l){const M=d.cr;s.fillStyle=M,l=M}this.Yt.Mi&&(v+=c,p+=c,b-=c,m-=c),p>m||s.fillRect(v,p,b-v+1,m-p+1)}}}class ww extends vw{constructor(){super(...arguments),this.hg=new bw}jg(t,e,i){return{...this.yM(t,e,i),...i.Dr(t)}}cg(){const t=this.Jn.N();this.hg.ht({Xs:this.sg,vu:this.Qn.Et().vu(),TM:t.wickVisible,Mi:t.borderVisible,lt:this.ng})}}const _w={type:"Candlestick",isBuiltIn:!0,defaultOptions:{upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Fg:(r,t)=>new ww(r,t)};class yw extends Ee{constructor(){super(...arguments),this.Yt=null,this.IM=[]}ht(t){this.Yt=t,this.IM=[]}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.Yt===null||this.Yt.ot.length===0||this.Yt.lt===null)return;this.IM.length||this.BM(e);const s=Math.max(1,Math.floor(i)),n=Math.round(this.Yt.EM*i)-Math.floor(s/2),h=n+s;for(let l=this.Yt.lt.from;l<this.Yt.lt.to;l++){const c=this.Yt.ot[l],u=this.IM[l-this.Yt.lt.from],d=Math.round(c.ut*i);let p,m;t.fillStyle=c.cr,d<=n?(p=d,m=h):(p=n,m=d-Math.floor(s/2)+s),t.fillRect(u.Uh,p,u.bi-u.Uh+1,m-p)}}BM(t){if(this.Yt===null||this.Yt.ot.length===0||this.Yt.lt===null)return void(this.IM=[]);const e=Math.ceil(this.Yt.vu*t)<=1?0:Math.max(1,Math.floor(t)),i=Math.round(this.Yt.vu*t)-e;this.IM=new Array(this.Yt.lt.to-this.Yt.lt.from);for(let n=this.Yt.lt.from;n<this.Yt.lt.to;n++){const h=this.Yt.ot[n],l=Math.round(h._t*t);let c,u;if(i%2){const d=(i-1)/2;c=l-d,u=l+d}else{const d=i/2;c=l-d,u=l+d-1}this.IM[n-this.Yt.lt.from]={Uh:c,bi:u,AM:l,ne:h._t*t,wt:h.wt}}for(let n=this.Yt.lt.from+1;n<this.Yt.lt.to;n++){const h=this.IM[n-this.Yt.lt.from],l=this.IM[n-this.Yt.lt.from-1];h.wt===l.wt+1&&h.Uh-l.bi!==e+1&&(l.AM>l.ne?l.bi=h.Uh-e-1:h.Uh=l.bi+e+1)}let s=Math.ceil(this.Yt.vu*t);for(let n=this.Yt.lt.from;n<this.Yt.lt.to;n++){const h=this.IM[n-this.Yt.lt.from];h.bi<h.Uh&&(h.bi=h.Uh);const l=h.bi-h.Uh+1;s=Math.min(l,s)}if(e>0&&s<4)for(let n=this.Yt.lt.from;n<this.Yt.lt.to;n++){const h=this.IM[n-this.Yt.lt.from];h.bi-h.Uh+1>s&&(h.AM>h.ne?h.bi-=1:h.Uh+=1)}}}class Ew extends Ma{constructor(){super(...arguments),this.hg=new yw}jg(t,e,i){return{...this.Yg(t,e),...i.Dr(t)}}cg(){const t={ot:this.sg,vu:this.Qn.Et().vu(),lt:this.ng,EM:this.Jn.Ft().Nt(this.Jn.N().base,E(this.Jn.zt()).Wt)};this.hg.ht(t)}}const Mw={type:"Histogram",isBuiltIn:!0,defaultOptions:{color:"#26a69a",base:0},Fg:(r,t)=>new Ew(r,t)};class Cw{constructor(t,e){this.Jn=t,this.ah=e,this.LM()}detach(){this.Jn.detachPrimitive(this.ah)}getSeries(){return this.Jn}applyOptions(t){this.ah&&this.ah.hr&&this.ah.hr(t)}LM(){this.Jn.attachPrimitive(this.ah)}}const xw={zOrder:"normal"};function En(r,t){return va(Math.min(Math.max(r,12),30)*t)}function Fs(r,t){switch(r){case"arrowDown":case"arrowUp":return En(t,1);case"circle":return En(t,.8);case"square":return En(t,.7)}}function uf(r){return(function(t){const e=Math.ceil(t);return e%2!=0?e-1:e})(En(r,1))}function df(r){return Math.max(En(r,.1),3)}function Nl(r,t,e){return t?r:e?Math.ceil(r/2):0}function Il(r,t,e,i){const s=(Fs("arrowUp",i)-1)/2*e.hb,n=(va(i/2)-1)/2*e.hb;t.beginPath(),r?(t.moveTo(e._t-s,e.ut),t.lineTo(e._t,e.ut-s),t.lineTo(e._t+s,e.ut),t.lineTo(e._t+n,e.ut),t.lineTo(e._t+n,e.ut+s),t.lineTo(e._t-n,e.ut+s),t.lineTo(e._t-n,e.ut)):(t.moveTo(e._t-s,e.ut),t.lineTo(e._t,e.ut+s),t.lineTo(e._t+s,e.ut),t.lineTo(e._t+n,e.ut),t.lineTo(e._t+n,e.ut-s),t.lineTo(e._t-n,e.ut-s),t.lineTo(e._t-n,e.ut)),t.fill()}function Ol(r,t,e,i,s,n){const h=(Fs("arrowUp",i)-1)/2,l=(va(i/2)-1)/2;return s>=t-l-2&&s<=t+l+2&&n>=(r?e:e-h)-2&&n<=(r?e+h:e)+2?!0:(()=>{if(s<t-h-3||s>t+h+3||n<(r?e-h-3:e)||n>(r?e:e+h+3))return!1;const c=Math.abs(s-t);return Math.abs(n-e)+3>=c/2})()}class Tw{constructor(){this.Yt=null,this.On=new Rn,this.F=-1,this.W="",this.Fp="",this.ab="normal"}ht(t){this.Yt=t}Nn(t,e,i){this.F===t&&this.W===e||(this.F=t,this.W=e,this.Fp=An(t,e),this.On.In()),this.ab=i}jn(t,e){if(this.Yt===null||this.Yt.lt===null)return null;for(let i=this.Yt.lt.from;i<this.Yt.lt.to;i++){const s=this.Yt.ot[i];if(s&&Nw(s,t,e))return{zOrder:"normal",externalId:s.Kn??""}}return null}draw(t){this.ab!=="aboveSeries"&&t.useBitmapCoordinateSpace((e=>{this.et(e)}))}drawBackground(t){this.ab==="aboveSeries"&&t.useBitmapCoordinateSpace((e=>{this.et(e)}))}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.Yt!==null&&this.Yt.lt!==null){t.textBaseline="middle",t.font=this.Fp;for(let s=this.Yt.lt.from;s<this.Yt.lt.to;s++){const n=this.Yt.ot[s];n.ri!==void 0&&(n.ri.Qi=this.On.Vi(t,n.ri.lb),n.ri.$t=this.F,n.ri._t=n._t-n.ri.Qi/2),Sw(n,t,e,i)}}}}function Sw(r,t,e,i){t.fillStyle=r.R,r.ri!==void 0&&(function(s,n,h,l,c,u){s.save(),s.scale(c,u),s.fillText(n,h,l),s.restore()})(t,r.ri.lb,r.ri._t,r.ri.ut,e,i),(function(s,n,h){if(s.zr!==0){switch(s.ob){case"arrowDown":return void Il(!1,n,h,s.zr);case"arrowUp":return void Il(!0,n,h,s.zr);case"circle":return void(function(l,c,u){const d=(Fs("circle",u)-1)/2;l.beginPath(),l.arc(c._t,c.ut,d*c.hb,0,2*Math.PI,!1),l.fill()})(n,h,s.zr);case"square":return void(function(l,c,u){const d=Fs("square",u),p=(d-1)*c.hb/2,m=c._t-p,v=c.ut-p;l.fillRect(m,v,d*c.hb,d*c.hb)})(n,h,s.zr)}s.ob}})(r,t,(function(s,n,h){const l=Math.max(1,Math.floor(n))%2/2;return{_t:Math.round(s._t*n)+l,ut:s.ut*h,hb:n}})(r,e,i))}function Nw(r,t,e){return!(r.ri===void 0||!(function(i,s,n,h,l,c){const u=h/2;return l>=i&&l<=i+n&&c>=s-u&&c<=s+u})(r.ri._t,r.ri.ut,r.ri.Qi,r.ri.$t,t,e))||(function(i,s,n){if(i.zr===0)return!1;switch(i.ob){case"arrowDown":return Ol(!0,i._t,i.ut,i.zr,s,n);case"arrowUp":return Ol(!1,i._t,i.ut,i.zr,s,n);case"circle":return(function(h,l,c,u,d){const p=2+Fs("circle",c)/2,m=h-u,v=l-d;return Math.sqrt(m*m+v*v)<=p})(i._t,i.ut,i.zr,s,n);case"square":return(function(h,l,c,u,d){const p=Fs("square",c),m=(p-1)/2,v=h-m,b=l-m;return u>=v&&u<=v+p&&d>=b&&d<=b+p})(i._t,i.ut,i.zr,s,n)}})(r,t,e)}function Pl(r){return r==="atPriceTop"||r==="atPriceBottom"||r==="atPriceMiddle"}function Iw(r,t,e,i,s,n,h,l){const c=(function(b,M){if(Pl(M.position)&&M.price!==void 0)return M.price;if("value"in(I=b)&&typeof I.value=="number")return b.value;var I;if((function(k){return"open"in k&&"high"in k&&"low"in k&&"close"in k})(b)){if(M.position==="inBar")return b.close;if(M.position==="aboveBar")return b.high;if(M.position==="belowBar")return b.low}})(e,t);if(c===void 0)return;const u=Pl(t.position),d=l.timeScale(),p=zi(t.size)?Math.max(t.size,0):1,m=uf(d.options().barSpacing)*p,v=m/2;switch(r.zr=m,t.position){case"inBar":case"atPriceMiddle":return r.ut=E(h.priceToCoordinate(c)),void(r.ri!==void 0&&(r.ri.ut=r.ut+v+n+.6*s));case"aboveBar":case"atPriceTop":{const b=u?0:i._b;return r.ut=E(h.priceToCoordinate(c))-v-b,r.ri!==void 0&&(r.ri.ut=r.ut-v-.6*s,i._b+=1.2*s),void(u||(i._b+=m+n))}case"belowBar":case"atPriceBottom":{const b=u?0:i.ub;return r.ut=E(h.priceToCoordinate(c))+v+b,r.ri!==void 0&&(r.ri.ut=r.ut+v+n+.6*s,i.ub+=1.2*s),void(u||(i.ub+=m+n))}}}class Ow{constructor(t,e,i){this.cb=[],this.xt=!0,this.fb=!0,this.Gt=new Tw,this.ge=t,this.Dp=e,this.Yt={ot:[],lt:null},this.Ps=i}renderer(){if(!this.ge.options().visible)return null;this.xt&&this.pb();const t=this.Dp.options().layout;return this.Gt.Nn(t.fontSize,t.fontFamily,this.Ps.zOrder),this.Gt.ht(this.Yt),this.Gt}mb(t){this.cb=t,this.kt("data")}kt(t){this.xt=!0,t==="data"&&(this.fb=!0)}wb(t){this.xt=!0,this.Ps=t}zOrder(){return this.Ps.zOrder==="aboveSeries"?"top":this.Ps.zOrder}pb(){const t=this.Dp.timeScale(),e=this.cb;this.fb&&(this.Yt.ot=e.map((u=>({wt:u.time,_t:0,ut:0,zr:0,ob:u.shape,R:u.color,Kn:u.id,gb:u.gb,ri:void 0}))),this.fb=!1);const i=this.Dp.options().layout;this.Yt.lt=null;const s=t.getVisibleLogicalRange();if(s===null)return;const n=new is(Math.floor(s.from),Math.ceil(s.to));if(this.ge.data()[0]===null||this.Yt.ot.length===0)return;let h=NaN;const l=df(t.options().barSpacing),c={_b:l,ub:l};this.Yt.lt=rf(this.Yt.ot,n,!0);for(let u=this.Yt.lt.from;u<this.Yt.lt.to;u++){const d=e[u];d.time!==h&&(c._b=l,c.ub=l,h=d.time);const p=this.Yt.ot[u];p._t=E(t.logicalToCoordinate(d.time)),d.text!==void 0&&d.text.length>0&&(p.ri={lb:d.text,_t:0,ut:0,Qi:0,$t:0});const m=this.ge.dataByIndex(d.time,0);m!==null&&Iw(p,d,m,c,i.fontSize,l,this.ge,this.Dp)}this.xt=!1}}function kl(r){return{...xw,...r}}class Pw{constructor(t){this.sh=null,this.cb=[],this.Mb=[],this.bb=null,this.ge=null,this.Dp=null,this.Sb=!0,this.xb=null,this.Cb=null,this.Pb=null,this.kb=!0,this.Ps=kl(t)}attached(t){this.yb(),this.Dp=t.chart,this.ge=t.series,this.sh=new Ow(this.ge,E(this.Dp),this.Ps),this.eb=t.requestUpdate,this.ge.subscribeDataChanged((e=>this.Pg(e))),this.kb=!0,this.UM()}UM(){this.eb&&this.eb()}detached(){this.ge&&this.bb&&this.ge.unsubscribeDataChanged(this.bb),this.Dp=null,this.ge=null,this.sh=null,this.bb=null}mb(t){this.kb=!0,this.cb=t,this.yb(),this.Sb=!0,this.Cb=null,this.UM()}Tb(){return this.cb}paneViews(){return this.sh?[this.sh]:[]}updateAllViews(){this.Rb()}hitTest(t,e){var i;return this.sh?((i=this.sh.renderer())==null?void 0:i.jn(t,e))??null:null}autoscaleInfo(t,e){if(this.sh){const i=this.Db();if(i)return{priceRange:null,margins:i}}return null}hr(t){this.Ps=kl({...this.Ps,...t}),this.UM&&this.UM()}Db(){const t=E(this.Dp).timeScale().options().barSpacing;if(this.Sb||t!==this.Pb){if(this.Pb=t,this.cb.length>0){const e=df(t),i=1.5*uf(t)+2*e,s=this.Vb();this.xb={above:Nl(i,s.aboveBar,s.inBar),below:Nl(i,s.belowBar,s.inBar)}}else this.xb=null;this.Sb=!1}return this.xb}Vb(){return this.Cb===null&&(this.Cb=this.cb.reduce(((t,e)=>(t[e.position]||(t[e.position]=!0),t)),{inBar:!1,aboveBar:!1,belowBar:!1,atPriceTop:!1,atPriceBottom:!1,atPriceMiddle:!1})),this.Cb}yb(){var s;if(!this.kb||!this.Dp||!this.ge)return;const t=this.Dp.timeScale(),e=(s=this.ge)==null?void 0:s.data();if(t.getVisibleLogicalRange()==null||!this.ge||e.length===0)return void(this.Mb=[]);const i=t.timeToIndex(E(e[0].time),!0);this.Mb=this.cb.map(((n,h)=>{const l=t.timeToIndex(n.time,!0),c=l<i?1:-1,u=E(this.ge).dataByIndex(l,c),d={time:t.timeToIndex(E(u).time,!1),position:n.position,shape:n.shape,color:n.color,id:n.id,gb:h,text:n.text,size:n.size,price:n.price,Pw:n.time};if(n.position==="atPriceTop"||n.position==="atPriceBottom"||n.position==="atPriceMiddle"){if(n.price===void 0)throw new Error(`Price is required for position ${n.position}`);return{...d,position:n.position,price:n.price}}return{...d,position:n.position,price:n.price}})),this.kb=!1}Rb(t){this.sh&&(this.yb(),this.sh.mb(this.Mb),this.sh.wb(this.Ps),this.sh.kt(t))}Pg(t){this.kb=!0,this.UM()}}class kw extends Cw{constructor(t,e,i){super(t,e),i&&this.setMarkers(i)}setMarkers(t){this.ah.mb(t)}markers(){return this.ah.Tb()}}function Aw(r,t,e){const i=new kw(r,new Pw({}));return t&&i.setMarkers(t),i}({...Fd});const Rw="_icon_4o1gt_29",Lw={"no-data":"_no-data_4o1gt_1",icon:Rw},Dw=`<div class="no-data">\r
	<div class="icon">\r
		<svg\r
			height="800px"\r
			width="800px"\r
			version="1.1"\r
			id="Layer_1"\r
			xmlns="http://www.w3.org/2000/svg"\r
			xmlns:xlink="http://www.w3.org/1999/xlink"\r
			viewBox="0 0 512 512"\r
			xml:space="preserve"\r
		>\r
			<path\r
				style="fill: #57c3d9"\r
				d="M456.344,511.991c-5.152,0-10.141-2.391-13.359-6.679l-36.728-48.972l-36.728,48.972\r
	c-6.304,8.413-20.413,8.413-26.717,0l-36.728-48.972l-36.728,48.972c-6.304,8.413-20.413,8.413-26.717,0l-36.728-48.972\r
	l-36.728,48.972c-6.304,8.413-20.413,8.413-26.717,0l-36.728-48.972l-36.728,48.972c-4.315,5.755-11.815,8.114-18.641,5.82\r
	c-6.815-2.272-11.413-8.652-11.413-15.837V217.04C38.96,97.363,136.328,0,256,0s217.04,97.363,217.04,217.04v278.256\r
	c0,7.185-4.598,13.566-11.413,15.837C459.888,511.714,458.105,511.991,456.344,511.991z"\r
			/>\r
			<path\r
				style="fill: #3db1cc"\r
				d="M269.358,505.312l36.728-48.972l36.728,48.972c6.304,8.413,20.413,8.413,26.717,0l36.728-48.972\r
	l36.728,48.972c3.218,4.288,8.206,6.679,13.359,6.679c1.761,0,3.544-0.277,5.282-0.858c6.815-2.272,11.413-8.652,11.413-15.837\r
	V217.04C473.04,97.363,375.672,0,256,0v511.622C261.103,511.622,266.206,509.518,269.358,505.312z"\r
			/>\r
			<path\r
				style="fill: #edf0f2"\r
				d="M172.523,300.517c-36.826,0-66.781-29.956-66.781-66.781s29.956-66.781,66.781-66.781\r
	s66.781,29.956,66.781,66.781S209.349,300.517,172.523,300.517z"\r
			/>\r
			<path\r
				style="fill: #dae1e6"\r
				d="M339.477,300.517c-36.826,0-66.781-29.956-66.781-66.781s29.956-66.781,66.781-66.781\r
	s66.781,29.956,66.781,66.781S376.302,300.517,339.477,300.517z"\r
			/>\r
			<circle style="fill: #736056" cx="189.214" cy="250.43" r="16.695" />\r
			<circle style="fill: #665247" cx="356.168" cy="250.43" r="16.695" />\r
		</svg>\r
	</div>\r
	<p>No data available</p>\r
</div>\r
`;var Es;class Ca extends O{constructor(){super(...arguments);f(this,Es,null)}render(){return this.element=P.htmlToElement(Dw,[],Lw),g(this,Es,C(this.element)),this.element}show(){o(this,Es).css("display","flex")}hide(){o(this,Es).css("display","none")}}Es=new WeakMap,N(Ca,"COMPONENT_NAME","NoData");const $w="_spinner_l25u5_1",zw="_rotate_l25u5_1",Bw="_background_l25u5_35",Fw="_path_l25u5_47",Vw={spinner:$w,rotate:zw,background:Bw,path:Fw},Yw=`<div class="spinner">\r
	<svg viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">\r
		<circle\r
			class="background"\r
			cx="25"\r
			cy="25"\r
			r="20"\r
			fill="none"\r
			stroke-width="4"\r
		/>\r
		<circle\r
			class="path"\r
			cx="25"\r
			cy="25"\r
			r="20"\r
			fill="none"\r
			stroke="currentColor"\r
			stroke-width="4"\r
			stroke-linecap="round"\r
		/>\r
	</svg>\r
</div>\r
`;var Ms;class xa extends O{constructor(){super(...arguments);f(this,Ms,null)}render(){return this.element=P.htmlToElement(Yw,[],Vw),g(this,Ms,C(this.element)),this.element}show(){o(this,Ms).css("display","flex")}hide(){o(this,Ms).css("display","none")}}Ms=new WeakMap,N(xa,"COMPONENT_NAME","Spinner");function q(r){return getComputedStyle(document.documentElement).getPropertyValue(r).trim()||null}const Yo=()=>({autoSize:!0,layout:{background:{type:"solid",color:q("--color-bg-primary")||"#ffffff"},textColor:q("--color-text-primary")||"#292121",fontFamily:"system-ui, sans-serif",panes:{separatorColor:q("--color-border-secondary")||"#e0e3eb",separatorHoverColor:q("--color-chart-separator-hover")||"rgb(224 227 235 / 20%)"},attributionLogo:!1},rightPriceScale:{scaleMargins:{top:.1,bottom:.05},borderVisible:!1,entireTextOnly:!0},crosshair:{mode:0,vertLine:{color:q("--color-chart-crosshair-line")||"#a5a5a5",style:3,labelBackgroundColor:q("--color-chart-crosshair-label")||"#2e2e2e"},horzLine:{color:q("--color-chart-crosshair-line")||"#a5a5a5",style:3,labelBackgroundColor:q("--color-chart-crosshair-label")||"#2e2e2e"}},grid:{vertLines:{color:q("--color-chart-grid")||"#edf0ee"},horzLines:{color:q("--color-chart-grid")||"#edf0ee"}},timeScale:{rightOffset:10,barSpacing:6,minBarSpacing:2,borderVisible:!1,rightBarStaysOnScroll:!0,tickMarkFormatter:r=>{const t=new Date(r*1e3),e=t.getUTCDate(),i=t.getUTCMonth(),s=t.getUTCFullYear(),n=t.getUTCHours(),h=t.getUTCMinutes();if(i===0&&e===1&&n===0&&h===0)return String(s);if(e===1&&n===0&&h===0)return t.toLocaleString("en-US",{month:"short"});if(n===0&&h===0)return String(e);const l=String(n).padStart(2,"0"),c=String(h).padStart(2,"0");return`${l}:${c}`}},localization:{timeFormatter:r=>{const t=new Date(r*1e3),e=t.toLocaleString("en-US",{weekday:"short"}),i=String(t.getUTCDate()).padStart(2,"0"),s=t.toLocaleString("en-US",{month:"short"}),n=t.toLocaleString("ru-RU",{year:"2-digit"}),h=String(t.getUTCHours()).padStart(2,"0"),l=String(t.getUTCMinutes()).padStart(2,"0");return`${e} ${i} ${s} ${n}  ${h}:${l}`}}}),Hw=()=>({borderVisible:!1,upColor:q("--color-chart-up")||"#008984",downColor:q("--color-chart-down")||"#f23645",wickUpColor:q("--color-chart-up")||"#008984",wickDownColor:q("--color-chart-down")||"#f23645"}),Uw=()=>({lastValueVisible:!1,priceLineVisible:!1,color:q("--color-chart-line")||"#3b6cb7",lineWidth:2,crosshairMarkerVisible:!1}),Rr=1e3,Al=50,ff=1e3,pf={lastValueVisible:!1,priceLineVisible:!1,lineWidth:3,crosshairMarkerVisible:!1};class Xw extends js{async getKlines(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/chart/klines/${t}`,method:"GET",errorMessage:"Failed to load candlestick data"})}async getIndicators(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/chart/indicators/${t}`,method:"GET",errorMessage:"Failed to load indicator data"})}async getDeals(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/chart/deals/${t}`,method:"GET",errorMessage:"Failed to load deal markers"})}}const Vh=new Xw,Ww={"chart-panel":"_chart-panel_1t7il_1","chart-canvas":"_chart-canvas_1t7il_25"},qw=`<div class="chart-panel" data-ref="chartPanel">\r
	<component-spinner></component-spinner>\r
	<component-no-data></component-no-data>\r
	<component-ruler-tool></component-ruler-tool>\r
	<component-scroll-button></component-scroll-button>\r
	<component-main-info-panel></component-main-info-panel>\r
	<div class="chart-canvas" data-ref="chartCanvas"></div>\r
</div>\r
`,Gw="_primary_3cyuk_27",jw="_secondary_3cyuk_35",Yh={"indicators-info-panel":"_indicators-info-panel_3cyuk_1",primary:Gw,secondary:jw},Zw=`<div class="indicators-info-panel"></div>\r
`;var Ve,Cs,Ws,gf,vf;class mf extends O{constructor(){super(...arguments);f(this,Ws);f(this,Ve,null);f(this,Cs,new Map)}render(e){return this.element=P.htmlToElement(Zw,[],Yh),g(this,Ve,C(this.element)),e?o(this,Ve).addClass(Yh.primary):o(this,Ve).addClass(Yh.secondary),this.element}update(e,i=!1,s=null){if(i){if(!s)throw new Error("Indicator keys must be provided when withRender is true");o(this,Cs).clear(),a(this,Ws,gf).call(this,s)}o(this,Cs).forEach((n,h)=>{const l=e[h];if(!l)return;let{value:c,color:u}=l;u==="transparent"&&(c="∅",u="inherit");const d=n.text(),p=n.css("color");d!==String(c)&&n.text(c),p!==u&&n.css("color",u)})}remove(){this.element.remove()}}Ve=new WeakMap,Cs=new WeakMap,Ws=new WeakSet,gf=function(e){const i=a(this,Ws,vf).call(this,e);o(this,Ve).html(i),o(this,Ve).findAll("[data-field]").forEach(s=>{const n=s.data("field");o(this,Cs).set(n,s)})},vf=function(e){return e.map(i=>`
					<div>
						<span>${i}</span>
						<span data-field="${i}"></span>
					</div>
				`).join("")},N(mf,"COMPONENT_NAME","IndicatorsInfoPanel");const Qw="_meta_13vbf_29",Kw="_candlestick_13vbf_37",Jw="_red_13vbf_47",t_="_green_13vbf_55",en={"main-info-panel":"_main-info-panel_13vbf_1",meta:Qw,candlestick:Kw,red:Jw,green:t_},e_=`<div class="main-info-panel">\r
	<div class="meta" data-ref="meta">\r
		<span data-field="symbol"></span> • <span data-field="interval"></span> •\r
		<span data-field="exchange"></span>\r
	</div>\r
	<div class="candlestick" data-ref="candlestick">\r
		<div>O <span data-field="open"></span></div>\r
		<div>H <span data-field="high"></span></div>\r
		<div>L <span data-field="low"></span></div>\r
		<div>C <span data-field="close"></span></div>\r
	</div>\r
</div>\r
`;var xs,sr,nr,ne,wf,_f,yf,Ef;class bf extends O{constructor(){super(...arguments);f(this,ne);f(this,xs,null);f(this,sr,new Map);f(this,nr,new Map)}render(){return a(this,ne,wf).call(this),a(this,ne,_f).call(this),this.element}update(e,i=!1){e&&(i&&a(this,ne,yf).call(this),a(this,ne,Ef).call(this,e))}}xs=new WeakMap,sr=new WeakMap,nr=new WeakMap,ne=new WeakSet,wf=function(){this.element=P.htmlToElement(e_,[],en),g(this,xs,C(this.element))},_f=function(){const e=o(this,xs).find('[data-ref="meta"]').findAll("[data-field]"),i=o(this,xs).find('[data-ref="candlestick"]').findAll("[data-field]");e.forEach(s=>{const n=s.data("field");o(this,sr).set(n,s)}),i.forEach(s=>{const n=s.data("field");o(this,nr).set(n,s)})},yf=function(){const e=w.get(_.EXECUTION_CONTEXT);o(this,sr).forEach((i,s)=>{i.text(e[s])})},Ef=function(e){const i=e.close>=e.open,s=i?en.green:en.red,n=i?en.red:en.green;o(this,nr).forEach((h,l)=>{const c=h.text(),u=e[l];c!==String(u)&&h.text(u),h.hasClass(s)||h.addClass(s).removeClass(n)})},N(bf,"COMPONENT_NAME","MainInfoPanel");const i_="_info_156i3_25",s_="_arrow_156i3_95",n_={"ruler-tool":"_ruler-tool_156i3_1",info:i_,"price-diff":"_price-diff_156i3_59","line-x":"_line-x_156i3_71","line-y":"_line-y_156i3_73","arrow-right":"_arrow-right_156i3_95","arrow-left":"_arrow-left_156i3_111","arrow-up":"_arrow-up_156i3_157","arrow-down":"_arrow-down_156i3_173",arrow:s_},r_=`<div\r
	class="ruler-tool"\r
	data-ref="rulerTool"\r
	data-active="false"\r
	data-trend="up"\r
>\r
	<div class="info">\r
		<div class="price-diff">\r
			<span data-field="price-abs"></span>\r
			<span data-field="price-pct"></span>\r
			<span data-field="price-ticks"></span>\r
		</div>\r
		<span data-field="bar-distance"></span>\r
	</div>\r
	<div class="line-x" data-ref="lineX" data-direction="right">\r
		<div class="arrow arrow-right"></div>\r
		<div class="arrow arrow-left"></div>\r
	</div>\r
	<div class="line-y" data-ref="lineY" data-direction="up">\r
		<div class="arrow arrow-up"></div>\r
		<div class="arrow arrow-down"></div>\r
	</div>\r
</div>\r
`;var K,ve,yi,Ts,Ss,ut,Ns,rr,hr,L,vn,Cf,xf,Tf,Sf,Nf,If,Ho,Of,Pf,kf,Af,Uo,Xo,Wo,qo;class Mf extends O{constructor(){super(...arguments);f(this,L);f(this,K,null);f(this,ve,null);f(this,yi,null);f(this,Ts,null);f(this,Ss,new Map);f(this,ut,{chartX:void 0,chartY:void 0,localX:void 0,localY:void 0});f(this,Ns,!1);f(this,rr);f(this,hr)}render(){return a(this,L,Cf).call(this),a(this,L,xf).call(this),this.element}update({logical:e,point:i,sourceEvent:s,candlestickSeries:n}){o(this,Ns)&&(a(this,L,kf).call(this,{localX:s.localX,localY:s.localY}),a(this,L,Af).call(this,{chartX:e,chartY:n.coordinateToPrice(i.y)}))}initialize(){o(this,L,vn)||a(this,L,Sf).call(this)}deactivate(){a(this,L,Nf).call(this),o(this,K).data("active","false"),g(this,Ns,!1)}}K=new WeakMap,ve=new WeakMap,yi=new WeakMap,Ts=new WeakMap,Ss=new WeakMap,ut=new WeakMap,Ns=new WeakMap,rr=new WeakMap,hr=new WeakMap,L=new WeakSet,vn=function(){return o(this,K).is("data-active")},Cf=function(){this.element=P.htmlToElement(r_,[],n_),g(this,K,C(this.element)),g(this,ve,o(this,K).find('[data-ref="lineX"]')),g(this,yi,o(this,K).find('[data-ref="lineY"]'))},xf=function(){g(this,Ts,a(this,L,If).bind(this)),o(this,K).findAll("[data-field]").forEach(e=>{const i=e.data("field");o(this,Ss).set(i,e)}),w.subscribe(_.EXECUTION_CONTEXT,a(this,L,Ho).bind(this))},Tf=function(){o(this,L,vn)||(o(this,K).data("active","true"),g(this,Ns,!0))},Sf=function(){const e=w.get(_.CHART_API);e&&e.subscribeClick(o(this,Ts))},Nf=function(){const e=w.get(_.CHART_API);e&&e.unsubscribeClick(o(this,Ts))},If=function({logical:e,point:i,sourceEvent:s}){if(o(this,L,vn)){a(this,L,Ho).call(this);return}const n=w.get(_.CANDLE_SERIES);n&&a(this,L,Of).call(this,{logical:e,point:i,sourceEvent:s,candlestickSeries:n})},Ho=function(){o(this,L,vn)&&w.set(_.RULER_ACTIVE,!1)},Of=function({logical:e,point:i,sourceEvent:s,candlestickSeries:n}){const{minMove:h,precision:l}=w.get(_.EXECUTION_CONTEXT);g(this,rr,h),g(this,hr,l),g(this,ut,{chartX:e,chartY:n.coordinateToPrice(i.y),localX:s.localX,localY:s.localY}),a(this,L,Pf).call(this),a(this,L,Tf).call(this)},Pf=function(){const e={"price-abs":a(this,L,Uo).call(this,o(this,ut).chartY),"price-pct":a(this,L,Xo).call(this,o(this,ut).chartY),"price-ticks":a(this,L,Wo).call(this,o(this,ut).chartY),"bar-distance":a(this,L,qo).call(this,o(this,ut).chartX)};o(this,Ss).forEach((i,s)=>{i.text(e[s])}),o(this,K).data("trend","up"),o(this,ve).data("direction","right"),o(this,yi).data("direction","up"),o(this,K).css("left",`${o(this,ut).localX}px`).css("top",`${o(this,ut).localY}px`).css("width","0px").css("height","0px")},kf=function({localX:e,localY:i}){const s=e-o(this,ut).localX,n=o(this,ut).localY-i;s>=0?(o(this,ve).data("direction")==="left"&&o(this,ve).data("direction","right"),o(this,K).css("width",`${s}px`)):(o(this,ve).data("direction")==="right"&&o(this,ve).data("direction","left"),o(this,K).css("left",`${e}px`).css("width",`${Math.abs(s)}px`)),n>=0?(o(this,K).data("trend")==="down"&&(o(this,K).data("trend","up"),o(this,yi).data("direction","up")),o(this,K).css("top",`${i}px`).css("height",`${n}px`)):(o(this,K).data("trend")==="up"&&(o(this,K).data("trend","down"),o(this,yi).data("direction","down")),o(this,K).css("height",`${Math.abs(n)}px`))},Af=function({chartX:e,chartY:i}){const s={"price-abs":a(this,L,Uo).call(this,i),"price-pct":a(this,L,Xo).call(this,i),"price-ticks":a(this,L,Wo).call(this,i),"bar-distance":a(this,L,qo).call(this,e)};o(this,Ss).forEach((n,h)=>{n.text(s[h])})},Uo=function(e){return(e-o(this,ut).chartY).toFixed(o(this,hr))},Xo=function(e){return`(${((e/o(this,ut).chartY-1)*100).toFixed(2)}%)`},Wo=function(e){return((e-o(this,ut).chartY)/o(this,rr)).toFixed(0)},qo=function(e){return`${(e-o(this,ut).chartX).toFixed(0)} bars`},N(Mf,"COMPONENT_NAME","RulerTool");const h_={"scroll-button":"_scroll-button_umc9l_1"},o_=`<button class="scroll-button">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 18 18"\r
		width="18"\r
		height="18"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M7.45 3.5 12.48 9l-5.03 5.49 1.1 1.01L14.52 9 8.55 2.49 7.45 3.5Z"\r
		></path>\r
		<path\r
			fill="currentColor"\r
			d="m3.93 5.99 2.58 3-2.58 3.02 1.14.98 3.42-4-3.42-3.98L3.93 6Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var or,Ke,Lf,Df,$f;class Rf extends O{constructor(){super(...arguments);f(this,Ke);f(this,or,null)}render(){return a(this,Ke,Lf).call(this),a(this,Ke,Df).call(this),this.element}}or=new WeakMap,Ke=new WeakSet,Lf=function(){this.element=P.htmlToElement(o_,[],h_),g(this,or,C(this.element))},Df=function(){o(this,or).on("click",a(this,Ke,$f).bind(this))},$f=function(){const e=w.get(_.CHART_API);if(!e)return;const i=Yo().timeScale.rightOffset;e.timeScale().scrollToPosition(i,!1)},N(Rf,"COMPONENT_NAME","ScrollButton");var Is,mt,tt,V,Zt,Qt,Os,y,zf,Bf,Ff,Vf,Yf,Hf,Uf,jo,Xf,Wf,Zo,Qo,qf,Gf,jf,Zf,Qf,Kf,Jf,tp,ep,ip,Yr,sp,np,rp,Ko,Jo,hp,op,ap,lp,ue,cp,up,dp,fp,pp,mp,gp,vp,Hr,bp,wp,_p,yp,Ep,Mp;const Sn=class Sn extends O{constructor(){super(...arguments);f(this,y);f(this,Is,null);f(this,mt,null);f(this,tt,{candlesticks:null,indicators:null,deals:null});f(this,V,{candlestick:null,indicators:new Map,deals:null});f(this,Zt,new Map);f(this,Qt,Rr);f(this,Os)}set height(e){o(this,Is).css("bottom",`${e}px`)}render(){return a(this,y,zf).call(this),a(this,y,Bf).call(this),a(this,y,Ff).call(this),this.element}};Is=new WeakMap,mt=new WeakMap,tt=new WeakMap,V=new WeakMap,Zt=new WeakMap,Qt=new WeakMap,Os=new WeakMap,y=new WeakSet,zf=function(){this.spinner=new xa,this.noData=new Ca,this.rulerTool=new Mf,this.ScrollButton=new Rf,this.mainInfoPanel=new bf},Bf=function(){this.element=P.htmlToElement(qw,[this.spinner,this.noData,this.rulerTool,this.ScrollButton,this.mainInfoPanel],Ww),g(this,Is,C(this.element))},Ff=function(){a(this,y,Vf).call(this),a(this,y,Yf).call(this),a(this,y,Hf).call(this),a(this,y,Uf).call(this)},Vf=function(){const e=o(this,Is).find('[data-ref="chartCanvas"]').element,i=Yo();g(this,mt,af(e,i))},Yf=function(){w.subscribe(_.EXECUTION_CONTEXT,a(this,y,jo).bind(this)),w.subscribe(_.THEME,a(this,y,Xf).bind(this)),w.subscribe(_.SELECTED_TIME,a(this,y,qf).bind(this)),o(this,mt).subscribeCrosshairMove(a(this,y,Gf).bind(this)),o(this,mt).timeScale().subscribeVisibleLogicalRangeChange(a(this,y,Kf).bind(this))},Hf=function(){w.set(_.RULER_TOOL,this.rulerTool),w.set(_.CHART_API,o(this,mt)),w.set(_.CANDLE_SERIES,null)},Uf=function(){const e=w.get(_.EXECUTION_CONTEXT);a(this,y,jo).call(this,e)},jo=async function(e){if(!e.id){a(this,y,Jf).call(this);return}await a(this,y,ep).call(this,e),o(this,Os)!==e.id&&(g(this,Os,e.id),a(this,y,Ko).call(this),a(this,y,Jo).call(this),a(this,y,ue).call(this)&&(a(this,y,cp).call(this),a(this,y,mp).call(this))),a(this,y,tp).call(this)},Xf=function(){if(a(this,y,Wf).call(this),a(this,y,ue).call(this)){const e=w.get(_.EXECUTION_CONTEXT);a(this,y,Zo).call(this,e),a(this,y,Qo).call(this,e)}},Wf=function(){const e=Yo();o(this,mt).applyOptions(e)},Zo=function(e){if(!o(this,V).candlestick||!e)return;const{precision:i,minMove:s}=e,n=Hw();o(this,V).candlestick.applyOptions({...n,priceFormat:{type:"price",precision:i,minMove:s}})},Qo=function(e){const i=Uw(),n=w.get(_.STRATEGIES)[e.strategy].indicatorOptions;o(this,V).indicators.forEach((h,l)=>{const c=n[l];c&&h.applyOptions({...i,...c})})},qf=function(e){if(!e||!a(this,y,ue).call(this))return;const i=o(this,tt).candlesticks;let s=null;for(let l=0;l<i.length-1;l++){const c=i[l].time,u=i[l+1].time;if(e>=c&&e<u){s=l;break}}if(s===null)return;const n=i.length-s;n>o(this,Qt)&&(g(this,Qt,n+Rr),a(this,y,Hr).call(this));const h=o(this,mt).timeScale().timeToIndex(i[s].time);o(this,mt).timeScale().setVisibleLogicalRange({from:h-Al,to:h+Al})},Gf=function({logical:e,point:i,seriesData:s,sourceEvent:n,time:h}){if(!i||!h||!a(this,y,ue).call(this))return;const l=s.get(o(this,V).candlestick);a(this,y,jf).call(this,l),a(this,y,Zf).call(this,s),a(this,y,Qf).call(this,{logical:e,point:i,sourceEvent:n})},jf=function(e){e&&this.mainInfoPanel.update(e)},Zf=function(e){const i=Object.fromEntries([...o(this,V).indicators].map(([s,n])=>[s,e.get(n)]));o(this,Zt).forEach(s=>{s.update(i)})},Qf=function({logical:e,point:i,sourceEvent:s}){this.rulerTool.update({logical:e,point:i,sourceEvent:s,candlestickSeries:o(this,V).candlestick})},Kf=function(e){if(a(this,y,ue).call(this)){if(e===null){g(this,Qt,Rr);return}o(this,Qt)>=o(this,tt).candlesticks.length||e.from<50&&(g(this,Qt,o(this,Qt)+Rr),a(this,y,Hr).call(this))}},Jf=function(){g(this,Os,void 0),a(this,y,Yr).call(this),a(this,y,Ko).call(this),a(this,y,Jo).call(this),this.noData.show(),w.set(_.CANDLE_SERIES,null)},tp=function(){a(this,y,ue).call(this)?(a(this,y,Hr).call(this),a(this,y,yp).call(this),this.noData.hide(),w.set(_.CANDLE_SERIES,o(this,V).candlestick)):(this.noData.show(),w.set(_.CANDLE_SERIES,null))},ep=async function(e){if(!e.id){a(this,y,Yr).call(this);return}try{await a(this,y,ip).call(this,Promise.all([a(this,y,sp).call(this,e.id),a(this,y,np).call(this,e.id),a(this,y,rp).call(this,e.id)]))}catch(i){console.error("Error loading chart data.",i),a(this,y,Yr).call(this)}},ip=async function(e){let i;try{return i=setTimeout(()=>{this.spinner.show()},ff),await e}finally{clearTimeout(i),this.spinner.hide()}},Yr=function(){g(this,tt,{candlesticks:null,indicators:null,deals:null})},sp=async function(e){try{o(this,tt).candlesticks=await Vh.getKlines(e)}catch{o(this,tt).candlesticks=[]}},np=async function(e){try{o(this,tt).indicators=await Vh.getIndicators(e)}catch{o(this,tt).indicators={}}},rp=async function(e){try{o(this,tt).deals=await Vh.getDeals(e)}catch{o(this,tt).deals=[]}},Ko=function(){o(this,Zt).forEach(e=>{e.remove()}),o(this,Zt).clear()},Jo=function(){a(this,y,hp).call(this),a(this,y,op).call(this),a(this,y,ap).call(this),a(this,y,lp).call(this),Nt.removeAll()},hp=function(){const e=o(this,V).candlestick;e&&(o(this,mt).removeSeries(e),o(this,V).candlestick=null)},op=function(){o(this,V).indicators.forEach(e=>{o(this,mt).removeSeries(e)}),o(this,V).indicators.clear()},ap=function(){Nt.removeAll()},lp=function(){o(this,V).deals=null},ue=function(){return o(this,tt).candlesticks&&o(this,tt).candlesticks.length},cp=function(){const e=w.get(_.EXECUTION_CONTEXT);a(this,y,up).call(this),a(this,y,dp).call(this,e),a(this,y,fp).call(this),a(this,y,Zo).call(this,e),a(this,y,Qo).call(this,e)},up=function(){o(this,V).candlestick=o(this,mt).addSeries(_w)},dp=function(e){const s=w.get(_.STRATEGIES)[e.strategy].indicatorOptions;Object.entries(s).forEach(([n,h])=>{const l=Sn.INDICATOR_TYPES,c=h.type??"line",u=l[c]??l.line,d=Math.max(0,Math.min(3,h.pane??0)),p=o(this,mt).addSeries(u,void 0,d);o(this,V).indicators.set(n,p)})},fp=function(){a(this,y,pp).call(this)},pp=function(){const e=Nt.get("trendlines");e.length&&e.forEach(i=>{Nt.renderSeries(Vo,pf,i)})},mp=function(){requestAnimationFrame(()=>{const e=w.get(_.EXECUTION_CONTEXT),s=w.get(_.STRATEGIES)[e.strategy].indicatorOptions;a(this,y,gp).call(this,s),a(this,y,vp).call(this)})},gp=function(e){Object.values(e).forEach(i=>{const s=i.pane??0;if(!o(this,Zt).has(s)){const n=new mf;o(this,Zt).set(s,n)}})},vp=function(){o(this,mt).panes().forEach(e=>{const i=e.paneIndex(),s=o(this,Zt).get(i),n=i===0,h=s.render(n),l=e.getHTMLElement();l.style.position="relative",l.append(h)})},Hr=function(){!o(this,V).candlestick||!a(this,y,ue).call(this)||(a(this,y,bp).call(this),a(this,y,wp).call(this),a(this,y,_p).call(this))},bp=function(){o(this,V).candlestick.setData(o(this,tt).candlesticks.slice(-o(this,Qt)))},wp=function(){Object.values(o(this,tt).indicators).length&&o(this,V).indicators.forEach((e,i)=>{const s=o(this,tt).indicators[i];e.setData(s.slice(-o(this,Qt)))})},_p=function(){if(!o(this,tt).deals.length)return;const e=o(this,V).candlestick.data()[0].time,i=o(this,tt).deals.filter(s=>s.time>=e);o(this,V).deals?o(this,V).deals.setMarkers(i):o(this,V).deals=Aw(o(this,V).candlestick,i)},yp=function(){a(this,y,ue).call(this)&&(a(this,y,Ep).call(this),requestAnimationFrame(()=>{a(this,y,Mp).call(this)}))},Ep=function(){const e=o(this,V).candlestick.data().at(-1);e&&this.mainInfoPanel.update(e,!0)},Mp=function(){const e=w.get(_.EXECUTION_CONTEXT),s=w.get(_.STRATEGIES)[e.strategy].indicatorOptions,n=Object.fromEntries(Array.from(o(this,V).indicators,([h,l])=>{const c=l.data();return[h,c.length?c.at(-1):null]}));o(this,Zt).forEach((h,l)=>{const c=Object.entries(s).filter(([u,d])=>(d.pane??0)===l).map(([u])=>u);h.update(n,!0,c)})},N(Sn,"COMPONENT_NAME","ChartPanel"),N(Sn,"INDICATOR_TYPES",{line:Vo,histogram:Mw});let Go=Sn;const a_={"report-header":"_report-header_1eimu_1","tab-buttons":"_tab-buttons_1eimu_21","size-buttons":"_size-buttons_1eimu_23"},l_=`<div class="report-header">\r
	<div class="tab-buttons" data-ref="tabButtons"></div>\r
	<div class="size-buttons">\r
		<component-toggle-visibility-button></component-toggle-visibility-button>\r
		<component-toggle-expansion-button></component-toggle-expansion-button>\r
	</div>\r
</div>\r
`,c_={"report-tab-button":"_report-tab-button_1my8y_1"},u_=`<button class="report-tab-button" data-active="false"></button>\r
`;var Ei,ar;class Ki extends O{constructor({title:e}){super();f(this,Ei,null);f(this,ar);g(this,ar,e)}render(){return this.element=P.htmlToElement(u_,[],c_),g(this,Ei,C(this.element).text(o(this,ar))),this.element}setOnClick(e){o(this,Ei).click(e)}activate(){o(this,Ei).data("active","true")}deactivate(){o(this,Ei).data("active","false")}}Ei=new WeakMap,ar=new WeakMap,N(Ki,"COMPONENT_NAME","ReportTabButton");var Ps,Je,xp,Tp,Sp;class Cp extends O{constructor({toggleVisibilityButton:e,toggleExpansionButton:i}){super();f(this,Je);f(this,Ps,null);this.toggleVisibilityButton=e,this.toggleExpansionButton=i}get minHeight(){return parseInt(o(this,Ps).css("min-height"))}render(){return a(this,Je,xp).call(this),a(this,Je,Tp).call(this),this.element}connectButtons(e){Object.entries(this.buttons).forEach(([i,s])=>{s.setOnClick(()=>{a(this,Je,Sp).call(this,i),e==null||e(i)})})}}Ps=new WeakMap,Je=new WeakSet,xp=function(){this.buttons={overviewMetrics:new Ki({title:"Overview"}),performanceMetrics:new Ki({title:"Performance"}),tradeMetrics:new Ki({title:"Trade Analytics"}),riskMetrics:new Ki({title:"Risk & Ratios"}),trades:new Ki({title:"Trade Log"})}},Tp=function(){this.element=P.htmlToElement(l_,[this.toggleVisibilityButton,this.toggleExpansionButton],a_),g(this,Ps,C(this.element));const e=o(this,Ps).find('[data-ref="tabButtons"]');Object.values(this.buttons).forEach(i=>{e.append(i.render())}),this.buttons.overviewMetrics.activate()},Sp=function(e){for(const[i,s]of Object.entries(this.buttons))i===e?s.activate():s.deactivate()},N(Cp,"COMPONENT_NAME","ReportHeader");const d_={"toggle-expansion-button":"_toggle-expansion-button_1fmm1_1","icon-collapsed":"_icon-collapsed_1fmm1_11","icon-expanded":"_icon-expanded_1fmm1_19"},f_=`<button class="toggle-expansion-button" data-active="false">\r
	<div class="icon-collapsed">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 28 28"\r
			width="28"\r
			height="28"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M19.32 6H8.68A2.68 2.68 0 0 0 6 8.68V11h1V8.68C7 7.75 7.75 7 8.68 7h10.64c.93 0 1.68.75 1.68 1.68V11h1V8.68C22 7.2 20.8 6 19.32 6ZM7 19.32c0 .93.75 1.68 1.68 1.68h10.64c.93 0 1.68-.75 1.68-1.68V17h1v2.32C22 20.8 20.8 22 19.32 22H8.68A2.68 2.68 0 0 1 6 19.32V17h1v2.32Z"\r
			></path>\r
		</svg>\r
	</div>\r
	<div class="icon-expanded">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 28 28"\r
			width="28"\r
			height="28"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M19.32 17H8.68A2.68 2.68 0 0 0 6 19.68V22h1v-2.32c0-.93.75-1.68 1.68-1.68h10.64c.93 0 1.68.75 1.68 1.68V22h1v-2.32C22 18.2 20.8 17 19.32 17ZM7 8.32C7 9.25 7.75 10 8.68 10h10.64c.93 0 1.68-.75 1.68-1.68V6h1v2.32C22 9.8 20.8 11 19.32 11H8.68A2.68 2.68 0 0 1 6 8.32V6h1v2.32Z"\r
			></path>\r
		</svg>\r
	</div>\r
</button>\r
`;var Mi,ti,Ip,Op,Pp;class Np extends O{constructor({onClick:e}){super();f(this,ti);f(this,Mi,null);this.onClick=e}get isActive(){return o(this,Mi).is("data-active")}render(){return a(this,ti,Ip).call(this),a(this,ti,Op).call(this),this.element}toggleActiveState(){const e=String(!this.isActive);o(this,Mi).data("active",e)}}Mi=new WeakMap,ti=new WeakSet,Ip=function(){this.element=P.htmlToElement(f_,[],d_),g(this,Mi,C(this.element))},Op=function(){o(this,Mi).on("click",a(this,ti,Pp).bind(this))},Pp=function(){var e;this.toggleActiveState(),(e=this.onClick)==null||e.call(this)},N(Np,"COMPONENT_NAME","ToggleExpansionButton");const p_={"toggle-visibility-button":"_toggle-visibility-button_1pi6n_1","icon-visible":"_icon-visible_1pi6n_11","icon-hidden":"_icon-hidden_1pi6n_19"},m_=`<button class="toggle-visibility-button" data-active="false">\r
	<div class="icon-visible">\r
		<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
			<path fill="currentColor" d="M7 20h14v1H7z"></path>\r
		</svg>\r
	</div>\r
	<div class="icon-hidden">\r
		<svg xmlns="http://www.w3.org/2000/svg" width="19" height="12" fill="none">\r
			<path stroke="currentColor" d="M1 8l8.5-6.5L18 8"></path>\r
		</svg>\r
	</div>\r
</button>\r
`;var Ci,ei,Ap,Rp,Lp;class kp extends O{constructor({onClick:e}){super();f(this,ei);f(this,Ci,null);this.onClick=e}get isActive(){return o(this,Ci).is("data-active")}render(){return a(this,ei,Ap).call(this),a(this,ei,Rp).call(this),this.element}toggleActiveState(){const e=String(!this.isActive);o(this,Ci).data("active",e)}}Ci=new WeakMap,ei=new WeakSet,Ap=function(){this.element=P.htmlToElement(m_,[],p_),g(this,Ci,C(this.element))},Rp=function(){o(this,Ci).on("click",a(this,ei,Lp).bind(this))},Lp=function(){var e;this.toggleActiveState(),(e=this.onClick)==null||e.call(this)},N(kp,"COMPONENT_NAME","ToggleVisibilityButton");const g_="_handle_10bl0_27",v_={"report-panel":"_report-panel_10bl0_1",handle:g_},b_=`<div class="report-panel">\r
	<div class="handle" data-ref="handle"></div>\r
	<component-report-header></component-report-header>\r
	<component-report-content></component-report-content>\r
</div>\r
`,w_={"report-content":"_report-content_1plw8_1"},__=`<div class="report-content">\r
	<component-overview-metrics-tab></component-overview-metrics-tab>\r
	<component-performance-metrics-tab></component-performance-metrics-tab>\r
	<component-trade-metrics-tab></component-trade-metrics-tab>\r
	<component-risk-metrics-tab></component-risk-metrics-tab>\r
	<component-trades-tab></component-trades-tab>\r
</div>\r
`;class y_ extends js{async getOverviewMetrics(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/metrics/${t}/overview`,method:"GET",errorMessage:"Failed to load overview metrics"})}async getPerformanceMetrics(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/metrics/${t}/performance`,method:"GET",errorMessage:"Failed to load performance metrics"})}async getTradeMetrics(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/metrics/${t}/trades`,method:"GET",errorMessage:"Failed to load trade-related metrics"})}async getRiskMetrics(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/metrics/${t}/risk`,method:"GET",errorMessage:"Failed to load risk-related metrics"})}async getTrades(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/trades/${t}`,method:"GET",errorMessage:"Failed to load report trades"})}}const xr=new y_,E_={"overview-metrics-tab":"_overview-metrics-tab_16dhb_1"},M_=`<div class="overview-metrics-tab">\r
	<component-spinner></component-spinner>\r
	<component-no-data></component-no-data>\r
	<component-overview-metrics></component-overview-metrics>\r
	<component-equity-curve></component-equity-curve>\r
</div>\r
`,C_=()=>({autoSize:!0,layout:{background:{type:"solid",color:q("--color-bg-primary")||"#ffffff"},textColor:q("--color-text-primary")||"#292121",fontFamily:"system-ui, sans-serif",attributionLogo:!1},rightPriceScale:{scaleMargins:{top:.05,bottom:.05},borderVisible:!1,entireTextOnly:!0},crosshair:{vertLine:{color:q("--color-equity-curve-crosshair")||"#e8e8e8",style:0,labelVisible:!1},horzLine:{visible:!1,labelVisible:!1}},grid:{vertLines:{visible:!1},horzLines:{visible:!1}},timeScale:{maxBarSpacing:50,fixLeftEdge:!0,fixRightEdge:!0,lockVisibleTimeRangeOnResize:!0,borderVisible:!1,tickMarkFormatter:(r,t)=>{const e=new Date(r*1e3),i=String(e.getUTCFullYear()),s=e.toLocaleString("en-US",{month:"short"}),n=String(e.getUTCDate());if(t===0)return String(i);if(t===1)return s;if(t===2)return n}}}),x_=()=>({lastValueVisible:!1,priceLineVisible:!1,topColor:q("--color-equity-curve-area-top")||"#78CEFF",bottomColor:q("--color-equity-curve-area-bottom")||"#EBF5FB",lineColor:q("--color-equity-curve-line")||"#00A9FF",lineWidth:3,crosshairMarkerBorderColor:q("--color-equity-curve-marker")||"#ffffff",crosshairMarkerBorderWidth:3}),T_=100,S_={weekday:"short",month:"short",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"UTC"},N_=50,I_=20,O_={"equity-curve":"_equity-curve_vfuql_1"},P_=`<div class="equity-curve">\r
	<component-equity-tooltip></component-equity-tooltip>\r
</div>\r
`,k_={"equity-tooltip":"_equity-tooltip_nst2y_1","text-white":"_text-white_nst2y_41"},A_=`<div class="equity-tooltip" data-active="false">\r
	<div>Trade #<span data-field="deal"></span></div>\r
	<div class="text-white">\r
		Current Equity: <span data-field="equity"></span>\r
	</div>\r
	<div><span data-field="time"></span></div>\r
	<div>Click to show on chart</div>\r
</div>\r
`;var Kt,lr,ks,ie,$p,zp,Ur;class Dp extends O{constructor(){super(...arguments);f(this,ie);f(this,Kt,null);f(this,lr,new Map);f(this,ks,!1)}get width(){return parseInt(o(this,Kt).css("width"))}get height(){return parseInt(o(this,Kt).css("height"))}get offsetX(){return I_}get isActive(){return o(this,ks)}render(){return a(this,ie,$p).call(this),a(this,ie,zp).call(this),this.element}updateContent({deal:e,equity:i,timestamp:s}){const h=new Date(s*1e3).toLocaleString("en-US",S_);a(this,ie,Ur).call(this,"deal",`${e}`),a(this,ie,Ur).call(this,"equity",`${i} USDT`),a(this,ie,Ur).call(this,"time",h)}updatePosition({left:e,bottom:i}){o(this,Kt).css("left",`${e}px`).css("bottom",`${i}px`)}activate(){o(this,Kt).data("active","true"),g(this,ks,!0)}deactivate(){o(this,Kt).data("active","false"),g(this,ks,!1)}}Kt=new WeakMap,lr=new WeakMap,ks=new WeakMap,ie=new WeakSet,$p=function(){this.element=P.htmlToElement(A_,[],k_),g(this,Kt,C(this.element))},zp=function(){["deal","equity","time"].forEach(e=>{const i=o(this,Kt).find(`[data-field="${e}"]`);o(this,lr).set(e,i)})},Ur=function(e,i){o(this,lr).get(e).text(i)},N(Dp,"COMPONENT_NAME","EquityTooltip");var As,Jt,Ye,xi,cr,z,Fp,Vp,Yp,Hp,Up,ta,ea,Xp,Wp,qp,Gp,jp,Zp,Qp;class Bp extends O{constructor(){super(...arguments);f(this,z);f(this,As,null);f(this,Jt,null);f(this,Ye,null);f(this,xi,null);f(this,cr,!1)}render(){return a(this,z,Fp).call(this),a(this,z,Vp).call(this),a(this,z,Yp).call(this),this.element}update(e){o(this,Ye).setData(e),o(this,Jt).timeScale().fitContent()}show(){o(this,As).css("display","block")}hide(){o(this,As).css("display","none")}}As=new WeakMap,Jt=new WeakMap,Ye=new WeakMap,xi=new WeakMap,cr=new WeakMap,z=new WeakSet,Fp=function(){this.equityTooltip=new Dp},Vp=function(){this.element=P.htmlToElement(P_,[this.equityTooltip],O_),g(this,As,C(this.element))},Yp=function(){a(this,z,Hp).call(this),a(this,z,Xp).call(this)},Hp=function(){g(this,Jt,af(this.element)),g(this,Ye,o(this,Jt).addSeries(gw)),a(this,z,ta).call(this),a(this,z,ea).call(this)},Up=function(){a(this,z,ta).call(this),a(this,z,ea).call(this)},ta=function(){const e=C_();o(this,Jt).applyOptions(e)},ea=function(){const e=x_();o(this,Ye).applyOptions(e)},Xp=function(){o(this,Jt).subscribeClick(a(this,z,Wp).bind(this)),o(this,Jt).subscribeCrosshairMove(a(this,z,qp).bind(this)),o(this,Jt).timeScale().subscribeVisibleLogicalRangeChange(a(this,z,Zp).bind(this)),w.subscribe(_.THEME,a(this,z,Up).bind(this))},Wp=function({time:e}){w.set(_.SELECTED_TIME,e)},qp=function(e){const{point:i,time:s,sourceEvent:n}=e;if(!i||!s||i.x<0||i.y<0){this.equityTooltip.deactivate();return}this.equityTooltip.isActive||(g(this,xi,a(this,z,Qp).call(this)),this.equityTooltip.activate()),a(this,z,Gp).call(this,e),n&&a(this,z,jp).call(this,n)},Gp=function(e){const{logical:i,seriesData:s}=e,n=s.get(o(this,Ye));n&&this.equityTooltip.updateContent({deal:i+1,equity:n.value,timestamp:n.time})},jp=function(e){const{clientX:i,clientY:s}=e,{width:n,height:h,offsetX:l}=this.equityTooltip,c=o(this,xi).height-s-h/2;let u=i-o(this,xi).left-n-l;u<N_&&(u=i-o(this,xi).left+l),this.equityTooltip.updatePosition({left:u,bottom:c})},Zp=function(e){const i=e.to-e.from<=T_;i!==o(this,cr)&&(g(this,cr,i),o(this,Ye).applyOptions({pointMarkersVisible:i}))},Qp=function(){return{left:this.element.getBoundingClientRect().left,height:window.innerHeight}},N(Bp,"COMPONENT_NAME","EquityCurve");const R_="_cell_96plr_15",L_="_title_96plr_25",D_="_values_96plr_33",$_="_red_96plr_43",z_="_green_96plr_51",sn={"overview-metrics":"_overview-metrics_96plr_1",cell:R_,title:L_,values:D_,red:$_,green:z_},B_=`<div class="overview-metrics">\r
	<div class="cell">\r
		<div class="title">Total P&L</div>\r
		<div class="values">\r
			<span data-field="0"></span>\r
			<span data-field="1"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Profit Factor</div>\r
		<div class="values">\r
			<span data-field="2"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Max Drawdown</div>\r
		<div class="values">\r
			<span data-field="3"></span>\r
			<span data-field="4"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Average per Trade</div>\r
		<div class="values">\r
			<span data-field="5"></span>\r
			<span data-field="6"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Winning Trades</div>\r
		<div class="values">\r
			<span data-field="7"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Total Trades</div>\r
		<div class="values">\r
			<span data-field="8"></span>\r
		</div>\r
	</div>\r
</div>\r
`;var Kr,ur,dr,re,Kp,Jp,tm,em;const Nn=class Nn extends O{constructor(){super(...arguments);f(this,re);f(this,ur,null);f(this,dr,new Map)}render(){return a(this,re,Kp).call(this),a(this,re,Jp).call(this),this.element}update(e){o(this,dr).forEach(({element:i,isProfitField:s},n)=>{const h=e[n];i.text(h),s&&a(this,re,em).call(this,i,h)})}};Kr=new WeakMap,ur=new WeakMap,dr=new WeakMap,re=new WeakSet,Kp=function(){this.element=P.htmlToElement(B_,[],sn),g(this,ur,C(this.element))},Jp=function(){o(this,ur).findAll("[data-field]").forEach(e=>{const i=Number(e.data("field")),s=a(this,re,tm).call(this,i);o(this,dr).set(i,{element:e,isProfitField:s})})},tm=function(e){return o(Nn,Kr).includes(e)},em=function(e,i){i.startsWith("-")?e.removeClass(sn.green).addClass(sn.red):e.removeClass(sn.red).addClass(sn.green)},N(Nn,"COMPONENT_NAME","OverviewMetrics"),f(Nn,Kr,[0,1,5,6]);let ia=Nn;var Rs,Ot,sm,nm,rm,sa,hm;class im extends O{constructor(){super(...arguments);f(this,Ot);f(this,Rs,null)}render(){return a(this,Ot,sm).call(this),a(this,Ot,nm).call(this),a(this,Ot,rm).call(this),this.element}show(){o(this,Rs).css("display","flex")}hide(){o(this,Rs).css("display","none")}}Rs=new WeakMap,Ot=new WeakSet,sm=function(){this.spinner=new xa,this.noData=new Ca,this.overviewMetrics=new ia,this.equityCurve=new Bp},nm=function(){this.element=P.htmlToElement(M_,[this.spinner,this.noData,this.overviewMetrics,this.equityCurve],E_),g(this,Rs,C(this.element))},rm=function(){w.subscribe(_.EXECUTION_CONTEXT,a(this,Ot,sa).bind(this)),a(this,Ot,sa).call(this,w.get(_.EXECUTION_CONTEXT))},sa=async function(e){try{let i={primary:[],equity:[]};if(e.id)try{i=await a(this,Ot,hm).call(this,xr.getOverviewMetrics(e.id))}catch{i={primary:[],equity:[]}}i.equity.length?(this.overviewMetrics.update(i.primary),this.equityCurve.update(i.equity),this.noData.hide()):this.noData.show()}catch(i){console.error("Failed to update overview.",i)}},hm=async function(e){let i;try{return i=setTimeout(()=>{this.spinner.show()},ff),await e}finally{clearTimeout(i),this.spinner.hide()}},N(im,"COMPONENT_NAME","OverviewMetricsTab");const F_="_cell_1pfav_23",V_={"metrics-item":"_metrics-item_1pfav_1",cell:F_,"align-end":"_align-end_1pfav_35","text-sm":"_text-sm_1pfav_43"},Y_=`<div class="metrics-item">\r
	<div class="cell">\r
		<span data-field="title.0"></span>\r
	</div>\r
	<div class="cell align-end">\r
		<span data-field="all.0"></span>\r
		<span data-field="all.1" class="text-sm"></span>\r
	</div>\r
	<div class="cell align-end">\r
		<span data-field="long.0"></span>\r
		<span data-field="long.1" class="text-sm"></span>\r
	</div>\r
	<div class="cell align-end">\r
		<span data-field="short.0"></span>\r
		<span data-field="short.1" class="text-sm"></span>\r
	</div>\r
	<div class="cell align-end"></div>\r
</div>\r
`;var fr,pr,qs,om,am;class bh extends O{constructor(){super(...arguments);f(this,qs);f(this,fr,null);f(this,pr,new Map)}render(){return a(this,qs,om).call(this),a(this,qs,am).call(this),this.element}update(e){o(this,pr).forEach(({element:i,group:s,index:n})=>{i.text(e[s][n])})}}fr=new WeakMap,pr=new WeakMap,qs=new WeakSet,om=function(){this.element=P.htmlToElement(Y_,[],V_),g(this,fr,C(this.element))},am=function(){o(this,fr).findAll("[data-field]").forEach(e=>{const i=e.data("field"),[s,n]=i.split(".");o(this,pr).set(i,{element:e,group:s,index:Number(n)})})},N(bh,"COMPONENT_NAME","MetricsItem");const H_="_table_m7c19_11",U_="_header_m7c19_27",X_="_row_m7c19_39",W_="_cell_m7c19_49",q_="_items_m7c19_79",G_={"performance-metrics-tab":"_performance-metrics-tab_m7c19_1",table:H_,header:U_,row:X_,cell:W_,"align-end":"_align-end_m7c19_63",items:q_},j_=`<div class="performance-metrics-tab">\r
	<div class="table">\r
		<div class="header">\r
			<div class="row">\r
				<div class="cell">Metric</div>\r
				<div class="cell align-end">All</div>\r
				<div class="cell align-end">Long</div>\r
				<div class="cell align-end">Short</div>\r
				<div class="cell align-end"></div>\r
			</div>\r
		</div>\r
		<div class="items" data-ref="metricsItems"></div>\r
	</div>\r
</div>\r
`;var Ti,Si,Bt,cm,um,na,dm;class lm extends O{constructor(){super(...arguments);f(this,Bt);f(this,Ti,null);f(this,Si,new Map)}render(){return a(this,Bt,cm).call(this),a(this,Bt,um).call(this),this.element}show(){o(this,Ti).css("display","flex")}hide(){o(this,Ti).css("display","none")}}Ti=new WeakMap,Si=new WeakMap,Bt=new WeakSet,cm=function(){this.element=P.htmlToElement(j_,[],G_),g(this,Ti,C(this.element))},um=function(){w.subscribe(_.EXECUTION_CONTEXT,a(this,Bt,na).bind(this)),a(this,Bt,na).call(this,w.get(_.EXECUTION_CONTEXT))},na=async function(e){try{let i=[];if(e.id)try{i=await xr.getPerformanceMetrics(e.id)}catch{i=[]}a(this,Bt,dm).call(this,i)}catch(i){console.error("Failed to update metrics.",i)}},dm=function(e){if(!e.length){o(this,Si).forEach(s=>s.element.remove()),o(this,Si).clear();return}const i=o(this,Ti).find('[data-ref="metricsItems"]');e.forEach((s,n)=>{let h=o(this,Si).get(n);h||(h=new bh,o(this,Si).set(n,h),i.append(h.render())),h.update(s)})},N(lm,"COMPONENT_NAME","PerformanceMetricsTab");const Z_="_table_arjnf_11",Q_="_header_arjnf_27",K_="_row_arjnf_39",J_="_cell_arjnf_49",ty="_items_arjnf_79",ey={"risk-metrics-tab":"_risk-metrics-tab_arjnf_1",table:Z_,header:Q_,row:K_,cell:J_,"align-end":"_align-end_arjnf_63",items:ty},iy=`<div class="risk-metrics-tab">\r
	<div class="table">\r
		<div class="header">\r
			<div class="row">\r
				<div class="cell">Metric</div>\r
				<div class="cell align-end">All</div>\r
				<div class="cell align-end">Long</div>\r
				<div class="cell align-end">Short</div>\r
				<div class="cell align-end"></div>\r
			</div>\r
		</div>\r
		<div class="items" data-ref="metricsItems"></div>\r
	</div>\r
</div>\r
`;var Ni,Ii,Ft,pm,mm,ra,gm;class fm extends O{constructor(){super(...arguments);f(this,Ft);f(this,Ni,null);f(this,Ii,new Map)}render(){return a(this,Ft,pm).call(this),a(this,Ft,mm).call(this),this.element}show(){o(this,Ni).css("display","flex")}hide(){o(this,Ni).css("display","none")}}Ni=new WeakMap,Ii=new WeakMap,Ft=new WeakSet,pm=function(){this.element=P.htmlToElement(iy,[],ey),g(this,Ni,C(this.element))},mm=function(){w.subscribe(_.EXECUTION_CONTEXT,a(this,Ft,ra).bind(this)),a(this,Ft,ra).call(this,w.get(_.EXECUTION_CONTEXT))},ra=async function(e){try{let i=[];if(e.id)try{i=await xr.getRiskMetrics(e.id)}catch{i=[]}a(this,Ft,gm).call(this,i)}catch(i){console.error("Failed to update metrics.",i)}},gm=function(e){if(!e.length){o(this,Ii).forEach(s=>s.element.remove()),o(this,Ii).clear();return}const i=o(this,Ni).find('[data-ref="metricsItems"]');e.forEach((s,n)=>{let h=o(this,Ii).get(n);h||(h=new bh,o(this,Ii).set(n,h),i.append(h.render())),h.update(s)})},N(fm,"COMPONENT_NAME","RiskMetricsTab");const sy="_table_1xb6b_11",ny="_header_1xb6b_27",ry="_row_1xb6b_39",hy="_cell_1xb6b_49",oy="_items_1xb6b_79",ay={"trade-metrics-tab":"_trade-metrics-tab_1xb6b_1",table:sy,header:ny,row:ry,cell:hy,"align-end":"_align-end_1xb6b_63",items:oy},ly=`<div class="trade-metrics-tab">\r
	<div class="table">\r
		<div class="header">\r
			<div class="row">\r
				<div class="cell">Metric</div>\r
				<div class="cell align-end">All</div>\r
				<div class="cell align-end">Long</div>\r
				<div class="cell align-end">Short</div>\r
				<div class="cell align-end"></div>\r
			</div>\r
		</div>\r
		<div class="items" data-ref="metricsItems"></div>\r
	</div>\r
</div>\r
`;var Oi,Pi,Vt,bm,wm,ha,_m;class vm extends O{constructor(){super(...arguments);f(this,Vt);f(this,Oi,null);f(this,Pi,new Map)}render(){return a(this,Vt,bm).call(this),a(this,Vt,wm).call(this),this.element}show(){o(this,Oi).css("display","flex")}hide(){o(this,Oi).css("display","none")}}Oi=new WeakMap,Pi=new WeakMap,Vt=new WeakSet,bm=function(){this.element=P.htmlToElement(ly,[],ay),g(this,Oi,C(this.element))},wm=function(){w.subscribe(_.EXECUTION_CONTEXT,a(this,Vt,ha).bind(this)),a(this,Vt,ha).call(this,w.get(_.EXECUTION_CONTEXT))},ha=async function(e){try{let i=[];if(e.id)try{i=await xr.getTradeMetrics(e.id)}catch{i=[]}a(this,Vt,_m).call(this,i)}catch(i){console.error("Failed to update metrics.",i)}},_m=function(e){if(!e.length){o(this,Pi).forEach(s=>s.element.remove()),o(this,Pi).clear();return}const i=o(this,Oi).find('[data-ref="metricsItems"]');e.forEach((s,n)=>{let h=o(this,Pi).get(n);h||(h=new bh,o(this,Pi).set(n,h),i.append(h.render())),h.update(s)})},N(vm,"COMPONENT_NAME","TradeMetricsTab");const cy="_table_q3m30_13",uy="_header_q3m30_29",dy="_row_q3m30_41",fy="_cell_q3m30_51",py="_items_q3m30_99",my={"trades-tab":"_trades-tab_q3m30_1",table:cy,header:uy,row:dy,cell:fy,"align-end":"_align-end_q3m30_83",items:py},gy=`<div class="trades-tab">\r
	<div class="table">\r
		<div class="header">\r
			<div class="row">\r
				<div class="cell">\r
					<component-toggle-sorting-button></component-toggle-sorting-button>\r
				</div>\r
				<div class="cell">Type</div>\r
				<div class="cell">Signal</div>\r
				<div class="cell">Date/Time</div>\r
				<div class="cell align-end">Price</div>\r
				<div class="cell align-end">Quantity</div>\r
				<div class="cell align-end">P&L</div>\r
				<div class="cell align-end">Cumulative P&L</div>\r
			</div>\r
		</div>\r
		<div class="items" data-ref="tradesItems"></div>\r
	</div>\r
</div>\r
`,vy={"toggle-sorting-button":"_toggle-sorting-button_7fiwl_1","icon-ascending":"_icon-ascending_7fiwl_21","icon-descending":"_icon-descending_7fiwl_29"},by=`<button class="toggle-sorting-button" data-active="false">\r
	<span>Trade #</span>\r
	<span class="icon-ascending">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			width="16"\r
			height="16"\r
			fill="#6a6d78"\r
			class="bi bi-arrow-up"\r
			viewBox="0 0 16 16"\r
		>\r
			<path\r
				fill-rule="evenodd"\r
				d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5"\r
			/>\r
		</svg>\r
	</span>\r
	<span class="icon-descending">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			width="16"\r
			height="16"\r
			fill="#6a6d78"\r
			class="bi bi-arrow-down"\r
			viewBox="0 0 16 16"\r
		>\r
			<path\r
				fill-rule="evenodd"\r
				d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"\r
			/>\r
		</svg>\r
	</span>\r
</button>\r
`;var ki,ii,Em,Mm,Cm;class ym extends O{constructor({onClick:e}){super();f(this,ii);f(this,ki,null);this.onClick=e}get isActive(){return o(this,ki).is("data-active")}render(){return a(this,ii,Em).call(this),a(this,ii,Mm).call(this),this.element}toggleActiveState(){o(this,ki).data("active",String(!this.isActive))}}ki=new WeakMap,ii=new WeakSet,Em=function(){this.element=P.htmlToElement(by,[],vy),g(this,ki,C(this.element))},Mm=function(){o(this,ki).on("click",a(this,ii,Cm).bind(this))},Cm=function(){var e;this.toggleActiveState(),(e=this.onClick)==null||e.call(this)},N(ym,"COMPONENT_NAME","ToggleSortingButton");const wy="_cell_s94hx_23",_y="_compact_s94hx_85",yy="_red_s94hx_101",Ey="_green_s94hx_109",nn={"trades-item":"_trades-item_s94hx_1",cell:wy,"border-bottom":"_border-bottom_s94hx_43","align-end":"_align-end_s94hx_69",compact:_y,"text-sm":"_text-sm_s94hx_93",red:yy,green:Ey},My=`<div class="trades-item">\r
	<div class="cell">\r
		<div data-field="0"></div>\r
	</div>\r
	<div class="cell">\r
		<div data-field="1" class="border-bottom"></div>\r
		<div data-field="2"></div>\r
	</div>\r
	<div class="cell">\r
		<div data-field="3" class="border-bottom"></div>\r
		<div data-field="4"></div>\r
	</div>\r
	<div class="cell">\r
		<div data-field="5" class="border-bottom"></div>\r
		<div data-field="6"></div>\r
	</div>\r
	<div class="cell align-end">\r
		<div data-field="7" class="border-bottom"></div>\r
		<div data-field="8"></div>\r
	</div>\r
	<div class="cell align-end">\r
		<div data-field="9"></div>\r
	</div>\r
	<div class="cell align-end compact">\r
		<span data-field="10"></span>\r
		<span data-field="11" class="text-sm"></span>\r
	</div>\r
	<div class="cell align-end compact">\r
		<span data-field="12"></span>\r
		<span data-field="13" class="text-sm"></span>\r
	</div>\r
</div>\r
`;var Jr,mr,gr,he,xm,Tm,Sm,Nm;const In=class In extends O{constructor(){super(...arguments);f(this,he);f(this,mr,null);f(this,gr,new Map)}render(){return a(this,he,xm).call(this),a(this,he,Tm).call(this),this.element}update(e){o(this,gr).forEach(({element:i,isProfitField:s},n)=>{const h=e[n];i.text(h),s&&a(this,he,Nm).call(this,i,h)})}remove(){this.element.remove()}};Jr=new WeakMap,mr=new WeakMap,gr=new WeakMap,he=new WeakSet,xm=function(){this.element=P.htmlToElement(My,[],nn),g(this,mr,C(this.element))},Tm=function(){o(this,mr).findAll("[data-field]").forEach(e=>{const i=Number(e.data("field")),s=a(this,he,Sm).call(this,i);o(this,gr).set(i,{element:e,isProfitField:s})})},Sm=function(e){return o(In,Jr).includes(e)},Nm=function(e,i){i.startsWith("-")?e.removeClass(nn.green).addClass(nn.red):e.removeClass(nn.red).addClass(nn.green)},N(In,"COMPONENT_NAME","TradesItem"),f(In,Jr,[10,11,12,13]);let oa=In;var te,gt,be,Ls,vr,He,th,br,wr,eh,F,Om,Pm,km,Am,Rm,aa,la,Lm,ca,Xr,Wr;class Im extends O{constructor(){super(...arguments);f(this,F);f(this,te,null);f(this,gt,[]);f(this,be,new Map);f(this,Ls,0);f(this,vr,0);f(this,He,100);f(this,th,10);f(this,br,0);f(this,wr,0);f(this,eh,30)}render(){return a(this,F,Om).call(this),a(this,F,Pm).call(this),a(this,F,km).call(this),this.element}handleSortingToggle(){o(this,gt).length&&(a(this,F,la).call(this),a(this,F,ca).call(this),a(this,F,Xr).call(this),a(this,F,Wr).call(this))}show(){o(this,te).css("display","flex")}hide(){o(this,te).css("display","none")}}te=new WeakMap,gt=new WeakMap,be=new WeakMap,Ls=new WeakMap,vr=new WeakMap,He=new WeakMap,th=new WeakMap,br=new WeakMap,wr=new WeakMap,eh=new WeakMap,F=new WeakSet,Om=function(){this.toggleSortingButton=new ym({onClick:this.handleSortingToggle.bind(this)})},Pm=function(){this.element=P.htmlToElement(gy,[this.toggleSortingButton],my),g(this,te,C(this.element))},km=function(){a(this,F,Am).call(this),a(this,F,aa).call(this,w.get(_.EXECUTION_CONTEXT))},Am=function(){o(this,te).on("scroll",a(this,F,Rm).bind(this)),w.subscribe(_.EXECUTION_CONTEXT,a(this,F,aa).bind(this))},Rm=function(){const e=Date.now();e-o(this,wr)<o(this,eh)||(g(this,wr,e),g(this,br,o(this,te).element.scrollTop),a(this,F,Xr).call(this),a(this,F,Wr).call(this))},aa=async function(e){try{let i=[];if(e.id)try{i=await xr.getTrades(e.id)}catch{i=[]}g(this,gt,[...i]),a(this,F,la).call(this),a(this,F,Lm).call(this),a(this,F,Xr).call(this),a(this,F,Wr).call(this)}catch(i){console.error("Failed to update trades.",i)}},la=function(){for(const e of o(this,be).values())e.element.remove();o(this,be).clear()},Lm=function(){if(o(this,gt).length<2)return;(this.toggleSortingButton.isActive?o(this,gt)[0][0]<o(this,gt)[1][0]:o(this,gt)[0][0]>o(this,gt)[1][0])&&a(this,F,ca).call(this)},ca=function(){o(this,gt).reverse()},Xr=function(){const e=Math.max(o(this,th),Math.ceil(o(this,te).element.clientHeight/o(this,He))+2);g(this,Ls,Math.floor(o(this,br)/o(this,He))),g(this,vr,Math.min(o(this,Ls)+e-1,o(this,gt).length-1))},Wr=function(){const e=o(this,te).find('[data-ref="tradesItems"]');if(!o(this,gt).length){e.css("height","0px");return}const i=o(this,gt).length*o(this,He);e.css("height",`${i}px`);const s=new Map;for(let n=o(this,Ls);n<=o(this,vr);n++){const h=o(this,gt)[n];let l;o(this,be).has(n)?l=o(this,be).get(n):(l=new oa,e.append(l.render()),C(l.element).css({position:"absolute",top:`${n*o(this,He)}px`,left:"0",right:"0",height:`${o(this,He)}px`}),l.update(h)),s.set(n,l)}for(const[n,h]of o(this,be))s.has(n)||h.element.remove();g(this,be,s)},N(Im,"COMPONENT_NAME","TradesTab");var Gs,$m,zm;class Dm extends O{constructor(){super(...arguments);f(this,Gs)}render(){return a(this,Gs,$m).call(this),a(this,Gs,zm).call(this),this.element}showOnly(e){Object.entries(this.tabs).forEach(([i,s])=>{i===e?s.show():s.hide()})}}Gs=new WeakSet,$m=function(){this.tabs={overviewMetrics:new im,performanceMetrics:new lm,tradeMetrics:new vm,riskMetrics:new fm,trades:new Im}},zm=function(){this.element=P.htmlToElement(__,Object.values(this.tabs),w_)},N(Dm,"COMPONENT_NAME","ReportContent");var Ue,oe,Fm,Vm,Ym,Hm;class Bm extends O{constructor({reportHeader:e,onMousedown:i}){super();f(this,oe);f(this,Ue,null);this.reportHeader=e,this.onMousedown=i}get height(){return parseInt(o(this,Ue).css("height"))}set height(e){o(this,Ue).css("height",`${e}px`)}get minHeight(){const e=o(this,Ue).find('[data-ref="handle"]').css("min-height"),i=this.reportHeader.minHeight;return parseInt(e)+i}render(){return a(this,oe,Fm).call(this),a(this,oe,Vm).call(this),a(this,oe,Ym).call(this),this.element}}Ue=new WeakMap,oe=new WeakSet,Fm=function(){this.reportContent=new Dm},Vm=function(){this.element=P.htmlToElement(b_,[this.reportHeader,this.reportContent],v_),g(this,Ue,C(this.element))},Ym=function(){o(this,Ue).find('[data-ref="handle"]').on("mousedown",a(this,oe,Hm).bind(this)),this.reportHeader.connectButtons(e=>{this.reportContent.showOnly(e)})},Hm=function(e){var i;(i=this.onMousedown)==null||i.call(this,e.clientY)},N(Bm,"COMPONENT_NAME","ReportPanel");var _r,Ds,Xe,Ai,et,Xm,Wm,qm,bn,Ji;class Um extends O{constructor(){super(...arguments);f(this,et);f(this,_r,null);f(this,Ds);f(this,Xe);f(this,Ai)}render(){return a(this,et,Xm).call(this),a(this,et,Wm).call(this),a(this,et,qm).call(this),this.element}handleVisibilityToggle(){this.toggleVisibilityButton.isActive?(this.toggleExpansionButton.isActive?this.toggleExpansionButton.toggleActiveState():a(this,et,bn).call(this),a(this,et,Ji).call(this,o(this,Xe))):a(this,et,Ji).call(this,o(this,Ds))}handleExpansionToggle(){this.toggleExpansionButton.isActive?(this.toggleVisibilityButton.isActive?this.toggleVisibilityButton.toggleActiveState():a(this,et,bn).call(this),a(this,et,Ji).call(this,o(this,Ai))):a(this,et,Ji).call(this,o(this,Ds))}handleManualResize(e){a(this,et,bn).call(this);const i=this.reportPanel.height;let s=this.toggleVisibilityButton.isActive,n=this.toggleExpansionButton.isActive;const h=c=>{const u=Math.max(o(this,Xe),i+e-c.clientY);a(this,et,Ji).call(this,u),u===o(this,Xe)&&!s?(this.toggleVisibilityButton.toggleActiveState(),s=!s):s&&u>o(this,Xe)&&(this.toggleVisibilityButton.toggleActiveState(),s=!s),u>=o(this,Ai)&&!n?(this.toggleExpansionButton.toggleActiveState(),n=!n):n&&u<o(this,Ai)&&(this.toggleExpansionButton.toggleActiveState(),n=!n)},l=()=>{C(document).off("mousemove",h).off("mouseup",l).find("body").removeClass("resizing")};C(document).on("mousemove",h).on("mouseup",l).find("body").addClass("resizing")}}_r=new WeakMap,Ds=new WeakMap,Xe=new WeakMap,Ai=new WeakMap,et=new WeakSet,Xm=function(){this.chartPanel=new Go,this.toggleVisibilityButton=new kp({onClick:this.handleVisibilityToggle.bind(this)}),this.toggleExpansionButton=new Np({onClick:this.handleExpansionToggle.bind(this)}),this.reportHeader=new Cp({toggleVisibilityButton:this.toggleVisibilityButton,toggleExpansionButton:this.toggleExpansionButton}),this.reportPanel=new Bm({reportHeader:this.reportHeader,onMousedown:this.handleManualResize.bind(this)})},Wm=function(){this.element=P.htmlToElement(i1,[this.chartPanel,this.reportPanel],e1),g(this,_r,C(this.element))},qm=function(){requestAnimationFrame(()=>a(this,et,bn).call(this))},bn=function(){g(this,Ds,this.reportPanel.height),g(this,Xe,this.reportPanel.minHeight),g(this,Ai,parseInt(o(this,_r).css("height")))},Ji=function(e){this.chartPanel.height=e,this.reportPanel.height=e},N(Um,"COMPONENT_NAME","Dashboard");const Cy=`<div class="notification" data-ref="notification">\r
	<div class="content" data-field="content"></div>\r
</div>\r
`;class Gm extends O{render(){return this.element=P.htmlToElement(Cy,[],Lr),this.element}}N(Gm,"COMPONENT_NAME","Notification");const xy="_toolbox_lvde1_1",Ty={toolbox:xy},Sy=`<div class="toolbox">\r
	<component-screenshot-button></component-screenshot-button>\r
	<component-full-screen-button></component-full-screen-button>\r
	<hr />\r
	<component-trendline-tool-button></component-trendline-tool-button>\r
	<component-ruler-tool-button></component-ruler-tool-button>\r
	<hr />\r
	<component-hide-drawings-button></component-hide-drawings-button>\r
	<component-clear-drawings-button></component-clear-drawings-button>\r
</div>\r
`,Ny={"clear-drawings-button":"_clear-drawings-button_1x3ps_1"},Iy=`<button class="clear-drawings-button" title="Remove Drawings">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M18 7h5v1h-2.01l-1.33 14.64a1.5 1.5 0 0 1-1.5 1.36H9.84a1.5 1.5 0 0 1-1.49-1.36L7.01 8H5V7h5V6c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v1Zm-6-2a1 1 0 0 0-1 1v1h6V6a1 1 0 0 0-1-1h-4ZM8.02 8l1.32 14.54a.5.5 0 0 0 .5.46h8.33a.5.5 0 0 0 .5-.46L19.99 8H8.02Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var yr,si,Zm,Qm,Km;class jm extends O{constructor(){super(...arguments);f(this,si);f(this,yr,null)}render(){return a(this,si,Zm).call(this),a(this,si,Qm).call(this),this.element}}yr=new WeakMap,si=new WeakSet,Zm=function(){this.element=P.htmlToElement(Iy,[],Ny),g(this,yr,C(this.element))},Qm=function(){o(this,yr).on("click",a(this,si,Km).bind(this))},Km=function(){const e=w.get(_.CHART_API),i=w.get(_.CANDLE_SERIES);if(!e||!i){H.show("warning","No chart data available");return}Nt.removeAll(),Nt.clear()},N(jm,"COMPONENT_NAME","ClearDrawingsButton");const Oy={"full-screen-button":"_full-screen-button_rj2mh_1"},Py=`<button class="full-screen-button" title="Full Screen Mode">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M8.5 6A2.5 2.5 0 0 0 6 8.5V11h1V8.5C7 7.67 7.67 7 8.5 7H11V6H8.5zM6 17v2.5A2.5 2.5 0 0 0 8.5 22H11v-1H8.5A1.5 1.5 0 0 1 7 19.5V17H6zM19.5 7H17V6h2.5A2.5 2.5 0 0 1 22 8.5V11h-1V8.5c0-.83-.67-1.5-1.5-1.5zM22 19.5V17h-1v2.5c0 .83-.67 1.5-1.5 1.5H17v1h2.5a2.5 2.5 0 0 0 2.5-2.5z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Er,ni,tg,eg,ig;class Jm extends O{constructor(){super(...arguments);f(this,ni);f(this,Er,null)}render(){return a(this,ni,tg).call(this),a(this,ni,eg).call(this),this.element}}Er=new WeakMap,ni=new WeakSet,tg=function(){this.element=P.htmlToElement(Py,[],Oy),g(this,Er,C(this.element))},eg=function(){o(this,Er).on("click",a(this,ni,ig).bind(this))},ig=function(){var s,n,h,l;const e=C('[data-ref="chartPanel"]').element;if(!e)return;const i=((s=e.requestFullscreen)==null?void 0:s.bind(e))||((n=e.webkitRequestFullscreen)==null?void 0:n.bind(e))||((h=e.mozRequestFullScreen)==null?void 0:h.bind(e))||((l=e.msRequestFullscreen)==null?void 0:l.bind(e));i&&i()},N(Jm,"COMPONENT_NAME","FullScreenButton");const ky={true:"Show drawing objects",false:"Hide drawing objects"},Ay={"hide-drawings-button":"_hide-drawings-button_a2i4m_1","icon-visible":"_icon-visible_a2i4m_11","icon-hidden":"_icon-hidden_a2i4m_19"},Ry=`<button class="hide-drawings-button" data-active="false" title="Hide Drawings">\r
	<div class="icon-visible">\r
		<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
			<path\r
				fill="currentColor"\r
				fill-rule="evenodd"\r
				d="M5 10.76l-.41-.72-.03-.04.03-.04a15 15 0 012.09-2.9c1.47-1.6 3.6-3.12 6.32-3.12 2.73 0 4.85 1.53 6.33 3.12a15.01 15.01 0 012.08 2.9l.03.04-.03.04a15 15 0 01-2.09 2.9c-1.47 1.6-3.6 3.12-6.32 3.12-2.73 0-4.85-1.53-6.33-3.12a15 15 0 01-1.66-2.18zm17.45-.98L22 10l.45.22-.01.02a5.04 5.04 0 01-.15.28 16.01 16.01 0 01-2.23 3.1c-1.56 1.69-3.94 3.44-7.06 3.44-3.12 0-5.5-1.75-7.06-3.44a16 16 0 01-2.38-3.38v-.02h-.01L4 10l-.45-.22.01-.02a5.4 5.4 0 01.15-.28 16 16 0 012.23-3.1C7.5 4.69 9.88 2.94 13 2.94c3.12 0 5.5 1.75 7.06 3.44a16.01 16.01 0 012.38 3.38v.02h.01zM22 10l.45-.22.1.22-.1.22L22 10zM3.55 9.78L4 10l-.45.22-.1-.22.1-.22zm6.8.22A2.6 2.6 0 0113 7.44 2.6 2.6 0 0115.65 10 2.6 2.6 0 0113 12.56 2.6 2.6 0 0110.35 10zM13 6.44A3.6 3.6 0 009.35 10 3.6 3.6 0 0013 13.56c2 0 3.65-1.58 3.65-3.56A3.6 3.6 0 0013 6.44zm7.85 12l.8-.8.7.71-.79.8a.5.5 0 000 .7l.59.59c.2.2.5.2.7 0l1.8-1.8.7.71-1.79 1.8a1.5 1.5 0 01-2.12 0l-.59-.59a1.5 1.5 0 010-2.12zM16.5 21.5l-.35-.35a.5.5 0 00-.07.07l-1 1.5-1 1.5a.5.5 0 00.42.78h4a2.5 2.5 0 001.73-.77A2.5 2.5 0 0021 22.5a2.5 2.5 0 00-.77-1.73A2.5 2.5 0 0018.5 20a3.1 3.1 0 00-1.65.58 5.28 5.28 0 00-.69.55v.01h-.01l.35.36zm.39.32l-.97 1.46-.49.72h3.07c.34 0 .72-.17 1.02-.48.3-.3.48-.68.48-1.02 0-.34-.17-.72-.48-1.02-.3-.3-.68-.48-1.02-.48-.35 0-.75.18-1.1.42a4.27 4.27 0 00-.51.4z"\r
			></path>\r
		</svg>\r
	</div>\r
	<div class="icon-hidden">\r
		<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
			<path\r
				fill="currentColor"\r
				fill-rule="evenodd"\r
				d="M19.76 6.07l-.7.7a13.4 13.4 0 011.93 2.47c.19.3.33.55.42.72l.03.04-.03.04a15 15 0 01-2.09 2.9c-1.47 1.6-3.6 3.12-6.32 3.12-.98 0-1.88-.2-2.7-.52l-.77.76c1.03.47 2.18.76 3.47.76 3.12 0 5.5-1.75 7.06-3.44a16 16 0 002.38-3.38v-.02h.01L22 10l.45.22.1-.22-.1-.22L22 10l.45-.22-.01-.02a5.1 5.1 0 00-.15-.28 16 16 0 00-2.53-3.41zM6.24 13.93l.7-.7-.27-.29a15 15 0 01-2.08-2.9L4.56 10l.03-.04a15 15 0 012.09-2.9c1.47-1.6 3.6-3.12 6.32-3.12.98 0 1.88.2 2.7.52l.77-.76A8.32 8.32 0 0013 2.94c-3.12 0-5.5 1.75-7.06 3.44a16 16 0 00-2.38 3.38v.02h-.01L4 10l-.45-.22-.1.22.1.22L4 10l-.45.22.01.02a5.5 5.5 0 00.15.28 16 16 0 002.53 3.41zm6.09-.43a3.6 3.6 0 004.24-4.24l-.93.93a2.6 2.6 0 01-2.36 2.36l-.95.95zm-1.97-3.69l-.93.93a3.6 3.6 0 014.24-4.24l-.95.95a2.6 2.6 0 00-2.36 2.36zm11.29 7.84l-.8.79a1.5 1.5 0 000 2.12l.59.59a1.5 1.5 0 002.12 0l1.8-1.8-.71-.7-1.8 1.79a.5.5 0 01-.7 0l-.59-.59a.5.5 0 010-.7l.8-.8-.71-.7zm-5.5 3.5l.35.35-.35-.35.01-.02.02-.02.02-.02a4.68 4.68 0 01.65-.5c.4-.27 1-.59 1.65-.59.66 0 1.28.33 1.73.77.44.45.77 1.07.77 1.73a2.5 2.5 0 01-.77 1.73 2.5 2.5 0 01-1.73.77h-4a.5.5 0 01-.42-.78l1-1.5 1-1.5a.5.5 0 01.07-.07zm.74.67a3.46 3.46 0 01.51-.4c.35-.24.75-.42 1.1-.42.34 0 .72.17 1.02.48.3.3.48.68.48 1.02 0 .34-.17.72-.48 1.02-.3.3-.68.48-1.02.48h-3.07l.49-.72.97-1.46zM21.2 2.5L5.5 18.2l-.7-.7L20.5 1.8l.7.7z"\r
			></path>\r
		</svg>\r
	</div>\r
</button>\r
`;var Ri,Pt,ng,rg,hg,og,ua;class sg extends O{constructor({onActivate:e}){super();f(this,Pt);f(this,Ri,null);this.onActivate=e}render(){return a(this,Pt,rg).call(this),a(this,Pt,hg).call(this),this.element}deactivate(){a(this,Pt,ua).call(this,!1)}}Ri=new WeakMap,Pt=new WeakSet,ng=function(){return o(this,Ri).is("data-active")},rg=function(){this.element=P.htmlToElement(Ry,[],Ay),g(this,Ri,C(this.element))},hg=function(){o(this,Ri).on("click",a(this,Pt,og).bind(this))},og=function(){var n;const e=w.get(_.CHART_API),i=w.get(_.CANDLE_SERIES);if(!e||!i){H.show("warning","No chart data available");return}const s=!o(this,Pt,ng);a(this,Pt,ua).call(this,s),s&&((n=this.onActivate)==null||n.call(this))},ua=function(e){o(this,Ri).data("active",e).attr("title",ky[e?"true":"false"]),e?Nt.hide():Nt.show()},N(sg,"COMPONENT_NAME","HideDrawingsButton");const Ly={"ruler-tool-button":"_ruler-tool-button_njj72_1"},Dy=`<button class="ruler-tool-button" data-active="false" title="Measure">\r
	<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
		<path\r
			fill="currentColor"\r
			d="M2 9.75a1.5 1.5 0 0 0-1.5 1.5v5.5a1.5 1.5 0 0 0 1.5 1.5h24a1.5 1.5 0 0 0 1.5-1.5v-5.5a1.5 1.5 0 0 0-1.5-1.5zm0 1h3v2.5h1v-2.5h3.25v3.9h1v-3.9h3.25v2.5h1v-2.5h3.25v3.9h1v-3.9H22v2.5h1v-2.5h3a.5.5 0 0 1 .5.5v5.5a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-5.5a.5.5 0 0 1 .5-.5z"\r
			transform="rotate(-45 14 14)"\r
		></path>\r
	</svg>\r
</button>\r
`;var We,wt,da,lg,cg,ug,dg,fg;class ag extends O{constructor({onActivate:e}){super();f(this,wt);f(this,We,null);this.onActivate=e}render(){return a(this,wt,lg).call(this),a(this,wt,cg).call(this),this.element}deactivate(){const e=w.get(_.RULER_TOOL);!o(this,wt,da)||!e||(o(this,We).data("active","false"),this.element.blur(),e.deactivate())}}We=new WeakMap,wt=new WeakSet,da=function(){return o(this,We).is("data-active")},lg=function(){this.element=P.htmlToElement(Dy,[],Ly),g(this,We,C(this.element))},cg=function(){o(this,We).on("click",a(this,wt,ug).bind(this)),w.subscribe(_.RULER_ACTIVE,a(this,wt,dg).bind(this))},ug=function(){var e;if(o(this,wt,da))this.deactivate();else{const i=w.get(_.CHART_API),s=w.get(_.CANDLE_SERIES);if(!i||!s){H.show("warning","No chart data available");return}a(this,wt,fg).call(this),(e=this.onActivate)==null||e.call(this)}},dg=function(e){e||this.deactivate()},fg=function(){const e=w.get(_.RULER_TOOL);e&&(o(this,We).data("active","true"),e.initialize())},N(ag,"COMPONENT_NAME","RulerToolButton");const $y={"screenshot-button":"_screenshot-button_ir7q9_1"},zy=`<button class="screenshot-button" title="Take Screenshot">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		width="28"\r
		height="28"\r
		fill="currentColor"\r
	>\r
		<path\r
			fill-rule="evenodd"\r
			clip-rule="evenodd"\r
			d="M11.118 6a.5.5 0 0 0-.447.276L9.809 8H5.5A1.5 1.5 0 0 0 4 9.5v10A1.5 1.5 0 0 0 5.5 21h16a1.5 1.5 0 0 0 1.5-1.5v-10A1.5 1.5 0 0 0 21.5 8h-4.309l-.862-1.724A.5.5 0 0 0 15.882 6h-4.764zm-1.342-.17A1.5 1.5 0 0 1 11.118 5h4.764a1.5 1.5 0 0 1 1.342.83L17.809 7H21.5A2.5 2.5 0 0 1 24 9.5v10a2.5 2.5 0 0 1-2.5 2.5h-16A2.5 2.5 0 0 1 3 19.5v-10A2.5 2.5 0 0 1 5.5 7h3.691l.585-1.17z"\r
		></path>\r
		<path\r
			fill-rule="evenodd"\r
			clip-rule="evenodd"\r
			d="M13.5 18a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7zm0 1a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Mr,ae,mg,gg,vg,bg;class pg extends O{constructor(){super(...arguments);f(this,ae);f(this,Mr,null)}render(){return a(this,ae,mg).call(this),a(this,ae,gg).call(this),this.element}}Mr=new WeakMap,ae=new WeakSet,mg=function(){this.element=P.htmlToElement(zy,[],$y),g(this,Mr,C(this.element))},gg=function(){o(this,Mr).on("click",a(this,ae,vg).bind(this))},vg=function(){const e=w.get(_.CHART_API),i=w.get(_.CANDLE_SERIES);if(!e||!i){H.show("warning","No chart data available");return}e.takeScreenshot().toBlob(a(this,ae,bg),"image/png",1)},bg=function(e){const i=URL.createObjectURL(e),s=window.open(i,"_blank");s&&(s.onload=()=>URL.revokeObjectURL(i))},N(pg,"COMPONENT_NAME","ScreenshotButton");const By={"trendline-tool-button":"_trendline-tool-button_1havz_1"},Fy=`<button class="trendline-tool-button" data-active="false" title="Trend Line">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<g fill="currentColor" fill-rule="nonzero">\r
			<path d="M7.354 21.354l14-14-.707-.707-14 14z"></path>\r
			<path\r
				d="M22.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"\r
			></path>\r
		</g>\r
	</svg>\r
</button>\r
`;var qe,$s,At,it,fa,_g,yg,Eg,Mg,Cg,xg,Tg;class wg extends O{constructor({onActivate:e}){super();f(this,it);f(this,qe,null);f(this,$s,null);f(this,At,[]);this.onActivate=e}render(){return a(this,it,_g).call(this),a(this,it,yg).call(this),this.element}deactivate(){o(this,it,fa)&&(o(this,qe).data("active","false"),this.element.blur(),g(this,At,[]),a(this,it,xg).call(this))}}qe=new WeakMap,$s=new WeakMap,At=new WeakMap,it=new WeakSet,fa=function(){return o(this,qe).is("data-active")},_g=function(){this.element=P.htmlToElement(Fy,[],By),g(this,qe,C(this.element))},yg=function(){o(this,qe).on("click",a(this,it,Eg).bind(this)),g(this,$s,a(this,it,Tg).bind(this)),w.subscribe(_.CANDLE_SERIES,this.deactivate.bind(this))},Eg=function(){var e;if(o(this,it,fa))this.deactivate();else{if(!w.get(_.CANDLE_SERIES)){H.show("warning","No chart data available");return}a(this,it,Mg).call(this),(e=this.onActivate)==null||e.call(this)}},Mg=function(){o(this,qe).data("active","true"),a(this,it,Cg).call(this),H.show("info","Select two points on the chart")},Cg=function(){const e=w.get(_.CHART_API);e&&e.subscribeClick(o(this,$s))},xg=function(){const e=w.get(_.CHART_API);e&&e.unsubscribeClick(o(this,$s))},Tg=function({time:e,point:i}){const s=w.get(_.CHART_API),n=w.get(_.CANDLE_SERIES);if(!s||!n){H.show("warning","No chart data available");return}if(!s||!n)return;const h=e,l=n.coordinateToPrice(i.y);if(!h){H.show("warning","Cannot draw a line outside the chart area"),this.deactivate();return}if(!o(this,At).length){o(this,At).push({time:h,value:l});return}if(h===o(this,At)[0].time){H.show("warning","Cannot draw a vertical line"),this.deactivate();return}const c={time:h,value:l};h>o(this,At)[0].time?o(this,At).push(c):o(this,At).unshift(c),Nt.renderSeries(Vo,pf,o(this,At)),Nt.add("trendlines",o(this,At)),this.deactivate()},N(wg,"COMPONENT_NAME","TrendlineToolButton");var le,Ng,Ig,Og,Pg;class Sg extends O{constructor(){super(...arguments);f(this,le)}render(){return a(this,le,Ng).call(this),a(this,le,Ig).call(this),a(this,le,Og).call(this),this.element}handleTrendlineToolActivate(){this.rulerToolButton.deactivate(),this.hideDrawingsButton.deactivate()}handleRulerToolActivate(){this.trendlineToolButton.deactivate()}handleHideDrawingsButtonActivate(){this.trendlineToolButton.deactivate()}}le=new WeakSet,Ng=function(){this.trendlineToolButton=new wg({onActivate:this.handleTrendlineToolActivate.bind(this)}),this.rulerToolButton=new ag({onActivate:this.handleRulerToolActivate.bind(this)}),this.hideDrawingsButton=new sg({onActivate:this.handleHideDrawingsButtonActivate.bind(this)})},Ig=function(){this.element=P.htmlToElement(Sy,[pg,Jm,this.trendlineToolButton,this.rulerToolButton,this.hideDrawingsButton,jm],Ty)},Og=function(){document.addEventListener("keydown",a(this,le,Pg).bind(this))},Pg=function(e){e.key==="Escape"&&(this.trendlineToolButton.deactivate(),this.rulerToolButton.deactivate())},N(Sg,"COMPONENT_NAME","Toolbox");class kg extends O{render(){return this.element=P.htmlToElement(nv,[Sg,Um,Dd,Gm],sv),this.element}}N(kg,"COMPONENT_NAME","App");class Vy extends js{async getExchanges(){return this._executeRequest({path:"/data/exchanges",method:"GET",errorMessage:"Failed to load supported exchanges"})}async getIntervals(){return this._executeRequest({path:"/data/intervals",method:"GET",errorMessage:"Failed to load supported intervals"})}async getStrategies(){return this._executeRequest({path:"/data/strategies",method:"GET",errorMessage:"Failed to load strategy registry"})}}const Hh=new Vy;class Yy{static async start(){try{console.log("Initializing state..."),await this.initState(),console.log("Initializing services..."),this.initServices(),console.log("Rendering app..."),this.renderApp(),console.log("App initialized successfully!")}catch(t){console.error("App initialization failed:",t)}}static async initState(){const[t,e,i,s]=await Promise.all([Hh.getStrategies(),Hh.getExchanges(),Hh.getIntervals(),St.getAll()]);if(!Object.keys(t).length)throw new Error("No available strategies");const n=Object.keys(s).length?{id:Object.keys(s)[0],...Object.values(s)[0]}:{};w.set(_.STRATEGIES,t),w.set(_.EXCHANGES,e),w.set(_.INTERVALS,i),w.set(_.EXECUTION_CONTEXTS,s),w.set(_.EXECUTION_CONTEXT,n)}static initServices(){Nt.init(),tv.init(),Dr.init()}static renderApp(){C("#app").append(new kg().render())}}requestAnimationFrame(()=>{Yy.start()});
