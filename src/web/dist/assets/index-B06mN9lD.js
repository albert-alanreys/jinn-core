var zg=Object.defineProperty;var Oa=r=>{throw TypeError(r)};var Lg=(r,t,e)=>t in r?zg(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var N=(r,t,e)=>Lg(r,typeof t!="symbol"?t+"":t,e),Ch=(r,t,e)=>t.has(r)||Oa("Cannot "+e);var o=(r,t,e)=>(Ch(r,t,"read from private field"),e?e.call(r):t.get(r)),f=(r,t,e)=>t.has(r)?Oa("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),g=(r,t,e,i)=>(Ch(r,t,"write to private field"),i?i.call(r,e):t.set(r,e),e),a=(r,t,e)=>(Ch(r,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();class wn{constructor(t){if(typeof t=="string"){if(this.element=document.querySelector(t),!this.element)throw new Error(`No element found for the selector: "${t}"`)}else if(t instanceof Element||t instanceof Document)this.element=t;else throw new Error("The selector must be a string, HTMLElement, or Document")}find(t){const e=new wn(this.element.querySelector(t));if(e)return e;throw new Error(`No element found for the selector: "${t}"`)}findAll(t){const e=this.element.querySelectorAll(t);return Array.from(e).map(i=>new wn(i))}closest(t){const e=this.element.closest(t);return e?new wn(e):null}append(t){if(!(t instanceof HTMLElement))throw new Error("The provided childElement must be an instance of HTMLElement");return this.element.appendChild(t),this}prepend(t){if(!(t instanceof HTMLElement))throw new Error("The provided childElement must be an instance of HTMLElement");const e=this.element.firstChild;return e?this.element.insertBefore(t,e):this.element.appendChild(t),this}before(t){if(!(t instanceof HTMLElement))throw new Error("The provided newElement must be an instance of HTMLElement");const e=this.element.parentElement;if(!e)throw new Error("The current element does not have a parent element");return e.insertBefore(t,this.element),this}html(t){return typeof t>"u"?this.element.innerHTML:(this.element.innerHTML=t,this)}text(t){return typeof t>"u"?this.element.textContent:(this.element.textContent=t,this)}click(t){return this.element.addEventListener("click",t),this}on(t,e){if(typeof t!="string"||typeof e!="function")throw new Error("eventType must be a string and callback must be a function");return this.element.addEventListener(t,e),this}off(t,e){if(typeof t!="string")throw new Error("eventType must be a string");if(e)this.element.removeEventListener(t,e);else if(this.element instanceof Document){const i=()=>{};this.element.addEventListener(t,i),this.element.removeEventListener(t,i)}else{const i=this.element.cloneNode(!0);this.element.parentNode.replaceChild(i,this.element),this.element=i}return this}trigger(t,e={},i={}){if(typeof t!="string")throw new Error("Event name must be a string");const s=new CustomEvent(t,{detail:e,bubbles:i.bubbles??!0,cancelable:i.cancelable??!0,composed:i.composed??!1});return this.element.dispatchEvent(s)}input({onInput:t,...e}){if(this.element.tagName.toLowerCase()!=="input")throw new Error("Element must be an input");for(const[i,s]of Object.entries(e))this.element.setAttribute(i,s);return t&&this.element.addEventListener("input",t),this}css(t,e){if(typeof t=="string"&&typeof e>"u")return window.getComputedStyle(this.element).getPropertyValue(t);if(typeof t=="object")for(const[i,s]of Object.entries(t))this.element.style[i]=s;else if(typeof t=="string"&&e)this.element.style[t]=e;else throw new Error("Invalid arguments");return this}cursor(t){return this.element===document?document.body.style.cursor=t:this.element.style.cursor=t,this}addClass(t){if(Array.isArray(t))for(const e of t)this.element.classList.add(e);else if(typeof t=="string")this.element.classList.add(t);else throw new Error('The "classNames" parameter must be a string or an array of strings');return this}removeClass(t){if(Array.isArray(t))for(const e of t)this.element.classList.remove(e);else this.element.classList.remove(t);return this}hasClass(t){if(typeof t!="string")throw new Error("Class name must be a string");return this.element.classList.contains(t)}attr(t,e){if(typeof t!="string")throw new Error("Attribute name must be a string");return typeof e>"u"?this.element.getAttribute(t):(this.element.setAttribute(t,e),this)}data(t,e){if(typeof t!="string")throw new Error("Key must be a string");const i=`data-${t}`;return typeof e>"u"?this.element.getAttribute(i):(this.element.setAttribute(i,e),this)}is(t){if(typeof t!="string")throw new Error("Attribute name must be a string");const e=this.element.getAttribute(t);return e!==null&&e!=="false"}removeAttr(t){if(typeof t!="string")throw new Error("attrName must be a string");return this.element.removeAttribute(t),this}}const M=r=>new wn(r);var Qr,Ll;class Pg{constructor(){f(this,Qr);this.state={},this.subscribers=new Map}set(t,e){this.state[t]=e,a(this,Qr,Ll).call(this,t,e)}get(t){return this.state[t]}subscribe(t,e){this.subscribers.has(t)||this.subscribers.set(t,new Set),this.subscribers.get(t).add(e)}unsubscribe(t,e){if(this.subscribers.has(t)){const i=this.subscribers.get(t);i.delete(e),i.size===0&&this.subscribers.delete(t)}}}Qr=new WeakSet,Ll=function(t,e){var i;(i=this.subscribers.get(t))==null||i.forEach(s=>s(e))};const b=new Pg;var ai,rn;class Dg{constructor(){f(this,ai)}getItem(t){if(!a(this,ai,rn).call(this))return console.warn("localStorage is not available."),null;const e=localStorage.getItem(t);if(e===null)return null;try{return JSON.parse(e)}catch(i){return console.error(`Failed to parse localStorage item: "${t}"`,i),null}}setItem(t,e){if(!a(this,ai,rn).call(this)){console.warn("localStorage is not available.");return}localStorage.setItem(t,JSON.stringify(e))}removeItem(t){if(!a(this,ai,rn).call(this)){console.warn("localStorage is not available.");return}localStorage.removeItem(t)}clear(){if(!a(this,ai,rn).call(this)){console.warn("localStorage is not available.");return}localStorage.clear()}}ai=new WeakSet,rn=function(){try{const t="__test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch{return!1}};const j=new Dg,w={CANDLE_SERIES:"candleSeries",CHART_API:"chartApi",SELECTED_TIME:"selectedTime",RULER_ACTIVE:"rulerActive",RULER_TOOL:"rulerTool",STRATEGIES:"strategies",EXCHANGES:"exchanges",INTERVALS:"intervals",EXECUTION_CONTEXTS:"executionContexts",EXECUTION_CONTEXT:"executionContext",EXECUTION_ALERTS:"executionAlerts",OPTIMIZATION_CONTEXTS:"optimizationContexts",THEME:"theme"},Q={OPTIMIZATION_CONFIGS:"optimizationConfigs",BACKTESTING_CONFIGS:"backtestingConfigs",TRADING_CONFIGS:"tradingConfigs",DRAWINGS:"drawings",THEME:"theme"};function Pl(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Expected a plain object");return Object.fromEntries(Object.entries(r).map(([t,e])=>[t.replace(/[A-Z]/g,i=>`_${i.toLowerCase()}`),e]))}const Bg=typeof window.SERVER_URL=="string"&&!window.SERVER_URL.startsWith("{")?window.SERVER_URL:void 0;function Ia(r){if(typeof r=="string")return r;if(r!=null&&r.message){if(typeof r.message=="string")return r.message;if(Array.isArray(r.message))return r.message[0]}return r!=null&&r.type?r.type:typeof r=="object"?JSON.stringify(r):"Unknown error occurred"}async function $g({path:r,method:t="GET",body:e=null,headers:i={}}){let s=!0,n=null,h=null;const l=`${Bg}${r}`,c={method:t,headers:{"Content-Type":"application/json",...i}};e&&(c.body=JSON.stringify(e));try{const u=await fetch(l,c);if(u.ok)h=await u.json();else{const d=await u.json();n=Ia(d)}}catch(u){n=Ia(u)}finally{s=!1}return{isLoading:s,data:h,error:n}}const Vg="_notification_1wo9y_1",Fg="_visible_1wo9y_25",Yg="_content_1wo9y_33",Xg="_info_1wo9y_51",Hg="_success_1wo9y_59",Ug="_warning_1wo9y_67",Wg="_error_1wo9y_75",Lr={notification:Vg,"slide-up-fade":"_slide-up-fade_1wo9y_1",visible:Fg,content:Yg,info:Xg,success:Hg,warning:Ug,error:Wg};var os,li,Ln,Hh;class qg{constructor(){f(this,Ln);f(this,os,[]);f(this,li,!1)}show(t,e){if(!["info","success","warning","error"].includes(t))throw new Error('Invalid notification type: expected "success" or "error"');o(this,os).push({type:t,message:e}),o(this,li)||a(this,Ln,Hh).call(this)}}os=new WeakMap,li=new WeakMap,Ln=new WeakSet,Hh=function(){if(!o(this,os).length||o(this,li))return;const t=M('[data-ref="notification"]'),{type:e,message:i}=o(this,os).shift(),s=Lr[e],n=parseFloat(t.css("animation-duration"))*1e3,h=n+100,l=n+500;t.find('[data-field="content"]').text(i),t.addClass(Lr.visible),t.addClass(s),g(this,li,!0),setTimeout(()=>{t.removeClass(Lr.visible),t.removeClass(s),g(this,li,!1)},h),setTimeout(()=>{a(this,Ln,Hh).call(this)},l)};const X=new qg;var Gr,Fs,Dl,Bl;class Qs{constructor(){f(this,Fs);f(this,Gr,"/api")}async _executeRequest({path:t,method:e,body:i,queryParams:s,errorMessage:n}){try{const{data:h,error:l}=await $g({path:a(this,Fs,Dl).call(this,t,s),method:e,body:i});if(l)throw new Error(l);return h}catch(h){throw a(this,Fs,Bl).call(this,n),h}}_validateRequired(t,e){const i=Object.entries(t).filter(([s,n])=>!n).map(([s])=>s);if(i.length)throw new Error(e||`Missing required parameters: ${i.join(", ")}`)}}Gr=new WeakMap,Fs=new WeakSet,Dl=function(t,e){let i=`${o(this,Gr)}${t}`;if(e){const s=new URLSearchParams;Object.entries(e).forEach(([n,h])=>{h!=null&&s.append(n,h.toString())}),i+=`?${s.toString()}`}return i},Bl=function(t){try{t&&X.show("error",t)}catch(e){console.error("Notification display failed:",e)}};class jg extends Qs{async getAll(){return this._executeRequest({path:"/contexts/execution",method:"GET",errorMessage:"Failed to load execution contexts"})}async get(t,e){this._validateRequired({contextId:t},"contextId is required");const i=e?Pl({updatedAfter:e}):void 0;return this._executeRequest({path:`/contexts/execution/${t}`,method:"GET",queryParams:i,errorMessage:"Failed to load execution context data"})}async add(t){return this._validateRequired({configs:t},"configs is required"),this._executeRequest({path:"/contexts/execution",method:"POST",body:t,errorMessage:"Failed to add execution contexts"})}async update(t,e,i){return this._validateRequired({contextId:t,param:e},"contextId and param are required"),this._executeRequest({path:`/contexts/execution/${t}`,method:"PATCH",body:{param:e,value:i},errorMessage:"Failed to update execution context parameter"})}async delete(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/contexts/execution/${t}`,method:"DELETE",errorMessage:"Failed to delete execution context"})}async getAllStatuses(){return this._executeRequest({path:"/contexts/execution/status",method:"GET",errorMessage:"Failed to load execution contexts statuses"})}async getStatus(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/contexts/execution/${t}/status`,method:"GET",errorMessage:"Failed to load execution context status"})}}const St=new jg;var as,Xt,se,Uh,Wh,$l;class Qg{constructor(){f(this,se);f(this,as,!0);f(this,Xt,[])}get isVisible(){return o(this,as)}async init(){const t=await St.getAllStatuses(),e=Object.entries(t).filter(([s,n])=>n==="READY").map(([s])=>s);this.getTypes().forEach(s=>{a(this,se,$l).call(this,e,s)})}show(){o(this,Xt).length&&(o(this,Xt).forEach(t=>{t.applyOptions({visible:!0})}),g(this,as,!0))}hide(){o(this,Xt).length&&(o(this,Xt).forEach(t=>{t.applyOptions({visible:!1})}),g(this,as,!1))}get(t){var s;const e=a(this,se,Uh).call(this);return e?((s=(j.getItem(Q.DRAWINGS)||{})[t])==null?void 0:s[e])||[]:[]}add(t,e){const i=this.get(t);this.set(t,[e,...i])}set(t,e){const i=a(this,se,Uh).call(this);if(!i)return;const s=j.getItem(Q.DRAWINGS)||{};s[t]||(s[t]={}),s[t][i]=e,j.setItem(Q.DRAWINGS,s)}clear(t=null){t?this.set(t,[]):this.getTypes().forEach(i=>this.set(i,[]))}getTypes(){const t=j.getItem(Q.DRAWINGS)||{};return Object.keys(t)}renderSeries(t,e,i){const s=a(this,se,Wh).call(this);if(!s)return;const n=s.addSeries(t,e);n.setData(i),o(this,Xt).push(n)}removeAll(){const t=a(this,se,Wh).call(this);t&&(o(this,Xt).forEach(e=>t.removeSeries(e)),g(this,Xt,[]))}}as=new WeakMap,Xt=new WeakMap,se=new WeakSet,Uh=function(){return b.get(w.EXECUTION_CONTEXT).id||null},Wh=function(){return b.get(w.CHART_API)||null},$l=function(t,e){const i=j.getItem(Q.DRAWINGS)||{},s=i[e]||{},n=Object.fromEntries(Object.entries(s).filter(([h])=>t.includes(h)));j.setItem(Q.DRAWINGS,{...i,[e]:n})};const Nt=new Qg;var Zr,ci,Pn,Dn,Te,Wi;class Gg{constructor(){f(this,Te);f(this,Zr,"data-theme");f(this,ci,"light");f(this,Pn,"dark");f(this,Dn,"auto")}get LIGHT(){return o(this,ci)}get DARK(){return o(this,Pn)}get AUTO(){return o(this,Dn)}init(){const t=j.getItem(Q.THEME)||o(this,ci);return a(this,Te,Wi).call(this,t),t}toggle(){const e=this.get()===this.LIGHT?this.DARK:this.LIGHT;return a(this,Te,Wi).call(this,e),e}get(){return b.get(w.THEME)||o(this,ci)}setLightTheme(){a(this,Te,Wi).call(this,o(this,ci))}setDarkTheme(){a(this,Te,Wi).call(this,o(this,Pn))}setAutoTheme(){a(this,Te,Wi).call(this,o(this,Dn))}}Zr=new WeakMap,ci=new WeakMap,Pn=new WeakMap,Dn=new WeakMap,Te=new WeakSet,Wi=function(t){document.documentElement.setAttribute(o(this,Zr),t),j.setItem(Q.THEME,t),b.set(w.THEME,t)};const Pr=new Gg,Zg=100,Aa={status:{filled:"green",pending:"gray",cancelled:"red"},side:{buy:"green",sell:"red"}},Vl=1e3,qh=5e3;class Kg extends Qs{async get({limit:t,sinceId:e}={}){e&&this._validateRequired({sinceId:e},"sinceId is required");const i={};t&&(i.limit=t),e&&(i.sinceId=e);const s=Object.keys(i).length?Pl(i):void 0;return this._executeRequest({path:"/alerts",method:"GET",queryParams:s,errorMessage:"Failed to load alerts"})}async delete(t){return this._validateRequired({alertId:t},"alertId is required"),this._executeRequest({path:`/alerts/${t}`,method:"DELETE",errorMessage:"Failed to delete alert"})}}const jh=new Kg;var xe,Se,nt,Qh,Gh,Fl,Zh,Yl,Kh;class Jg{constructor(){f(this,nt);f(this,xe,null);f(this,Se,null)}init(){b.subscribe(w.EXECUTION_CONTEXT,a(this,nt,Qh).bind(this)),b.subscribe(w.EXECUTION_CONTEXTS,a(this,nt,Gh).bind(this)),a(this,nt,Qh).call(this,b.get(w.EXECUTION_CONTEXT)),a(this,nt,Gh).call(this,b.get(w.EXECUTION_CONTEXTS))}}xe=new WeakMap,Se=new WeakMap,nt=new WeakSet,Qh=function(t){if(!t||!Object.keys(t).length){a(this,nt,Zh).call(this);return}t.isLive?a(this,nt,Fl).call(this):a(this,nt,Zh).call(this)},Gh=function(t){if(!t||!Object.keys(t).length){a(this,nt,Kh).call(this);return}Object.values(t).some(i=>i==null?void 0:i.isLive)?a(this,nt,Yl).call(this):a(this,nt,Kh).call(this)},Fl=function(){o(this,xe)===null&&g(this,xe,setInterval(async()=>{try{const t=b.get(w.CANDLE_SERIES),e=b.get(w.EXECUTION_CONTEXT);if(!e.id||!t)return;const i=await St.get(e.id,t.data().at(-1).time*1e3);if(Object.keys(i).length){const[[s,n]]=Object.entries(i);b.set(w.EXECUTION_CONTEXT,{id:s,...n})}}catch(t){console.error("Failed to fetch updated context.",t)}},qh))},Zh=function(){o(this,xe)!==null&&(clearInterval(o(this,xe)),g(this,xe,null))},Yl=function(){o(this,Se)===null&&g(this,Se,setInterval(async()=>{try{const t=b.get(w.EXECUTION_ALERTS)||[],e=t.length?t.at(-1).alertId:null,i=e?await jh.get({sinceId:e}):await jh.get({limit:Zg});i.length&&b.set(w.EXECUTION_ALERTS,i)}catch(t){console.error("Failed to fetch alerts.",t)}},qh))},Kh=function(){o(this,Se)!==null&&(clearInterval(o(this,Se)),g(this,Se,null))};const tv=new Jg;class I{render(){throw new Error("Render method must be implemented in the child class")}}var Ys,Xl,Hl;class ev{constructor(){f(this,Ys)}htmlToElement(t,e=[],i=null){const h=new DOMParser().parseFromString(t,"text/html").body.firstElementChild;return i&&a(this,Ys,Hl).call(this,h,i),a(this,Ys,Xl).call(this,h,e),h}}Ys=new WeakSet,Xl=function(t,e){const i=new Map,s=t.querySelectorAll("*");e.map(h=>h instanceof I?h:new h).forEach(h=>{const l=h.constructor.COMPONENT_NAME.toLowerCase();i.set(l,h)}),s.forEach(h=>{const c=h.tagName.toLowerCase().replace(/^component-/,"").replace(/-/g,""),u=i.get(c);if(u){const d=u.render();h.replaceWith(d)}})},Hl=function(t,e){if(!t||!e)return;const i=t.querySelectorAll("[class]");[t,...i].forEach(s=>{for(const[n,h]of Object.entries(e))s.classList.contains(n)&&s.classList.replace(n,h)})};const A=new ev,iv="_app_od8n2_1",sv={app:iv},nv=`<div class="app">\r
	<component-toolbox></component-toolbox>\r
	<component-dashboard></component-dashboard>\r
	<component-controller></component-controller>\r
	<component-notification></component-notification>\r
</div>\r
`,rv="_controller_1qyyi_1",hv={controller:rv},ov=`<div class="controller">\r
	<component-controller-content></component-controller-content>\r
	<component-controller-sidebar></component-controller-sidebar>\r
</div>\r
`,av={"controller-content":"_controller-content_1r5el_1"},lv=`<div class="controller-content">\r
	<component-strategies-tab></component-strategies-tab>\r
	<component-params-tab></component-params-tab>\r
	<component-alerts-tab></component-alerts-tab>\r
	<component-optimization-tab></component-optimization-tab>\r
	<component-backtesting-tab></component-backtesting-tab>\r
	<component-trading-tab></component-trading-tab>\r
	<component-theme></component-theme>\r
</div>\r
`,cv="_header_11wty_13",uv="_items_11wty_33",dv={"alerts-tab":"_alerts-tab_11wty_1",header:cv,items:uv},fv=`<div class="alerts-tab">\r
	<div class="header"><span>Live Trading Alerts</span></div>\r
	<div class="items" data-ref="alertsItems"></div>\r
</div>\r
`,pv={"delete-button":"_delete-button_5orrh_1"},mv=`<button class="delete-button" data-ref="deleteButton" title="">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 18 18"\r
		width="18"\r
		height="18"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M12 4h3v1h-1.04l-.88 9.64a1.5 1.5 0 0 1-1.5 1.36H6.42a1.5 1.5 0 0 1-1.5-1.36L4.05 5H3V4h3v-.5C6 2.67 6.67 2 7.5 2h3c.83 0 1.5.67 1.5 1.5V4ZM7.5 3a.5.5 0 0 0-.5.5V4h4v-.5a.5.5 0 0 0-.5-.5h-3ZM5.05 5l.87 9.55a.5.5 0 0 0 .5.45h5.17a.5.5 0 0 0 .5-.45L12.94 5h-7.9Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Bn;class Gs extends I{constructor({title:e}){super();f(this,Bn);g(this,Bn,e)}render(){return this.element=A.htmlToElement(mv,[],pv),M(this.element).attr("title",o(this,Bn)),this.element}}Bn=new WeakMap,N(Gs,"COMPONENT_NAME","DeleteButton");const gv={"open-button":"_open-button_174e9_1"},vv=`<button class="open-button" data-ref="openButton" title="">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
		fill="none"\r
	>\r
		<path\r
			fill="currentColor"\r
			fill-rule="evenodd"\r
			clip-rule="evenodd"\r
			d="M14 9.5a.5.5 0 0 0 1 0V7.02A6.5 6.5 0 0 1 20.98 13H18.5a.5.5 0 0 0 0 1h2.48A6.5 6.5 0 0 1 15 19.98V17.5a.5.5 0 0 0-1 0v2.48A6.5 6.5 0 0 1 8.02 14h2.48a.5.5 0 0 0 0-1H8.02A6.5 6.5 0 0 1 14 7.02V9.5zm1-3.48V4.5a.5.5 0 0 0-1 0v1.52A7.5 7.5 0 0 0 7.02 13H5.5a.5.5 0 0 0 0 1h1.52A7.5 7.5 0 0 0 14 20.98v1.52a.5.5 0 0 0 1 0v-1.52A7.5 7.5 0 0 0 21.98 14h1.52a.5.5 0 0 0 0-1h-1.52A7.5 7.5 0 0 0 15 6.02z"\r
		></path>\r
	</svg>\r
</button>\r
`;var $n;class ih extends I{constructor({title:e}){super();f(this,$n);g(this,$n,e)}render(){return this.element=A.htmlToElement(vv,[],gv),M(this.element).attr("title",o(this,$n)),this.element}}$n=new WeakMap,N(ih,"COMPONENT_NAME","OpenButton");const bv="_header_16bdh_11",wv="_details_16bdh_119",_v="_red_16bdh_145",yv="_green_16bdh_153",Ev="_gray_16bdh_161",ka={"alerts-item":"_alerts-item_16bdh_1",header:bv,"meta-info":"_meta-info_16bdh_29","strategy-name":"_strategy-name_16bdh_47","date-time":"_date-time_16bdh_59",details:wv,"field-row":"_field-row_16bdh_129",red:_v,green:yv,gray:Ev},Cv=`<div\r
	class="alerts-item"\r
	data-active="false"\r
	data-context-id=""\r
	data-alert-id=""\r
>\r
	<div class="header">\r
		<div class="meta-info">\r
			<span class="strategy-name" data-field="strategy"></span>\r
			<span class="date-time" data-field="time"></span>\r
		</div>\r
		<open-button></open-button>\r
		<delete-button></delete-button>\r
	</div>\r
	<div class="details">\r
		<div class="field-row">\r
			<span>Exchange</span><span data-field="exchange"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Type</span><span data-field="type"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Status</span><span data-field="status"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Side</span><span data-field="side"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Symbol</span><span data-field="symbol"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Quantity</span><span data-field="qty"></span>\r
		</div>\r
		<div class="field-row">\r
			<span>Price</span><span data-field="price"></span>\r
		</div>\r
	</div>\r
</div>\r
`;var ui,Vn,Xs,Wl,ql;class Ul extends I{constructor(){super(...arguments);f(this,Xs);f(this,ui,null);f(this,Vn,new Map)}render(){return a(this,Xs,Wl).call(this),a(this,Xs,ql).call(this),this.element}update(e){o(this,Vn).forEach((i,s)=>{o(this,ui).data("context-id",e.contextId),o(this,ui).data("alert-id",e.alertId);const n=e[s];if(i.text(n),Aa[s]){const h=ka[Aa[s][n]];h&&i.addClass(h)}})}remove(){this.element.remove()}}ui=new WeakMap,Vn=new WeakMap,Xs=new WeakSet,Wl=function(){this.element=A.htmlToElement(Cv,[new ih({title:"Open Strategy"}),new Gs({title:"Delete Alert"})],ka),g(this,ui,M(this.element))},ql=function(){o(this,ui).findAll("[data-field]").forEach(e=>{const i=e.data("field");o(this,Vn).set(i,e)})},N(Ul,"COMPONENT_NAME","AlertsItem");var de,Fn,di,Z,Ql,Gl,Zl,Kl,Jl,tc,ec,Jh,ic;class jl extends I{constructor(){super(...arguments);f(this,Z);f(this,de,null);f(this,Fn,null);f(this,di,new Map)}get isActive(){return o(this,de).css("display")==="flex"}render(){return a(this,Z,Ql).call(this),a(this,Z,Gl).call(this),this.element}show(){o(this,de).css("display","flex")}hide(){o(this,de).css("display","none")}}de=new WeakMap,Fn=new WeakMap,di=new WeakMap,Z=new WeakSet,Ql=function(){this.element=A.htmlToElement(fv,[],dv),g(this,de,M(this.element)),g(this,Fn,o(this,de).find('[data-ref="alertsItems"]'))},Gl=function(){a(this,Z,Zl).call(this),a(this,Z,Kl).call(this)},Zl=function(){(b.get(w.EXECUTION_ALERTS)||[]).forEach(i=>{a(this,Z,Jh).call(this,i.alertId,i)})},Kl=function(){o(this,de).click(a(this,Z,Jl).bind(this)),b.subscribe(w.EXECUTION_ALERTS,a(this,Z,ec).bind(this))},Jl=function(e){const i=M(e.target),s=i.closest("[data-alert-id]");if(!s)return;if(i.closest('[data-ref="openButton"]')){a(this,Z,tc).call(this,s.data("context-id"));return}if(i.closest('[data-ref="deleteButton"]')){a(this,Z,ic).call(this,s.data("alert-id"));return}const n=s.is("data-active");s.data("active",String(!n))},tc=function(e){const i=b.get(w.EXECUTION_CONTEXTS);if(!i[e]||b.get(w.EXECUTION_CONTEXT).id===e)return;const n=i[e];b.set(w.EXECUTION_CONTEXT,{id:e,...n})},ec=function(e){e.length&&e.forEach(i=>{o(this,di).has(i.alertId)||a(this,Z,Jh).call(this,i.alertId,i)})},Jh=function(e,i){const s=new Ul;o(this,Fn).prepend(s.render()),o(this,di).set(e,s),s.update(i)},ic=async function(e){try{await jh.delete(e);const s=(b.get(w.EXECUTION_ALERTS)||[]).filter(h=>h.alertId!==e);b.set(w.EXECUTION_ALERTS,s);const n=o(this,di).get(e);n&&(n.remove(),o(this,di).delete(e))}catch(i){console.error("Failed to delete alert.",i)}},N(jl,"COMPONENT_NAME","AlertsTab");const Mv={"add-config-button":"_add-config-button_ljgtp_1"},Tv=`<button\r
	class="add-config-button"\r
	title="Add New Setting"\r
	data-ref="addConfigButton"\r
>\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M13.5 6a8.5 8.5 0 1 0 0 17 8.5 8.5 0 0 0 0-17zM4 14.5a9.5 9.5 0 1 1 19 0 9.5 9.5 0 0 1-19 0z"\r
		></path>\r
		<path fill="currentColor" d="M9 14h4v-4h1v4h4v1h-4v4h-1v-4H9v-1z"></path>\r
	</svg>\r
</button>\r
`;class sh extends I{render(){return this.element=A.htmlToElement(Tv,[],Mv),this.element}}N(sh,"COMPONENT_NAME","AddConfigButton");const xv={"clone-configs-button":"_clone-configs-button_18bpk_1"},Sv=`<button\r
	class="clone-configs-button"\r
	title="Clone All Settings"\r
	data-ref="cloneConfigsButton"\r
>\r
	<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
		<g fill="none" fill-rule="evenodd" stroke="currentColor">\r
			<path\r
				d="M13.111 18.5H10.5a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1h11a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1h-8.389z"\r
			></path>\r
			<path\r
				d="M18.5 20v1.5a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1H8"\r
			></path>\r
		</g>\r
	</svg>\r
</button>\r
`;class nh extends I{render(){return this.element=A.htmlToElement(Sv,[],xv),this.element}}N(nh,"COMPONENT_NAME","CloneConfigsButton");const Nv={"delete-configs-button":"_delete-configs-button_ufjy9_1"},Ov=`<button\r
	class="delete-configs-button"\r
	title="Delete All Settings"\r
	data-ref="deleteConfigsButton"\r
>\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M18 7h5v1h-2.01l-1.33 14.64a1.5 1.5 0 0 1-1.5 1.36H9.84a1.5 1.5 0 0 1-1.49-1.36L7.01 8H5V7h5V6c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v1Zm-6-2a1 1 0 0 0-1 1v1h6V6a1 1 0 0 0-1-1h-4ZM8.02 8l1.32 14.54a.5.5 0 0 0 .5.46h8.33a.5.5 0 0 0 .5-.46L19.99 8H8.02Z"\r
		></path>\r
	</svg>\r
</button>\r
`;class rh extends I{render(){return this.element=A.htmlToElement(Ov,[],Nv),this.element}}N(rh,"COMPONENT_NAME","DeleteConfigsButton");const Iv={"export-configs-button":"_export-configs-button_17896_1"},Av=`<button\r
	class="export-configs-button"\r
	title="Export All Settings"\r
	data-ref="exportConfigsButton"\r
>\r
	<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none">\r
		<path\r
			stroke="currentColor"\r
			d="M6.5 16v4.5a1 1 0 001 1h14a1 1 0 001-1V16M14.5 5V17m-4-3.5l4 4l4-4"\r
		></path>\r
	</svg>\r
</button>\r
`;class hh extends I{render(){return this.element=A.htmlToElement(Av,[],Iv),this.element}}N(hh,"COMPONENT_NAME","ExportConfigsButton");const kv={"import-configs-button":"_import-configs-button_1ldac_1"},Rv=`<button\r
	class="import-configs-button"\r
	title="Import Settings"\r
	data-ref="importConfigsButton"\r
>\r
	<input type="file" accept=".json,.txt,.config" data-ref="fileInput" />\r
	<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none">\r
		<path\r
			stroke="currentColor"\r
			d="M21.5 12v-4.5a1 1 0 00-1-1h-14a1 1 0 00-1 1V12M13.5 23V11m4 3.5l-4-4-4 4"\r
		></path>\r
	</svg>\r
</button>\r
`;var Yn,ls;class oh extends I{constructor(){super(...arguments);f(this,Yn,null);f(this,ls,null)}render(){return this.element=A.htmlToElement(Rv,[],kv),g(this,Yn,M(this.element)),g(this,ls,o(this,Yn).find('[data-ref="fileInput"]')),this.element}clickOnInput(){o(this,ls).element.click()}resetInput(){o(this,ls).element.value=""}}Yn=new WeakMap,ls=new WeakMap,N(oh,"COMPONENT_NAME","ImportConfigsButton");const zv={"run-configs-button":"_run-configs-button_ltwyy_1"},Lv=`<button\r
	class="run-configs-button"\r
	title="Run All Settings"\r
	data-ref="runConfigsButton"\r
>\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			fill-rule="evenodd"\r
			d="m10.997 6.93 7.834 6.628a.58.58 0 0 1 0 .88l-7.834 6.627c-.359.303-.897.04-.897-.44V7.37c0-.48.538-.743.897-.44Zm8.53 5.749a1.741 1.741 0 0 1 0 2.637l-7.834 6.628c-1.076.91-2.692.119-2.692-1.319V7.37c0-1.438 1.616-2.23 2.692-1.319l7.834 6.628Z"\r
		></path>\r
	</svg>\r
</button>\r
`;class ah extends I{render(){return this.element=A.htmlToElement(Lv,[],zv),this.element}}N(ah,"COMPONENT_NAME","RunConfigsButton");const D={QUEUED:"QUEUED",CREATING:"CREATING",READY:"READY",FAILED:"FAILED"};function pa(r,t="configs.json"){if(!r||typeof r!="object"||Array.isArray(r))return console.warn("Export failed: Invalid configs object"),!1;try{const e=JSON.stringify(r,null,2),i=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(i),n=document.createElement("a");return n.href=s,n.download=t,n.style.display="none",document.body.appendChild(n),n.click(),setTimeout(()=>{document.body.removeChild(n),URL.revokeObjectURL(s)},100),!0}catch(e){return console.error("Failed to export configs:",e),!1}}function ma(r,t=[]){return!r||typeof r!="object"||Array.isArray(r)?!1:t.every(e=>e in r)}const Pv="_header_14ksy_13",Dv="_items_14ksy_33",Bv="_footer_14ksy_47",$v={"backtesting-tab":"_backtesting-tab_14ksy_1",header:Pv,items:Dv,footer:Bv,"left-buttons":"_left-buttons_14ksy_65","right-buttons":"_right-buttons_14ksy_67"},Vv=`<div class="backtesting-tab">\r
	<div class="header"><span>Backtesting Settings</span></div>\r
	<div class="items" data-ref="configItems"></div>\r
	<div class="footer">\r
		<div class="left-buttons">\r
			<component-delete-configs-button></component-delete-configs-button>\r
			<component-import-configs-button></component-import-configs-button>\r
			<component-export-configs-button></component-export-configs-button>\r
		</div>\r
		<div class="right-buttons">\r
			<component-add-config-button></component-add-config-button>\r
			<component-clone-configs-button></component-clone-configs-button>\r
			<component-run-configs-button></component-run-configs-button>\r
		</div>\r
	</div>\r
</div>\r
`,Fv={"run-button":"_run-button_r4w3j_1"},Yv=`<button class="run-button" data-ref="runButton" title="">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 18 18"\r
		width="18"\r
		height="18"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M2 9a7 7 0 1 1 14 0A7 7 0 0 1 2 9zm7-8a8 8 0 1 0 0 16A8 8 0 0 0 9 1zM7.79 5.09A.5.5 0 0 0 7 5.5v7a.5.5 0 0 0 .79.41l5-3.5a.5.5 0 0 0 0-.82l-5-3.5zM11.63 9L8 11.54V6.46L11.63 9z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Xn;class lh extends I{constructor({title:e}){super();f(this,Xn);g(this,Xn,e)}render(){return this.element=A.htmlToElement(Yv,[],Fv),M(this.element).attr("title",o(this,Xn)),this.element}}Xn=new WeakMap,N(lh,"COMPONENT_NAME","RunButton");const Xv={"date-input":"_date-input_u2rdp_1"},Hv=`<div class="date-input" data-ref="dateInput">\r
	<input type="text" placeholder="yyyy-mm-dd" />\r
</div>\r
`;var Hn,cs,us,Un,to;class In extends I{constructor(){super(...arguments);f(this,Un);f(this,Hn,null);f(this,cs,null);f(this,us)}get value(){return o(this,cs).element.value}render(){return this.element=A.htmlToElement(Hv,[],Xv),g(this,Hn,M(this.element)),g(this,cs,o(this,Hn).find("input")),this.element}update(e){g(this,us,e),a(this,Un,to).call(this)}isValid(){const e=this.value;if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;const s=new Date(e);return Number.isNaN(s.getTime())?!1:s.toISOString().slice(0,10)===e}commit(){g(this,us,this.value)}rollback(){a(this,Un,to).call(this)}}Hn=new WeakMap,cs=new WeakMap,us=new WeakMap,Un=new WeakSet,to=function(){o(this,cs).element.value=o(this,us)},N(In,"COMPONENT_NAME","DateInput");const Uv="_trigger_j4xhq_11",Wv="_title_j4xhq_35",qv="_arrow_j4xhq_45",jv="_options_j4xhq_89",Qv={"select-input":"_select-input_j4xhq_1",trigger:Uv,title:Wv,arrow:qv,options:jv},Gv=`<div class="select-input" data-ref="selectInput" data-active="false">\r
	<button type="button" class="trigger" data-ref="trigger">\r
		<span class="title" data-ref="value" data-value=""></span>\r
		<span class="arrow">\r
			<svg width="12" height="8" viewBox="0 0 12 8" fill="none">\r
				<path d="M6 8L0 0H12L6 8Z" fill="currentColor" />\r
			</svg>\r
		</span>\r
	</button>\r
	<ul class="options" data-ref="options"></ul>\r
</div>\r
`;var Ht,ds,fs,Ne,Oe,Ze,sc,nc,rc;class ee extends I{constructor({options:e=[]}={}){super();f(this,Ze);f(this,Ht,null);f(this,ds,null);f(this,fs,null);f(this,Ne,null);f(this,Oe);g(this,Ne,e)}get value(){return o(this,Oe)}get isActive(){return o(this,ds).data("active")}render(){return a(this,Ze,sc).call(this),a(this,Ze,rc).call(this),this.element}update(e){const i=o(this,Ne).find(s=>s===e);i&&(o(this,fs).data("value",i).text(i),g(this,Oe,e))}open(){o(this,Ht).data("active","true")}close(){o(this,Ht).data("active","false")}toggle(){const e=o(this,Ht).is("data-active");o(this,Ht).data("active",String(!e))}}Ht=new WeakMap,ds=new WeakMap,fs=new WeakMap,Ne=new WeakMap,Oe=new WeakMap,Ze=new WeakSet,sc=function(){this.element=A.htmlToElement(Gv,[],Qv),g(this,Ht,M(this.element)),a(this,Ze,nc).call(this)},nc=function(){g(this,ds,o(this,Ht).find('[data-ref="options"]')),g(this,fs,o(this,Ht).find('[data-ref="value"]'));const e=o(this,Ne).map(i=>`<li data-value="${i}" data-ref="option">${i}</li>`).join("");o(this,ds).html(e)},rc=function(){o(this,Ne).length&&(g(this,Oe,o(this,Ne)[0]),o(this,fs).data("value",o(this,Oe)).text(o(this,Oe)))},N(ee,"COMPONENT_NAME","SelectInput");const Zv={"text-input":"_text-input_ui3e0_1"},Kv=`<div class="text-input">\r
	<input type="text" />\r
</div>\r
`;var Wn,fi,ps,ms,ye,hc,oc,eo;class ch extends I{constructor({placeholder:e=""}={}){super();f(this,ye);f(this,Wn,null);f(this,fi,null);f(this,ps,null);f(this,ms);g(this,ms,e)}get value(){return o(this,fi).element.value}render(){return a(this,ye,hc).call(this),a(this,ye,oc).call(this),this.element}update(e){g(this,ps,e),a(this,ye,eo).call(this)}commit(e){g(this,ps,e)}rollback(){a(this,ye,eo).call(this)}}Wn=new WeakMap,fi=new WeakMap,ps=new WeakMap,ms=new WeakMap,ye=new WeakSet,hc=function(){return this.element=A.htmlToElement(Kv,[],Zv),g(this,Wn,M(this.element)),g(this,fi,o(this,Wn).find("input")),this.element},oc=function(){o(this,ms)&&o(this,fi).attr("placeholder",o(this,ms))},eo=function(){o(this,fi).element.value=o(this,ps)||""},N(ch,"COMPONENT_NAME","TextInput");const Jv={"checkbox-input":"_checkbox-input_1j5bz_1"},t0=`<div class="checkbox-input">\r
	<input type="checkbox" />\r
</div>\r
`;var qn,gs,vs,jn,io;class ac extends I{constructor(){super(...arguments);f(this,jn);f(this,qn,null);f(this,gs,null);f(this,vs)}get value(){return o(this,gs).element.checked}render(){return this.element=A.htmlToElement(t0,[],Jv),g(this,qn,M(this.element)),g(this,gs,o(this,qn).find("input")),this.element}update(e){g(this,vs,e),a(this,jn,io).call(this)}commit(){g(this,vs,this.value)}rollback(){a(this,jn,io).call(this)}}qn=new WeakMap,gs=new WeakMap,vs=new WeakMap,jn=new WeakSet,io=function(){o(this,gs).element.checked=!!o(this,vs)},N(ac,"COMPONENT_NAME","CheckboxInput");function e0(r){if(r===0)return 1;const t=r.toString();if(!t.includes("."))return 1;const i=t.split(".")[1].length;return Math.pow(10,-i)}const i0={"number-input":"_number-input_6lw4c_1","number-stepper":"_number-stepper_6lw4c_63","stepper-up":"_stepper-up_6lw4c_85","stepper-down":"_stepper-down_6lw4c_87"},s0=`<div class="number-input">\r
	<input type="number" />\r
	<div class="number-stepper" data-ref="numberStepper">\r
		<button\r
			class="stepper-up"\r
			type="button"\r
			tabindex="-1"\r
			data-ref="stepperUp"\r
		>\r
			<svg width="12" height="8" viewBox="0 0 12 8" fill="none">\r
				<path d="M6 0L12 8H0L6 0Z" fill="currentColor" />\r
			</svg>\r
		</button>\r
		<button\r
			class="stepper-down"\r
			type="button"\r
			tabindex="-1"\r
			data-ref="stepperDown"\r
		>\r
			<svg width="12" height="8" viewBox="0 0 12 8" fill="none">\r
				<path d="M6 8L0 0H12L6 8Z" fill="currentColor" />\r
			</svg>\r
		</button>\r
	</div>\r
</div>\r
`;var pi,wt,mi,dt,cc,uc,so,dc,fc,no;class lc extends I{constructor(){super(...arguments);f(this,dt);f(this,pi,null);f(this,wt,null);f(this,mi)}get value(){return o(this,wt).element.valueAsNumber}render(){return a(this,dt,cc).call(this),a(this,dt,uc).call(this),this.element}update(e){g(this,mi,e),a(this,dt,so).call(this)}isValid(){return/^-?\d+(\.\d+)?$/.test(this.value)}commit(){g(this,mi,this.value)}rollback(){a(this,dt,so).call(this)}}pi=new WeakMap,wt=new WeakMap,mi=new WeakMap,dt=new WeakSet,cc=function(){this.element=A.htmlToElement(s0,[],i0),g(this,pi,M(this.element)),g(this,wt,o(this,pi).find("input"))},uc=function(){o(this,pi).find('[data-ref="stepperUp"]').click(a(this,dt,dc).bind(this)),o(this,pi).find('[data-ref="stepperDown"]').click(a(this,dt,fc).bind(this))},so=function(){o(this,wt).attr("step",e0(o(this,mi))),o(this,wt).element.value=o(this,mi)},dc=function(e){e.preventDefault(),e.stopPropagation();const i=o(this,wt).element.valueAsNumber||0,s=parseFloat(o(this,wt).attr("step"))||1,n=i+s;o(this,wt).element.value=n,a(this,dt,no).call(this)},fc=function(e){e.preventDefault(),e.stopPropagation();const i=o(this,wt).element.valueAsNumber||0,s=parseFloat(o(this,wt).attr("step"))||1,n=i-s;o(this,wt).element.value=n,a(this,dt,no).call(this)},no=function(){const e=new Event("change",{bubbles:!0});o(this,wt).element.dispatchEvent(e)},N(lc,"COMPONENT_NAME","NumberInput");const n0={"params-item":"_params-item_1mcy3_1"},r0=`<div class="params-item">\r
	<span data-field="title"></span>\r
</div>\r
`;var bs,_t,Hs,pc,mc;class uh extends I{constructor(){super(...arguments);f(this,Hs);f(this,bs,null);f(this,_t,null)}get value(){var e;return((e=o(this,_t))==null?void 0:e.value)??null}render(){return a(this,Hs,pc).call(this),this.element}update(e,i,s){o(this,bs).find('[data-field="title"]').text(s),a(this,Hs,mc).call(this,e,i)}remove(){this.element.remove()}isValid(){var e;return(e=o(this,_t))==null?void 0:e.isValid()}commit(){var e;(e=o(this,_t))==null||e.commit()}rollback(){var e;(e=o(this,_t))==null||e.rollback()}}bs=new WeakMap,_t=new WeakMap,Hs=new WeakSet,pc=function(){return this.element=A.htmlToElement(r0,[],n0),g(this,bs,M(this.element)),this.element},mc=function(e,i){if(o(this,_t)&&(o(this,_t).remove(),g(this,_t,null)),typeof i=="number")g(this,_t,new lc);else if(typeof i=="boolean")g(this,_t,new ac);else return;const s=o(this,_t).render();o(this,bs).append(s),M(s).find("input").data("param-id",e),o(this,_t).update(i)},N(uh,"COMPONENT_NAME","ParamsItem");const h0={"config-item":"_config-item_892mi_1","config-header":"_config-header_892mi_9","config-info":"_config-info_892mi_29","strategy-name":"_strategy-name_892mi_47","strategy-meta":"_strategy-meta_892mi_59","config-actions":"_config-actions_892mi_73","config-content":"_config-content_892mi_101","config-property":"_config-property_892mi_111","config-params":"_config-params_892mi_129"},o0=`<div\r
	class="config-item"\r
	data-ref="configItem"\r
	data-active="false"\r
	data-config-id=""\r
	data-status=""\r
>\r
	<div class="config-header" data-ref="configHeader">\r
		<div class="config-info">\r
			<div class="strategy-name" data-field="strategy"></div>\r
			<div class="strategy-meta">\r
				<span data-field="symbol"></span> •\r
				<span data-field="interval"></span> •\r
				<span data-field="exchange"></span>\r
			</div>\r
		</div>\r
		<div class="config-actions">\r
			<run-button></run-button>\r
			<open-button></open-button>\r
			<delete-button></delete-button>\r
		</div>\r
	</div>\r
	<div class="config-content">\r
		<div class="config-property">\r
			<span class="label">Strategy</span>\r
			<span class="value" data-ref="strategyInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Symbol</span>\r
			<span class="value" data-ref="symbolInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Interval</span>\r
			<span class="value" data-ref="intervalInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Exchange</span>\r
			<span class="value" data-ref="exchangeInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Start</span>\r
			<span class="value" data-ref="startInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">End</span>\r
			<span class="value" data-ref="endInput" data-key=""></span>\r
		</div>\r
		<div class="config-params" data-ref="paramsItems"></div>\r
	</div>\r
</div>\r
`;var Ie,J,Lt,gi,Qn,rt,ws,R,gc,vc,bc,wc,ro,ho,_c,hn,yc,Ec,Dr,oo,Cc,ao,Mc,Tc;let a0=(Ie=class extends I{constructor({configId:e}){super();f(this,R);f(this,J,null);f(this,Lt,null);f(this,gi,new Map);f(this,Qn,new Map);f(this,rt,{strategy:void 0,symbol:void 0,interval:void 0,exchange:void 0,start:void 0,end:void 0,params:null});f(this,ws);g(this,ws,e)}get config(){return{...o(this,rt),params:{...o(this,rt).params}}}get configId(){return o(this,ws)}render(){return a(this,R,gc).call(this),a(this,R,vc).call(this),a(this,R,bc).call(this),this.element}update(e){g(this,rt,{...e,params:{...e.params||{}}}),a(this,R,_c).call(this),a(this,R,Dr).call(this),a(this,R,hn).call(this)}remove(){a(this,R,oo).call(this),this.element.remove()}toggle(){const e=o(this,J).data("active")==="true";o(this,J).data("active",String(!e))}setProcessing(){o(this,J).data("status","processing")}setSuccess(){o(this,J).data("status","success")}setError(){o(this,J).data("status","error")}clearStatus(){o(this,J).data("status","")}handleChange(e){const i=a(this,R,ao).call(this,e),s=M(e.target).data("param-id");if(s){a(this,R,Cc).call(this,s,e);return}if(!i)return;const n=o(this,Lt)[i],h=n.value;a(this,R,Mc).call(this,i)?(n.commit(h),a(this,R,ho).call(this,i,h),a(this,R,hn).call(this)):n.rollback()}handleClick(e){if(!M(e.target).closest('[data-ref="selectInput"]')){a(this,R,Tc).call(this);return}const s=a(this,R,ao).call(this,e),n=o(this,Lt)[s];if(!n)return;const h=M(e.target).closest("[data-ref]"),l=h.data("ref");if(l==="value"||l==="trigger"){n.toggle();return}if(l==="option"){const c=h.data("value");n.update(c),n.close(),a(this,R,ho).call(this,s,c),a(this,R,hn).call(this)}}},J=new WeakMap,Lt=new WeakMap,gi=new WeakMap,Qn=new WeakMap,rt=new WeakMap,ws=new WeakMap,R=new WeakSet,gc=function(){const e={strategies:b.get(w.STRATEGIES),exchanges:b.get(w.EXCHANGES),intervals:b.get(w.INTERVALS)};g(this,Lt,{strategy:new ee({options:Object.keys(e.strategies)}),symbol:new ch({placeholder:Ie.DEFAULT_SYMBOL}),interval:new ee({options:e.intervals}),exchange:new ee({options:e.exchanges}),start:new In,end:new In})},vc=function(){this.element=A.htmlToElement(o0,[new lh({title:"Run Setting"}),new ih({title:"Open Strategy"}),new Gs({title:"Delete Setting"})],h0),g(this,J,M(this.element))},bc=function(){o(this,J).data("config-id",o(this,ws)),a(this,R,yc).call(this),a(this,R,Ec).call(this),a(this,R,wc).call(this),a(this,R,Dr).call(this),a(this,R,hn).call(this)},wc=function(){Object.keys(o(this,rt)).forEach(e=>{var i;e!=="params"&&(o(this,rt)[e]=((i=o(this,Lt)[e])==null?void 0:i.value)??null)}),a(this,R,ro).call(this)},ro=function(){const e=o(this,rt).strategy;if(!e)return;const s=b.get(w.STRATEGIES)[e];s&&s.params?o(this,rt).params={...s.params}:o(this,rt).params={}},ho=function(e,i){o(this,rt)[e]=i??null,e==="strategy"&&(a(this,R,ro).call(this),a(this,R,Dr).call(this))},_c=function(){Object.entries(o(this,rt)).forEach(([e,i])=>{if(e==="params")return;const s=o(this,Lt)[e];s&&i!==null&&s.update(i)})},hn=function(){o(this,Qn).forEach((e,i)=>{const s=o(this,rt)[i];i==="symbol"&&(!s||s==="")?e.text("[No Symbol]"):s&&e.text(s)})},yc=function(){o(this,J).findAll("[data-field]").forEach(e=>{const i=e.data("field");o(this,Qn).set(i,e)})},Ec=function(){const e={strategy:o(this,J).find('[data-ref="strategyInput"]'),symbol:o(this,J).find('[data-ref="symbolInput"]'),interval:o(this,J).find('[data-ref="intervalInput"]'),exchange:o(this,J).find('[data-ref="exchangeInput"]'),start:o(this,J).find('[data-ref="startInput"]'),end:o(this,J).find('[data-ref="endInput"]')};Object.entries(e).forEach(([i,s])=>{s.append(o(this,Lt)[i].render()),s.data("key",i)})},Dr=function(){a(this,R,oo).call(this);const e=o(this,rt).params||{},s=b.get(w.STRATEGIES)[o(this,rt).strategy],n=(s==null?void 0:s.paramLabels)||{};if(Object.keys(e).length){const h=o(this,J).find('[data-ref="paramsItems"]');Object.entries(e).forEach(([l,c])=>{const u=new uh,d=u.render();h.append(d),u.update(l,c,n[l]||l),o(this,gi).set(l,u)})}},oo=function(){o(this,gi).forEach(e=>e.remove()),o(this,gi).clear()},Cc=function(e){const i=o(this,gi).get(e);if(i)if(i.isValid()){const s=i.value;o(this,rt).params[e]=s,i.commit()}else i.rollback()},ao=function(e){const i=M(e.target).closest("[data-key]");return(i==null?void 0:i.data("key"))??null},Mc=function(e){var i,s;return((s=(i=o(this,Lt)[e]).isValid)==null?void 0:s.call(i))??!0},Tc=function(){["strategy","exchange","interval"].forEach(e=>{o(this,Lt)[e].close()})},N(Ie,"COMPONENT_NAME","ConfigItem"),N(Ie,"DEFAULT_SYMBOL","BTCUSDT"),Ie);var Ut,Gn,vi,ft,fe,Ae,ke,T,xc,Sc,Nc,Oc,Ic,Ac,kc,Rc,co,zc,Lc,Pc,Dc,uo,Bc,$c,Vc,Fc,fo,on,qi,po,Yc,Xc,Hc,ji,Uc,Wc,an,Qi;const Cn=class Cn extends I{constructor(){super(...arguments);f(this,T);f(this,Ut,null);f(this,Gn,null);f(this,vi,null);f(this,ft,new Map);f(this,fe,new Set);f(this,Ae,{optimization:new Set,execution:new Set});f(this,ke)}get isActive(){return o(this,Ut).css("display")==="flex"}render(){return a(this,T,xc).call(this),a(this,T,Sc).call(this),a(this,T,Nc).call(this),this.element}show(){o(this,Ut).css("display","flex")}hide(){o(this,Ut).css("display","none")}};Ut=new WeakMap,Gn=new WeakMap,vi=new WeakMap,ft=new WeakMap,fe=new WeakMap,Ae=new WeakMap,ke=new WeakMap,T=new WeakSet,xc=function(){g(this,vi,{delete:new rh,import:new oh,export:new hh,add:new sh,clone:new nh,run:new ah})},Sc=function(){this.element=A.htmlToElement(Vv,Object.values(o(this,vi)),$v),g(this,Ut,M(this.element)),g(this,Gn,o(this,Ut).find('[data-ref="configItems"]'))},Nc=async function(){a(this,T,Yc).call(this),a(this,T,Oc).call(this),await a(this,T,Vc).call(this)},Oc=function(){o(this,Ut).on("change",a(this,T,Ic).bind(this)),o(this,Ut).on("click",a(this,T,Ac).bind(this)),b.subscribe(w.EXECUTION_CONTEXTS,a(this,T,kc).bind(this)),b.subscribe(w.OPTIMIZATION_CONTEXTS,a(this,T,Rc).bind(this))},Ic=function(e){if(M(e.target).closest("[data-ref]").data("ref")==="fileInput"){a(this,T,Xc).call(this,e.target.files);return}const s=a(this,T,po).call(this,e);s&&(s.handleChange(e),a(this,T,ji).call(this,s.configId,s.config))},Ac=async function(e){const i=M(e.target).closest("[data-ref]");if(!i)return;const s=i.data("ref");if(s==="configItems")return;const n={runConfigsButton:()=>a(this,T,co).call(this),cloneConfigsButton:()=>a(this,T,zc).call(this),addConfigButton:()=>a(this,T,Lc).call(this),exportConfigsButton:()=>a(this,T,Pc).call(this),importConfigsButton:()=>a(this,T,Dc).call(this),deleteConfigsButton:()=>a(this,T,uo).call(this)};if(n[s]){n[s]();return}const h=a(this,T,po).call(this,e);if(!h)return;const l={configHeader:()=>h.toggle(),runButton:()=>a(this,T,co).call(this,[h.configId]),openButton:()=>a(this,T,$c).call(this,h.configId),deleteButton:()=>a(this,T,uo).call(this,[h.configId])};l[s]?l[s]():(h.handleClick(e),a(this,T,ji).call(this,h.configId,h.config))},kc=function(e){Array.from(o(this,Ae).execution).forEach(i=>{if(!(i in e)){const s=o(this,ft).get(i);s&&s.clearStatus(),o(this,Ae).execution.delete(i)}}),Object.entries(e).forEach(([i,s])=>{s.isLive||o(this,Ae).execution.add(i)})},Rc=function(e){const i=j.getItem(Q.BACKTESTING_CONFIGS)||{};Object.entries(e).forEach(([s,n])=>{o(this,Ae).optimization.has(s)||(n.params.forEach(h=>{const l=crypto.randomUUID(),c={...n,params:h};i[l]=c,a(this,T,qi).call(this,l,c)}),o(this,Ae).optimization.add(s))}),j.setItem(Q.BACKTESTING_CONFIGS,i)},co=async function(e){const i=e||Array.from(o(this,ft).keys());if(!i.length)return;const s={};i.forEach(n=>s[n]=o(this,ft).get(n).config);try{const{added:n}=await St.add(s);n.forEach(h=>{a(this,T,an).call(this,h,D.QUEUED),o(this,fe).add(h)}),n.length&&a(this,T,fo).call(this)}catch(n){console.error("Failed to run configs.",n)}},zc=function(){Array.from(o(this,ft).values()).forEach(i=>{const s=crypto.randomUUID(),n={...i.config};a(this,T,qi).call(this,s,n),a(this,T,ji).call(this,s,n)})},Lc=function(){const e=crypto.randomUUID(),i=a(this,T,qi).call(this,e);a(this,T,ji).call(this,e,i.config)},Pc=function(){const e=a(this,T,Qi).call(this);if(!e||!Object.keys(e).length){X.show("info","No configs available to export");return}const s=`backtesting-configs_${new Date().toISOString().split("T")[0]}.json`;pa(e,s),X.show("success","Settings exported successfully")},Dc=function(){o(this,vi).import.clickOnInput()},uo=function(e){const i=e||Array.from(o(this,ft).keys());i.length&&i.forEach(s=>a(this,T,Wc).call(this,s))},Bc=async function(e){try{const i=b.get(w.EXECUTION_CONTEXTS),s=await St.get(e),n={...i,...s};b.set(w.EXECUTION_CONTEXTS,n),a(this,T,an).call(this,e,D.READY)}catch(i){console.error(`Failed to handle ready context ${e}.`,i)}},$c=function(e){const i=b.get(w.EXECUTION_CONTEXTS);if(!i[e]){X.show("warning","Strategy not created or was deleted");return}if(b.get(w.EXECUTION_CONTEXT).id===e)return;const n=i[e];b.set(w.EXECUTION_CONTEXT,{id:e,...n})},Vc=async function(){try{const e=await St.getAllStatuses();await Promise.all(Object.entries(e).map(async([s,n])=>{a(this,T,an).call(this,s,n)})),Object.values(e).some(s=>[D.QUEUED,D.CREATING].includes(s))&&a(this,T,fo).call(this)}catch(e){console.error("Failed to sync statuses.",e)}},Fc=async function(){try{if(!o(this,fe).size){a(this,T,on).call(this);return}for(const e of Array.from(o(this,fe))){const{status:i}=await St.getStatus(e);i===D.READY?(await a(this,T,Bc).call(this,e),o(this,fe).delete(e)):i===D.FAILED&&(a(this,T,an).call(this,e,D.FAILED),o(this,fe).delete(e))}o(this,fe).size||a(this,T,on).call(this)}catch(e){console.error("Polling failed.",e),a(this,T,on).call(this)}},fo=function(){o(this,ke)||g(this,ke,setInterval(()=>a(this,T,Fc).call(this),Vl))},on=function(){o(this,ke)&&(clearInterval(o(this,ke)),g(this,ke,void 0))},qi=function(e,i){const s=new a0({configId:e});return o(this,Gn).append(s.render()),o(this,ft).set(e,s),i&&s.update(i),s},po=function(e){const i=M(e.target).closest('[data-ref="configItem"]');if(!i)return null;const s=i.data("config-id");return o(this,ft).get(s)},Yc=function(){const e=a(this,T,Qi).call(this);Object.entries(e).forEach(([i,s])=>{a(this,T,qi).call(this,i,s)})},Xc=function(e){if(!e||!e.length)return;const i=e[0],s=new FileReader;s.onload=n=>{try{const h=JSON.parse(n.target.result);a(this,T,Hc).call(this,h),o(this,vi).import.resetInput(),X.show("success","Settings imported successfully")}catch{X.show("error","The file you selected is not a valid JSON settings file")}},s.readAsText(i)},Hc=function(e){if(!e||typeof e!="object")return;const i=a(this,T,Qi).call(this);Object.entries(e).forEach(([s,n])=>{if(!ma(n,Cn.REQUIRED_KEYS))return;const l={...i[s]||{},...n},c=o(this,ft).get(s);c?c.update(l):a(this,T,qi).call(this,s,l),a(this,T,ji).call(this,s,l)})},ji=function(e,i){const s=a(this,T,Qi).call(this);s[e]=i,j.setItem(Q.BACKTESTING_CONFIGS,s)},Uc=function(e){const i=a(this,T,Qi).call(this);delete i[e],j.setItem(Q.BACKTESTING_CONFIGS,i)},Wc=async function(e){const i=o(this,ft).get(e);i&&(i.remove(),o(this,ft).delete(e),a(this,T,Uc).call(this,e),o(this,ft).size||a(this,T,on).call(this))},an=function(e,i){const s=o(this,ft).get(e);s&&(s.clearStatus(),[D.QUEUED,D.CREATING].includes(i)?s.setProcessing():i===D.READY?s.setSuccess():i===D.FAILED&&s.setError())},Qi=function(){return j.getItem(Q.BACKTESTING_CONFIGS)||{}},N(Cn,"COMPONENT_NAME","BacktestingTab"),N(Cn,"REQUIRED_KEYS",["strategy","symbol","interval","exchange","params","start","end"]);let lo=Cn;class l0 extends Qs{async getAll(){return this._executeRequest({path:"/contexts/optimization",method:"GET",errorMessage:"Failed to load optimization contexts"})}async get(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/contexts/optimization/${t}`,method:"GET",errorMessage:"Failed to load optimization context data"})}async add(t){return this._validateRequired({configs:t},"configs is required"),this._executeRequest({path:"/contexts/optimization",method:"POST",body:t,errorMessage:"Failed to add optimization contexts"})}async delete(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/contexts/optimization/${t}`,method:"DELETE",errorMessage:"Failed to delete optimization context"})}async getAllStatuses(){return this._executeRequest({path:"/contexts/optimization/status",method:"GET",errorMessage:"Failed to load optimization contexts statuses"})}async getStatus(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/contexts/optimization/${t}/status`,method:"GET",errorMessage:"Failed to load optimization context status"})}}const Hi=new l0,c0="_header_bij1z_13",u0="_items_bij1z_33",d0="_footer_bij1z_47",f0={"optimization-tab":"_optimization-tab_bij1z_1",header:c0,items:u0,footer:d0,"left-buttons":"_left-buttons_bij1z_65","right-buttons":"_right-buttons_bij1z_67"},p0=`<div class="optimization-tab">\r
	<div class="header"><span>Optimization Settings</span></div>\r
	<div class="items" data-ref="configItems"></div>\r
	<div class="footer">\r
		<div class="left-buttons">\r
			<component-delete-configs-button></component-delete-configs-button>\r
			<component-import-configs-button></component-import-configs-button>\r
			<component-export-configs-button></component-export-configs-button>\r
		</div>\r
		<div class="right-buttons">\r
			<component-add-config-button></component-add-config-button>\r
			<component-clone-configs-button></component-clone-configs-button>\r
			<component-run-configs-button></component-run-configs-button>\r
		</div>\r
	</div>\r
</div>\r
`,m0={"config-item":"_config-item_1kkx0_1","config-header":"_config-header_1kkx0_9","config-info":"_config-info_1kkx0_29","strategy-name":"_strategy-name_1kkx0_47","strategy-meta":"_strategy-meta_1kkx0_59","config-actions":"_config-actions_1kkx0_73","config-content":"_config-content_1kkx0_101","config-property":"_config-property_1kkx0_111"},g0=`<div\r
	class="config-item"\r
	data-ref="configItem"\r
	data-active="false"\r
	data-config-id=""\r
	data-status=""\r
>\r
	<div class="config-header" data-ref="configHeader">\r
		<div class="config-info">\r
			<div class="strategy-name" data-field="strategy"></div>\r
			<div class="strategy-meta">\r
				<span data-field="symbol"></span> •\r
				<span data-field="interval"></span> •\r
				<span data-field="exchange"></span>\r
			</div>\r
		</div>\r
		<div class="config-actions">\r
			<run-button></run-button>\r
			<delete-button></delete-button>\r
		</div>\r
	</div>\r
	<div class="config-content">\r
		<div class="config-property">\r
			<span class="label">Strategy</span>\r
			<span class="value" data-ref="strategyInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Symbol</span>\r
			<span class="value" data-ref="symbolInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Interval</span>\r
			<span class="value" data-ref="intervalInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Exchange</span>\r
			<span class="value" data-ref="exchangeInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Start</span>\r
			<span class="value" data-ref="startInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">End</span>\r
			<span class="value" data-ref="endInput" data-key=""></span>\r
		</div>\r
	</div>\r
</div>\r
`;var Re,st,Pt,Zn,Wt,_s,$,qc,jc,Qc,Gc,mo,Zc,ln,Kc,Jc,go,tu,eu;let v0=(Re=class extends I{constructor({configId:e}){super();f(this,$);f(this,st,null);f(this,Pt,null);f(this,Zn,new Map);f(this,Wt,{strategy:void 0,symbol:void 0,interval:void 0,exchange:void 0,start:void 0,end:void 0});f(this,_s);g(this,_s,e)}get config(){return{...o(this,Wt)}}get configId(){return o(this,_s)}render(){return a(this,$,qc).call(this),a(this,$,jc).call(this),a(this,$,Qc).call(this),this.element}update(e){g(this,Wt,{...e}),a(this,$,Zc).call(this),a(this,$,ln).call(this)}remove(){this.element.remove()}toggle(){const e=o(this,st).data("active")==="true";o(this,st).data("active",String(!e))}setProcessing(){o(this,st).data("status","processing")}setSuccess(){o(this,st).data("status","success")}setError(){o(this,st).data("status","error")}clearStatus(){o(this,st).data("status","")}handleChange(e){const i=a(this,$,go).call(this,e);if(!i)return;const s=o(this,Pt)[i],n=s.value;a(this,$,tu).call(this,i)?(s.commit(n),a(this,$,mo).call(this,i,n),a(this,$,ln).call(this)):s.rollback()}handleClick(e){if(!M(e.target).closest('[data-ref="selectInput"]')){a(this,$,eu).call(this);return}const s=a(this,$,go).call(this,e),n=o(this,Pt)[s];if(!n)return;const h=M(e.target).closest("[data-ref]"),l=h.data("ref");if(l==="value"||l==="trigger"){n.toggle();return}if(l==="option"){const c=h.data("value");n.update(c),n.close(),a(this,$,mo).call(this,s,c),a(this,$,ln).call(this)}}},st=new WeakMap,Pt=new WeakMap,Zn=new WeakMap,Wt=new WeakMap,_s=new WeakMap,$=new WeakSet,qc=function(){const e={strategies:b.get(w.STRATEGIES),exchanges:b.get(w.EXCHANGES),intervals:b.get(w.INTERVALS)};g(this,Pt,{strategy:new ee({options:Object.keys(e.strategies)}),symbol:new ch({placeholder:Re.DEFAULT_SYMBOL}),interval:new ee({options:e.intervals}),exchange:new ee({options:e.exchanges}),start:new In,end:new In})},jc=function(){this.element=A.htmlToElement(g0,[new lh({title:"Run Setting"}),new Gs({title:"Delete Setting"})],m0),g(this,st,M(this.element))},Qc=function(){o(this,st).data("config-id",o(this,_s)),a(this,$,Kc).call(this),a(this,$,Jc).call(this),a(this,$,Gc).call(this),a(this,$,ln).call(this)},Gc=function(){Object.keys(o(this,Wt)).forEach(e=>{var i;o(this,Wt)[e]=((i=o(this,Pt)[e])==null?void 0:i.value)??null})},mo=function(e,i){o(this,Wt)[e]=i??null},Zc=function(){Object.entries(o(this,Wt)).forEach(([e,i])=>{const s=o(this,Pt)[e];s&&i!==null&&s.update(i)})},ln=function(){o(this,Zn).forEach((e,i)=>{const s=o(this,Wt)[i];i==="symbol"&&(!s||s==="")?e.text("[No Symbol]"):s&&e.text(s)})},Kc=function(){o(this,st).findAll("[data-field]").forEach(e=>{const i=e.data("field");o(this,Zn).set(i,e)})},Jc=function(){const e={strategy:o(this,st).find('[data-ref="strategyInput"]'),symbol:o(this,st).find('[data-ref="symbolInput"]'),interval:o(this,st).find('[data-ref="intervalInput"]'),exchange:o(this,st).find('[data-ref="exchangeInput"]'),start:o(this,st).find('[data-ref="startInput"]'),end:o(this,st).find('[data-ref="endInput"]')};Object.entries(e).forEach(([i,s])=>{s.append(o(this,Pt)[i].render()),s.data("key",i)})},go=function(e){const i=M(e.target).closest("[data-key]");return(i==null?void 0:i.data("key"))??null},tu=function(e){var i,s;return((s=(i=o(this,Pt)[e]).isValid)==null?void 0:s.call(i))??!0},eu=function(){["strategy","exchange","interval"].forEach(e=>{o(this,Pt)[e].close()})},N(Re,"COMPONENT_NAME","ConfigItem"),N(Re,"DEFAULT_SYMBOL","BTCUSDT"),Re);var qt,Kn,bi,yt,ze,S,iu,su,nu,ru,hu,ou,bo,au,lu,cu,uu,wo,_o,du,fu,yo,Br,cn,Eo,pu,mu,gu,Gi,vu,bu,un,dn,Zi;const Mn=class Mn extends I{constructor(){super(...arguments);f(this,S);f(this,qt,null);f(this,Kn,null);f(this,bi,null);f(this,yt,new Map);f(this,ze)}get isActive(){return o(this,qt).css("display")==="flex"}render(){return a(this,S,iu).call(this),a(this,S,su).call(this),a(this,S,nu).call(this),this.element}show(){o(this,qt).css("display","flex")}hide(){o(this,qt).css("display","none")}};qt=new WeakMap,Kn=new WeakMap,bi=new WeakMap,yt=new WeakMap,ze=new WeakMap,S=new WeakSet,iu=function(){g(this,bi,{delete:new rh,import:new oh,export:new hh,add:new sh,clone:new nh,run:new ah})},su=function(){this.element=A.htmlToElement(p0,Object.values(o(this,bi)),f0),g(this,qt,M(this.element)),g(this,Kn,o(this,qt).find('[data-ref="configItems"]'))},nu=async function(){a(this,S,pu).call(this),a(this,S,ru).call(this),await a(this,S,du).call(this)},ru=function(){o(this,qt).on("change",a(this,S,hu).bind(this)),o(this,qt).on("click",a(this,S,ou).bind(this))},hu=function(e){if(M(e.target).closest("[data-ref]").data("ref")==="fileInput"){a(this,S,mu).call(this,e.target.files);return}const s=a(this,S,Eo).call(this,e);s&&(s.handleChange(e),a(this,S,Gi).call(this,s.configId,s.config))},ou=async function(e){const i=M(e.target).closest("[data-ref]");if(!i)return;const s=i.data("ref");if(s==="configItems")return;const n={runConfigsButton:()=>a(this,S,bo).call(this),cloneConfigsButton:()=>a(this,S,au).call(this),addConfigButton:()=>a(this,S,lu).call(this),exportConfigsButton:()=>a(this,S,cu).call(this),importConfigsButton:()=>a(this,S,uu).call(this),deleteConfigsButton:()=>a(this,S,wo).call(this)};if(n[s]){n[s]();return}const h=a(this,S,Eo).call(this,e);if(!h)return;const l={configHeader:()=>h.toggle(),runButton:()=>a(this,S,bo).call(this,[h.configId]),deleteButton:()=>a(this,S,wo).call(this,[h.configId])};l[s]?l[s]():(h.handleClick(e),a(this,S,Gi).call(this,h.configId,h.config))},bo=async function(e=null){const i=e||Array.from(o(this,yt).keys());if(!i.length)return;const s={};i.forEach(n=>s[n]=o(this,yt).get(n).config);try{const{added:n}=await Hi.add(s);n.forEach(h=>a(this,S,dn).call(this,h,D.QUEUED)),n.length&&a(this,S,yo).call(this)}catch(n){console.error("Failed to run configs.",n)}},au=function(){Array.from(o(this,yt).values()).forEach(i=>{const s=crypto.randomUUID(),n={...i.config};a(this,S,cn).call(this,s,n),a(this,S,Gi).call(this,s,n)})},lu=function(){const e=crypto.randomUUID(),i=a(this,S,cn).call(this,e);a(this,S,Gi).call(this,e,i.config)},cu=function(){const e=a(this,S,Zi).call(this);if(!e||!Object.keys(e).length){X.show("info","No configs available to export");return}const s=`optimization-configs_${new Date().toISOString().split("T")[0]}.json`;pa(e,s),X.show("success","Settings exported successfully")},uu=function(){o(this,bi).import.clickOnInput()},wo=function(e=null){const i=e||Array.from(o(this,yt).keys());i.length&&i.forEach(s=>a(this,S,bu).call(this,s))},_o=async function(e){try{const i=await Hi.get(e),s=Object.values(i)[0],h={...b.get(w.OPTIMIZATION_CONTEXTS)||{},[e]:s};b.set(w.OPTIMIZATION_CONTEXTS,h),a(this,S,dn).call(this,e,D.READY),a(this,S,un).call(this,e)}catch(i){console.error(`Failed to handle ready context ${e}.`,i)}},du=async function(){try{const e=await Hi.getAllStatuses();await Promise.all(Object.entries(e).map(async([s,n])=>{n!==D.READY&&a(this,S,dn).call(this,s,n),n===D.READY?await a(this,S,_o).call(this,s):n===D.FAILED&&a(this,S,un).call(this,s)})),Object.values(e).some(s=>[D.QUEUED,D.CREATING].includes(s))&&a(this,S,yo).call(this)}catch(e){console.error("Failed to sync statuses.",e)}},fu=async function(){try{const e=await Hi.getAllStatuses();for(const[s,n]of Object.entries(e))n===D.READY&&await a(this,S,_o).call(this,s),n===D.FAILED&&(a(this,S,dn).call(this,s,D.FAILED),a(this,S,un).call(this,s));Object.values(e).some(s=>[D.QUEUED,D.CREATING].includes(s))||a(this,S,Br).call(this)}catch(e){console.error("Polling failed.",e),a(this,S,Br).call(this)}},yo=function(){o(this,ze)||g(this,ze,setInterval(()=>a(this,S,fu).call(this),qh))},Br=function(){o(this,ze)&&(clearInterval(o(this,ze)),g(this,ze,null))},cn=function(e,i=null){const s=new v0({configId:e});return o(this,Kn).append(s.render()),o(this,yt).set(e,s),i&&s.update(i),s},Eo=function(e){const i=M(e.target).closest('[data-ref="configItem"]');if(!i)return null;const s=i.data("config-id");return o(this,yt).get(s)},pu=function(){const e=a(this,S,Zi).call(this);Object.entries(e).forEach(([i,s])=>{a(this,S,cn).call(this,i,s)})},mu=function(e){if(!e||!e.length)return;const i=e[0],s=new FileReader;s.onload=n=>{try{const h=JSON.parse(n.target.result);a(this,S,gu).call(this,h),o(this,bi).import.resetInput(),X.show("success","Settings imported successfully")}catch{X.show("error","The file you selected is not a valid JSON settings file")}},s.readAsText(i)},gu=function(e){if(!e||typeof e!="object")return;const i=a(this,S,Zi).call(this);Object.entries(e).forEach(([s,n])=>{if(!ma(n,Mn.REQUIRED_KEYS))return;const l={...i[s]||{},...n},c=o(this,yt).get(s);c?c.update(l):a(this,S,cn).call(this,s,l),a(this,S,Gi).call(this,s,l)})},Gi=function(e,i){const s=a(this,S,Zi).call(this);s[e]=i,j.setItem(Q.OPTIMIZATION_CONFIGS,s)},vu=function(e){const i=a(this,S,Zi).call(this);delete i[e],j.setItem(Q.OPTIMIZATION_CONFIGS,i)},bu=async function(e){const i=o(this,yt).get(e);i&&(a(this,S,un).call(this,e),i.remove(),o(this,yt).delete(e),a(this,S,vu).call(this,e),o(this,yt).size||a(this,S,Br).call(this))},un=async function(e){try{(await Hi.getAll())[e]&&await Hi.delete(e)}catch(i){console.error(`Failed to delete context ${e}.`,i)}},dn=function(e,i){const s=o(this,yt).get(e);s&&(s.clearStatus(),[D.QUEUED,D.CREATING].includes(i)?s.setProcessing():i===D.READY?s.setSuccess():i===D.FAILED&&s.setError())},Zi=function(){return j.getItem(Q.OPTIMIZATION_CONFIGS)||{}},N(Mn,"COMPONENT_NAME","OptimizationTab"),N(Mn,"REQUIRED_KEYS",["strategy","symbol","interval","exchange","start","end"]);let vo=Mn;const b0="_header_nemla_13",w0="_items_nemla_33",_0={"params-tab":"_params-tab_nemla_1",header:b0,items:w0},y0=`<div class="params-tab">\r
	<div class="header"><span>Strategy Parameters</span></div>\r
	<div class="items" data-ref="paramsItems"></div>\r
</div>\r
`;var pe,wi,Jn,vt,_u,yu,Eu,Cu,Co,Mu;class wu extends I{constructor(){super(...arguments);f(this,vt);f(this,pe,null);f(this,wi,new Map);f(this,Jn)}get isActive(){return o(this,pe).css("display")==="flex"}render(){return a(this,vt,_u).call(this),a(this,vt,yu).call(this),this.element}show(){o(this,pe).css("display","flex")}hide(){o(this,pe).css("display","none")}}pe=new WeakMap,wi=new WeakMap,Jn=new WeakMap,vt=new WeakSet,_u=function(){this.element=A.htmlToElement(y0,[],_0),g(this,pe,M(this.element))},yu=function(){a(this,vt,Eu).call(this),a(this,vt,Co).call(this,b.get(w.EXECUTION_CONTEXT))},Eu=function(){o(this,pe).on("change",a(this,vt,Cu).bind(this)),b.subscribe(w.EXECUTION_CONTEXT,a(this,vt,Co).bind(this))},Cu=async function(e){const i=M(e.target).data("param-id"),s=o(this,wi).get(i);if(s.isValid()){const n=b.get(w.EXECUTION_CONTEXT),h=n.id,l=s.value;try{await St.update(h,i,l),b.set(w.EXECUTION_CONTEXT,{...n,params:{...n.params,[i]:l}}),s.commit()}catch(c){console.error("Failed to update strategy parameter.",c),s.rollback()}}else s.rollback()},Co=function(e){if(o(this,Jn)!==e.id){if(a(this,vt,Mu).call(this),e.id){const i=o(this,pe).find('[data-ref="paramsItems"]'),h=b.get(w.STRATEGIES)[e.strategy].paramLabels||{};Object.entries(e.params).forEach(([l,c])=>{const u=new uh;i.append(u.render()),u.update(l,c,h[l]||l),o(this,wi).set(l,u)})}g(this,Jn,e.id)}},Mu=function(){o(this,wi).forEach(e=>e.remove()),o(this,wi).clear()},N(wu,"COMPONENT_NAME","ParamsTab");const E0="_header_vgi08_13",C0="_items_vgi08_33",M0={"strategies-tab":"_strategies-tab_vgi08_1",header:E0,items:C0},T0=`<div class="strategies-tab">\r
	<div class="header"><span>Active Strategies</span></div>\r
	<div class="items" data-ref="strategiesItems"></div>\r
</div>\r
`,x0="_content_ryfxe_21",S0={"strategies-item":"_strategies-item_ryfxe_1",content:x0,"strategy-header":"_strategy-header_ryfxe_39","strategy-name":"_strategy-name_ryfxe_51","status-dot":"_status-dot_ryfxe_63","strategy-meta":"_strategy-meta_ryfxe_115"},N0=`<div class="strategies-item" data-active="false" data-context-id="">\r
	<div class="content">\r
		<div class="strategy-header">\r
			<span class="strategy-name" data-field="strategy"></span>\r
			<span\r
				class="status-dot"\r
				data-active="false"\r
				data-ref="statusDot"\r
				title="Live Trading"\r
			>\r
			</span>\r
		</div>\r
		<div class="strategy-meta">\r
			<span data-field="symbol"></span> • <span data-field="interval"></span> •\r
			<span data-field="exchange"></span>\r
		</div>\r
	</div>\r
	<delete-button></delete-button>\r
</div>\r
`;var me,tr,Us,Tu,xu;class Mo extends I{constructor(){super(...arguments);f(this,Us);f(this,me,null);f(this,tr,new Map)}render(){return a(this,Us,Tu).call(this),a(this,Us,xu).call(this),this.element}update(e,i){o(this,tr).forEach((s,n)=>{o(this,me).data("context-id",e),s.text(i[n]),i.isLive&&o(this,me).find('[data-ref="statusDot"]').data("active","true")})}remove(){this.element.remove()}activate(){o(this,me).data("active","true")}deactivate(){o(this,me).data("active","false")}}me=new WeakMap,tr=new WeakMap,Us=new WeakSet,Tu=function(){this.element=A.htmlToElement(N0,[new Gs({title:"Delete Strategy"})],S0),g(this,me,M(this.element))},xu=function(){o(this,me).findAll("[data-field]").forEach(e=>{const i=e.data("field");o(this,tr).set(i,e)})},N(Mo,"COMPONENT_NAME","StrategiesItem");var jt,Et,ht,H,Nu,Ou,Iu,Au,ku,Ru,zu,Lu,$r,Pu;class Su extends I{constructor(){super(...arguments);f(this,H);f(this,jt,null);f(this,Et,new Map);f(this,ht)}get isActive(){return o(this,jt).css("display")==="flex"}render(){return a(this,H,Nu).call(this),a(this,H,Ou).call(this),this.element}show(){o(this,jt).css("display","flex")}hide(){o(this,jt).css("display","none")}}jt=new WeakMap,Et=new WeakMap,ht=new WeakMap,H=new WeakSet,Nu=function(){this.element=A.htmlToElement(T0,[],M0),g(this,jt,M(this.element))},Ou=function(){const e=b.get(w.EXECUTION_CONTEXT);g(this,ht,e.id),a(this,H,Iu).call(this),a(this,H,Au).call(this)},Iu=function(){const e=b.get(w.EXECUTION_CONTEXTS),i=o(this,jt).find('[data-ref="strategiesItems"]');Object.keys(e).length&&(Object.entries(e).forEach(([s,n])=>{const h=new Mo;o(this,Et).set(s,h),i.append(h.render()),h.update(s,n)}),o(this,ht)&&o(this,Et).has(o(this,ht))&&o(this,Et).get(o(this,ht)).activate())},Au=function(){o(this,jt).click(a(this,H,ku).bind(this)),b.subscribe(w.EXECUTION_CONTEXT,a(this,H,Ru).bind(this)),b.subscribe(w.EXECUTION_CONTEXTS,a(this,H,zu).bind(this))},ku=function(e){const i=M(e.target),s=i.closest("[data-context-id]");if(!s)return;const n=s.data("context-id");i.closest('[data-ref="deleteButton"]')?a(this,H,Lu).call(this,n):a(this,H,$r).call(this,n)},Ru=function(e){o(this,ht)!==e.id&&(o(this,ht)&&o(this,Et).has(o(this,ht))&&o(this,Et).get(o(this,ht)).deactivate(),e.id&&o(this,Et).has(e.id)&&o(this,Et).get(e.id).activate(),g(this,ht,e.id))},zu=function(e){const i=o(this,jt).find('[data-ref="strategiesItems"]');if(o(this,Et).forEach((s,n)=>{e[n]||(s.remove(),o(this,Et).delete(n))}),Object.entries(e).forEach(([s,n])=>{if(!o(this,Et).has(s)){const h=new Mo;o(this,Et).set(s,h),i.append(h.render()),h.update(s,n)}}),!o(this,ht)&&Object.keys(e).length){const s=Object.keys(e)[0];a(this,H,$r).call(this,s)}},Lu=async function(e){try{await St.delete(e);const i=b.get(w.EXECUTION_CONTEXTS),{[e]:s,...n}=i;if(b.set(w.EXECUTION_CONTEXTS,n),e===o(this,ht)){const h=Object.keys(n);h.length?a(this,H,$r).call(this,h[0]):a(this,H,Pu).call(this)}e===o(this,ht)&&(Nt.removeAll(),Nt.clear()),X.show("success","Strategy deleted successfully")}catch(i){X.show("error","Failed to delete strategy"),console.error(`Failed to delete context ${e}.`,i)}},$r=function(e){if(o(this,ht)===e)return;const i=b.get(w.EXECUTION_CONTEXTS)[e];b.set(w.EXECUTION_CONTEXT,{id:e,...i})},Pu=function(){b.set(w.EXECUTION_CONTEXT,{}),g(this,ht,void 0)},N(Su,"COMPONENT_NAME","StrategiesTab");const O0="_header_1oz6m_13",I0="_items_1oz6m_33",A0="_footer_1oz6m_47",k0={"trading-tab":"_trading-tab_1oz6m_1",header:O0,items:I0,footer:A0,"left-buttons":"_left-buttons_1oz6m_65","right-buttons":"_right-buttons_1oz6m_67"},R0=`<div class="trading-tab">\r
	<div class="header"><span>Live Trading Settings</span></div>\r
	<div class="items" data-ref="configItems"></div>\r
	<div class="footer">\r
		<div class="left-buttons">\r
			<component-delete-configs-button></component-delete-configs-button>\r
			<component-import-configs-button></component-import-configs-button>\r
			<component-export-configs-button></component-export-configs-button>\r
		</div>\r
		<div class="right-buttons">\r
			<component-add-config-button></component-add-config-button>\r
			<component-clone-configs-button></component-clone-configs-button>\r
			<component-run-configs-button></component-run-configs-button>\r
		</div>\r
	</div>\r
</div>\r
`,z0={"config-item":"_config-item_892mi_1","config-header":"_config-header_892mi_9","config-info":"_config-info_892mi_29","strategy-name":"_strategy-name_892mi_47","strategy-meta":"_strategy-meta_892mi_59","config-actions":"_config-actions_892mi_73","config-content":"_config-content_892mi_101","config-property":"_config-property_892mi_111","config-params":"_config-params_892mi_129"},L0=`<div\r
	class="config-item"\r
	data-ref="configItem"\r
	data-active="false"\r
	data-config-id=""\r
	data-status=""\r
>\r
	<div class="config-header" data-ref="configHeader">\r
		<div class="config-info">\r
			<div class="strategy-name" data-field="strategy"></div>\r
			<div class="strategy-meta">\r
				<span data-field="symbol"></span> •\r
				<span data-field="interval"></span> •\r
				<span data-field="exchange"></span>\r
			</div>\r
		</div>\r
		<div class="config-actions">\r
			<run-button></run-button>\r
			<open-button></open-button>\r
			<delete-button></delete-button>\r
		</div>\r
	</div>\r
	<div class="config-content">\r
		<div class="config-property">\r
			<span class="label">Strategy</span>\r
			<span class="value" data-ref="strategyInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Symbol</span>\r
			<span class="value" data-ref="symbolInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Interval</span>\r
			<span class="value" data-ref="intervalInput" data-key=""></span>\r
		</div>\r
		<div class="config-property">\r
			<span class="label">Exchange</span>\r
			<span class="value" data-ref="exchangeInput" data-key=""></span>\r
		</div>\r
		<div class="config-params" data-ref="paramsItems"></div>\r
	</div>\r
</div>\r
`;var ot,Dt,_i,er,at,ys,z,Du,Bu,$u,Vu,xo,So,Fu,fn,Yu,Xu,Vr,No,Hu,Oo,Uu,Wu;const Tn=class Tn extends I{constructor({configId:e}){super();f(this,z);f(this,ot,null);f(this,Dt,null);f(this,_i,new Map);f(this,er,new Map);f(this,at,{strategy:void 0,symbol:void 0,interval:void 0,exchange:void 0,params:null});f(this,ys);g(this,ys,e)}get config(){return{...o(this,at),params:{...o(this,at).params}}}get configId(){return o(this,ys)}render(){return a(this,z,Du).call(this),a(this,z,Bu).call(this),a(this,z,$u).call(this),this.element}update(e){g(this,at,{...e,params:{...e.params||{}}}),a(this,z,Fu).call(this),a(this,z,Vr).call(this),a(this,z,fn).call(this)}remove(){a(this,z,No).call(this),this.element.remove()}toggle(){const e=o(this,ot).data("active")==="true";o(this,ot).data("active",String(!e))}setProcessing(){o(this,ot).data("status","processing")}setSuccess(){o(this,ot).data("status","success")}setError(){o(this,ot).data("status","error")}clearStatus(){o(this,ot).data("status","")}handleChange(e){const i=a(this,z,Oo).call(this,e),s=M(e.target).data("param-id");if(s){a(this,z,Hu).call(this,s,e);return}if(!i)return;const n=o(this,Dt)[i],h=n.value;a(this,z,Uu).call(this,i)?(n.commit(h),a(this,z,So).call(this,i,h),a(this,z,fn).call(this)):n.rollback()}handleClick(e){if(!M(e.target).closest('[data-ref="selectInput"]')){a(this,z,Wu).call(this);return}const s=a(this,z,Oo).call(this,e),n=o(this,Dt)[s];if(!n)return;const h=M(e.target).closest("[data-ref]"),l=h.data("ref");if(l==="value"||l==="trigger"){n.toggle();return}if(l==="option"){const c=h.data("value");n.update(c),n.close(),a(this,z,So).call(this,s,c),a(this,z,fn).call(this)}}};ot=new WeakMap,Dt=new WeakMap,_i=new WeakMap,er=new WeakMap,at=new WeakMap,ys=new WeakMap,z=new WeakSet,Du=function(){const e={strategies:b.get(w.STRATEGIES),exchanges:b.get(w.EXCHANGES),intervals:b.get(w.INTERVALS)};g(this,Dt,{strategy:new ee({options:Object.keys(e.strategies)}),symbol:new ch({placeholder:Tn.DEFAULT_SYMBOL}),interval:new ee({options:e.intervals}),exchange:new ee({options:e.exchanges})})},Bu=function(){this.element=A.htmlToElement(L0,[new lh({title:"Run Setting"}),new ih({title:"Open Strategy"}),new Gs({title:"Delete Setting"})],z0),g(this,ot,M(this.element))},$u=function(){o(this,ot).data("config-id",o(this,ys)),a(this,z,Yu).call(this),a(this,z,Xu).call(this),a(this,z,Vu).call(this),a(this,z,Vr).call(this),a(this,z,fn).call(this)},Vu=function(){Object.keys(o(this,at)).forEach(e=>{var i;e!=="params"&&(o(this,at)[e]=((i=o(this,Dt)[e])==null?void 0:i.value)??null)}),a(this,z,xo).call(this)},xo=function(){const e=o(this,at).strategy;if(!e)return;const s=b.get(w.STRATEGIES)[e];s&&s.params?o(this,at).params={...s.params}:o(this,at).params={}},So=function(e,i){o(this,at)[e]=i??null,e==="strategy"&&(a(this,z,xo).call(this),a(this,z,Vr).call(this))},Fu=function(){Object.entries(o(this,at)).forEach(([e,i])=>{if(e==="params")return;const s=o(this,Dt)[e];s&&i!==null&&s.update(i)})},fn=function(){o(this,er).forEach((e,i)=>{const s=o(this,at)[i];i==="symbol"&&(!s||s==="")?e.text("[No Symbol]"):s&&e.text(s)})},Yu=function(){o(this,ot).findAll("[data-field]").forEach(e=>{const i=e.data("field");o(this,er).set(i,e)})},Xu=function(){const e={strategy:o(this,ot).find('[data-ref="strategyInput"]'),symbol:o(this,ot).find('[data-ref="symbolInput"]'),interval:o(this,ot).find('[data-ref="intervalInput"]'),exchange:o(this,ot).find('[data-ref="exchangeInput"]')};Object.entries(e).forEach(([i,s])=>{s.append(o(this,Dt)[i].render()),s.data("key",i)})},Vr=function(){a(this,z,No).call(this);const e=o(this,at).params||{},s=b.get(w.STRATEGIES)[o(this,at).strategy],n=(s==null?void 0:s.paramLabels)||{};if(Object.keys(e).length){const h=o(this,ot).find('[data-ref="paramsItems"]');Object.entries(e).forEach(([l,c])=>{const u=new uh,d=u.render();h.append(d),u.update(l,c,n[l]||l),o(this,_i).set(l,u)})}},No=function(){o(this,_i).forEach(e=>e.remove()),o(this,_i).clear()},Hu=function(e){const i=o(this,_i).get(e);if(i)if(i.isValid()){const s=i.value;o(this,at).params[e]=s,i.commit()}else i.rollback()},Oo=function(e){const i=M(e.target).closest("[data-key]");return(i==null?void 0:i.data("key"))??null},Uu=function(e){var i,s;return((s=(i=o(this,Dt)[e]).isValid)==null?void 0:s.call(i))??!0},Wu=function(){["strategy","exchange","interval"].forEach(e=>{o(this,Dt)[e].close()})},N(Tn,"COMPONENT_NAME","ConfigItem"),N(Tn,"DEFAULT_SYMBOL","BTCUSDT");let To=Tn;var Qt,ir,yi,pt,ge,Le,Pe,x,qu,ju,Qu,Gu,Zu,Ku,Ju,td,Ao,ed,id,sd,nd,ko,rd,hd,od,ad,Ro,pn,Ki,zo,ld,cd,ud,Ji,dd,fd,mn,ts;const xn=class xn extends I{constructor(){super(...arguments);f(this,x);f(this,Qt,null);f(this,ir,null);f(this,yi,null);f(this,pt,new Map);f(this,ge,new Set);f(this,Le,{optimization:new Set,execution:new Set});f(this,Pe)}get isActive(){return o(this,Qt).css("display")==="flex"}render(){return a(this,x,qu).call(this),a(this,x,ju).call(this),a(this,x,Qu).call(this),this.element}show(){o(this,Qt).css("display","flex")}hide(){o(this,Qt).css("display","none")}};Qt=new WeakMap,ir=new WeakMap,yi=new WeakMap,pt=new WeakMap,ge=new WeakMap,Le=new WeakMap,Pe=new WeakMap,x=new WeakSet,qu=function(){g(this,yi,{delete:new rh,import:new oh,export:new hh,add:new sh,clone:new nh,run:new ah})},ju=function(){this.element=A.htmlToElement(R0,Object.values(o(this,yi)),k0),g(this,Qt,M(this.element)),g(this,ir,o(this,Qt).find('[data-ref="configItems"]'))},Qu=async function(){a(this,x,ld).call(this),a(this,x,Gu).call(this),await a(this,x,od).call(this)},Gu=function(){o(this,Qt).on("change",a(this,x,Zu).bind(this)),o(this,Qt).on("click",a(this,x,Ku).bind(this)),b.subscribe(w.EXECUTION_CONTEXTS,a(this,x,Ju).bind(this)),b.subscribe(w.OPTIMIZATION_CONTEXTS,a(this,x,td).bind(this))},Zu=function(e){if(M(e.target).closest("[data-ref]").data("ref")==="fileInput"){a(this,x,cd).call(this,e.target.files);return}const s=a(this,x,zo).call(this,e);s&&(s.handleChange(e),a(this,x,Ji).call(this,s.configId,s.config))},Ku=async function(e){const i=M(e.target).closest("[data-ref]");if(!i)return;const s=i.data("ref");if(s==="configItems")return;const n={runConfigsButton:()=>a(this,x,Ao).call(this),cloneConfigsButton:()=>a(this,x,ed).call(this),addConfigButton:()=>a(this,x,id).call(this),exportConfigsButton:()=>a(this,x,sd).call(this),importConfigsButton:()=>a(this,x,nd).call(this),deleteConfigsButton:()=>a(this,x,ko).call(this)};if(n[s]){n[s]();return}const h=a(this,x,zo).call(this,e);if(!h)return;const l={configHeader:()=>h.toggle(),runButton:()=>a(this,x,Ao).call(this,[h.configId]),openButton:()=>a(this,x,hd).call(this,h.configId),deleteButton:()=>a(this,x,ko).call(this,[h.configId])};l[s]?l[s]():(h.handleClick(e),a(this,x,Ji).call(this,h.configId,h.config))},Ju=function(e){Array.from(o(this,Le).execution).forEach(i=>{if(!(i in e)){const s=o(this,pt).get(i);s&&s.clearStatus(),o(this,Le).execution.delete(i)}}),Object.entries(e).forEach(([i,s])=>{s.isLive&&o(this,Le).execution.add(i)})},td=function(e){const i=j.getItem(Q.TRADING_CONFIGS)||{};Object.entries(e).forEach(([s,n])=>{if(o(this,Le).optimization.has(s))return;const{start:h,end:l,...c}=n;n.params.forEach(u=>{const d=crypto.randomUUID(),p={...c,params:u};i[d]=p,a(this,x,Ki).call(this,d,p)}),o(this,Le).optimization.add(s)}),j.setItem(Q.TRADING_CONFIGS,i)},Ao=async function(e){const i=e||Array.from(o(this,pt).keys());if(!i.length)return;const s={};i.forEach(n=>s[n]=o(this,pt).get(n).config);try{const{added:n}=await St.add(s);n.forEach(h=>{a(this,x,mn).call(this,h,D.QUEUED),o(this,ge).add(h)}),n.length&&a(this,x,Ro).call(this)}catch(n){console.error("Failed to run configs.",n)}},ed=function(){Array.from(o(this,pt).values()).forEach(i=>{const s=crypto.randomUUID(),n={...i.config};a(this,x,Ki).call(this,s,n),a(this,x,Ji).call(this,s,n)})},id=function(){const e=crypto.randomUUID(),i=a(this,x,Ki).call(this,e);a(this,x,Ji).call(this,e,i.config)},sd=function(){const e=a(this,x,ts).call(this);if(!e||!Object.keys(e).length){X.show("info","No configs available to export");return}const s=`trading-configs_${new Date().toISOString().split("T")[0]}.json`;pa(e,s),X.show("success","Settings exported successfully")},nd=function(){o(this,yi).import.clickOnInput()},ko=function(e){const i=e||Array.from(o(this,pt).keys());i.length&&i.forEach(s=>a(this,x,fd).call(this,s))},rd=async function(e){try{const i=b.get(w.EXECUTION_CONTEXTS),s=await St.get(e),n={...i,...s};b.set(w.EXECUTION_CONTEXTS,n),a(this,x,mn).call(this,e,D.READY)}catch(i){console.error(`Failed to handle ready context ${e}.`,i)}},hd=function(e){const i=b.get(w.EXECUTION_CONTEXTS);if(!i[e]){X.show("warning","Strategy not created or was deleted");return}if(b.get(w.EXECUTION_CONTEXT).id===e)return;const n=i[e];b.set(w.EXECUTION_CONTEXT,{id:e,...n})},od=async function(){try{const e=await St.getAllStatuses();await Promise.all(Object.entries(e).map(async([s,n])=>{a(this,x,mn).call(this,s,n)})),Object.values(e).some(s=>[D.QUEUED,D.CREATING].includes(s))&&a(this,x,Ro).call(this)}catch(e){console.error("Failed to sync statuses.",e)}},ad=async function(){try{if(!o(this,ge).size){a(this,x,pn).call(this);return}for(const e of Array.from(o(this,ge))){const{status:i}=await St.getStatus(e);i===D.READY?(await a(this,x,rd).call(this,e),o(this,ge).delete(e)):i===D.FAILED&&(a(this,x,mn).call(this,e,D.FAILED),o(this,ge).delete(e))}o(this,ge).size||a(this,x,pn).call(this)}catch(e){console.error("Polling failed.",e),a(this,x,pn).call(this)}},Ro=function(){o(this,Pe)||g(this,Pe,setInterval(()=>a(this,x,ad).call(this),Vl))},pn=function(){o(this,Pe)&&(clearInterval(o(this,Pe)),g(this,Pe,void 0))},Ki=function(e,i){const s=new To({configId:e});return o(this,ir).append(s.render()),o(this,pt).set(e,s),i&&s.update(i),s},zo=function(e){const i=M(e.target).closest('[data-ref="configItem"]');if(!i)return null;const s=i.data("config-id");return o(this,pt).get(s)},ld=function(){const e=a(this,x,ts).call(this);Object.entries(e).forEach(([i,s])=>{a(this,x,Ki).call(this,i,s)})},cd=function(e){if(!e||!e.length)return;const i=e[0],s=new FileReader;s.onload=n=>{try{const h=JSON.parse(n.target.result);a(this,x,ud).call(this,h),o(this,yi).import.resetInput(),X.show("success","Settings imported successfully")}catch{X.show("error","The file you selected is not a valid JSON settings file")}},s.readAsText(i)},ud=function(e){if(!e||typeof e!="object")return;const i=a(this,x,ts).call(this);Object.entries(e).forEach(([s,n])=>{if(!ma(n,xn.REQUIRED_KEYS))return;const l={...i[s]||{},...n},c=o(this,pt).get(s);c?c.update(l):a(this,x,Ki).call(this,s,l),a(this,x,Ji).call(this,s,l)})},Ji=function(e,i){const s=a(this,x,ts).call(this);s[e]=i,j.setItem(Q.TRADING_CONFIGS,s)},dd=function(e){const i=a(this,x,ts).call(this);delete i[e],j.setItem(Q.TRADING_CONFIGS,i)},fd=async function(e){const i=o(this,pt).get(e);i&&(i.remove(),o(this,pt).delete(e),a(this,x,dd).call(this,e),o(this,pt).size||a(this,x,pn).call(this))},mn=function(e,i){const s=o(this,pt).get(e);s&&(s.clearStatus(),[D.QUEUED,D.CREATING].includes(i)?s.setProcessing():i===D.READY?s.setSuccess():i===D.FAILED&&s.setError())},ts=function(){return j.getItem(Q.TRADING_CONFIGS)||{}},N(xn,"COMPONENT_NAME","TradingTab"),N(xn,"REQUIRED_KEYS",["strategy","symbol","interval","exchange","params"]);let Io=xn;var Ei,Tt,md,gd,vd,bd,wd,_d;class pd extends I{constructor(){super(...arguments);f(this,Tt);f(this,Ei,null)}render(){return a(this,Tt,gd).call(this),a(this,Tt,vd).call(this),this.element}showOnly(e){if(this.tabs[e].isActive&&o(this,Tt,md)){a(this,Tt,wd).call(this);return}a(this,Tt,bd).call(this),a(this,Tt,_d).call(this,e)}}Ei=new WeakMap,Tt=new WeakSet,md=function(){return o(this,Ei).css("display")==="flex"},gd=function(){this.tabs={strategies:new Su,params:new wu,alerts:new jl,optimization:new vo,backtesting:new lo,trading:new Io}},vd=function(){this.element=A.htmlToElement(lv,Object.values(this.tabs),av),g(this,Ei,M(this.element))},bd=function(){o(this,Ei).css("display","flex")},wd=function(){o(this,Ei).css("display","none")},_d=function(e){for(const[i,s]of Object.entries(this.tabs))i===e?s.show():s.hide()},N(pd,"COMPONENT_NAME","ControllerContent");const P0={"controller-sidebar":"_controller-sidebar_guqof_1","buttons-group":"_buttons-group_guqof_15"},D0=`<div class="controller-sidebar">\r
	<div class="buttons-group">\r
		<component-strategies-tab-button></component-strategies-tab-button>\r
		<component-params-tab-button></component-params-tab-button>\r
		<component-alerts-tab-button></component-alerts-tab-button>\r
	</div>\r
	<hr />\r
	<div class="buttons-group">\r
		<component-optimization-tab-button></component-optimization-tab-button>\r
		<component-backtesting-tab-button></component-backtesting-tab-button>\r
		<component-trading-tab-button></component-trading-tab-button>\r
	</div>\r
	<div class="buttons-group">\r
		<component-theme-button></component-theme-button>\r
		<component-docs-button></component-docs-button>\r
	</div>\r
</div>\r
`,B0={"alerts-tab-button":"_alerts-tab-button_1tr6j_1"},$0=`<button class="alerts-tab-button" data-active="false">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 44 44"\r
		width="44"\r
		height="44"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M35 14.66 29.16 9l-.7.72 5.84 5.66.7-.72ZM9 14.66 14.84 9l.7.72-5.84 5.66-.7-.72ZM22 16v7h-5v1h6v-8h-1Z"\r
		></path>\r
		<path\r
			fill="currentColor"\r
			fill-rule="evenodd"\r
			d="M22 33a11 11 0 1 0 0-22 11 11 0 0 0 0 22Zm0-1a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var De;class yd extends I{constructor(){super(...arguments);f(this,De,null)}get isActive(){return o(this,De).is("data-active")}render(){return this.element=A.htmlToElement($0,[],B0),g(this,De,M(this.element)),this.element}setOnClick(e){o(this,De).click(e)}activate(){o(this,De).data("active","true")}deactivate(){o(this,De).data("active","false")}}De=new WeakMap,N(yd,"COMPONENT_NAME","AlertsTabButton");const V0={"backtesting-tab-button":"_backtesting-tab-button_hnp66_1"},F0=`<button class="backtesting-tab-button" data-active="false">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
		fill="none"\r
	>\r
		<path\r
			stroke="currentColor"\r
			d="M6 12l4.8-4.8a1 1 0 0 1 1.4 0l2.7 2.7a1 1 0 0 0 1.3.1L23 5"\r
		></path>\r
		<path\r
			fill="currentColor"\r
			fill-rule="evenodd"\r
			d="M19 12a1 1 0 0 0-1 1v4h-3v-1a1 1 0 0 0-1-1h-3a1 1 0 0 0-1 1v2H7a1 1 0 0 0-1 1v4h17V13a1 1 0 0 0-1-1h-3zm0 10h3v-9h-3v9zm-1 0v-4h-3v4h3zm-4-4.5V22h-3v-6h3v1.5zM10 22v-3H7v3h3z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Be;class Ed extends I{constructor(){super(...arguments);f(this,Be,null)}get isActive(){return o(this,Be).is("data-active")}render(){return this.element=A.htmlToElement(F0,[],V0),g(this,Be,M(this.element)),this.element}setOnClick(e){o(this,Be).click(e)}activate(){o(this,Be).data("active","true")}deactivate(){o(this,Be).data("active","false")}}Be=new WeakMap,N(Ed,"COMPONENT_NAME","BacktestingTabButton");const Y0={"docs-button":"_docs-button_1a3p5_1"},X0=`<button class="docs-button">\r
	<a href="https://github.com/albert-alanreys/jinn-docs" target="_blank">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 28 28"\r
			width="28"\r
			height="28"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M14 3a11 11 0 1 1 0 22 11 11 0 0 1 0-22m0 1a10 10 0 1 0 0 20 10 10 0 0 0 0-20m0 14a1 1 0 1 1 0 2 1 1 0 0 1 0-2m.22-10a3.78 3.78 0 0 1 2.08 6.93l-1.06.7c-.46.3-.74.82-.74 1.37h-1c0-.89.45-1.72 1.19-2.2l1.06-.7A2.77 2.77 0 0 0 14.22 9H14a3 3 0 0 0-3 3h-1a4 4 0 0 1 4-4z"\r
			></path>\r
		</svg>\r
	</a>\r
</button>\r
`;class Cd extends I{render(){return this.element=A.htmlToElement(X0,[],Y0),this.element}}N(Cd,"COMPONENT_NAME","DocsButton");const H0={"optimization-tab-button":"_optimization-tab-button_13h0p_1"},U0=`<button class="optimization-tab-button" data-active="false">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
		fill="none"\r
	>\r
		<path\r
			stroke="currentColor"\r
			stroke-width=".91"\r
			d="M8 16h5v8l7-11h-5V4L8 16Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var $e;class Md extends I{constructor(){super(...arguments);f(this,$e,null)}get isActive(){return o(this,$e).is("data-active")}render(){return this.element=A.htmlToElement(U0,[],H0),g(this,$e,M(this.element)),this.element}setOnClick(e){o(this,$e).click(e)}activate(){o(this,$e).data("active","true")}deactivate(){o(this,$e).data("active","false")}}$e=new WeakMap,N(Md,"COMPONENT_NAME","OptimizationTabButton");const W0={"params-tab-button":"_params-tab-button_1xwfe_1"},q0=`<button class="params-tab-button" data-active="false">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
		fill="currentColor"\r
	>\r
		<path\r
			fill-rule="evenodd"\r
			d="M18 14a4 4 0 1 1-8 0 4 4 0 0 1 8 0Zm-1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"\r
		></path>\r
		<path\r
			fill-rule="evenodd"\r
			d="M8.5 5h11l5 9-5 9h-11l-5-9 5-9Zm-3.86 9L9.1 6h9.82l4.45 8-4.45 8H9.1l-4.45-8Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Ve;class Td extends I{constructor(){super(...arguments);f(this,Ve,null)}get isActive(){return o(this,Ve).is("data-active")}render(){return this.element=A.htmlToElement(q0,[],W0),g(this,Ve,M(this.element)),this.element}setOnClick(e){o(this,Ve).click(e)}activate(){o(this,Ve).data("active","true")}deactivate(){o(this,Ve).data("active","false")}}Ve=new WeakMap,N(Td,"COMPONENT_NAME","ParamsTabButton");const j0={"strategies-tab-button":"_strategies-tab-button_bh98p_1"},Q0=`<button class="strategies-tab-button" data-active="true">\r
	<span>\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 44 44"\r
			width="44"\r
			height="44"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M13 11h18a2 2 0 0 1 2 2v17a2 2 0 0 1-2 2H13a2 2 0 0 1-2-2V13c0-1.1.9-2 2-2Zm18-1H13a3 3 0 0 0-3 3v17a3 3 0 0 0 3 3h18a3 3 0 0 0 3-3V13a3 3 0 0 0-3-3Zm-2 11H15v1h14v-1Zm-14-5h14v1H15v-1Zm14 10H15v1h14v-1Z"\r
			></path>\r
		</svg>\r
	</span>\r
</button>\r
`;var Fe;class xd extends I{constructor(){super(...arguments);f(this,Fe,null)}get isActive(){return o(this,Fe).is("data-active")}render(){return this.element=A.htmlToElement(Q0,[],j0),g(this,Fe,M(this.element)),this.element}setOnClick(e){o(this,Fe).click(e)}activate(){o(this,Fe).data("active","true")}deactivate(){o(this,Fe).data("active","false")}}Fe=new WeakMap,N(xd,"COMPONENT_NAME","StrategiesTabButton");const G0={"theme-button":"_theme-button_19q0t_1"},Z0=`<button class="theme-button" data-active="false">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			fill-rule="evenodd"\r
			d="M19.67 6.44a8.27 8.27 0 0 0-3.57-1.39 9 9 0 1 0 .54 17.83 8.71 8.71 0 0 0 3.63-1.8c.38-.29.74-.6 1.07-.9 0 0-.55 0-1.35-.15-2.11-.38-5.96-1.68-5.96-6.03 0-4.32 3.5-5.92 5.46-6.47.76-.22 1.3-.28 1.3-.28a14.2 14.2 0 0 0-1.12-.8Zm-1.3.4a6.54 6.54 0 0 0-2.37-.8 8 8 0 1 0 .48 15.85c.79-.13 1.63-.54 2.44-1.07-.51-.13-1.07-.31-1.63-.56a7.46 7.46 0 0 1-2.9-2.14A6.44 6.44 0 0 1 13.03 14a7.13 7.13 0 0 1 3.9-6.5c.49-.28.99-.5 1.45-.66Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Es,Bt,Nd,Od,Id,Lo;class Sd extends I{constructor(){super(...arguments);f(this,Bt);f(this,Es,null)}render(){return a(this,Bt,Nd).call(this),a(this,Bt,Od).call(this),this.element}}Es=new WeakMap,Bt=new WeakSet,Nd=function(){this.element=A.htmlToElement(Z0,[],G0),g(this,Es,M(this.element))},Od=function(){o(this,Es).on("click",a(this,Bt,Id).bind(this)),a(this,Bt,Lo).call(this)},Id=function(){Pr.toggle(),a(this,Bt,Lo).call(this)},Lo=function(){const e=Pr.get()===Pr.DARK;o(this,Es).data("active",e.toString())},N(Sd,"COMPONENT_NAME","ThemeButton");const K0={"trading-tab-button":"_trading-tab-button_j6w11_1"},J0=`<button class="trading-tab-button" data-active="false">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M4.5 3C3.67 3 3 3.67 3 4.5v13c0 .83.67 1.5 1.5 1.5H13v3H7.5a.5.5 0 0 0 0 1h12a.5.5 0 1 0 0-1H14v-3h8.5c.83 0 1.5-.67 1.5-1.5v-13c0-.83-.67-1.5-1.5-1.5h-18ZM4 4.5c0-.28.22-.5.5-.5h18c.28 0 .5.22.5.5v13a.5.5 0 0 1-.5.5h-18a.5.5 0 0 1-.5-.5v-13Zm15.85 4.35a.5.5 0 1 0-.7-.7L15 12.29l-2.65-2.64a.5.5 0 0 0-.7 0l-4.5 4.5a.5.5 0 0 0 .7.7L12 10.71l2.65 2.64c.2.2.5.2.7 0l4.5-4.5Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Ye;class Ad extends I{constructor(){super(...arguments);f(this,Ye,null)}get isActive(){return o(this,Ye).is("data-active")}render(){return this.element=A.htmlToElement(J0,[],K0),g(this,Ye,M(this.element)),this.element}setOnClick(e){o(this,Ye).click(e)}activate(){o(this,Ye).data("active","true")}deactivate(){o(this,Ye).data("active","false")}}Ye=new WeakMap,N(Ad,"COMPONENT_NAME","TradingTabButton");var Ke,Rd,zd,Ld;class kd extends I{constructor(){super(...arguments);f(this,Ke)}render(){return a(this,Ke,Rd).call(this),a(this,Ke,zd).call(this),this.element}connectButtons(e){Object.entries(this.buttons).forEach(([i,s])=>{s.setOnClick(()=>{s.isActive?s.deactivate():a(this,Ke,Ld).call(this,i),e==null||e(i)})})}}Ke=new WeakSet,Rd=function(){this.buttons={strategies:new xd,params:new Td,alerts:new yd,optimization:new Md,backtesting:new Ed,trading:new Ad}},zd=function(){this.element=A.htmlToElement(D0,[...Object.values(this.buttons),Sd,Cd],P0)},Ld=function(e){for(const[i,s]of Object.entries(this.buttons))i===e?s.activate():s.deactivate()},N(kd,"COMPONENT_NAME","ControllerSidebar");var Je,Dd,Bd,$d;class Pd extends I{constructor(){super(...arguments);f(this,Je)}render(){return a(this,Je,Dd).call(this),a(this,Je,Bd).call(this),a(this,Je,$d).call(this),this.element}}Je=new WeakSet,Dd=function(){this.controllerContent=new pd,this.controllerSidebar=new kd},Bd=function(){this.element=A.htmlToElement(ov,[this.controllerContent,this.controllerSidebar],hv)},$d=function(){this.controllerSidebar.connectButtons(e=>{this.controllerContent.showOnly(e)})},N(Pd,"COMPONENT_NAME","Controller");const t1="_dashboard_x3hjs_1",e1={dashboard:t1},i1=`<div class="dashboard">\r
	<component-chart-panel></component-chart-panel>\r
	<component-report-panel></component-report-panel>\r
</div>\r
`;function Y(r){var t=r.width,e=r.height;if(t<0)throw new Error("Negative width is not allowed for Size");if(e<0)throw new Error("Negative height is not allowed for Size");return{width:t,height:e}}function Bi(r,t){return r.width===t.width&&r.height===t.height}var s1=function(){function r(t){var e=this;this._resolutionListener=function(){return e._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return r.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(r.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),r.prototype.subscribe=function(t){var e=this,i={next:t};return this._observers.push(i),{unsubscribe:function(){e._observers=e._observers.filter(function(s){return s!==i})}}},r.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},r.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},r.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},r.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach(function(e){return e.next(t._window.devicePixelRatio)}),this._reinstallResolutionListener()},r}();function n1(r){return new s1(r)}var r1=function(){function r(t,e,i){var s;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=Y({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=e??function(n){return n},this._allowResizeObserver=(s=i==null?void 0:i.allowResizeObserver)!==null&&s!==void 0?s:!0,this._chooseAndInitObserver()}return r.prototype.dispose=function(){var t,e;if(this._canvasElement===null)throw new Error("Object is disposed");(t=this._canvasElementResizeObserver)===null||t===void 0||t.disconnect(),this._canvasElementResizeObserver=null,(e=this._devicePixelRatioObservable)===null||e===void 0||e.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(r.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bitmapSize",{get:function(){return Y({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),r.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=Y(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},r.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},r.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(e){return e!==t})},Object.defineProperty(r.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),r.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},r.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(e){return e!==t})},r.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},r.prototype._resizeBitmap=function(t){var e=this.bitmapSize;Bi(e,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(e,t))},r.prototype._emitBitmapSizeChanged=function(t,e){var i=this;this._bitmapSizeChangedListeners.forEach(function(s){return s.call(i,t,e)})},r.prototype._suggestNewBitmapSize=function(t){var e=this._suggestedBitmapSize,i=Y(this._transformBitmapSize(t,this._canvasElementClientSize)),s=Bi(this.bitmapSize,i)?null:i;e===null&&s===null||e!==null&&s!==null&&Bi(e,s)||(this._suggestedBitmapSize=s,this._emitSuggestedBitmapSizeChanged(e,s))},r.prototype._emitSuggestedBitmapSizeChanged=function(t,e){var i=this;this._suggestedBitmapSizeChangedListeners.forEach(function(s){return s.call(i,t,e)})},r.prototype._chooseAndInitObserver=function(){var t=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}o1().then(function(e){return e?t._initResizeObserver():t._initDevicePixelRatioObservable()})},r.prototype._initDevicePixelRatioObservable=function(){var t=this;if(this._canvasElement!==null){var e=Ra(this._canvasElement);if(e===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=n1(e),this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()}),this._invalidateBitmapSize()}},r.prototype._invalidateBitmapSize=function(){var t,e;if(this._canvasElement!==null){var i=Ra(this._canvasElement);if(i!==null){var s=(e=(t=this._devicePixelRatioObservable)===null||t===void 0?void 0:t.value)!==null&&e!==void 0?e:i.devicePixelRatio,n=this._canvasElement.getClientRects(),h=n[0]!==void 0?a1(n[0],s):Y({width:this._canvasElementClientSize.width*s,height:this._canvasElementClientSize.height*s});this._suggestNewBitmapSize(h)}}},r.prototype._initResizeObserver=function(){var t=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(e){var i=e.find(function(h){return h.target===t._canvasElement});if(!(!i||!i.devicePixelContentBoxSize||!i.devicePixelContentBoxSize[0])){var s=i.devicePixelContentBoxSize[0],n=Y({width:s.inlineSize,height:s.blockSize});t._suggestNewBitmapSize(n)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},r}();function h1(r,t){return new r1(r,t.transform,t.options)}function Ra(r){return r.ownerDocument.defaultView}function o1(){return new Promise(function(r){var t=new ResizeObserver(function(e){r(e.every(function(i){return"devicePixelContentBoxSize"in i})),t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function a1(r,t){return Y({width:Math.round(r.left*t+r.width*t)-Math.round(r.left*t),height:Math.round(r.top*t+r.height*t)-Math.round(r.top*t)})}var l1=function(){function r(t,e,i){if(e.width===0||e.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=e,i.width===0||i.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=i,this._context=t}return r.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},r.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(r.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),r}();function $i(r,t){var e=r.canvasElementClientSize;if(e.width===0||e.height===0)return null;var i=r.bitmapSize;if(i.width===0||i.height===0)return null;var s=r.canvasElement.getContext("2d",t);return s===null?null:new l1(s,e,i)}/*!
 * @license
 * TradingView Lightweight Charts™ v5.0.7
 * Copyright (c) 2025 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const Vd={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var za,La;function Vi(r,t){const e={0:[],1:[r.lineWidth,r.lineWidth],2:[2*r.lineWidth,2*r.lineWidth],3:[6*r.lineWidth,6*r.lineWidth],4:[r.lineWidth,4*r.lineWidth]}[t];r.setLineDash(e)}function Fd(r,t,e,i){r.beginPath();const s=r.lineWidth%2?.5:0;r.moveTo(e,t+s),r.lineTo(i,t+s),r.stroke()}function ut(r,t){if(!r)throw new Error("Assertion failed"+(t?": "+t:""))}function Mt(r){if(r===void 0)throw new Error("Value is undefined");return r}function E(r){if(r===null)throw new Error("Value is null");return r}function Ge(r){return E(Mt(r))}(function(r){r[r.Simple=0]="Simple",r[r.WithSteps=1]="WithSteps",r[r.Curved=2]="Curved"})(za||(za={})),function(r){r[r.Solid=0]="Solid",r[r.Dotted=1]="Dotted",r[r.Dashed=2]="Dashed",r[r.LargeDashed=3]="LargeDashed",r[r.SparseDotted=4]="SparseDotted"}(La||(La={}));class G{constructor(){this.t=[]}i(t,e,i){const s={h:t,l:e,o:i===!0};this.t.push(s)}_(t){const e=this.t.findIndex(i=>t===i.h);e>-1&&this.t.splice(e,1)}u(t){this.t=this.t.filter(e=>e.l!==t)}p(t,e,i){const s=[...this.t];this.t=this.t.filter(n=>!n.o),s.forEach(n=>n.h(t,e,i))}v(){return this.t.length>0}m(){this.t=[]}}function Ot(r,...t){for(const e of t)for(const i in e)e[i]!==void 0&&Object.prototype.hasOwnProperty.call(e,i)&&!["__proto__","constructor","prototype"].includes(i)&&(typeof e[i]!="object"||r[i]===void 0||Array.isArray(e[i])?r[i]=e[i]:Ot(r[i],e[i]));return r}function Fi(r){return typeof r=="number"&&isFinite(r)}function An(r){return typeof r=="number"&&r%1==0}function Mr(r){return typeof r=="string"}function Sr(r){return typeof r=="boolean"}function we(r){const t=r;if(!t||typeof t!="object")return t;let e,i,s;for(i in e=Array.isArray(t)?[]:{},t)t.hasOwnProperty(i)&&(s=t[i],e[i]=s&&typeof s=="object"?we(s):s);return e}function c1(r){return r!==null}function kn(r){return r===null?void 0:r}const Yd="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function Rn(r,t,e){return t===void 0&&(t=Yd),`${e=e!==void 0?`${e} `:""}${r}px ${t}`}class u1{constructor(t){this.M={S:1,C:5,k:NaN,P:"",T:"",R:"",D:"",V:0,I:0,B:0,A:0,L:0},this.O=t}N(){const t=this.M,e=this.W(),i=this.F();return t.k===e&&t.T===i||(t.k=e,t.T=i,t.P=Rn(e,i),t.A=2.5/12*e,t.V=t.A,t.I=e/12*t.C,t.B=e/12*t.C,t.L=0),t.R=this.H(),t.D=this.U(),this.M}H(){return this.O.N().layout.textColor}U(){return this.O.$()}W(){return this.O.N().layout.fontSize}F(){return this.O.N().layout.fontFamily}}function Mh(r){return r<0?0:r>255?255:Math.round(r)||0}function Pa(r){return .199*r[0]+.687*r[1]+.114*r[2]}class d1{constructor(t,e){this.q=new Map,this.Y=t,e&&(this.q=e)}j(t,e){if(t==="transparent")return t;const i=this.K(t),s=i[3];return`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${e*s})`}X(t){const e=this.K(t);return{Z:`rgb(${e[0]}, ${e[1]}, ${e[2]})`,G:Pa(e)>160?"black":"white"}}J(t){return Pa(this.K(t))}tt(t,e,i){const[s,n,h,l]=this.K(t),[c,u,d,p]=this.K(e),m=[Mh(s+i*(c-s)),Mh(n+i*(u-n)),Mh(h+i*(d-h)),(v=l+i*(p-l),v<=0||v>1?Math.min(Math.max(v,0),1):Math.round(1e4*v)/1e4)];var v;return`rgba(${m[0]}, ${m[1]}, ${m[2]}, ${m[3]})`}K(t){const e=this.q.get(t);if(e)return e;const i=function(h){const l=document.createElement("div");l.style.display="none",document.body.appendChild(l),l.style.color=h;const c=window.getComputedStyle(l).color;return document.body.removeChild(l),c}(t),s=i.match(/^rgba?\s*\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d+))?\)$/);if(!s){if(this.Y.length)for(const h of this.Y){const l=h(t);if(l)return this.q.set(t,l),l}throw new Error(`Failed to parse color: ${t}`)}const n=[parseInt(s[1],10),parseInt(s[2],10),parseInt(s[3],10),s[4]?parseFloat(s[4]):1];return this.q.set(t,n),n}}class Xd{constructor(){this.it=[]}st(t){this.it=t}nt(t,e,i){this.it.forEach(s=>{s.nt(t,e,i)})}}class Ee{nt(t,e,i){t.useBitmapCoordinateSpace(s=>this.et(s,e,i))}}class f1 extends Ee{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.rt===null||this.rt.lt===null)return;const s=this.rt.lt,n=this.rt,h=Math.max(1,Math.floor(e))%2/2,l=c=>{t.beginPath();for(let u=s.to-1;u>=s.from;--u){const d=n.ot[u],p=Math.round(d._t*e)+h,m=d.ut*i,v=c*i+h;t.moveTo(p,m),t.arc(p,m,v,0,2*Math.PI)}t.fill()};n.ct>0&&(t.fillStyle=n.dt,l(n.ft+n.ct)),t.fillStyle=n.vt,l(n.ft)}}function p1(){return{ot:[{_t:0,ut:0,wt:0,gt:0}],vt:"",dt:"",ft:0,ct:0,lt:null}}const m1={from:0,to:1};class g1{constructor(t,e,i){this.Mt=new Xd,this.bt=[],this.St=[],this.xt=!0,this.O=t,this.Ct=e,this.yt=i,this.Mt.st(this.bt)}kt(t){this.Pt(),this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Mt}Pt(){const t=this.yt.Dt();t.length!==this.bt.length&&(this.St=t.map(p1),this.bt=this.St.map(e=>{const i=new f1;return i.ht(e),i}),this.Mt.st(this.bt))}Rt(){const t=this.Ct.N().mode===2||!this.Ct.Vt(),e=this.yt.It(),i=this.Ct.Bt(),s=this.O.At();this.Pt(),e.forEach((n,h)=>{const l=this.St[h],c=n.Et(i),u=n.zt();!t&&c!==null&&n.Vt()&&u!==null?(l.vt=c.Lt,l.ft=c.ft,l.ct=c.Ot,l.ot[0].gt=c.gt,l.ot[0].ut=n.Wt().Nt(c.gt,u.Ft),l.dt=c.Ht??this.O.Ut(l.ot[0].ut/n.Wt().$t()),l.ot[0].wt=i,l.ot[0]._t=s.qt(i),l.lt=m1):l.lt=null})}}class v1 extends Ee{constructor(t){super(),this.Yt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.Yt===null)return;const n=this.Yt.jt.Vt,h=this.Yt.Kt.Vt;if(!n&&!h)return;const l=Math.round(this.Yt._t*i),c=Math.round(this.Yt.ut*s);t.lineCap="butt",n&&l>=0&&(t.lineWidth=Math.floor(this.Yt.jt.ct*i),t.strokeStyle=this.Yt.jt.R,t.fillStyle=this.Yt.jt.R,Vi(t,this.Yt.jt.Xt),function(u,d,p,m){u.beginPath();const v=u.lineWidth%2?.5:0;u.moveTo(d+v,p),u.lineTo(d+v,m),u.stroke()}(t,l,0,e.height)),h&&c>=0&&(t.lineWidth=Math.floor(this.Yt.Kt.ct*s),t.strokeStyle=this.Yt.Kt.R,t.fillStyle=this.Yt.Kt.R,Vi(t,this.Yt.Kt.Xt),Fd(t,c,0,e.width))}}class b1{constructor(t,e){this.xt=!0,this.Zt={jt:{ct:1,Xt:0,R:"",Vt:!1},Kt:{ct:1,Xt:0,R:"",Vt:!1},_t:0,ut:0},this.Gt=new v1(this.Zt),this.Jt=t,this.yt=e}kt(){this.xt=!0}Tt(t){return this.xt&&(this.Rt(),this.xt=!1),this.Gt}Rt(){const t=this.Jt.Vt(),e=this.yt.Qt().N().crosshair,i=this.Zt;if(e.mode===2)return i.Kt.Vt=!1,void(i.jt.Vt=!1);i.Kt.Vt=t&&this.Jt.ti(this.yt),i.jt.Vt=t&&this.Jt.ii(),i.Kt.ct=e.horzLine.width,i.Kt.Xt=e.horzLine.style,i.Kt.R=e.horzLine.color,i.jt.ct=e.vertLine.width,i.jt.Xt=e.vertLine.style,i.jt.R=e.vertLine.color,i._t=this.Jt.si(),i.ut=this.Jt.ni()}}function w1(r,t,e,i,s,n){r.fillRect(t+n,e,i-2*n,n),r.fillRect(t+n,e+s-n,i-2*n,n),r.fillRect(t,e,n,s),r.fillRect(t+i-n,e,n,s)}function dh(r,t,e,i,s,n){r.save(),r.globalCompositeOperation="copy",r.fillStyle=n,r.fillRect(t,e,i,s),r.restore()}function Da(r,t,e,i,s,n){r.beginPath(),r.roundRect?r.roundRect(t,e,i,s,n):(r.lineTo(t+i-n[1],e),n[1]!==0&&r.arcTo(t+i,e,t+i,e+n[1],n[1]),r.lineTo(t+i,e+s-n[2]),n[2]!==0&&r.arcTo(t+i,e+s,t+i-n[2],e+s,n[2]),r.lineTo(t+n[3],e+s),n[3]!==0&&r.arcTo(t,e+s,t,e+s-n[3],n[3]),r.lineTo(t,e+n[0]),n[0]!==0&&r.arcTo(t,e,t+n[0],e,n[0]))}function Ba(r,t,e,i,s,n,h=0,l=[0,0,0,0],c=""){if(r.save(),!h||!c||c===n)return Da(r,t,e,i,s,l),r.fillStyle=n,r.fill(),void r.restore();const u=h/2;var d;Da(r,t+u,e+u,i-h,s-h,(d=-u,l.map(p=>p===0?p:p+d))),n!=="transparent"&&(r.fillStyle=n,r.fill()),c!=="transparent"&&(r.lineWidth=h,r.strokeStyle=c,r.closePath(),r.stroke()),r.restore()}function Hd(r,t,e,i,s,n,h){r.save(),r.globalCompositeOperation="copy";const l=r.createLinearGradient(0,0,0,s);l.addColorStop(0,n),l.addColorStop(1,h),r.fillStyle=l,r.fillRect(t,e,i,s),r.restore()}class $a{constructor(t,e){this.ht(t,e)}ht(t,e){this.Yt=t,this.ei=e}$t(t,e){return this.Yt.Vt?t.k+t.A+t.V:0}nt(t,e,i,s){if(!this.Yt.Vt||this.Yt.ri.length===0)return;const n=this.Yt.R,h=this.ei.Z,l=t.useBitmapCoordinateSpace(c=>{const u=c.context;u.font=e.P;const d=this.hi(c,e,i,s),p=d.ai;return d.li?Ba(u,p.oi,p._i,p.ui,p.ci,h,p.di,[p.ft,0,0,p.ft],h):Ba(u,p.fi,p._i,p.ui,p.ci,h,p.di,[0,p.ft,p.ft,0],h),this.Yt.pi&&(u.fillStyle=n,u.fillRect(p.fi,p.mi,p.wi-p.fi,p.gi)),this.Yt.Mi&&(u.fillStyle=e.D,u.fillRect(d.li?p.bi-p.di:0,p._i,p.di,p.Si-p._i)),d});t.useMediaCoordinateSpace(({context:c})=>{const u=l.xi;c.font=e.P,c.textAlign=l.li?"right":"left",c.textBaseline="middle",c.fillStyle=n,c.fillText(this.Yt.ri,u.Ci,(u._i+u.Si)/2+u.yi)})}hi(t,e,i,s){const{context:n,bitmapSize:h,mediaSize:l,horizontalPixelRatio:c,verticalPixelRatio:u}=t,d=this.Yt.pi||!this.Yt.ki?e.C:0,p=this.Yt.Pi?e.S:0,m=e.A+this.ei.Ti,v=e.V+this.ei.Ri,_=e.I,C=e.B,O=this.Yt.ri,k=e.k,P=i.Di(n,O),U=Math.ceil(i.Vi(n,O)),W=k+m+v,xt=e.S+_+C+U+d,zt=Math.max(1,Math.floor(u));let kt=Math.round(W*u);kt%2!=zt%2&&(kt+=1);const ce=p>0?Math.max(1,Math.floor(p*c)):0,Ce=Math.round(xt*c),Zs=Math.round(d*c),Rg=this.ei.Ii??this.ei.Bi,xa=Math.round(Rg*u)-Math.floor(.5*u),wh=Math.floor(xa+zt/2-kt/2),Sa=wh+kt,xr=s==="right",Na=xr?l.width-p:p,Ks=xr?h.width-ce:ce;let _h,yh,Eh;return xr?(_h=Ks-Ce,yh=Ks-Zs,Eh=Na-d-_-p):(_h=Ks+Ce,yh=Ks+Zs,Eh=Na+d+_),{li:xr,ai:{_i:wh,mi:xa,Si:Sa,ui:Ce,ci:kt,ft:2*c,di:ce,oi:_h,fi:Ks,wi:yh,gi:zt,bi:h.width},xi:{_i:wh/u,Si:Sa/u,Ci:Eh,yi:P}}}}class fh{constructor(t){this.Ai={Bi:0,Z:"#000",Ri:0,Ti:0},this.Ei={ri:"",Vt:!1,pi:!0,ki:!1,Ht:"",R:"#FFF",Mi:!1,Pi:!1},this.zi={ri:"",Vt:!1,pi:!1,ki:!0,Ht:"",R:"#FFF",Mi:!0,Pi:!0},this.xt=!0,this.Li=new(t||$a)(this.Ei,this.Ai),this.Oi=new(t||$a)(this.zi,this.Ai)}ri(){return this.Ni(),this.Ei.ri}Bi(){return this.Ni(),this.Ai.Bi}kt(){this.xt=!0}$t(t,e=!1){return Math.max(this.Li.$t(t,e),this.Oi.$t(t,e))}Wi(){return this.Ai.Ii||0}Fi(t){this.Ai.Ii=t}Hi(){return this.Ni(),this.Ei.Vt||this.zi.Vt}Ui(){return this.Ni(),this.Ei.Vt}Tt(t){return this.Ni(),this.Ei.pi=this.Ei.pi&&t.N().ticksVisible,this.zi.pi=this.zi.pi&&t.N().ticksVisible,this.Li.ht(this.Ei,this.Ai),this.Oi.ht(this.zi,this.Ai),this.Li}$i(){return this.Ni(),this.Li.ht(this.Ei,this.Ai),this.Oi.ht(this.zi,this.Ai),this.Oi}Ni(){this.xt&&(this.Ei.pi=!0,this.zi.pi=!1,this.qi(this.Ei,this.zi,this.Ai))}}class _1 extends fh{constructor(t,e,i){super(),this.Jt=t,this.Yi=e,this.ji=i}qi(t,e,i){if(t.Vt=!1,this.Jt.N().mode===2)return;const s=this.Jt.N().horzLine;if(!s.labelVisible)return;const n=this.Yi.zt();if(!this.Jt.Vt()||this.Yi.Ki()||n===null)return;const h=this.Yi.Xi().X(s.labelBackgroundColor);i.Z=h.Z,t.R=h.G;const l=2/12*this.Yi.k();i.Ti=l,i.Ri=l;const c=this.ji(this.Yi);i.Bi=c.Bi,t.ri=this.Yi.Zi(c.gt,n),t.Vt=!0}}const y1=/[1-9]/g;class Ud{constructor(){this.Yt=null}ht(t){this.Yt=t}nt(t,e){if(this.Yt===null||this.Yt.Vt===!1||this.Yt.ri.length===0)return;const i=t.useMediaCoordinateSpace(({context:m})=>(m.font=e.P,Math.round(e.Gi.Vi(m,E(this.Yt).ri,y1))));if(i<=0)return;const s=e.Ji,n=i+2*s,h=n/2,l=this.Yt.Qi;let c=this.Yt.Bi,u=Math.floor(c-h)+.5;u<0?(c+=Math.abs(0-u),u=Math.floor(c-h)+.5):u+n>l&&(c-=Math.abs(l-(u+n)),u=Math.floor(c-h)+.5);const d=u+n,p=Math.ceil(0+e.S+e.C+e.A+e.k+e.V);t.useBitmapCoordinateSpace(({context:m,horizontalPixelRatio:v,verticalPixelRatio:_})=>{const C=E(this.Yt);m.fillStyle=C.Z;const O=Math.round(u*v),k=Math.round(0*_),P=Math.round(d*v),U=Math.round(p*_),W=Math.round(2*v);if(m.beginPath(),m.moveTo(O,k),m.lineTo(O,U-W),m.arcTo(O,U,O+W,U,W),m.lineTo(P-W,U),m.arcTo(P,U,P,U-W,W),m.lineTo(P,k),m.fill(),C.pi){const xt=Math.round(C.Bi*v),zt=k,kt=Math.round((zt+e.C)*_);m.fillStyle=C.R;const ce=Math.max(1,Math.floor(v)),Ce=Math.floor(.5*v);m.fillRect(xt-Ce,zt,ce,kt-zt)}}),t.useMediaCoordinateSpace(({context:m})=>{const v=E(this.Yt),_=0+e.S+e.C+e.A+e.k/2;m.font=e.P,m.textAlign="left",m.textBaseline="middle",m.fillStyle=v.R;const C=e.Gi.Di(m,"Apr0");m.translate(u+s,_+C),m.fillText(v.ri,0,0)})}}class E1{constructor(t,e,i){this.xt=!0,this.Gt=new Ud,this.Zt={Vt:!1,Z:"#4c525e",R:"white",ri:"",Qi:0,Bi:NaN,pi:!0},this.Ct=t,this.ts=e,this.ji=i}kt(){this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Gt.ht(this.Zt),this.Gt}Rt(){const t=this.Zt;if(t.Vt=!1,this.Ct.N().mode===2)return;const e=this.Ct.N().vertLine;if(!e.labelVisible)return;const i=this.ts.At();if(i.Ki())return;t.Qi=i.Qi();const s=this.ji();if(s===null)return;t.Bi=s.Bi;const n=i.ss(this.Ct.Bt());t.ri=i.ns(E(n)),t.Vt=!0;const h=this.ts.Xi().X(e.labelBackgroundColor);t.Z=h.Z,t.R=h.G,t.pi=i.N().ticksVisible}}class Wd{constructor(){this.es=null,this.rs=0}hs(){return this.rs}ls(t){this.rs=t}Wt(){return this.es}_s(t){this.es=t}us(t){return[]}cs(){return[]}Vt(){return!0}}var Va;(function(r){r[r.Normal=0]="Normal",r[r.Magnet=1]="Magnet",r[r.Hidden=2]="Hidden",r[r.MagnetOHLC=3]="MagnetOHLC"})(Va||(Va={}));class C1 extends Wd{constructor(t,e){super(),this.yt=null,this.ds=NaN,this.fs=0,this.ps=!1,this.vs=new Map,this.ws=!1,this.gs=new WeakMap,this.Ms=new WeakMap,this.bs=NaN,this.Ss=NaN,this.xs=NaN,this.Cs=NaN,this.ts=t,this.ys=e,this.ks=((s,n)=>h=>{const l=n(),c=s();if(h===E(this.yt).Ps())return{gt:c,Bi:l};{const u=E(h.zt());return{gt:h.Ts(l,u),Bi:l}}})(()=>this.ds,()=>this.Ss);const i=((s,n)=>()=>{const h=this.ts.At().Rs(s()),l=n();return h&&Number.isFinite(l)?{wt:h,Bi:l}:null})(()=>this.fs,()=>this.si());this.Ds=new E1(this,t,i)}N(){return this.ys}Vs(t,e){this.xs=t,this.Cs=e}Is(){this.xs=NaN,this.Cs=NaN}Bs(){return this.xs}As(){return this.Cs}Es(t,e,i){this.ws||(this.ws=!0),this.ps=!0,this.zs(t,e,i)}Bt(){return this.fs}si(){return this.bs}ni(){return this.Ss}Vt(){return this.ps}Ls(){this.ps=!1,this.Os(),this.ds=NaN,this.bs=NaN,this.Ss=NaN,this.yt=null,this.Is(),this.Ns()}Ws(t){let e=this.gs.get(t);e||(e=new b1(this,t),this.gs.set(t,e));let i=this.Ms.get(t);return i||(i=new g1(this.ts,this,t),this.Ms.set(t,i)),[e,i]}ti(t){return t===this.yt&&this.ys.horzLine.visible}ii(){return this.ys.vertLine.visible}Fs(t,e){this.ps&&this.yt===t||this.vs.clear();const i=[];return this.yt===t&&i.push(this.Hs(this.vs,e,this.ks)),i}cs(){return this.ps?[this.Ds]:[]}Us(){return this.yt}Ns(){this.ts.$s().forEach(t=>{var e,i;(e=this.gs.get(t))==null||e.kt(),(i=this.Ms.get(t))==null||i.kt()}),this.vs.forEach(t=>t.kt()),this.Ds.kt()}qs(t){return t&&!t.Ps().Ki()?t.Ps():null}zs(t,e,i){this.Ys(t,e,i)&&this.Ns()}Ys(t,e,i){const s=this.bs,n=this.Ss,h=this.ds,l=this.fs,c=this.yt,u=this.qs(i);this.fs=t,this.bs=isNaN(t)?NaN:this.ts.At().qt(t),this.yt=i;const d=u!==null?u.zt():null;return u!==null&&d!==null?(this.ds=e,this.Ss=u.Nt(e,d)):(this.ds=NaN,this.Ss=NaN),s!==this.bs||n!==this.Ss||l!==this.fs||h!==this.ds||c!==this.yt}Os(){const t=this.ts.js().map(i=>i.Xs().Ks()).filter(c1),e=t.length===0?null:Math.max(...t);this.fs=e!==null?e:NaN}Hs(t,e,i){let s=t.get(e);return s===void 0&&(s=new _1(this,e,i),t.set(e,s)),s}}function ph(r){return r==="left"||r==="right"}class lt{constructor(t){this.Zs=new Map,this.Gs=[],this.Js=t}Qs(t,e){const i=function(s,n){return s===void 0?n:{tn:Math.max(s.tn,n.tn),sn:s.sn||n.sn}}(this.Zs.get(t),e);this.Zs.set(t,i)}nn(){return this.Js}en(t){const e=this.Zs.get(t);return e===void 0?{tn:this.Js}:{tn:Math.max(this.Js,e.tn),sn:e.sn}}rn(){this.hn(),this.Gs=[{an:0}]}ln(t){this.hn(),this.Gs=[{an:1,Ft:t}]}_n(t){this.un(),this.Gs.push({an:5,Ft:t})}hn(){this.un(),this.Gs.push({an:6})}cn(){this.hn(),this.Gs=[{an:4}]}dn(t){this.hn(),this.Gs.push({an:2,Ft:t})}fn(t){this.hn(),this.Gs.push({an:3,Ft:t})}pn(){return this.Gs}vn(t){for(const e of t.Gs)this.mn(e);this.Js=Math.max(this.Js,t.Js),t.Zs.forEach((e,i)=>{this.Qs(i,e)})}static wn(){return new lt(2)}static gn(){return new lt(3)}mn(t){switch(t.an){case 0:this.rn();break;case 1:this.ln(t.Ft);break;case 2:this.dn(t.Ft);break;case 3:this.fn(t.Ft);break;case 4:this.cn();break;case 5:this._n(t.Ft);break;case 6:this.un()}}un(){const t=this.Gs.findIndex(e=>e.an===5);t!==-1&&this.Gs.splice(t,1)}}const Fa=".";function _e(r,t){if(!Fi(r))return"n/a";if(!An(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return t===0?r.toString():("0000000000000000"+r.toString()).slice(-t)}class mh{constructor(t,e){if(e||(e=1),Fi(t)&&An(t)||(t=100),t<0)throw new TypeError("invalid base");this.Yi=t,this.Mn=e,this.bn()}format(t){const e=t<0?"−":"";return t=Math.abs(t),e+this.Sn(t)}bn(){if(this.xn=0,this.Yi>0&&this.Mn>0){let t=this.Yi;for(;t>1;)t/=10,this.xn++}}Sn(t){const e=this.Yi/this.Mn;let i=Math.floor(t),s="";const n=this.xn!==void 0?this.xn:NaN;if(e>1){let h=+(Math.round(t*e)-i*e).toFixed(this.xn);h>=e&&(h-=e,i+=1),s=Fa+_e(+h.toFixed(this.xn)*this.Mn,n)}else i=Math.round(i*e)/e,n>0&&(s=Fa+_e(0,n));return i.toFixed(0)+s}}class qd extends mh{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class M1{constructor(t){this.Cn=t}format(t){let e="";return t<0&&(e="-",t=-t),t<995?e+this.yn(t):t<999995?e+this.yn(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this.yn(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.yn(t/1e9)+"B")}yn(t){let e;const i=Math.pow(10,this.Cn);return e=(t=Math.round(t*i)/i)>=1e-15&&t<1?t.toFixed(this.Cn).replace(/\.?0+$/,""):String(t),e.replace(/(\.[1-9]*)0+$/,(s,n)=>n)}}const T1=/[2-9]/g;class zn{constructor(t=50){this.kn=0,this.Pn=1,this.Tn=1,this.Rn={},this.Dn=new Map,this.Vn=t}In(){this.kn=0,this.Dn.clear(),this.Pn=1,this.Tn=1,this.Rn={}}Vi(t,e,i){return this.Bn(t,e,i).width}Di(t,e,i){const s=this.Bn(t,e,i);return((s.actualBoundingBoxAscent||0)-(s.actualBoundingBoxDescent||0))/2}Bn(t,e,i){const s=i||T1,n=String(e).replace(s,"0");if(this.Dn.has(n))return Mt(this.Dn.get(n)).An;if(this.kn===this.Vn){const l=this.Rn[this.Tn];delete this.Rn[this.Tn],this.Dn.delete(l),this.Tn++,this.kn--}t.save(),t.textBaseline="middle";const h=t.measureText(n);return t.restore(),h.width===0&&e.length||(this.Dn.set(n,{An:h,En:this.Pn}),this.Rn[this.Pn]=n,this.kn++,this.Pn++),h}}class x1{constructor(t){this.zn=null,this.M=null,this.Ln="right",this.On=t}Nn(t,e,i){this.zn=t,this.M=e,this.Ln=i}nt(t){this.M!==null&&this.zn!==null&&this.zn.nt(t,this.M,this.On,this.Ln)}}class jd{constructor(t,e,i){this.Wn=t,this.On=new zn(50),this.Fn=e,this.O=i,this.W=-1,this.Gt=new x1(this.On)}Tt(){const t=this.O.Hn(this.Fn);if(t===null)return null;const e=t.Un(this.Fn)?t.$n():this.Fn.Wt();if(e===null)return null;const i=t.qn(e);if(i==="overlay")return null;const s=this.O.Yn();return s.k!==this.W&&(this.W=s.k,this.On.In()),this.Gt.Nn(this.Wn.$i(),s,i),this.Gt}}class S1 extends Ee{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}jn(t,e){var h;if(!((h=this.Yt)!=null&&h.Vt))return null;const{ut:i,ct:s,Kn:n}=this.Yt;return e>=i-s-7&&e<=i+s+7?{Xn:this.Yt,Kn:n}:null}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.Yt===null||this.Yt.Vt===!1)return;const n=Math.round(this.Yt.ut*s);n<0||n>e.height||(t.lineCap="butt",t.strokeStyle=this.Yt.R,t.lineWidth=Math.floor(this.Yt.ct*i),Vi(t,this.Yt.Xt),Fd(t,n,0,e.width))}}class ga{constructor(t){this.Zn={ut:0,R:"rgba(0, 0, 0, 0)",ct:1,Xt:0,Vt:!1},this.Gn=new S1,this.xt=!0,this.Jn=t,this.Qn=t.Qt(),this.Gn.ht(this.Zn)}kt(){this.xt=!0}Tt(){return this.Jn.Vt()?(this.xt&&(this.te(),this.xt=!1),this.Gn):null}}class N1 extends ga{constructor(t){super(t)}te(){this.Zn.Vt=!1;const t=this.Jn.Wt(),e=t.ie().ie;if(e!==2&&e!==3)return;const i=this.Jn.N();if(!i.baseLineVisible||!this.Jn.Vt())return;const s=this.Jn.zt();s!==null&&(this.Zn.Vt=!0,this.Zn.ut=t.Nt(s.Ft,s.Ft),this.Zn.R=i.baseLineColor,this.Zn.ct=i.baseLineWidth,this.Zn.Xt=i.baseLineStyle)}}class O1 extends Ee{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}se(){return this.Yt}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){const s=this.Yt;if(s===null)return;const n=Math.max(1,Math.floor(e)),h=n%2/2,l=Math.round(s.ne.x*e)+h,c=s.ne.y*i;t.fillStyle=s.ee,t.beginPath();const u=Math.max(2,1.5*s.re)*e;t.arc(l,c,u,0,2*Math.PI,!1),t.fill(),t.fillStyle=s.he,t.beginPath(),t.arc(l,c,s.ft*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=n,t.strokeStyle=s.ae,t.beginPath(),t.arc(l,c,s.ft*e+n/2,0,2*Math.PI,!1),t.stroke()}}const I1=[{le:0,oe:.25,_e:4,ue:10,ce:.25,de:0,fe:.4,pe:.8},{le:.25,oe:.525,_e:10,ue:14,ce:0,de:0,fe:.8,pe:0},{le:.525,oe:1,_e:14,ue:14,ce:0,de:0,fe:0,pe:0}];class A1{constructor(t){this.Gt=new O1,this.xt=!0,this.ve=!0,this.me=performance.now(),this.we=this.me-1,this.ge=t}Me(){this.we=this.me-1,this.kt()}be(){if(this.kt(),this.ge.N().lastPriceAnimation===2){const t=performance.now(),e=this.we-t;if(e>0)return void(e<650&&(this.we+=2600));this.me=t,this.we=t+2600}}kt(){this.xt=!0}Se(){this.ve=!0}Vt(){return this.ge.N().lastPriceAnimation!==0}xe(){switch(this.ge.N().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.we}}Tt(){return this.xt?(this.Rt(),this.xt=!1,this.ve=!1):this.ve&&(this.Ce(),this.ve=!1),this.Gt}Rt(){this.Gt.ht(null);const t=this.ge.Qt().At(),e=t.ye(),i=this.ge.zt();if(e===null||i===null)return;const s=this.ge.ke(!0);if(s.Pe||!e.Te(s.Re))return;const n={x:t.qt(s.Re),y:this.ge.Wt().Nt(s.gt,i.Ft)},h=s.R,l=this.ge.N().lineWidth,c=this.De(this.Ve(),h);this.Gt.ht({ee:h,re:l,he:c.he,ae:c.ae,ft:c.ft,ne:n})}Ce(){const t=this.Gt.se();if(t!==null){const e=this.De(this.Ve(),t.ee);t.he=e.he,t.ae=e.ae,t.ft=e.ft}}Ve(){return this.xe()?performance.now()-this.me:2599}Ie(t,e,i,s){const n=i+(s-i)*e;return this.ge.Qt().Xi().j(t,n)}De(t,e){const i=t%2600/2600;let s;for(const u of I1)if(i>=u.le&&i<=u.oe){s=u;break}ut(s!==void 0,"Last price animation internal logic error");const n=(i-s.le)/(s.oe-s.le);return{he:this.Ie(e,n,s.ce,s.de),ae:this.Ie(e,n,s.fe,s.pe),ft:(h=n,l=s._e,c=s.ue,l+(c-l)*h)};var h,l,c}}class k1 extends ga{constructor(t){super(t)}te(){const t=this.Zn;t.Vt=!1;const e=this.Jn.N();if(!e.priceLineVisible||!this.Jn.Vt())return;const i=this.Jn.ke(e.priceLineSource===0);i.Pe||(t.Vt=!0,t.ut=i.Bi,t.R=this.Jn.Be(i.R),t.ct=e.priceLineWidth,t.Xt=e.priceLineStyle)}}class R1 extends fh{constructor(t){super(),this.Jt=t}qi(t,e,i){t.Vt=!1,e.Vt=!1;const s=this.Jt;if(!s.Vt())return;const n=s.N(),h=n.lastValueVisible,l=s.Ae()!=="",c=n.seriesLastValueMode===0,u=s.ke(!1);if(u.Pe)return;h&&(t.ri=this.Ee(u,h,c),t.Vt=t.ri.length!==0),(l||c)&&(e.ri=this.ze(u,h,l,c),e.Vt=e.ri.length>0);const d=s.Be(u.R),p=this.Jt.Qt().Xi().X(d);i.Z=p.Z,i.Bi=u.Bi,e.Ht=s.Qt().Ut(u.Bi/s.Wt().$t()),t.Ht=d,t.R=p.G,e.R=p.G}ze(t,e,i,s){let n="";const h=this.Jt.Ae();return i&&h.length!==0&&(n+=`${h} `),e&&s&&(n+=this.Jt.Wt().Le()?t.Oe:t.Ne),n.trim()}Ee(t,e,i){return e?i?this.Jt.Wt().Le()?t.Ne:t.Oe:t.ri:""}}function Ya(r,t,e,i){const s=Number.isFinite(t),n=Number.isFinite(e);return s&&n?r(t,e):s||n?s?t:e:i}class gt{constructor(t,e){this.We=t,this.Fe=e}He(t){return t!==null&&this.We===t.We&&this.Fe===t.Fe}Ue(){return new gt(this.We,this.Fe)}$e(){return this.We}qe(){return this.Fe}Ye(){return this.Fe-this.We}Ki(){return this.Fe===this.We||Number.isNaN(this.Fe)||Number.isNaN(this.We)}vn(t){return t===null?this:new gt(Ya(Math.min,this.$e(),t.$e(),-1/0),Ya(Math.max,this.qe(),t.qe(),1/0))}je(t){if(!Fi(t)||this.Fe-this.We===0)return;const e=.5*(this.Fe+this.We);let i=this.Fe-e,s=this.We-e;i*=t,s*=t,this.Fe=e+i,this.We=e+s}Ke(t){Fi(t)&&(this.Fe+=t,this.We+=t)}Xe(){return{minValue:this.We,maxValue:this.Fe}}static Ze(t){return t===null?null:new gt(t.minValue,t.maxValue)}}class qr{constructor(t,e){this.Ge=t,this.Je=e||null}Qe(){return this.Ge}tr(){return this.Je}Xe(){return{priceRange:this.Ge===null?null:this.Ge.Xe(),margins:this.Je||void 0}}static Ze(t){return t===null?null:new qr(gt.Ze(t.priceRange),t.margins)}}class z1 extends ga{constructor(t,e){super(t),this.ir=e}te(){const t=this.Zn;t.Vt=!1;const e=this.ir.N();if(!this.Jn.Vt()||!e.lineVisible)return;const i=this.ir.sr();i!==null&&(t.Vt=!0,t.ut=i,t.R=e.color,t.ct=e.lineWidth,t.Xt=e.lineStyle,t.Kn=this.ir.N().id)}}class L1 extends fh{constructor(t,e){super(),this.ge=t,this.ir=e}qi(t,e,i){t.Vt=!1,e.Vt=!1;const s=this.ir.N(),n=s.axisLabelVisible,h=s.title!=="",l=this.ge;if(!n||!l.Vt())return;const c=this.ir.sr();if(c===null)return;h&&(e.ri=s.title,e.Vt=!0),e.Ht=l.Qt().Ut(c/l.Wt().$t()),t.ri=this.nr(s.price),t.Vt=!0;const u=this.ge.Qt().Xi().X(s.axisLabelColor||s.color);i.Z=u.Z;const d=s.axisLabelTextColor||u.G;t.R=d,e.R=d,i.Bi=c}nr(t){const e=this.ge.zt();return e===null?"":this.ge.Wt().Zi(t,e.Ft)}}class P1{constructor(t,e){this.ge=t,this.ys=e,this.er=new z1(t,this),this.Wn=new L1(t,this),this.rr=new jd(this.Wn,t,t.Qt())}hr(t){Ot(this.ys,t),this.kt(),this.ge.Qt().ar()}N(){return this.ys}lr(){return this.er}_r(){return this.rr}ur(){return this.Wn}kt(){this.er.kt(),this.Wn.kt()}sr(){const t=this.ge,e=t.Wt();if(t.Qt().At().Ki()||e.Ki())return null;const i=t.zt();return i===null?null:e.Nt(this.ys.price,i.Ft)}}class D1 extends Wd{constructor(t){super(),this.ts=t}Qt(){return this.ts}}const B1={Bar:(r,t,e,i)=>{const s=t.upColor,n=t.downColor,h=E(r(e,i)),l=Ge(h.Ft[0])<=Ge(h.Ft[3]);return{cr:h.R??(l?s:n)}},Candlestick:(r,t,e,i)=>{const s=t.upColor,n=t.downColor,h=t.borderUpColor,l=t.borderDownColor,c=t.wickUpColor,u=t.wickDownColor,d=E(r(e,i)),p=Ge(d.Ft[0])<=Ge(d.Ft[3]);return{cr:d.R??(p?s:n),dr:d.Ht??(p?h:l),pr:d.vr??(p?c:u)}},Custom:(r,t,e,i)=>({cr:E(r(e,i)).R??t.color}),Area:(r,t,e,i)=>{const s=E(r(e,i));return{cr:s.vt??t.lineColor,vt:s.vt??t.lineColor,mr:s.mr??t.topColor,wr:s.wr??t.bottomColor}},Baseline:(r,t,e,i)=>{const s=E(r(e,i));return{cr:s.Ft[3]>=t.baseValue.price?t.topLineColor:t.bottomLineColor,gr:s.gr??t.topLineColor,Mr:s.Mr??t.bottomLineColor,br:s.br??t.topFillColor1,Sr:s.Sr??t.topFillColor2,Cr:s.Cr??t.bottomFillColor1,yr:s.yr??t.bottomFillColor2}},Line:(r,t,e,i)=>{const s=E(r(e,i));return{cr:s.R??t.color,vt:s.R??t.color}},Histogram:(r,t,e,i)=>({cr:E(r(e,i)).R??t.color})};class $1{constructor(t){this.kr=(e,i)=>i!==void 0?i.Ft:this.ge.Xs().Pr(e),this.ge=t,this.Tr=B1[t.Rr()]}Dr(t,e){return this.Tr(this.kr,this.ge.N(),t,e)}}function Qd(r,t,e,i,s=0,n=t.length){let h=n-s;for(;0<h;){const l=h>>1,c=s+l;i(t[c],e)===r?(s=c+1,h-=l+1):h=l}return s}const Bs=Qd.bind(null,!0),Gd=Qd.bind(null,!1);var Xa;(function(r){r[r.NearestLeft=-1]="NearestLeft",r[r.None=0]="None",r[r.NearestRight=1]="NearestRight"})(Xa||(Xa={}));const Me=30;class V1{constructor(){this.Vr=[],this.Ir=new Map,this.Br=new Map,this.Ar=[]}Er(){return this.zr()>0?this.Vr[this.Vr.length-1]:null}Lr(){return this.zr()>0?this.Or(0):null}Ks(){return this.zr()>0?this.Or(this.Vr.length-1):null}zr(){return this.Vr.length}Ki(){return this.zr()===0}Te(t){return this.Nr(t,0)!==null}Pr(t){return this.Wr(t)}Wr(t,e=0){const i=this.Nr(t,e);return i===null?null:{...this.Fr(i),Re:this.Or(i)}}Hr(){return this.Vr}Ur(t,e,i){if(this.Ki())return null;let s=null;for(const n of i)s=Nr(s,this.$r(t,e,n));return s}ht(t){this.Br.clear(),this.Ir.clear(),this.Vr=t,this.Ar=t.map(e=>e.Re)}qr(){return this.Ar}Or(t){return this.Vr[t].Re}Fr(t){return this.Vr[t]}Nr(t,e){const i=this.Yr(t);if(i===null&&e!==0)switch(e){case-1:return this.jr(t);case 1:return this.Kr(t);default:throw new TypeError("Unknown search mode")}return i}jr(t){let e=this.Xr(t);return e>0&&(e-=1),e!==this.Vr.length&&this.Or(e)<t?e:null}Kr(t){const e=this.Zr(t);return e!==this.Vr.length&&t<this.Or(e)?e:null}Yr(t){const e=this.Xr(t);return e===this.Vr.length||t<this.Vr[e].Re?null:e}Xr(t){return Bs(this.Vr,t,(e,i)=>e.Re<i)}Zr(t){return Gd(this.Vr,t,(e,i)=>e.Re>i)}Gr(t,e,i){let s=null;for(let n=t;n<e;n++){const h=this.Vr[n].Ft[i];Number.isNaN(h)||(s===null?s={Jr:h,Qr:h}:(h<s.Jr&&(s.Jr=h),h>s.Qr&&(s.Qr=h)))}return s}$r(t,e,i){if(this.Ki())return null;let s=null;const n=E(this.Lr()),h=E(this.Ks()),l=Math.max(t,n),c=Math.min(e,h),u=Math.ceil(l/Me)*Me,d=Math.max(u,Math.floor(c/Me)*Me);{const m=this.Xr(l),v=this.Zr(Math.min(c,u,e));s=Nr(s,this.Gr(m,v,i))}let p=this.Ir.get(i);p===void 0&&(p=new Map,this.Ir.set(i,p));for(let m=Math.max(u+1,l);m<d;m+=Me){const v=Math.floor(m/Me);let _=p.get(v);if(_===void 0){const C=this.Xr(v*Me),O=this.Zr((v+1)*Me-1);_=this.Gr(C,O,i),p.set(v,_)}s=Nr(s,_)}{const m=this.Xr(d),v=this.Zr(c);s=Nr(s,this.Gr(m,v,i))}return s}}function Nr(r,t){return r===null?t:t===null?r:{Jr:Math.min(r.Jr,t.Jr),Qr:Math.max(r.Qr,t.Qr)}}class F1{constructor(t){this.th=t}nt(t,e,i){this.th.draw(t)}ih(t,e,i){var s,n;(n=(s=this.th).drawBackground)==null||n.call(s,t)}}class Y1{constructor(t){this.Dn=null,this.sh=t}Tt(){var i;const t=this.sh.renderer();if(t===null)return null;if(((i=this.Dn)==null?void 0:i.nh)===t)return this.Dn.eh;const e=new F1(t);return this.Dn={nh:t,eh:e},e}rh(){var t,e;return((e=(t=this.sh).zOrder)==null?void 0:e.call(t))??"normal"}}class Zd{constructor(t){this.hh=null,this.ah=t}oh(){return this.ah}Ns(){var t,e;(e=(t=this.ah).updateAllViews)==null||e.call(t)}Ws(){var i,s,n;const t=((s=(i=this.ah).paneViews)==null?void 0:s.call(i))??[];if(((n=this.hh)==null?void 0:n.nh)===t)return this.hh.eh;const e=t.map(h=>new Y1(h));return this.hh={nh:t,eh:e},e}jn(t,e){var i,s;return((s=(i=this.ah).hitTest)==null?void 0:s.call(i,t,e))??null}}let X1=class extends Zd{us(){return[]}};class H1{constructor(t){this.th=t}nt(t,e,i){this.th.draw(t)}ih(t,e,i){var s,n;(n=(s=this.th).drawBackground)==null||n.call(s,t)}}class Ha{constructor(t){this.Dn=null,this.sh=t}Tt(){var i;const t=this.sh.renderer();if(t===null)return null;if(((i=this.Dn)==null?void 0:i.nh)===t)return this.Dn.eh;const e=new H1(t);return this.Dn={nh:t,eh:e},e}rh(){var t,e;return((e=(t=this.sh).zOrder)==null?void 0:e.call(t))??"normal"}}function Kd(r){var t,e,i;return{ri:r.text(),Bi:r.coordinate(),Ii:(t=r.fixedCoordinate)==null?void 0:t.call(r),R:r.textColor(),Z:r.backColor(),Vt:((e=r.visible)==null?void 0:e.call(r))??!0,pi:((i=r.tickVisible)==null?void 0:i.call(r))??!0}}class U1{constructor(t,e){this.Gt=new Ud,this._h=t,this.uh=e}Tt(){return this.Gt.ht({Qi:this.uh.Qi(),...Kd(this._h)}),this.Gt}}class W1 extends fh{constructor(t,e){super(),this._h=t,this.Yi=e}qi(t,e,i){const s=Kd(this._h);i.Z=s.Z,t.R=s.R;const n=2/12*this.Yi.k();i.Ti=n,i.Ri=n,i.Bi=s.Bi,i.Ii=s.Ii,t.ri=s.ri,t.Vt=s.Vt,t.pi=s.pi}}class q1 extends Zd{constructor(t,e){super(t),this.dh=null,this.fh=null,this.ph=null,this.mh=null,this.ge=e}cs(){var s,n,h;const t=((n=(s=this.ah).timeAxisViews)==null?void 0:n.call(s))??[];if(((h=this.dh)==null?void 0:h.nh)===t)return this.dh.eh;const e=this.ge.Qt().At(),i=t.map(l=>new U1(l,e));return this.dh={nh:t,eh:i},i}Fs(){var s,n,h;const t=((n=(s=this.ah).priceAxisViews)==null?void 0:n.call(s))??[];if(((h=this.fh)==null?void 0:h.nh)===t)return this.fh.eh;const e=this.ge.Wt(),i=t.map(l=>new W1(l,e));return this.fh={nh:t,eh:i},i}wh(){var i,s,n;const t=((s=(i=this.ah).priceAxisPaneViews)==null?void 0:s.call(i))??[];if(((n=this.ph)==null?void 0:n.nh)===t)return this.ph.eh;const e=t.map(h=>new Ha(h));return this.ph={nh:t,eh:e},e}gh(){var i,s,n;const t=((s=(i=this.ah).timeAxisPaneViews)==null?void 0:s.call(i))??[];if(((n=this.mh)==null?void 0:n.nh)===t)return this.mh.eh;const e=t.map(h=>new Ha(h));return this.mh={nh:t,eh:e},e}Mh(t,e){var i,s;return((s=(i=this.ah).autoscaleInfo)==null?void 0:s.call(i,t,e))??null}}function Th(r,t,e,i){r.forEach(s=>{t(s).forEach(n=>{n.rh()===e&&i.push(n)})})}function xh(r){return r.Ws()}function j1(r){return r.wh()}function Q1(r){return r.gh()}const G1=["Area","Line","Baseline"];class gh extends D1{constructor(t,e,i,s,n){super(t),this.Yt=new V1,this.er=new k1(this),this.bh=[],this.Sh=new N1(this),this.xh=null,this.Ch=null,this.yh=null,this.kh=[],this.ys=i,this.Ph=e;const h=new R1(this);this.vs=[h],this.rr=new jd(h,this,t),G1.includes(this.Ph)&&(this.xh=new A1(this)),this.Th(),this.sh=s(this,this.Qt(),n)}m(){this.yh!==null&&clearTimeout(this.yh)}Be(t){return this.ys.priceLineColor||t}ke(t){const e={Pe:!0},i=this.Wt();if(this.Qt().At().Ki()||i.Ki()||this.Yt.Ki())return e;const s=this.Qt().At().ye(),n=this.zt();if(s===null||n===null)return e;let h,l;if(t){const p=this.Yt.Er();if(p===null)return e;h=p,l=p.Re}else{const p=this.Yt.Wr(s.bi(),-1);if(p===null||(h=this.Yt.Pr(p.Re),h===null))return e;l=p.Re}const c=h.Ft[3],u=this.Rh().Dr(l,{Ft:h}),d=i.Nt(c,n.Ft);return{Pe:!1,gt:c,ri:i.Zi(c,n.Ft),Oe:i.Dh(c),Ne:i.Vh(c,n.Ft),R:u.cr,Bi:d,Re:l}}Rh(){return this.Ch!==null||(this.Ch=new $1(this)),this.Ch}N(){return this.ys}hr(t){const e=t.priceScaleId;e!==void 0&&e!==this.ys.priceScaleId&&this.Qt().Ih(this,e),Ot(this.ys,t),t.priceFormat!==void 0&&(this.Th(),this.Qt().Bh()),this.Qt().Ah(this),this.Qt().Eh(),this.sh.kt("options")}ht(t,e){this.Yt.ht(t),this.sh.kt("data"),this.xh!==null&&(e&&e.zh?this.xh.be():t.length===0&&this.xh.Me());const i=this.Qt().Hn(this);this.Qt().Lh(i),this.Qt().Ah(this),this.Qt().Eh(),this.Qt().ar()}Oh(t){const e=new P1(this,t);return this.bh.push(e),this.Qt().Ah(this),e}Nh(t){const e=this.bh.indexOf(t);e!==-1&&this.bh.splice(e,1),this.Qt().Ah(this)}Wh(){return this.bh}Rr(){return this.Ph}zt(){const t=this.Fh();return t===null?null:{Ft:t.Ft[3],Hh:t.wt}}Fh(){const t=this.Qt().At().ye();if(t===null)return null;const e=t.Uh();return this.Yt.Wr(e,1)}Xs(){return this.Yt}$h(t){const e=this.Yt.Pr(t);return e===null?null:this.Ph==="Bar"||this.Ph==="Candlestick"||this.Ph==="Custom"?{qh:e.Ft[0],Yh:e.Ft[1],jh:e.Ft[2],Kh:e.Ft[3]}:e.Ft[3]}Xh(t){const e=[];Th(this.kh,xh,"top",e);const i=this.xh;return i!==null&&i.Vt()&&(this.yh===null&&i.xe()&&(this.yh=setTimeout(()=>{this.yh=null,this.Qt().Zh()},0)),i.Se(),e.unshift(i)),e}Ws(){const t=[];this.Gh()||t.push(this.Sh),t.push(this.sh,this.er);const e=this.bh.map(i=>i.lr());return t.push(...e),Th(this.kh,xh,"normal",t),t}Jh(){return this.Qh(xh,"bottom")}ta(t){return this.Qh(j1,t)}ia(t){return this.Qh(Q1,t)}sa(t,e){return this.kh.map(i=>i.jn(t,e)).filter(i=>i!==null)}us(){return[this.rr,...this.bh.map(t=>t._r())]}Fs(t,e){if(e!==this.es&&!this.Gh())return[];const i=[...this.vs];for(const s of this.bh)i.push(s.ur());return this.kh.forEach(s=>{i.push(...s.Fs())}),i}cs(){const t=[];return this.kh.forEach(e=>{t.push(...e.cs())}),t}Mh(t,e){if(this.ys.autoscaleInfoProvider!==void 0){const i=this.ys.autoscaleInfoProvider(()=>{const s=this.na(t,e);return s===null?null:s.Xe()});return qr.Ze(i)}return this.na(t,e)}ea(){return this.ys.priceFormat.minMove}ra(){return this.ha}Ns(){var t;this.sh.kt();for(const e of this.vs)e.kt();for(const e of this.bh)e.kt();this.er.kt(),this.Sh.kt(),(t=this.xh)==null||t.kt(),this.kh.forEach(e=>e.Ns())}Wt(){return E(super.Wt())}Et(t){if(!((this.Ph==="Line"||this.Ph==="Area"||this.Ph==="Baseline")&&this.ys.crosshairMarkerVisible))return null;const e=this.Yt.Pr(t);return e===null?null:{gt:e.Ft[3],ft:this.aa(),Ht:this.la(),Ot:this.oa(),Lt:this._a(t)}}Ae(){return this.ys.title}Vt(){return this.ys.visible}ua(t){this.kh.push(new q1(t,this))}ca(t){this.kh=this.kh.filter(e=>e.oh()!==t)}da(){if(this.Ph==="Custom")return t=>this.sh.fa(t)}pa(){if(this.Ph==="Custom")return t=>this.sh.va(t)}ma(){return this.Yt.qr()}Gh(){return!ph(this.Wt().wa())}na(t,e){if(!An(t)||!An(e)||this.Yt.Ki())return null;const i=this.Ph==="Line"||this.Ph==="Area"||this.Ph==="Baseline"||this.Ph==="Histogram"?[3]:[2,1],s=this.Yt.Ur(t,e,i);let n=s!==null?new gt(s.Jr,s.Qr):null,h=null;if(this.Rr()==="Histogram"){const l=this.ys.base,c=new gt(l,l);n=n!==null?n.vn(c):c}return this.kh.forEach(l=>{const c=l.Mh(t,e);if(c!=null&&c.priceRange){const u=new gt(c.priceRange.minValue,c.priceRange.maxValue);n=n!==null?n.vn(u):u}c!=null&&c.margins&&(h=c.margins)}),new qr(n,h)}aa(){switch(this.Ph){case"Line":case"Area":case"Baseline":return this.ys.crosshairMarkerRadius}return 0}la(){switch(this.Ph){case"Line":case"Area":case"Baseline":{const t=this.ys.crosshairMarkerBorderColor;if(t.length!==0)return t}}return null}oa(){switch(this.Ph){case"Line":case"Area":case"Baseline":return this.ys.crosshairMarkerBorderWidth}return 0}_a(t){switch(this.Ph){case"Line":case"Area":case"Baseline":{const e=this.ys.crosshairMarkerBackgroundColor;if(e.length!==0)return e}}return this.Rh().Dr(t).cr}Th(){switch(this.ys.priceFormat.type){case"custom":this.ha={format:this.ys.priceFormat.formatter};break;case"volume":this.ha=new M1(this.ys.priceFormat.precision);break;case"percent":this.ha=new qd(this.ys.priceFormat.precision);break;default:{const t=Math.pow(10,this.ys.priceFormat.precision);this.ha=new mh(t,this.ys.priceFormat.minMove*t)}}this.es!==null&&this.es.ga()}Qh(t,e){const i=[];return Th(this.kh,t,e,i),i}}const Z1=[3],K1=[0,1,2,3];class J1{constructor(t){this.ys=t}Ma(t,e,i){let s=t;if(this.ys.mode===0)return s;const n=i.Ps(),h=n.zt();if(h===null)return s;const l=n.Nt(t,h),c=i.ba().filter(d=>d instanceof gh).reduce((d,p)=>{if(i.Un(p)||!p.Vt())return d;const m=p.Wt(),v=p.Xs();if(m.Ki()||!v.Te(e))return d;const _=v.Pr(e);if(_===null)return d;const C=Ge(p.zt()),O=this.ys.mode===3?K1:Z1;return d.concat(O.map(k=>m.Nt(_.Ft[k],C.Ft)))},[]);if(c.length===0)return s;c.sort((d,p)=>Math.abs(d-l)-Math.abs(p-l));const u=c[0];return s=n.Ts(u,h),s}}function ns(r,t,e){return Math.min(Math.max(r,t),e)}function Or(r,t,e){return t-r<=e}function va(r){const t=Math.ceil(r);return t%2==0?t-1:t}class tb extends Ee{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.Yt===null)return;const n=Math.max(1,Math.floor(i));t.lineWidth=n,function(h,l){h.save(),h.lineWidth%2&&h.translate(.5,.5),l(),h.restore()}(t,()=>{const h=E(this.Yt);if(h.Sa){t.strokeStyle=h.xa,Vi(t,h.Ca),t.beginPath();for(const l of h.ya){const c=Math.round(l.ka*i);t.moveTo(c,-n),t.lineTo(c,e.height+n)}t.stroke()}if(h.Pa){t.strokeStyle=h.Ta,Vi(t,h.Ra),t.beginPath();for(const l of h.Da){const c=Math.round(l.ka*s);t.moveTo(-n,c),t.lineTo(e.width+n,c)}t.stroke()}})}}class eb{constructor(t){this.Gt=new tb,this.xt=!0,this.yt=t}kt(){this.xt=!0}Tt(){if(this.xt){const t=this.yt.Qt().N().grid,e={Pa:t.horzLines.visible,Sa:t.vertLines.visible,Ta:t.horzLines.color,xa:t.vertLines.color,Ra:t.horzLines.style,Ca:t.vertLines.style,Da:this.yt.Ps().Va(),ya:(this.yt.Qt().At().Va()||[]).map(i=>({ka:i.coord}))};this.Gt.ht(e),this.xt=!1}return this.Gt}}class ib{constructor(t){this.sh=new eb(t)}lr(){return this.sh}}const Sh={Ia:4,Ba:1e-4};function ss(r,t){const e=100*(r-t)/t;return t<0?-e:e}function sb(r,t){const e=ss(r.$e(),t),i=ss(r.qe(),t);return new gt(e,i)}function _n(r,t){const e=100*(r-t)/t+100;return t<0?-e:e}function nb(r,t){const e=_n(r.$e(),t),i=_n(r.qe(),t);return new gt(e,i)}function jr(r,t){const e=Math.abs(r);if(e<1e-15)return 0;const i=Math.log10(e+t.Ba)+t.Ia;return r<0?-i:i}function yn(r,t){const e=Math.abs(r);if(e<1e-15)return 0;const i=Math.pow(10,e-t.Ia)-t.Ba;return r<0?-i:i}function Js(r,t){if(r===null)return null;const e=jr(r.$e(),t),i=jr(r.qe(),t);return new gt(e,i)}function gn(r,t){if(r===null)return null;const e=yn(r.$e(),t),i=yn(r.qe(),t);return new gt(e,i)}function Nh(r){if(r===null)return Sh;const t=Math.abs(r.qe()-r.$e());if(t>=1||t<1e-15)return Sh;const e=Math.ceil(Math.abs(Math.log10(t))),i=Sh.Ia+e;return{Ia:i,Ba:1/Math.pow(10,i)}}class Oh{constructor(t,e){if(this.Aa=t,this.Ea=e,function(i){if(i<0)return!1;for(let s=i;s>1;s/=10)if(s%10!=0)return!1;return!0}(this.Aa))this.za=[2,2.5,2];else{this.za=[];for(let i=this.Aa;i!==1;){if(i%2==0)this.za.push(2),i/=2;else{if(i%5!=0)throw new Error("unexpected base");this.za.push(2,2.5),i/=5}if(this.za.length>100)throw new Error("something wrong with base")}}}La(t,e,i){const s=this.Aa===0?0:1/this.Aa;let n=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-e)))),h=0,l=this.Ea[0];for(;;){const p=Or(n,s,1e-14)&&n>s+1e-14,m=Or(n,i*l,1e-14),v=Or(n,1,1e-14);if(!(p&&m&&v))break;n/=l,l=this.Ea[++h%this.Ea.length]}if(n<=s+1e-14&&(n=s),n=Math.max(1,n),this.za.length>0&&(c=n,u=1,d=1e-14,Math.abs(c-u)<d))for(h=0,l=this.za[0];Or(n,i*l,1e-14)&&n>s+1e-14;)n/=l,l=this.za[++h%this.za.length];var c,u,d;return n}}class Ua{constructor(t,e,i,s){this.Oa=[],this.Yi=t,this.Aa=e,this.Na=i,this.Wa=s}La(t,e){if(t<e)throw new Error("high < low");const i=this.Yi.$t(),s=(t-e)*this.Fa()/i,n=new Oh(this.Aa,[2,2.5,2]),h=new Oh(this.Aa,[2,2,2.5]),l=new Oh(this.Aa,[2.5,2,2]),c=[];return c.push(n.La(t,e,s),h.La(t,e,s),l.La(t,e,s)),function(u){if(u.length<1)throw Error("array is empty");let d=u[0];for(let p=1;p<u.length;++p)u[p]<d&&(d=u[p]);return d}(c)}Ha(){const t=this.Yi,e=t.zt();if(e===null)return void(this.Oa=[]);const i=t.$t(),s=this.Na(i-1,e),n=this.Na(0,e),h=this.Yi.N().entireTextOnly?this.Ua()/2:0,l=h,c=i-1-h,u=Math.max(s,n),d=Math.min(s,n);if(u===d)return void(this.Oa=[]);const p=this.La(u,d);if(this.$a(e,p,u,d,l,c),t.qa()&&this.Ya(p,d,u)){const m=this.Yi.ja();this.Ka(e,p,l,c,m,2*m)}}Va(){return this.Oa}Ua(){return this.Yi.k()}Fa(){return Math.ceil(2.5*this.Ua())}$a(t,e,i,s,n,h){const l=this.Oa,c=this.Yi;let u=i%e;u+=u<0?e:0;const d=i>=s?1:-1;let p=null,m=0;for(let v=i-u;v>s;v-=e){const _=this.Wa(v,t,!0);p!==null&&Math.abs(_-p)<this.Fa()||_<n||_>h||(m<l.length?(l[m].ka=_,l[m].Xa=c.Za(v)):l.push({ka:_,Xa:c.Za(v)}),m++,p=_,c.Ga()&&(e=this.La(v*d,s)))}l.length=m}Ka(t,e,i,s,n,h){const l=this.Oa,c=this.Ja(t,i,n,h),u=this.Ja(t,s,-h,-n),d=this.Wa(0,t,!0)-this.Wa(e,t,!0);l.length>0&&l[0].ka-c.ka<d/2&&l.shift(),l.length>0&&u.ka-l[l.length-1].ka<d/2&&l.pop(),l.unshift(c),l.push(u)}Ja(t,e,i,s){const n=(i+s)/2,h=this.Na(e+i,t),l=this.Na(e+s,t),c=Math.min(h,l),u=Math.max(h,l),d=Math.max(.1,this.La(u,c)),p=this.Na(e+n,t),m=p-p%d,v=this.Wa(m,t,!0);return{Xa:this.Yi.Za(m),ka:v}}Ya(t,e,i){let s=Ge(this.Yi.Qe());return this.Yi.Ga()&&(s=gn(s,this.Yi.Qa())),s.$e()-e<t&&i-s.qe()<t}}function Jd(r){return r.slice().sort((t,e)=>E(t.hs())-E(e.hs()))}var Wa;(function(r){r[r.Normal=0]="Normal",r[r.Logarithmic=1]="Logarithmic",r[r.Percentage=2]="Percentage",r[r.IndexedTo100=3]="IndexedTo100"})(Wa||(Wa={}));const qa=new qd,ja=new mh(100,1);class rb{constructor(t,e,i,s,n){this.tl=0,this.il=null,this.Ge=null,this.sl=null,this.nl={el:!1,rl:null},this.hl=!1,this.al=0,this.ll=0,this.ol=new G,this._l=new G,this.ul=[],this.cl=null,this.dl=null,this.fl=null,this.pl=null,this.vl=null,this.ha=ja,this.ml=Nh(null),this.wl=t,this.ys=e,this.gl=i,this.Ml=s,this.bl=n,this.Sl=new Ua(this,100,this.xl.bind(this),this.Cl.bind(this))}wa(){return this.wl}N(){return this.ys}hr(t){if(Ot(this.ys,t),this.ga(),t.mode!==void 0&&this.yl({ie:t.mode}),t.scaleMargins!==void 0){const e=Mt(t.scaleMargins.top),i=Mt(t.scaleMargins.bottom);if(e<0||e>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${e}`);if(i<0||i>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${i}`);if(e+i>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${e+i}`);this.kl(),this.fl=null}}Pl(){return this.ys.autoScale}Tl(){return this.hl}Ga(){return this.ys.mode===1}Le(){return this.ys.mode===2}Rl(){return this.ys.mode===3}Qa(){return this.ml}ie(){return{sn:this.ys.autoScale,Dl:this.ys.invertScale,ie:this.ys.mode}}yl(t){const e=this.ie();let i=null;t.sn!==void 0&&(this.ys.autoScale=t.sn),t.ie!==void 0&&(this.ys.mode=t.ie,t.ie!==2&&t.ie!==3||(this.ys.autoScale=!0),this.nl.el=!1),e.ie===1&&t.ie!==e.ie&&(function(n,h){if(n===null)return!1;const l=yn(n.$e(),h),c=yn(n.qe(),h);return isFinite(l)&&isFinite(c)}(this.Ge,this.ml)?(i=gn(this.Ge,this.ml),i!==null&&this.Vl(i)):this.ys.autoScale=!0),t.ie===1&&t.ie!==e.ie&&(i=Js(this.Ge,this.ml),i!==null&&this.Vl(i));const s=e.ie!==this.ys.mode;s&&(e.ie===2||this.Le())&&this.ga(),s&&(e.ie===3||this.Rl())&&this.ga(),t.Dl!==void 0&&e.Dl!==t.Dl&&(this.ys.invertScale=t.Dl,this.Il()),this._l.p(e,this.ie())}Bl(){return this._l}k(){return this.gl.fontSize}$t(){return this.tl}Al(t){this.tl!==t&&(this.tl=t,this.kl(),this.fl=null)}El(){if(this.il)return this.il;const t=this.$t()-this.zl()-this.Ll();return this.il=t,t}Qe(){return this.Ol(),this.Ge}Vl(t,e){const i=this.Ge;(e||i===null&&t!==null||i!==null&&!i.He(t))&&(this.fl=null,this.Ge=t)}Nl(t){this.Vl(t),this.Wl(t!==null)}Ki(){return this.Ol(),this.tl===0||!this.Ge||this.Ge.Ki()}Fl(t){return this.Dl()?t:this.$t()-1-t}Nt(t,e){return this.Le()?t=ss(t,e):this.Rl()&&(t=_n(t,e)),this.Cl(t,e)}Hl(t,e,i){this.Ol();const s=this.Ll(),n=E(this.Qe()),h=n.$e(),l=n.qe(),c=this.El()-1,u=this.Dl(),d=c/(l-h),p=i===void 0?0:i.from,m=i===void 0?t.length:i.to,v=this.Ul();for(let _=p;_<m;_++){const C=t[_],O=C.gt;if(isNaN(O))continue;let k=O;v!==null&&(k=v(C.gt,e));const P=s+d*(k-h),U=u?P:this.tl-1-P;C.ut=U}}$l(t,e,i){this.Ol();const s=this.Ll(),n=E(this.Qe()),h=n.$e(),l=n.qe(),c=this.El()-1,u=this.Dl(),d=c/(l-h),p=i===void 0?0:i.from,m=i===void 0?t.length:i.to,v=this.Ul();for(let _=p;_<m;_++){const C=t[_];let O=C.qh,k=C.Yh,P=C.jh,U=C.Kh;v!==null&&(O=v(C.qh,e),k=v(C.Yh,e),P=v(C.jh,e),U=v(C.Kh,e));let W=s+d*(O-h),xt=u?W:this.tl-1-W;C.ql=xt,W=s+d*(k-h),xt=u?W:this.tl-1-W,C.Yl=xt,W=s+d*(P-h),xt=u?W:this.tl-1-W,C.jl=xt,W=s+d*(U-h),xt=u?W:this.tl-1-W,C.Kl=xt}}Ts(t,e){const i=this.xl(t,e);return this.Xl(i,e)}Xl(t,e){let i=t;return this.Le()?i=function(s,n){return n<0&&(s=-s),s/100*n+n}(i,e):this.Rl()&&(i=function(s,n){return s-=100,n<0&&(s=-s),s/100*n+n}(i,e)),i}ba(){return this.ul}Dt(){return this.dl||(this.dl=Jd(this.ul)),this.dl}Zl(t){this.ul.indexOf(t)===-1&&(this.ul.push(t),this.ga(),this.Gl())}Jl(t){const e=this.ul.indexOf(t);if(e===-1)throw new Error("source is not attached to scale");this.ul.splice(e,1),this.ul.length===0&&(this.yl({sn:!0}),this.Vl(null)),this.ga(),this.Gl()}zt(){let t=null;for(const e of this.ul){const i=e.zt();i!==null&&(t===null||i.Hh<t.Hh)&&(t=i)}return t===null?null:t.Ft}Dl(){return this.ys.invertScale}Va(){const t=this.zt()===null;if(this.fl!==null&&(t||this.fl.Ql===t))return this.fl.Va;this.Sl.Ha();const e=this.Sl.Va();return this.fl={Va:e,Ql:t},this.ol.p(),e}io(){return this.ol}so(t){this.Le()||this.Rl()||this.pl===null&&this.sl===null&&(this.Ki()||(this.pl=this.tl-t,this.sl=E(this.Qe()).Ue()))}no(t){if(this.Le()||this.Rl()||this.pl===null)return;this.yl({sn:!1}),(t=this.tl-t)<0&&(t=0);let e=(this.pl+.2*(this.tl-1))/(t+.2*(this.tl-1));const i=E(this.sl).Ue();e=Math.max(e,.1),i.je(e),this.Vl(i)}eo(){this.Le()||this.Rl()||(this.pl=null,this.sl=null)}ro(t){this.Pl()||this.vl===null&&this.sl===null&&(this.Ki()||(this.vl=t,this.sl=E(this.Qe()).Ue()))}ho(t){if(this.Pl()||this.vl===null)return;const e=E(this.Qe()).Ye()/(this.El()-1);let i=t-this.vl;this.Dl()&&(i*=-1);const s=i*e,n=E(this.sl).Ue();n.Ke(s),this.Vl(n,!0),this.fl=null}ao(){this.Pl()||this.vl!==null&&(this.vl=null,this.sl=null)}ra(){return this.ha||this.ga(),this.ha}Zi(t,e){switch(this.ys.mode){case 2:return this.lo(ss(t,e));case 3:return this.ra().format(_n(t,e));default:return this.nr(t)}}Za(t){switch(this.ys.mode){case 2:return this.lo(t);case 3:return this.ra().format(t);default:return this.nr(t)}}Dh(t){return this.nr(t,E(this.cl).ra())}Vh(t,e){return t=ss(t,e),this.lo(t,qa)}oo(){return this.ul}_o(t){this.nl={rl:t,el:!1}}Ns(){this.ul.forEach(t=>t.Ns())}qa(){return this.ys.ensureEdgeTickMarksVisible&&this.Pl()}ja(){return this.k()/2}ga(){this.fl=null;let t=1/0;this.cl=null;for(const i of this.ul)i.hs()<t&&(t=i.hs(),this.cl=i);let e=100;this.cl!==null&&(e=Math.round(1/this.cl.ea())),this.ha=ja,this.Le()?(this.ha=qa,e=100):this.Rl()?(this.ha=new mh(100,1),e=100):this.cl!==null&&(this.ha=this.cl.ra()),this.Sl=new Ua(this,e,this.xl.bind(this),this.Cl.bind(this)),this.Sl.Ha()}Gl(){this.dl=null}Xi(){return this.bl}Wl(t){this.hl=t}zl(){return this.Dl()?this.ys.scaleMargins.bottom*this.$t()+this.ll:this.ys.scaleMargins.top*this.$t()+this.al}Ll(){return this.Dl()?this.ys.scaleMargins.top*this.$t()+this.al:this.ys.scaleMargins.bottom*this.$t()+this.ll}Ol(){this.nl.el||(this.nl.el=!0,this.uo())}kl(){this.il=null}Cl(t,e){if(this.Ol(),this.Ki())return 0;t=this.Ga()&&t?jr(t,this.ml):t;const i=E(this.Qe()),s=this.Ll()+(this.El()-1)*(t-i.$e())/i.Ye();return this.Fl(s)}xl(t,e){if(this.Ol(),this.Ki())return 0;const i=this.Fl(t),s=E(this.Qe()),n=s.$e()+s.Ye()*((i-this.Ll())/(this.El()-1));return this.Ga()?yn(n,this.ml):n}Il(){this.fl=null,this.Sl.Ha()}uo(){if(this.Tl()&&!this.Pl())return;const t=this.nl.rl;if(t===null)return;let e=null;const i=this.oo();let s=0,n=0;for(const c of i){if(!c.Vt())continue;const u=c.zt();if(u===null)continue;const d=c.Mh(t.Uh(),t.bi());let p=d&&d.Qe();if(p!==null){switch(this.ys.mode){case 1:p=Js(p,this.ml);break;case 2:p=sb(p,u.Ft);break;case 3:p=nb(p,u.Ft)}if(e=e===null?p:e.vn(E(p)),d!==null){const m=d.tr();m!==null&&(s=Math.max(s,m.above),n=Math.max(n,m.below))}}}if(this.qa()&&(s=Math.max(s,this.ja()),n=Math.max(n,this.ja())),s===this.al&&n===this.ll||(this.al=s,this.ll=n,this.fl=null,this.kl()),e!==null){if(e.$e()===e.qe()){const c=this.cl,u=5*(c===null||this.Le()||this.Rl()?1:c.ea());this.Ga()&&(e=gn(e,this.ml)),e=new gt(e.$e()-u,e.qe()+u),this.Ga()&&(e=Js(e,this.ml))}if(this.Ga()){const c=gn(e,this.ml),u=Nh(c);if(h=u,l=this.ml,h.Ia!==l.Ia||h.Ba!==l.Ba){const d=this.sl!==null?gn(this.sl,this.ml):null;this.ml=u,e=Js(c,u),d!==null&&(this.sl=Js(d,u))}}this.Vl(e)}else this.Ge===null&&(this.Vl(new gt(-.5,.5)),this.ml=Nh(null));var h,l}Ul(){return this.Le()?ss:this.Rl()?_n:this.Ga()?t=>jr(t,this.ml):null}co(t,e,i){return e===void 0?(i===void 0&&(i=this.ra()),i.format(t)):e(t)}nr(t,e){return this.co(t,this.Ml.priceFormatter,e)}lo(t,e){return this.co(t,this.Ml.percentageFormatter,e)}}function Qa(r){return r instanceof gh}class Ga{constructor(t,e){this.ul=[],this.do=new Map,this.tl=0,this.fo=0,this.po=1e3,this.dl=null,this.vo=new G,this.kh=[],this.uh=t,this.ts=e,this.mo=new ib(this);const i=e.N();this.wo=this.Mo("left",i.leftPriceScale),this.bo=this.Mo("right",i.rightPriceScale),this.wo.Bl().i(this.So.bind(this,this.wo),this),this.bo.Bl().i(this.So.bind(this,this.bo),this),this.xo(i)}xo(t){if(t.leftPriceScale&&this.wo.hr(t.leftPriceScale),t.rightPriceScale&&this.bo.hr(t.rightPriceScale),t.localization&&(this.wo.ga(),this.bo.ga()),t.overlayPriceScales){const e=Array.from(this.do.values());for(const i of e){const s=E(i[0].Wt());s.hr(t.overlayPriceScales),t.localization&&s.ga()}}}Co(t){switch(t){case"left":return this.wo;case"right":return this.bo}return this.do.has(t)?Mt(this.do.get(t))[0].Wt():null}m(){this.Qt().yo().u(this),this.wo.Bl().u(this),this.bo.Bl().u(this),this.ul.forEach(t=>{t.m&&t.m()}),this.kh=this.kh.filter(t=>{const e=t.oh();return e.detached&&e.detached(),!1}),this.vo.p()}ko(){return this.po}Po(t){this.po=t}Qt(){return this.ts}Qi(){return this.fo}$t(){return this.tl}To(t){this.fo=t,this.Ro()}Al(t){this.tl=t,this.wo.Al(t),this.bo.Al(t),this.ul.forEach(e=>{if(this.Un(e)){const i=e.Wt();i!==null&&i.Al(t)}}),this.Ro()}Do(){return this.ul.filter(Qa)}ba(){return this.ul}Un(t){const e=t.Wt();return e===null||this.wo!==e&&this.bo!==e}Zl(t,e,i){this.Vo(t,e,i?t.hs():this.ul.length)}Jl(t,e){const i=this.ul.indexOf(t);ut(i!==-1,"removeDataSource: invalid data source"),this.ul.splice(i,1),e||this.ul.forEach((h,l)=>h.ls(l));const s=E(t.Wt()).wa();if(this.do.has(s)){const h=Mt(this.do.get(s)),l=h.indexOf(t);l!==-1&&(h.splice(l,1),h.length===0&&this.do.delete(s))}const n=t.Wt();n&&n.ba().indexOf(t)>=0&&(n.Jl(t),this.Io(n)),this.dl=null}qn(t){return t===this.wo?"left":t===this.bo?"right":"overlay"}Bo(){return this.wo}Ao(){return this.bo}Eo(t,e){t.so(e)}zo(t,e){t.no(e),this.Ro()}Lo(t){t.eo()}Oo(t,e){t.ro(e)}No(t,e){t.ho(e),this.Ro()}Wo(t){t.ao()}Ro(){this.ul.forEach(t=>{t.Ns()})}Ps(){let t=null;return this.ts.N().rightPriceScale.visible&&this.bo.ba().length!==0?t=this.bo:this.ts.N().leftPriceScale.visible&&this.wo.ba().length!==0?t=this.wo:this.ul.length!==0&&(t=this.ul[0].Wt()),t===null&&(t=this.bo),t}$n(){let t=null;return this.ts.N().rightPriceScale.visible?t=this.bo:this.ts.N().leftPriceScale.visible&&(t=this.wo),t}Io(t){t!==null&&t.Pl()&&this.Fo(t)}Ho(t){const e=this.uh.ye();t.yl({sn:!0}),e!==null&&t._o(e),this.Ro()}Uo(){this.Fo(this.wo),this.Fo(this.bo)}$o(){this.Io(this.wo),this.Io(this.bo),this.ul.forEach(t=>{this.Un(t)&&this.Io(t.Wt())}),this.Ro(),this.ts.ar()}Dt(){return this.dl===null&&(this.dl=Jd(this.ul)),this.dl}qo(t,e){e=ns(e,0,this.ul.length-1);const i=this.ul.indexOf(t);ut(i!==-1,"setSeriesOrder: invalid data source"),this.ul.splice(i,1),this.ul.splice(e,0,t),this.ul.forEach((s,n)=>s.ls(n)),this.dl=null;for(const s of[this.wo,this.bo])s.Gl(),s.ga();this.ts.ar()}It(){return this.Dt().filter(Qa)}Yo(){return this.vo}jo(){return this.mo}ua(t){this.kh.push(new X1(t))}ca(t){this.kh=this.kh.filter(e=>e.oh()!==t),t.detached&&t.detached(),this.ts.ar()}Ko(){return this.kh}sa(t,e){return this.kh.map(i=>i.jn(t,e)).filter(i=>i!==null)}Fo(t){const e=t.oo();if(e&&e.length>0&&!this.uh.Ki()){const i=this.uh.ye();i!==null&&t._o(i)}t.Ns()}Vo(t,e,i){let s=this.Co(e);if(s===null&&(s=this.Mo(e,this.ts.N().overlayPriceScales)),this.ul.splice(i,0,t),!ph(e)){const n=this.do.get(e)||[];n.push(t),this.do.set(e,n)}t.ls(i),s.Zl(t),t._s(s),this.Io(s),this.dl=null}So(t,e,i){e.ie!==i.ie&&this.Fo(t)}Mo(t,e){const i={visible:!0,autoScale:!0,...we(e)},s=new rb(t,i,this.ts.N().layout,this.ts.N().localization,this.ts.Xi());return s.Al(this.$t()),s}}function Ir(r){return{Xo:r.Xo,Zo:{Kn:r.Go.externalId},Jo:r.Go.cursorStyle}}function hb(r,t,e,i){for(const s of r){const n=s.Tt(i);if(n!==null&&n.jn){const h=n.jn(t,e);if(h!==null)return{Qo:s,Zo:h}}}return null}function ob(r){return r.Ws!==void 0}function tf(r,t,e){const i=[r,...r.Dt()],s=function(n,h,l){var m;let c,u;for(const v of n){const _=((m=v.sa)==null?void 0:m.call(v,h,l))??[];for(const C of _)d=C.zOrder,p=c==null?void 0:c.zOrder,(!p||d==="top"&&p!=="top"||d==="normal"&&p==="bottom")&&(c=C,u=v)}var d,p;return c&&u?{Go:c,Xo:u}:null}(i,t,e);if((s==null?void 0:s.Go.zOrder)==="top")return Ir(s);for(const n of i){if(s&&s.Xo===n&&s.Go.zOrder!=="bottom"&&!s.Go.isBackground)return Ir(s);if(ob(n)){const h=hb(n.Ws(r),t,e,r);if(h!==null)return{Xo:n,Qo:h.Qo,Zo:h.Zo}}if(s&&s.Xo===n&&s.Go.zOrder!=="bottom"&&s.Go.isBackground)return Ir(s)}return s!=null&&s.Go?Ir(s):null}class ab{constructor(t,e,i=50){this.kn=0,this.Pn=1,this.Tn=1,this.Dn=new Map,this.Rn=new Map,this.t_=t,this.i_=e,this.Vn=i}s_(t){const e=t.time,i=this.i_.cacheKey(e),s=this.Dn.get(i);if(s!==void 0)return s.n_;if(this.kn===this.Vn){const h=this.Rn.get(this.Tn);this.Rn.delete(this.Tn),this.Dn.delete(Mt(h)),this.Tn++,this.kn--}const n=this.t_(t);return this.Dn.set(i,{n_:n,En:this.Pn}),this.Rn.set(this.Pn,i),this.kn++,this.Pn++,n}}class rs{constructor(t,e){ut(t<=e,"right should be >= left"),this.e_=t,this.r_=e}Uh(){return this.e_}bi(){return this.r_}h_(){return this.r_-this.e_+1}Te(t){return this.e_<=t&&t<=this.r_}He(t){return this.e_===t.Uh()&&this.r_===t.bi()}}function Za(r,t){return r===null||t===null?r===t:r.He(t)}class lb{constructor(){this.a_=new Map,this.Dn=null,this.l_=!1}o_(t){this.l_=t,this.Dn=null}__(t,e){this.u_(e),this.Dn=null;for(let i=e;i<t.length;++i){const s=t[i];let n=this.a_.get(s.timeWeight);n===void 0&&(n=[],this.a_.set(s.timeWeight,n)),n.push({index:i,time:s.time,weight:s.timeWeight,originalTime:s.originalTime})}}c_(t,e,i,s,n){const h=Math.ceil(e/t);return this.Dn!==null&&this.Dn.d_===h&&n===this.Dn.f_&&i===this.Dn.p_||(this.Dn={f_:n,p_:i,Va:this.v_(h,i,s),d_:h}),this.Dn.Va}u_(t){if(t===0)return void this.a_.clear();const e=[];this.a_.forEach((i,s)=>{t<=i[0].index?e.push(s):i.splice(Bs(i,t,n=>n.index<t),1/0)});for(const i of e)this.a_.delete(i)}v_(t,e,i){let s=[];const n=h=>!e||i.has(h.index);for(const h of Array.from(this.a_.keys()).sort((l,c)=>c-l)){if(!this.a_.get(h))continue;const l=s;s=[];const c=l.length;let u=0;const d=Mt(this.a_.get(h)),p=d.length;let m=1/0,v=-1/0;for(let _=0;_<p;_++){const C=d[_],O=C.index;for(;u<c;){const k=l[u],P=k.index;if(!(P<O&&n(k))){m=P;break}u++,s.push(k),v=P,m=1/0}if(m-O>=t&&O-v>=t&&n(C))s.push(C),v=O;else if(this.l_)return l}for(;u<c;u++)n(l[u])&&s.push(l[u])}return s}}class hs{constructor(t){this.m_=t}w_(){return this.m_===null?null:new rs(Math.floor(this.m_.Uh()),Math.ceil(this.m_.bi()))}g_(){return this.m_}static M_(){return new hs(null)}}function cb(r,t){return r.weight>t.weight?r:t}class ub{constructor(t,e,i,s){this.fo=0,this.b_=null,this.S_=[],this.vl=null,this.pl=null,this.x_=new lb,this.C_=new Map,this.y_=hs.M_(),this.k_=!0,this.P_=new G,this.T_=new G,this.R_=new G,this.D_=null,this.V_=null,this.I_=new Map,this.B_=-1,this.A_=[],this.ys=e,this.Ml=i,this.E_=e.rightOffset,this.z_=e.barSpacing,this.ts=t,this.i_=s,this.L_(),this.x_.o_(e.uniformDistribution),this.O_()}N(){return this.ys}N_(t){Ot(this.Ml,t),this.W_(),this.L_()}hr(t,e){Ot(this.ys,t),this.ys.fixLeftEdge&&this.F_(),this.ys.fixRightEdge&&this.H_(),t.barSpacing!==void 0&&this.ts.dn(t.barSpacing),t.rightOffset!==void 0&&this.ts.fn(t.rightOffset),t.minBarSpacing===void 0&&t.maxBarSpacing===void 0||this.ts.dn(t.barSpacing??this.z_),t.ignoreWhitespaceIndices!==void 0&&t.ignoreWhitespaceIndices!==this.ys.ignoreWhitespaceIndices&&this.O_(),this.W_(),this.L_(),this.R_.p()}Rs(t){var e;return((e=this.S_[t])==null?void 0:e.time)??null}ss(t){return this.S_[t]??null}U_(t,e){if(this.S_.length<1)return null;if(this.i_.key(t)>this.i_.key(this.S_[this.S_.length-1].time))return e?this.S_.length-1:null;const i=Bs(this.S_,this.i_.key(t),(s,n)=>this.i_.key(s.time)<n);return this.i_.key(t)<this.i_.key(this.S_[i].time)?e?i:null:i}Ki(){return this.fo===0||this.S_.length===0||this.b_===null}q_(){return this.S_.length>0}ye(){return this.Y_(),this.y_.w_()}j_(){return this.Y_(),this.y_.g_()}K_(){const t=this.ye();if(t===null)return null;const e={from:t.Uh(),to:t.bi()};return this.X_(e)}X_(t){const e=Math.round(t.from),i=Math.round(t.to),s=E(this.Z_()),n=E(this.G_());return{from:E(this.ss(Math.max(s,e))),to:E(this.ss(Math.min(n,i)))}}J_(t){return{from:E(this.U_(t.from,!0)),to:E(this.U_(t.to,!0))}}Qi(){return this.fo}To(t){if(!isFinite(t)||t<=0||this.fo===t)return;const e=this.j_(),i=this.fo;if(this.fo=t,this.k_=!0,this.ys.lockVisibleTimeRangeOnResize&&i!==0){const s=this.z_*t/i;this.z_=s}if(this.ys.fixLeftEdge&&e!==null&&e.Uh()<=0){const s=i-t;this.E_-=Math.round(s/this.z_)+1,this.k_=!0}this.Q_(),this.tu()}qt(t){if(this.Ki()||!An(t))return 0;const e=this.iu()+this.E_-t;return this.fo-(e+.5)*this.z_-1}su(t,e){const i=this.iu(),s=e===void 0?0:e.from,n=e===void 0?t.length:e.to;for(let h=s;h<n;h++){const l=t[h].wt,c=i+this.E_-l,u=this.fo-(c+.5)*this.z_-1;t[h]._t=u}}nu(t,e){const i=Math.ceil(this.eu(t));return e&&this.ys.ignoreWhitespaceIndices&&!this.ru(i)?this.hu(i):i}fn(t){this.k_=!0,this.E_=t,this.tu(),this.ts.au(),this.ts.ar()}lu(){return this.z_}dn(t){this.ou(t),this.tu(),this.ts.au(),this.ts.ar()}_u(){return this.E_}Va(){if(this.Ki())return null;if(this.V_!==null)return this.V_;const t=this.z_,e=5*(this.ts.N().layout.fontSize+4)/8*(this.ys.tickMarkMaxCharacterLength||8),i=Math.round(e/t),s=E(this.ye()),n=Math.max(s.Uh(),s.Uh()-i),h=Math.max(s.bi(),s.bi()-i),l=this.x_.c_(t,e,this.ys.ignoreWhitespaceIndices,this.I_,this.B_),c=this.Z_()+i,u=this.G_()-i,d=this.uu(),p=this.ys.fixLeftEdge||d,m=this.ys.fixRightEdge||d;let v=0;for(const _ of l){if(!(n<=_.index&&_.index<=h))continue;let C;v<this.A_.length?(C=this.A_[v],C.coord=this.qt(_.index),C.label=this.cu(_),C.weight=_.weight):(C={needAlignCoordinate:!1,coord:this.qt(_.index),label:this.cu(_),weight:_.weight},this.A_.push(C)),this.z_>e/2&&!d?C.needAlignCoordinate=!1:C.needAlignCoordinate=p&&_.index<=c||m&&_.index>=u,v++}return this.A_.length=v,this.V_=this.A_,this.A_}du(){this.k_=!0,this.dn(this.ys.barSpacing),this.fn(this.ys.rightOffset)}fu(t){this.k_=!0,this.b_=t,this.tu(),this.F_()}pu(t,e){const i=this.eu(t),s=this.lu(),n=s+e*(s/10);this.dn(n),this.ys.rightBarStaysOnScroll||this.fn(this._u()+(i-this.eu(t)))}so(t){this.vl&&this.ao(),this.pl===null&&this.D_===null&&(this.Ki()||(this.pl=t,this.vu()))}no(t){if(this.D_===null)return;const e=ns(this.fo-t,0,this.fo),i=ns(this.fo-E(this.pl),0,this.fo);e!==0&&i!==0&&this.dn(this.D_.lu*e/i)}eo(){this.pl!==null&&(this.pl=null,this.mu())}ro(t){this.vl===null&&this.D_===null&&(this.Ki()||(this.vl=t,this.vu()))}ho(t){if(this.vl===null)return;const e=(this.vl-t)/this.lu();this.E_=E(this.D_)._u+e,this.k_=!0,this.tu()}ao(){this.vl!==null&&(this.vl=null,this.mu())}wu(){this.gu(this.ys.rightOffset)}gu(t,e=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const i=this.E_,s=performance.now();this.ts._n({Mu:n=>(n-s)/e>=1,bu:n=>{const h=(n-s)/e;return h>=1?t:i+(t-i)*h}})}kt(t,e){this.k_=!0,this.S_=t,this.x_.__(t,e),this.tu()}Su(){return this.P_}xu(){return this.T_}Cu(){return this.R_}iu(){return this.b_||0}yu(t){const e=t.h_();this.ou(this.fo/e),this.E_=t.bi()-this.iu(),this.tu(),this.k_=!0,this.ts.au(),this.ts.ar()}ku(){const t=this.Z_(),e=this.G_();t!==null&&e!==null&&this.yu(new rs(t,e+this.ys.rightOffset))}Pu(t){const e=new rs(t.from,t.to);this.yu(e)}ns(t){return this.Ml.timeFormatter!==void 0?this.Ml.timeFormatter(t.originalTime):this.i_.formatHorzItem(t.time)}O_(){if(!this.ys.ignoreWhitespaceIndices)return;this.I_.clear();const t=this.ts.js();for(const e of t)for(const i of e.ma())this.I_.set(i,!0);this.B_++}uu(){const t=this.ts.N().handleScroll,e=this.ts.N().handleScale;return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||e.axisDoubleClickReset.time||e.axisPressedMouseMove.time||e.mouseWheel||e.pinch)}Z_(){return this.S_.length===0?null:0}G_(){return this.S_.length===0?null:this.S_.length-1}Tu(t){return(this.fo-1-t)/this.z_}eu(t){const e=this.Tu(t),i=this.iu()+this.E_-e;return Math.round(1e6*i)/1e6}ou(t){const e=this.z_;this.z_=t,this.Q_(),e!==this.z_&&(this.k_=!0,this.Ru())}Y_(){if(!this.k_)return;if(this.k_=!1,this.Ki())return void this.Du(hs.M_());const t=this.iu(),e=this.fo/this.z_,i=this.E_+t,s=new rs(i-e+1,i);this.Du(new hs(s))}Q_(){const t=ns(this.z_,this.Vu(),this.Iu());this.z_!==t&&(this.z_=t,this.k_=!0)}Iu(){return this.ys.maxBarSpacing>0?this.ys.maxBarSpacing:.5*this.fo}Vu(){return this.ys.fixLeftEdge&&this.ys.fixRightEdge&&this.S_.length!==0?this.fo/this.S_.length:this.ys.minBarSpacing}tu(){const t=this.Bu();t!==null&&this.E_<t&&(this.E_=t,this.k_=!0);const e=this.Au();this.E_>e&&(this.E_=e,this.k_=!0)}Bu(){const t=this.Z_(),e=this.b_;return t===null||e===null?null:t-e-1+(this.ys.fixLeftEdge?this.fo/this.z_:Math.min(2,this.S_.length))}Au(){return this.ys.fixRightEdge?0:this.fo/this.z_-Math.min(2,this.S_.length)}vu(){this.D_={lu:this.lu(),_u:this._u()}}mu(){this.D_=null}cu(t){let e=this.C_.get(t.weight);return e===void 0&&(e=new ab(i=>this.Eu(i),this.i_),this.C_.set(t.weight,e)),e.s_(t)}Eu(t){return this.i_.formatTickmark(t,this.Ml)}Du(t){const e=this.y_;this.y_=t,Za(e.w_(),this.y_.w_())||this.P_.p(),Za(e.g_(),this.y_.g_())||this.T_.p(),this.Ru()}Ru(){this.V_=null}W_(){this.Ru(),this.C_.clear()}L_(){this.i_.updateFormatter(this.Ml)}F_(){if(!this.ys.fixLeftEdge)return;const t=this.Z_();if(t===null)return;const e=this.ye();if(e===null)return;const i=e.Uh()-t;if(i<0){const s=this.E_-i-1;this.fn(s)}this.Q_()}H_(){this.tu(),this.Q_()}ru(t){return!this.ys.ignoreWhitespaceIndices||this.I_.get(t)||!1}hu(t){const e=function*(s){const n=Math.round(s),h=n<s;let l=1;for(;;)h?(yield n+l,yield n-l):(yield n-l,yield n+l),l++}(t),i=this.G_();for(;i;){const s=e.next().value;if(this.I_.get(s))return s;if(s<0||s>i)break}return t}}var Ka,Ja,tl,el,il;(function(r){r[r.OnTouchEnd=0]="OnTouchEnd",r[r.OnNextTap=1]="OnNextTap"})(Ka||(Ka={}));class db{constructor(t,e,i){this.zu=[],this.Lu=[],this.fo=0,this.Ou=null,this.Nu=new G,this.Wu=new G,this.Fu=null,this.Hu=t,this.ys=e,this.i_=i,this.bl=new d1(this.ys.layout.colorParsers),this.Uu=new u1(this),this.uh=new ub(this,e.timeScale,this.ys.localization,i),this.Ct=new C1(this,e.crosshair),this.$u=new J1(e.crosshair),this.qu(0),this.zu[0].Po(2e3),this.Yu=this.ju(0),this.Ku=this.ju(1)}Bh(){this.Xu(lt.gn())}ar(){this.Xu(lt.wn())}Zh(){this.Xu(new lt(1))}Ah(t){const e=this.Zu(t);this.Xu(e)}Gu(){return this.Ou}Ju(t){var i,s,n,h;if(((i=this.Ou)==null?void 0:i.Xo)===(t==null?void 0:t.Xo)&&((n=(s=this.Ou)==null?void 0:s.Zo)==null?void 0:n.Kn)===((h=t==null?void 0:t.Zo)==null?void 0:h.Kn))return;const e=this.Ou;this.Ou=t,e!==null&&this.Ah(e.Xo),t!==null&&t.Xo!==(e==null?void 0:e.Xo)&&this.Ah(t.Xo)}N(){return this.ys}hr(t){Ot(this.ys,t),this.zu.forEach(e=>e.xo(t)),t.timeScale!==void 0&&this.uh.hr(t.timeScale),t.localization!==void 0&&this.uh.N_(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.Nu.p(),this.Yu=this.ju(0),this.Ku=this.ju(1),this.Bh()}Qu(t,e,i=0){const s=this.zu[i];if(s===void 0)return;if(t==="left")return Ot(this.ys,{leftPriceScale:e}),s.xo({leftPriceScale:e}),this.Nu.p(),void this.Bh();if(t==="right")return Ot(this.ys,{rightPriceScale:e}),s.xo({rightPriceScale:e}),this.Nu.p(),void this.Bh();const n=this.tc(t,i);n!==null&&(n.Wt.hr(e),this.Nu.p())}tc(t,e){const i=this.zu[e];if(i===void 0)return null;const s=i.Co(t);return s!==null?{Us:i,Wt:s}:null}At(){return this.uh}$s(){return this.zu}sc(){return this.Ct}nc(){return this.Wu}ec(t,e){t.Al(e),this.au()}To(t){this.fo=t,this.uh.To(this.fo),this.zu.forEach(e=>e.To(t)),this.au()}rc(t){this.zu.length!==1&&(ut(t>=0&&t<this.zu.length,"Invalid pane index"),this.zu.splice(t,1),this.Bh())}hc(t,e){if(this.zu.length<2)return;ut(t>=0&&t<this.zu.length,"Invalid pane index");const i=this.zu[t],s=this.zu.reduce((p,m)=>p+m.ko(),0),n=this.zu.reduce((p,m)=>p+m.$t(),0),h=n-30*(this.zu.length-1);e=Math.min(h,Math.max(30,e));const l=s/n,c=i.$t();i.Po(e*l);let u=e-c,d=this.zu.length-1;for(const p of this.zu)if(p!==i){const m=Math.min(h,Math.max(30,p.$t()-u/d));u-=p.$t()-m,d-=1;const v=m*l;p.Po(v)}this.Bh()}ac(t,e){ut(t>=0&&t<this.zu.length&&e>=0&&e<this.zu.length,"Invalid pane index");const i=this.zu[t],s=this.zu[e];this.zu[t]=s,this.zu[e]=i,this.Bh()}Eo(t,e,i){t.Eo(e,i)}zo(t,e,i){t.zo(e,i),this.Eh(),this.Xu(this.lc(t,2))}Lo(t,e){t.Lo(e),this.Xu(this.lc(t,2))}Oo(t,e,i){e.Pl()||t.Oo(e,i)}No(t,e,i){e.Pl()||(t.No(e,i),this.Eh(),this.Xu(this.lc(t,2)))}Wo(t,e){e.Pl()||(t.Wo(e),this.Xu(this.lc(t,2)))}Ho(t,e){t.Ho(e),this.Xu(this.lc(t,2))}oc(t){this.uh.so(t)}_c(t,e){const i=this.At();if(i.Ki()||e===0)return;const s=i.Qi();t=Math.max(1,Math.min(t,s)),i.pu(t,e),this.au()}uc(t){this.cc(0),this.dc(t),this.fc()}vc(t){this.uh.no(t),this.au()}mc(){this.uh.eo(),this.ar()}cc(t){this.uh.ro(t)}dc(t){this.uh.ho(t),this.au()}fc(){this.uh.ao(),this.ar()}js(){return this.Lu}wc(t,e,i,s,n){this.Ct.Vs(t,e);let h=NaN,l=this.uh.nu(t,!0);const c=this.uh.ye();c!==null&&(l=Math.min(Math.max(c.Uh(),l),c.bi()));const u=s.Ps(),d=u.zt();if(d!==null&&(h=u.Ts(e,d)),h=this.$u.Ma(h,l,s),this.Ct.Es(l,h,s),this.Zh(),!n){const p=tf(s,t,e);this.Ju(p&&{Xo:p.Xo,Zo:p.Zo,Jo:p.Jo||null}),this.Wu.p(this.Ct.Bt(),{x:t,y:e},i)}}gc(t,e,i){const s=i.Ps(),n=s.zt(),h=s.Nt(t,E(n)),l=this.uh.U_(e,!0),c=this.uh.qt(E(l));this.wc(c,h,null,i,!0)}Mc(t){this.sc().Ls(),this.Zh(),t||this.Wu.p(null,null,null)}Eh(){const t=this.Ct.Us();if(t!==null){const e=this.Ct.Bs(),i=this.Ct.As();this.wc(e,i,null,t)}this.Ct.Ns()}bc(t,e,i){const s=this.uh.Rs(0);e!==void 0&&i!==void 0&&this.uh.kt(e,i);const n=this.uh.Rs(0),h=this.uh.iu(),l=this.uh.ye();if(l!==null&&s!==null&&n!==null){const c=l.Te(h),u=this.i_.key(s)>this.i_.key(n),d=t!==null&&t>h&&!u,p=this.uh.N().allowShiftVisibleRangeOnWhitespaceReplacement,m=c&&(i!==void 0||p)&&this.uh.N().shiftVisibleRangeOnNewBar;if(d&&!m){const v=t-h;this.uh.fn(this.uh._u()-v)}}this.uh.fu(t)}Lh(t){t!==null&&t.$o()}Hn(t){if(function(i){return i instanceof Ga}(t))return t;const e=this.zu.find(i=>i.Dt().includes(t));return e===void 0?null:e}au(){this.zu.forEach(t=>t.$o()),this.Eh()}m(){this.zu.forEach(t=>t.m()),this.zu.length=0,this.ys.localization.priceFormatter=void 0,this.ys.localization.percentageFormatter=void 0,this.ys.localization.timeFormatter=void 0}Sc(){return this.Uu}Yn(){return this.Uu.N()}yo(){return this.Nu}xc(t,e){const i=this.qu(e);this.Cc(t,i),this.Lu.push(t),this.Lu.length===1?this.Bh():this.ar()}yc(t){const e=this.Hn(t),i=this.Lu.indexOf(t);ut(i!==-1,"Series not found");const s=E(e);this.Lu.splice(i,1),s.Jl(t),t.m&&t.m(),this.uh.O_(),this.kc(s)}Ih(t,e){const i=E(this.Hn(t));i.Jl(t,!0),i.Zl(t,e,!0)}ku(){const t=lt.wn();t.rn(),this.Xu(t)}Pc(t){const e=lt.wn();e.ln(t),this.Xu(e)}cn(){const t=lt.wn();t.cn(),this.Xu(t)}dn(t){const e=lt.wn();e.dn(t),this.Xu(e)}fn(t){const e=lt.wn();e.fn(t),this.Xu(e)}_n(t){const e=lt.wn();e._n(t),this.Xu(e)}hn(){const t=lt.wn();t.hn(),this.Xu(t)}Tc(){return this.ys.rightPriceScale.visible?"right":"left"}Rc(t,e){if(ut(e>=0,"Index should be greater or equal to 0"),e===this.Dc(t))return;const i=E(this.Hn(t));i.Jl(t);const s=this.qu(e);this.Cc(t,s),i.ba().length===0&&this.kc(i)}Vc(){return this.Ku}$(){return this.Yu}Ut(t){const e=this.Ku,i=this.Yu;if(e===i)return e;if(t=Math.max(0,Math.min(100,Math.round(100*t))),this.Fu===null||this.Fu.mr!==i||this.Fu.wr!==e)this.Fu={mr:i,wr:e,Ic:new Map};else{const n=this.Fu.Ic.get(t);if(n!==void 0)return n}const s=this.bl.tt(i,e,t/100);return this.Fu.Ic.set(t,s),s}Bc(t){return this.zu.indexOf(t)}Xi(){return this.bl}qu(t){if(ut(t>=0,"Index should be greater or equal to 0"),(t=Math.min(this.zu.length,t))<this.zu.length)return this.zu[t];const e=new Ga(this.uh,this);this.zu.push(e);const i=lt.gn();return i.Qs(t,{tn:0,sn:!0}),this.Xu(i),e}Dc(t){return this.zu.findIndex(e=>e.Do().includes(t))}lc(t,e){const i=new lt(e);if(t!==null){const s=this.zu.indexOf(t);i.Qs(s,{tn:e})}return i}Zu(t,e){return e===void 0&&(e=2),this.lc(this.Hn(t),e)}Xu(t){this.Hu&&this.Hu(t),this.zu.forEach(e=>e.jo().lr().kt())}Cc(t,e){const i=t.N().priceScaleId,s=i!==void 0?i:this.Tc();e.Zl(t,s),ph(s)||t.hr(t.N())}ju(t){const e=this.ys.layout;return e.background.type==="gradient"?t===0?e.background.topColor:e.background.bottomColor:e.background.color}kc(t){t.ba().length===0&&this.zu.length>1&&(this.zu.splice(this.Bc(t),1),this.Bh())}}function Po(r){return!Fi(r)&&!Mr(r)}function ef(r){return Fi(r)}(function(r){r[r.Disabled=0]="Disabled",r[r.Continuous=1]="Continuous",r[r.OnDataUpdate=2]="OnDataUpdate"})(Ja||(Ja={})),function(r){r[r.LastBar=0]="LastBar",r[r.LastVisible=1]="LastVisible"}(tl||(tl={})),function(r){r.Solid="solid",r.VerticalGradient="gradient"}(el||(el={})),function(r){r[r.Year=0]="Year",r[r.Month=1]="Month",r[r.DayOfMonth=2]="DayOfMonth",r[r.Time=3]="Time",r[r.TimeWithSeconds=4]="TimeWithSeconds"}(il||(il={}));const sl=r=>r.getUTCFullYear();function fb(r,t,e){return t.replace(/yyyy/g,(i=>_e(sl(i),4))(r)).replace(/yy/g,(i=>_e(sl(i)%100,2))(r)).replace(/MMMM/g,((i,s)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(s,{month:"long"}))(r,e)).replace(/MMM/g,((i,s)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(s,{month:"short"}))(r,e)).replace(/MM/g,(i=>_e((s=>s.getUTCMonth()+1)(i),2))(r)).replace(/dd/g,(i=>_e((s=>s.getUTCDate())(i),2))(r))}class sf{constructor(t="yyyy-MM-dd",e="default"){this.Ac=t,this.Ec=e}s_(t){return fb(t,this.Ac,this.Ec)}}class pb{constructor(t){this.zc=t||"%h:%m:%s"}s_(t){return this.zc.replace("%h",_e(t.getUTCHours(),2)).replace("%m",_e(t.getUTCMinutes(),2)).replace("%s",_e(t.getUTCSeconds(),2))}}const mb={Lc:"yyyy-MM-dd",Oc:"%h:%m:%s",Nc:" ",Wc:"default"};class gb{constructor(t={}){const e={...mb,...t};this.Fc=new sf(e.Lc,e.Wc),this.Hc=new pb(e.Oc),this.Uc=e.Nc}s_(t){return`${this.Fc.s_(t)}${this.Uc}${this.Hc.s_(t)}`}}function Ar(r){return 60*r*60*1e3}function Ih(r){return 60*r*1e3}const kr=[{$c:(nl=1,1e3*nl),qc:10},{$c:Ih(1),qc:20},{$c:Ih(5),qc:21},{$c:Ih(30),qc:22},{$c:Ar(1),qc:30},{$c:Ar(3),qc:31},{$c:Ar(6),qc:32},{$c:Ar(12),qc:33}];var nl;function rl(r,t){if(r.getUTCFullYear()!==t.getUTCFullYear())return 70;if(r.getUTCMonth()!==t.getUTCMonth())return 60;if(r.getUTCDate()!==t.getUTCDate())return 50;for(let e=kr.length-1;e>=0;--e)if(Math.floor(t.getTime()/kr[e].$c)!==Math.floor(r.getTime()/kr[e].$c))return kr[e].qc;return 0}function Ah(r){let t=r;if(Mr(r)&&(t=ba(r)),!Po(t))throw new Error("time must be of type BusinessDay");const e=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{Yc:Math.round(e.getTime()/1e3),jc:t}}function hl(r){if(!ef(r))throw new Error("time must be of type isUTCTimestamp");return{Yc:r}}function ba(r){const t=new Date(r);if(isNaN(t.getTime()))throw new Error(`Invalid date string=${r}, expected format=yyyy-mm-dd`);return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function ol(r){Mr(r.time)&&(r.time=ba(r.time))}class al{options(){return this.ys}setOptions(t){this.ys=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?function(e){e.forEach(ol)}(t):ol(t)}createConverterToInternalObj(t){return E(function(e){return e.length===0?null:Po(e[0].time)||Mr(e[0].time)?Ah:hl}(t))}key(t){return typeof t=="object"&&"Yc"in t?t.Yc:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){const e=t;return e.jc===void 0?new Date(1e3*e.Yc).getTime():new Date(Date.UTC(e.jc.year,e.jc.month-1,e.jc.day)).getTime()}convertHorzItemToInternal(t){return ef(e=t)?hl(e):Po(e)?Ah(e):Ah(ba(e));var e}updateFormatter(t){if(!this.ys)return;const e=t.dateFormat;this.ys.timeScale.timeVisible?this.Kc=new gb({Lc:e,Oc:this.ys.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",Nc:"   ",Wc:t.locale}):this.Kc=new sf(e,t.locale)}formatHorzItem(t){const e=t;return this.Kc.s_(new Date(1e3*e.Yc))}formatTickmark(t,e){const i=function(n,h,l){switch(n){case 0:case 10:return h?l?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return h?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.weight,this.ys.timeScale.timeVisible,this.ys.timeScale.secondsVisible),s=this.ys.timeScale;if(s.tickMarkFormatter!==void 0){const n=s.tickMarkFormatter(t.originalTime,i,e.locale);if(n!==null)return n}return function(n,h,l){const c={};switch(h){case 0:c.year="numeric";break;case 1:c.month="short";break;case 2:c.day="numeric";break;case 3:c.hour12=!1,c.hour="2-digit",c.minute="2-digit";break;case 4:c.hour12=!1,c.hour="2-digit",c.minute="2-digit",c.second="2-digit"}const u=n.jc===void 0?new Date(1e3*n.Yc):new Date(Date.UTC(n.jc.year,n.jc.month-1,n.jc.day));return new Date(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate(),u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()).toLocaleString(l,c)}(t.time,i,e.locale)}maxTickMarkWeight(t){let e=t.reduce(cb,t[0]).weight;return e>30&&e<50&&(e=30),e}fillWeightsForPoints(t,e){(function(i,s=0){if(i.length===0)return;let n=s===0?null:i[s-1].time.Yc,h=n!==null?new Date(1e3*n):null,l=0;for(let c=s;c<i.length;++c){const u=i[c],d=new Date(1e3*u.time.Yc);h!==null&&(u.timeWeight=rl(d,h)),l+=u.time.Yc-(n||u.time.Yc),n=u.time.Yc,h=d}if(s===0&&i.length>1){const c=Math.ceil(l/(i.length-1)),u=new Date(1e3*(i[0].time.Yc-c));i[0].timeWeight=rl(new Date(1e3*i[0].time.Yc),u)}})(t,e)}static Xc(t){return Ot({localization:{dateFormat:"dd MMM 'yy"}},t??{})}}const $s=typeof window<"u";function ll(){return!!$s&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function kh(){return!!$s&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function Do(r){return r+r%2}function vb(r){$s&&window.chrome!==void 0&&r.addEventListener("mousedown",t=>{if(t.button===1)return t.preventDefault(),!1})}class vh{constructor(t,e,i){this.Zc=0,this.Gc=null,this.Jc={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.Qc=0,this.td=null,this.sd={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.nd=null,this.ed=!1,this.rd=null,this.hd=null,this.ad=!1,this.ld=!1,this.od=!1,this._d=null,this.ud=null,this.dd=null,this.fd=null,this.pd=null,this.vd=null,this.md=null,this.wd=0,this.gd=!1,this.Md=!1,this.bd=!1,this.Sd=0,this.xd=null,this.Cd=!kh(),this.yd=s=>{this.kd(s)},this.Pd=s=>{if(this.Td(s)){const n=this.Rd(s);if(++this.Qc,this.td&&this.Qc>1){const{Dd:h}=this.Vd(Yt(s),this.sd);h<30&&!this.od&&this.Id(n,this.Ad.Bd),this.Ed()}}else{const n=this.Rd(s);if(++this.Zc,this.Gc&&this.Zc>1){const{Dd:h}=this.Vd(Yt(s),this.Jc);h<5&&!this.ld&&this.zd(n,this.Ad.Ld),this.Od()}}},this.Nd=t,this.Ad=e,this.ys=i,this.Wd()}m(){this._d!==null&&(this._d(),this._d=null),this.ud!==null&&(this.ud(),this.ud=null),this.fd!==null&&(this.fd(),this.fd=null),this.pd!==null&&(this.pd(),this.pd=null),this.vd!==null&&(this.vd(),this.vd=null),this.dd!==null&&(this.dd(),this.dd=null),this.Fd(),this.Od()}Hd(t){this.fd&&this.fd();const e=this.Ud.bind(this);if(this.fd=()=>{this.Nd.removeEventListener("mousemove",e)},this.Nd.addEventListener("mousemove",e),this.Td(t))return;const i=this.Rd(t);this.zd(i,this.Ad.$d),this.Cd=!0}Od(){this.Gc!==null&&clearTimeout(this.Gc),this.Zc=0,this.Gc=null,this.Jc={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}Ed(){this.td!==null&&clearTimeout(this.td),this.Qc=0,this.td=null,this.sd={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}Ud(t){if(this.bd||this.hd!==null||this.Td(t))return;const e=this.Rd(t);this.zd(e,this.Ad.qd),this.Cd=!0}Yd(t){const e=Rh(t.changedTouches,E(this.xd));if(e===null||(this.Sd=Rr(t),this.md!==null)||this.Md)return;this.gd=!0;const i=this.Vd(Yt(e),E(this.hd)),{jd:s,Kd:n,Dd:h}=i;if(this.ad||!(h<5)){if(!this.ad){const l=.5*s,c=n>=l&&!this.ys.Xd(),u=l>n&&!this.ys.Zd();c||u||(this.Md=!0),this.ad=!0,this.od=!0,this.Fd(),this.Ed()}if(!this.Md){const l=this.Rd(t,e);this.Id(l,this.Ad.Gd),Ui(t)}}}Jd(t){if(t.button!==0)return;const e=this.Vd(Yt(t),E(this.rd)),{Dd:i}=e;if(i>=5&&(this.ld=!0,this.Od()),this.ld){const s=this.Rd(t);this.zd(s,this.Ad.Qd)}}Vd(t,e){const i=Math.abs(e._t-t._t),s=Math.abs(e.ut-t.ut);return{jd:i,Kd:s,Dd:i+s}}tf(t){let e=Rh(t.changedTouches,E(this.xd));if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e===null)return;this.xd=null,this.Sd=Rr(t),this.Fd(),this.hd=null,this.vd&&(this.vd(),this.vd=null);const i=this.Rd(t,e);if(this.Id(i,this.Ad.if),++this.Qc,this.td&&this.Qc>1){const{Dd:s}=this.Vd(Yt(e),this.sd);s<30&&!this.od&&this.Id(i,this.Ad.Bd),this.Ed()}else this.od||(this.Id(i,this.Ad.sf),this.Ad.sf&&Ui(t));this.Qc===0&&Ui(t),t.touches.length===0&&this.ed&&(this.ed=!1,Ui(t))}kd(t){if(t.button!==0)return;const e=this.Rd(t);if(this.rd=null,this.bd=!1,this.pd&&(this.pd(),this.pd=null),ll()&&this.Nd.ownerDocument.documentElement.removeEventListener("mouseleave",this.yd),!this.Td(t))if(this.zd(e,this.Ad.nf),++this.Zc,this.Gc&&this.Zc>1){const{Dd:i}=this.Vd(Yt(t),this.Jc);i<5&&!this.ld&&this.zd(e,this.Ad.Ld),this.Od()}else this.ld||this.zd(e,this.Ad.ef)}Fd(){this.nd!==null&&(clearTimeout(this.nd),this.nd=null)}rf(t){if(this.xd!==null)return;const e=t.changedTouches[0];this.xd=e.identifier,this.Sd=Rr(t);const i=this.Nd.ownerDocument.documentElement;this.od=!1,this.ad=!1,this.Md=!1,this.hd=Yt(e),this.vd&&(this.vd(),this.vd=null);{const n=this.Yd.bind(this),h=this.tf.bind(this);this.vd=()=>{i.removeEventListener("touchmove",n),i.removeEventListener("touchend",h)},i.addEventListener("touchmove",n,{passive:!1}),i.addEventListener("touchend",h,{passive:!1}),this.Fd(),this.nd=setTimeout(this.hf.bind(this,t),240)}const s=this.Rd(t,e);this.Id(s,this.Ad.af),this.td||(this.Qc=0,this.td=setTimeout(this.Ed.bind(this),500),this.sd=Yt(e))}lf(t){if(t.button!==0)return;const e=this.Nd.ownerDocument.documentElement;ll()&&e.addEventListener("mouseleave",this.yd),this.ld=!1,this.rd=Yt(t),this.pd&&(this.pd(),this.pd=null);{const s=this.Jd.bind(this),n=this.kd.bind(this);this.pd=()=>{e.removeEventListener("mousemove",s),e.removeEventListener("mouseup",n)},e.addEventListener("mousemove",s),e.addEventListener("mouseup",n)}if(this.bd=!0,this.Td(t))return;const i=this.Rd(t);this.zd(i,this.Ad._f),this.Gc||(this.Zc=0,this.Gc=setTimeout(this.Od.bind(this),500),this.Jc=Yt(t))}Wd(){this.Nd.addEventListener("mouseenter",this.Hd.bind(this)),this.Nd.addEventListener("touchcancel",this.Fd.bind(this));{const t=this.Nd.ownerDocument,e=i=>{this.Ad.uf&&(i.composed&&this.Nd.contains(i.composedPath()[0])||i.target&&this.Nd.contains(i.target)||this.Ad.uf())};this.ud=()=>{t.removeEventListener("touchstart",e)},this._d=()=>{t.removeEventListener("mousedown",e)},t.addEventListener("mousedown",e),t.addEventListener("touchstart",e,{passive:!0})}kh()&&(this.dd=()=>{this.Nd.removeEventListener("dblclick",this.Pd)},this.Nd.addEventListener("dblclick",this.Pd)),this.Nd.addEventListener("mouseleave",this.cf.bind(this)),this.Nd.addEventListener("touchstart",this.rf.bind(this),{passive:!0}),vb(this.Nd),this.Nd.addEventListener("mousedown",this.lf.bind(this)),this.df(),this.Nd.addEventListener("touchmove",()=>{},{passive:!1})}df(){this.Ad.ff===void 0&&this.Ad.pf===void 0&&this.Ad.vf===void 0||(this.Nd.addEventListener("touchstart",t=>this.mf(t.touches),{passive:!0}),this.Nd.addEventListener("touchmove",t=>{if(t.touches.length===2&&this.md!==null&&this.Ad.pf!==void 0){const e=cl(t.touches[0],t.touches[1])/this.wd;this.Ad.pf(this.md,e),Ui(t)}},{passive:!1}),this.Nd.addEventListener("touchend",t=>{this.mf(t.touches)}))}mf(t){t.length===1&&(this.gd=!1),t.length!==2||this.gd||this.ed?this.wf():this.gf(t)}gf(t){const e=this.Nd.getBoundingClientRect()||{left:0,top:0};this.md={_t:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,ut:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.wd=cl(t[0],t[1]),this.Ad.ff!==void 0&&this.Ad.ff(),this.Fd()}wf(){this.md!==null&&(this.md=null,this.Ad.vf!==void 0&&this.Ad.vf())}cf(t){if(this.fd&&this.fd(),this.Td(t)||!this.Cd)return;const e=this.Rd(t);this.zd(e,this.Ad.Mf),this.Cd=!kh()}hf(t){const e=Rh(t.touches,E(this.xd));if(e===null)return;const i=this.Rd(t,e);this.Id(i,this.Ad.bf),this.od=!0,this.ed=!0}Td(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents!==void 0?t.sourceCapabilities.firesTouchEvents:Rr(t)<this.Sd+500}Id(t,e){e&&e.call(this.Ad,t)}zd(t,e){e&&e.call(this.Ad,t)}Rd(t,e){const i=e||t,s=this.Nd.getBoundingClientRect()||{left:0,top:0};return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-s.left,localY:i.clientY-s.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,Sf:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",xf:t.type,Cf:i.target,Qo:t.view,yf:()=>{t.type!=="touchstart"&&Ui(t)}}}}function cl(r,t){const e=r.clientX-t.clientX,i=r.clientY-t.clientY;return Math.sqrt(e*e+i*i)}function Ui(r){r.cancelable&&r.preventDefault()}function Yt(r){return{_t:r.pageX,ut:r.pageY}}function Rr(r){return r.timeStamp||performance.now()}function Rh(r,t){for(let e=0;e<r.length;++e)if(r[e].identifier===t)return r[e];return null}class bb{constructor(t,e,i){this.kf=null,this.Pf=null,this.Tf=!0,this.Rf=null,this.Df=t,this.Vf=t.If()[e],this.Bf=t.If()[i],this.Af=document.createElement("tr"),this.Af.style.height="1px",this.Ef=document.createElement("td"),this.Ef.style.position="relative",this.Ef.style.padding="0",this.Ef.style.margin="0",this.Ef.setAttribute("colspan","3"),this.zf(),this.Af.appendChild(this.Ef),this.Tf=this.Df.N().layout.panes.enableResize,this.Tf?this.Lf():(this.kf=null,this.Pf=null)}m(){this.Pf!==null&&this.Pf.m()}Of(){return this.Af}Nf(){return Y({width:this.Vf.Nf().width,height:1})}Wf(){return Y({width:this.Vf.Wf().width,height:1*window.devicePixelRatio})}Ff(t,e,i){const s=this.Wf();t.fillStyle=this.Df.N().layout.panes.separatorColor,t.fillRect(e,i,s.width,s.height)}kt(){this.zf(),this.Df.N().layout.panes.enableResize!==this.Tf&&(this.Tf=this.Df.N().layout.panes.enableResize,this.Tf?this.Lf():(this.kf!==null&&(this.Ef.removeChild(this.kf.Hf),this.Ef.removeChild(this.kf.Uf),this.kf=null),this.Pf!==null&&(this.Pf.m(),this.Pf=null)))}Lf(){const t=document.createElement("div"),e=t.style;e.position="fixed",e.display="none",e.zIndex="49",e.top="0",e.left="0",e.width="100%",e.height="100%",e.cursor="row-resize",this.Ef.appendChild(t);const i=document.createElement("div"),s=i.style;s.position="absolute",s.zIndex="50",s.top="-4px",s.height="9px",s.width="100%",s.backgroundColor="",s.cursor="row-resize",this.Ef.appendChild(i);const n={$d:this.$f.bind(this),Mf:this.qf.bind(this),_f:this.Yf.bind(this),af:this.Yf.bind(this),Qd:this.jf.bind(this),Gd:this.jf.bind(this),nf:this.Kf.bind(this),if:this.Kf.bind(this)};this.Pf=new vh(i,n,{Xd:()=>!1,Zd:()=>!0}),this.kf={Uf:i,Hf:t}}zf(){this.Ef.style.background=this.Df.N().layout.panes.separatorColor}$f(t){this.kf!==null&&(this.kf.Uf.style.backgroundColor=this.Df.N().layout.panes.separatorHoverColor)}qf(t){this.kf!==null&&this.Rf===null&&(this.kf.Uf.style.backgroundColor="")}Yf(t){if(this.kf===null)return;const e=this.Vf.Xf().ko()+this.Bf.Xf().ko(),i=e/(this.Vf.Nf().height+this.Bf.Nf().height),s=30*i;e<=2*s||(this.Rf={Zf:t.pageY,Gf:this.Vf.Xf().ko(),Jf:e-s,Qf:e,tp:i,ip:s},this.kf.Hf.style.display="block")}jf(t){const e=this.Rf;if(e===null)return;const i=(t.pageY-e.Zf)*e.tp,s=ns(e.Gf+i,e.ip,e.Jf);this.Vf.Xf().Po(s),this.Bf.Xf().Po(e.Qf-s),this.Df.Qt().Bh()}Kf(t){this.Rf!==null&&this.kf!==null&&(this.Rf=null,this.kf.Hf.style.display="none")}}function zh(r,t){return r.sp-t.sp}function Lh(r,t,e){const i=(r.sp-t.sp)/(r.wt-t.wt);return Math.sign(i)*Math.min(Math.abs(i),e)}class wb{constructor(t,e,i,s){this.np=null,this.ep=null,this.rp=null,this.hp=null,this.ap=null,this.lp=0,this.op=0,this._p=t,this.up=e,this.cp=i,this.Mn=s}dp(t,e){if(this.np!==null){if(this.np.wt===e)return void(this.np.sp=t);if(Math.abs(this.np.sp-t)<this.Mn)return}this.hp=this.rp,this.rp=this.ep,this.ep=this.np,this.np={wt:e,sp:t}}le(t,e){if(this.np===null||this.ep===null||e-this.np.wt>50)return;let i=0;const s=Lh(this.np,this.ep,this.up),n=zh(this.np,this.ep),h=[s],l=[n];if(i+=n,this.rp!==null){const u=Lh(this.ep,this.rp,this.up);if(Math.sign(u)===Math.sign(s)){const d=zh(this.ep,this.rp);if(h.push(u),l.push(d),i+=d,this.hp!==null){const p=Lh(this.rp,this.hp,this.up);if(Math.sign(p)===Math.sign(s)){const m=zh(this.rp,this.hp);h.push(p),l.push(m),i+=m}}}}let c=0;for(let u=0;u<h.length;++u)c+=l[u]/i*h[u];Math.abs(c)<this._p||(this.ap={sp:t,wt:e},this.op=c,this.lp=function(u,d){const p=Math.log(d);return Math.log(1*p/-u)/p}(Math.abs(c),this.cp))}bu(t){const e=E(this.ap),i=t-e.wt;return e.sp+this.op*(Math.pow(this.cp,i)-1)/Math.log(this.cp)}Mu(t){return this.ap===null||this.fp(t)===this.lp}fp(t){const e=t-E(this.ap).wt;return Math.min(e,this.lp)}}class _b{constructor(t,e){this.pp=void 0,this.vp=void 0,this.mp=void 0,this.ps=!1,this.wp=t,this.gp=e,this.Mp()}kt(){this.Mp()}bp(){this.pp&&this.wp.removeChild(this.pp),this.vp&&this.wp.removeChild(this.vp),this.pp=void 0,this.vp=void 0}Sp(){return this.ps!==this.xp()||this.mp!==this.Cp()}Cp(){return this.gp.Qt().Xi().J(this.gp.N().layout.textColor)>160?"dark":"light"}xp(){return this.gp.N().layout.attributionLogo}yp(){const t=new URL(location.href);return t.hostname?"&utm_source="+t.hostname+t.pathname:""}Mp(){this.Sp()&&(this.bp(),this.ps=this.xp(),this.ps&&(this.mp=this.Cp(),this.vp=document.createElement("style"),this.vp.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.pp=document.createElement("a"),this.pp.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.yp()}`,this.pp.title="Charting by TradingView",this.pp.id="tv-attr-logo",this.pp.target="_blank",this.pp.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.pp.toggleAttribute("data-dark",this.mp==="dark"),this.wp.appendChild(this.vp),this.wp.appendChild(this.pp)))}}function Yi(r,t){const e=E(r.ownerDocument).createElement("canvas");r.appendChild(e);const i=h1(e,{options:{allowResizeObserver:!0},transform:(s,n)=>({width:Math.max(s.width,n.width),height:Math.max(s.height,n.height)})});return i.resizeCanvasElement(t),i}function Xi(r){var t;r.width=1,r.height=1,(t=r.getContext("2d"))==null||t.clearRect(0,0,1,1)}function Bo(r,t,e,i){r.ih&&r.ih(t,e,i)}function Fr(r,t,e,i){r.nt(t,e,i)}function $o(r,t,e,i){const s=r(e,i);for(const n of s){const h=n.Tt(i);h!==null&&t(h)}}function Ph(r,t){return e=>{var i,s;return function(n){return n.Wt!==void 0}(e)?(((i=e.Wt())==null?void 0:i.wa())??"")!==t?[]:((s=e.ta)==null?void 0:s.call(e,r))??[]:[]}}function ul(r,t,e,i){if(!r.length)return;let s=0;const n=r[0].$t(i,!0);let h=t===1?e/2-(r[0].Wi()-n/2):r[0].Wi()-n/2-e/2;h=Math.max(0,h);for(let l=1;l<r.length;l++){const c=r[l],u=r[l-1],d=u.$t(i,!1),p=c.Wi(),m=u.Wi();if(t===1?p>m-d:p<m+d){const v=m-d*t;c.Fi(v);const _=v-t*d/2;if((t===1?_<0:_>e)&&h>0){const C=t===1?-1-_:_-e,O=Math.min(C,h);for(let k=s;k<r.length;k++)r[k].Fi(r[k].Wi()+t*O);h-=O}}else s=l,h=t===1?m-d-p:p-(m+d)}}class dl{constructor(t,e,i,s){this.Yi=null,this.kp=null,this.Pp=!1,this.Tp=new zn(200),this.Rp=null,this.Dp=0,this.Vp=!1,this.Ip=()=>{this.Vp||this.yt.Bp().Qt().ar()},this.Ap=()=>{this.Vp||this.yt.Bp().Qt().ar()},this.yt=t,this.ys=e,this.gl=e.layout,this.Uu=i,this.Ep=s==="left",this.zp=Ph("normal",s),this.Lp=Ph("top",s),this.Op=Ph("bottom",s),this.Ef=document.createElement("div"),this.Ef.style.height="100%",this.Ef.style.overflow="hidden",this.Ef.style.width="25px",this.Ef.style.left="0",this.Ef.style.position="relative",this.Np=Yi(this.Ef,Y({width:16,height:16})),this.Np.subscribeSuggestedBitmapSizeChanged(this.Ip);const n=this.Np.canvasElement;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Wp=Yi(this.Ef,Y({width:16,height:16})),this.Wp.subscribeSuggestedBitmapSizeChanged(this.Ap);const h=this.Wp.canvasElement;h.style.position="absolute",h.style.zIndex="2",h.style.left="0",h.style.top="0";const l={_f:this.Yf.bind(this),af:this.Yf.bind(this),Qd:this.jf.bind(this),Gd:this.jf.bind(this),uf:this.Fp.bind(this),nf:this.Kf.bind(this),if:this.Kf.bind(this),Ld:this.Hp.bind(this),Bd:this.Hp.bind(this),$d:this.Up.bind(this),Mf:this.qf.bind(this)};this.Pf=new vh(this.Wp.canvasElement,l,{Xd:()=>!this.ys.handleScroll.vertTouchDrag,Zd:()=>!0})}m(){this.Pf.m(),this.Wp.unsubscribeSuggestedBitmapSizeChanged(this.Ap),Xi(this.Wp.canvasElement),this.Wp.dispose(),this.Np.unsubscribeSuggestedBitmapSizeChanged(this.Ip),Xi(this.Np.canvasElement),this.Np.dispose(),this.Yi!==null&&this.Yi.io().u(this),this.Yi=null}Of(){return this.Ef}k(){return this.gl.fontSize}$p(){const t=this.Uu.N();return this.Rp!==t.P&&(this.Tp.In(),this.Rp=t.P),t}qp(){if(this.Yi===null)return 0;let t=0;const e=this.$p(),i=E(this.Np.canvasElement.getContext("2d",{colorSpace:this.yt.Bp().N().layout.colorSpace}));i.save();const s=this.Yi.Va();i.font=this.Yp(),s.length>0&&(t=Math.max(this.Tp.Vi(i,s[0].Xa),this.Tp.Vi(i,s[s.length-1].Xa)));const n=this.jp();for(let u=n.length;u--;){const d=this.Tp.Vi(i,n[u].ri());d>t&&(t=d)}const h=this.Yi.zt();if(h!==null&&this.kp!==null&&(l=this.ys.crosshair).mode!==2&&l.horzLine.visible&&l.horzLine.labelVisible){const u=this.Yi.Ts(1,h),d=this.Yi.Ts(this.kp.height-2,h);t=Math.max(t,this.Tp.Vi(i,this.Yi.Zi(Math.floor(Math.min(u,d))+.11111111111111,h)),this.Tp.Vi(i,this.Yi.Zi(Math.ceil(Math.max(u,d))-.11111111111111,h)))}var l;i.restore();const c=t||34;return Do(Math.ceil(e.S+e.C+e.I+e.B+5+c))}Kp(t){this.kp!==null&&Bi(this.kp,t)||(this.kp=t,this.Vp=!0,this.Np.resizeCanvasElement(t),this.Wp.resizeCanvasElement(t),this.Vp=!1,this.Ef.style.width=`${t.width}px`,this.Ef.style.height=`${t.height}px`)}Xp(){return E(this.kp).width}_s(t){this.Yi!==t&&(this.Yi!==null&&this.Yi.io().u(this),this.Yi=t,t.io().i(this.ol.bind(this),this))}Wt(){return this.Yi}In(){const t=this.yt.Xf();this.yt.Bp().Qt().Ho(t,E(this.Wt()))}Zp(t){if(this.kp===null)return;const e={colorSpace:this.yt.Bp().N().layout.colorSpace};if(t!==1){this.Gp(),this.Np.applySuggestedBitmapSize();const s=$i(this.Np,e);s!==null&&(s.useBitmapCoordinateSpace(n=>{this.Jp(n),this.Qp(n)}),this.yt.tv(s,this.Op),this.iv(s),this.yt.tv(s,this.zp),this.sv(s))}this.Wp.applySuggestedBitmapSize();const i=$i(this.Wp,e);i!==null&&(i.useBitmapCoordinateSpace(({context:s,bitmapSize:n})=>{s.clearRect(0,0,n.width,n.height)}),this.nv(i),this.yt.tv(i,this.Lp))}Wf(){return this.Np.bitmapSize}Ff(t,e,i){const s=this.Wf();s.width>0&&s.height>0&&t.drawImage(this.Np.canvasElement,e,i)}kt(){var t;(t=this.Yi)==null||t.Va()}Yf(t){if(this.Yi===null||this.Yi.Ki()||!this.ys.handleScale.axisPressedMouseMove.price)return;const e=this.yt.Bp().Qt(),i=this.yt.Xf();this.Pp=!0,e.Eo(i,this.Yi,t.localY)}jf(t){if(this.Yi===null||!this.ys.handleScale.axisPressedMouseMove.price)return;const e=this.yt.Bp().Qt(),i=this.yt.Xf(),s=this.Yi;e.zo(i,s,t.localY)}Fp(){if(this.Yi===null||!this.ys.handleScale.axisPressedMouseMove.price)return;const t=this.yt.Bp().Qt(),e=this.yt.Xf(),i=this.Yi;this.Pp&&(this.Pp=!1,t.Lo(e,i))}Kf(t){if(this.Yi===null||!this.ys.handleScale.axisPressedMouseMove.price)return;const e=this.yt.Bp().Qt(),i=this.yt.Xf();this.Pp=!1,e.Lo(i,this.Yi)}Hp(t){this.ys.handleScale.axisDoubleClickReset.price&&this.In()}Up(t){this.Yi!==null&&(!this.yt.Bp().Qt().N().handleScale.axisPressedMouseMove.price||this.Yi.Le()||this.Yi.Rl()||this.ev(1))}qf(t){this.ev(0)}jp(){const t=[],e=this.Yi===null?void 0:this.Yi;return(i=>{for(let s=0;s<i.length;++s){const n=i[s].Fs(this.yt.Xf(),e);for(let h=0;h<n.length;h++)t.push(n[h])}})(this.yt.Xf().Dt()),t}Jp({context:t,bitmapSize:e}){const{width:i,height:s}=e,n=this.yt.Xf().Qt(),h=n.$(),l=n.Vc();h===l?dh(t,0,0,i,s,h):Hd(t,0,0,i,s,h,l)}Qp({context:t,bitmapSize:e,horizontalPixelRatio:i}){if(this.kp===null||this.Yi===null||!this.Yi.N().borderVisible)return;t.fillStyle=this.Yi.N().borderColor;const s=Math.max(1,Math.floor(this.$p().S*i));let n;n=this.Ep?e.width-s:0,t.fillRect(n,0,s,e.height)}iv(t){if(this.kp===null||this.Yi===null)return;const e=this.Yi.Va(),i=this.Yi.N(),s=this.$p(),n=this.Ep?this.kp.width-s.C:0;i.borderVisible&&i.ticksVisible&&t.useBitmapCoordinateSpace(({context:h,horizontalPixelRatio:l,verticalPixelRatio:c})=>{h.fillStyle=i.borderColor;const u=Math.max(1,Math.floor(c)),d=Math.floor(.5*c),p=Math.round(s.C*l);h.beginPath();for(const m of e)h.rect(Math.floor(n*l),Math.round(m.ka*c)-d,p,u);h.fill()}),t.useMediaCoordinateSpace(({context:h})=>{h.font=this.Yp(),h.fillStyle=i.textColor??this.gl.textColor,h.textAlign=this.Ep?"right":"left",h.textBaseline="middle";const l=this.Ep?Math.round(n-s.I):Math.round(n+s.C+s.I),c=e.map(u=>this.Tp.Di(h,u.Xa));for(let u=e.length;u--;){const d=e[u];h.fillText(d.Xa,l,d.ka+c[u])}})}Gp(){if(this.kp===null||this.Yi===null)return;let t=this.kp.height/2;const e=[],i=this.Yi.Dt().slice(),s=this.yt.Xf(),n=this.$p();this.Yi===s.$n()&&this.yt.Xf().Dt().forEach(c=>{s.Un(c)&&i.push(c)});const h=this.Yi.ba()[0],l=this.Yi;i.forEach(c=>{const u=c.Fs(s,l);u.forEach(d=>{d.Fi(null),d.Hi()&&e.push(d)}),h===c&&u.length>0&&(t=u[0].Bi())}),e.forEach(c=>c.Fi(c.Bi())),this.Yi.N().alignLabels&&this.rv(e,n,t)}rv(t,e,i){if(this.kp===null)return;const s=t.filter(h=>h.Bi()<=i),n=t.filter(h=>h.Bi()>i);s.sort((h,l)=>l.Bi()-h.Bi()),s.length&&n.length&&n.push(s[0]),n.sort((h,l)=>h.Bi()-l.Bi());for(const h of t){const l=Math.floor(h.$t(e)/2),c=h.Bi();c>-l&&c<l&&h.Fi(l),c>this.kp.height-l&&c<this.kp.height+l&&h.Fi(this.kp.height-l)}ul(s,1,this.kp.height,e),ul(n,-1,this.kp.height,e)}sv(t){if(this.kp===null)return;const e=this.jp(),i=this.$p(),s=this.Ep?"right":"left";e.forEach(n=>{n.Ui()&&n.Tt(E(this.Yi)).nt(t,i,this.Tp,s)})}nv(t){if(this.kp===null||this.Yi===null)return;const e=this.yt.Bp().Qt(),i=[],s=this.yt.Xf(),n=e.sc().Fs(s,this.Yi);n.length&&i.push(n);const h=this.$p(),l=this.Ep?"right":"left";i.forEach(c=>{c.forEach(u=>{u.Tt(E(this.Yi)).nt(t,h,this.Tp,l)})})}ev(t){this.Ef.style.cursor=t===1?"ns-resize":"default"}ol(){const t=this.qp();this.Dp<t&&this.yt.Bp().Qt().Bh(),this.Dp=t}Yp(){return Rn(this.gl.fontSize,this.gl.fontFamily)}}function yb(r,t){var e;return((e=r.Jh)==null?void 0:e.call(r,t))??[]}function fl(r,t){var e;return((e=r.Ws)==null?void 0:e.call(r,t))??[]}function pl(r,t){var e;return((e=r.us)==null?void 0:e.call(r,t))??[]}function Eb(r,t){var e;return((e=r.Xh)==null?void 0:e.call(r,t))??[]}class wa{constructor(t,e){this.kp=Y({width:0,height:0}),this.hv=null,this.av=null,this.lv=null,this.ov=null,this._v=!1,this.uv=new G,this.cv=new G,this.dv=0,this.fv=!1,this.pv=null,this.vv=!1,this.mv=null,this.wv=null,this.Vp=!1,this.Ip=()=>{this.Vp||this.gv===null||this.ts().ar()},this.Ap=()=>{this.Vp||this.gv===null||this.ts().ar()},this.gp=t,this.gv=e,this.gv.Yo().i(this.Mv.bind(this),this,!0),this.bv=document.createElement("td"),this.bv.style.padding="0",this.bv.style.position="relative";const i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.position="relative",i.style.overflow="hidden",this.Sv=document.createElement("td"),this.Sv.style.padding="0",this.xv=document.createElement("td"),this.xv.style.padding="0",this.bv.appendChild(i),this.Np=Yi(i,Y({width:16,height:16})),this.Np.subscribeSuggestedBitmapSizeChanged(this.Ip);const s=this.Np.canvasElement;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.Wp=Yi(i,Y({width:16,height:16})),this.Wp.subscribeSuggestedBitmapSizeChanged(this.Ap);const n=this.Wp.canvasElement;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0",this.Af=document.createElement("tr"),this.Af.appendChild(this.Sv),this.Af.appendChild(this.bv),this.Af.appendChild(this.xv),this.Cv(),this.Pf=new vh(this.Wp.canvasElement,this,{Xd:()=>this.pv===null&&!this.gp.N().handleScroll.vertTouchDrag,Zd:()=>this.pv===null&&!this.gp.N().handleScroll.horzTouchDrag})}m(){this.hv!==null&&this.hv.m(),this.av!==null&&this.av.m(),this.lv=null,this.Wp.unsubscribeSuggestedBitmapSizeChanged(this.Ap),Xi(this.Wp.canvasElement),this.Wp.dispose(),this.Np.unsubscribeSuggestedBitmapSizeChanged(this.Ip),Xi(this.Np.canvasElement),this.Np.dispose(),this.gv!==null&&(this.gv.Yo().u(this),this.gv.m()),this.Pf.m()}Xf(){return E(this.gv)}yv(t){var e;this.gv!==null&&this.gv.Yo().u(this),this.gv=t,this.gv!==null&&this.gv.Yo().i(wa.prototype.Mv.bind(this),this,!0),this.Cv(),this.gp.If().indexOf(this)===this.gp.If().length-1?(this.lv=this.lv??new _b(this.bv,this.gp),this.lv.kt()):((e=this.lv)==null||e.bp(),this.lv=null)}Bp(){return this.gp}Of(){return this.Af}Cv(){if(this.gv!==null&&(this.kv(),this.ts().js().length!==0)){if(this.hv!==null){const t=this.gv.Bo();this.hv._s(E(t))}if(this.av!==null){const t=this.gv.Ao();this.av._s(E(t))}}}Pv(){this.hv!==null&&this.hv.kt(),this.av!==null&&this.av.kt()}ko(){return this.gv!==null?this.gv.ko():0}Po(t){this.gv&&this.gv.Po(t)}$d(t){if(!this.gv)return;this.Tv();const e=t.localX,i=t.localY;this.Rv(e,i,t)}_f(t){this.Tv(),this.Dv(),this.Rv(t.localX,t.localY,t)}qd(t){if(!this.gv)return;this.Tv();const e=t.localX,i=t.localY;this.Rv(e,i,t)}ef(t){this.gv!==null&&(this.Tv(),this.Vv(t))}Ld(t){this.gv!==null&&this.Iv(this.cv,t)}Bd(t){this.Ld(t)}Qd(t){this.Tv(),this.Bv(t),this.Rv(t.localX,t.localY,t)}nf(t){this.gv!==null&&(this.Tv(),this.fv=!1,this.Av(t))}sf(t){this.gv!==null&&this.Vv(t)}bf(t){if(this.fv=!0,this.pv===null){const e={x:t.localX,y:t.localY};this.Ev(e,e,t)}}Mf(t){this.gv!==null&&(this.Tv(),this.gv.Qt().Ju(null),this.zv())}Lv(){return this.uv}Ov(){return this.cv}ff(){this.dv=1,this.ts().hn()}pf(t,e){if(!this.gp.N().handleScale.pinch)return;const i=5*(e-this.dv);this.dv=e,this.ts()._c(t._t,i)}af(t){this.fv=!1,this.vv=this.pv!==null,this.Dv();const e=this.ts().sc();this.pv!==null&&e.Vt()&&(this.mv={x:e.si(),y:e.ni()},this.pv={x:t.localX,y:t.localY})}Gd(t){if(this.gv===null)return;const e=t.localX,i=t.localY;if(this.pv===null)this.Bv(t);else{this.vv=!1;const s=E(this.mv),n=s.x+(e-this.pv.x),h=s.y+(i-this.pv.y);this.Rv(n,h,t)}}if(t){this.Bp().N().trackingMode.exitMode===0&&(this.vv=!0),this.Nv(),this.Av(t)}jn(t,e){const i=this.gv;return i===null?null:tf(i,t,e)}Wv(t,e){E(e==="left"?this.hv:this.av).Kp(Y({width:t,height:this.kp.height}))}Nf(){return this.kp}Kp(t){Bi(this.kp,t)||(this.kp=t,this.Vp=!0,this.Np.resizeCanvasElement(t),this.Wp.resizeCanvasElement(t),this.Vp=!1,this.bv.style.width=t.width+"px",this.bv.style.height=t.height+"px")}Fv(){const t=E(this.gv);t.Io(t.Bo()),t.Io(t.Ao());for(const e of t.ba())if(t.Un(e)){const i=e.Wt();i!==null&&t.Io(i),e.Ns()}for(const e of t.Ko())e.Ns()}Wf(){return this.Np.bitmapSize}Ff(t,e,i){const s=this.Wf();s.width>0&&s.height>0&&t.drawImage(this.Np.canvasElement,e,i)}Zp(t){if(t===0||this.gv===null)return;t>1&&this.Fv(),this.hv!==null&&this.hv.Zp(t),this.av!==null&&this.av.Zp(t);const e={colorSpace:this.gp.N().layout.colorSpace};if(t!==1){this.Np.applySuggestedBitmapSize();const s=$i(this.Np,e);s!==null&&(s.useBitmapCoordinateSpace(n=>{this.Jp(n)}),this.gv&&(this.Hv(s,yb),this.Uv(s),this.Hv(s,fl),this.Hv(s,pl)))}this.Wp.applySuggestedBitmapSize();const i=$i(this.Wp,e);i!==null&&(i.useBitmapCoordinateSpace(({context:s,bitmapSize:n})=>{s.clearRect(0,0,n.width,n.height)}),this.$v(i),this.Hv(i,Eb),this.Hv(i,pl))}qv(){return this.hv}Yv(){return this.av}tv(t,e){this.Hv(t,e)}Mv(){this.gv!==null&&this.gv.Yo().u(this),this.gv=null}Vv(t){this.Iv(this.uv,t)}Iv(t,e){const i=e.localX,s=e.localY;t.v()&&t.p(this.ts().At().nu(i),{x:i,y:s},e)}Jp({context:t,bitmapSize:e}){const{width:i,height:s}=e,n=this.ts(),h=n.$(),l=n.Vc();h===l?dh(t,0,0,i,s,l):Hd(t,0,0,i,s,h,l)}Uv(t){const e=E(this.gv),i=e.jo().lr().Tt(e);i!==null&&i.nt(t,!1)}$v(t){this.jv(t,fl,Fr,this.ts().sc())}Hv(t,e){const i=E(this.gv),s=i.Dt(),n=i.Ko();for(const h of n)this.jv(t,e,Bo,h);for(const h of s)this.jv(t,e,Bo,h);for(const h of n)this.jv(t,e,Fr,h);for(const h of s)this.jv(t,e,Fr,h)}jv(t,e,i,s){const n=E(this.gv),h=n.Qt().Gu(),l=h!==null&&h.Xo===s,c=h!==null&&l&&h.Zo!==void 0?h.Zo.Xn:void 0;$o(e,u=>i(u,t,l,c),s,n)}kv(){if(this.gv===null)return;const t=this.gp,e=this.gv.Bo().N().visible,i=this.gv.Ao().N().visible;e||this.hv===null||(this.Sv.removeChild(this.hv.Of()),this.hv.m(),this.hv=null),i||this.av===null||(this.xv.removeChild(this.av.Of()),this.av.m(),this.av=null);const s=t.Qt().Sc();e&&this.hv===null&&(this.hv=new dl(this,t.N(),s,"left"),this.Sv.appendChild(this.hv.Of())),i&&this.av===null&&(this.av=new dl(this,t.N(),s,"right"),this.xv.appendChild(this.av.Of()))}Kv(t){return t.Sf&&this.fv||this.pv!==null}Xv(t){return Math.max(0,Math.min(t,this.kp.width-1))}Zv(t){return Math.max(0,Math.min(t,this.kp.height-1))}Rv(t,e,i){this.ts().wc(this.Xv(t),this.Zv(e),i,E(this.gv))}zv(){this.ts().Mc()}Nv(){this.vv&&(this.pv=null,this.zv())}Ev(t,e,i){this.pv=t,this.vv=!1,this.Rv(e.x,e.y,i);const s=this.ts().sc();this.mv={x:s.si(),y:s.ni()}}ts(){return this.gp.Qt()}Av(t){if(!this._v)return;const e=this.ts(),i=this.Xf();if(e.Wo(i,i.Ps()),this.ov=null,this._v=!1,e.fc(),this.wv!==null){const s=performance.now(),n=e.At();this.wv.le(n._u(),s),this.wv.Mu(s)||e._n(this.wv)}}Tv(){this.pv=null}Dv(){if(this.gv){if(this.ts().hn(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)E(document.activeElement).blur();else{const t=document.getSelection();t!==null&&t.removeAllRanges()}!this.gv.Ps().Ki()&&this.ts().At().Ki()}}Bv(t){if(this.gv===null)return;const e=this.ts(),i=e.At();if(i.Ki())return;const s=this.gp.N(),n=s.handleScroll,h=s.kineticScroll;if((!n.pressedMouseMove||t.Sf)&&(!n.horzTouchDrag&&!n.vertTouchDrag||!t.Sf))return;const l=this.gv.Ps(),c=performance.now();if(this.ov!==null||this.Kv(t)||(this.ov={x:t.clientX,y:t.clientY,Yc:c,Gv:t.localX,Jv:t.localY}),this.ov!==null&&!this._v&&(this.ov.x!==t.clientX||this.ov.y!==t.clientY)){if(t.Sf&&h.touch||!t.Sf&&h.mouse){const u=i.lu();this.wv=new wb(.2/u,7/u,.997,15/u),this.wv.dp(i._u(),this.ov.Yc)}else this.wv=null;l.Ki()||e.Oo(this.gv,l,t.localY),e.cc(t.localX),this._v=!0}this._v&&(l.Ki()||e.No(this.gv,l,t.localY),e.dc(t.localX),this.wv!==null&&this.wv.dp(i._u(),c))}}class ml{constructor(t,e,i,s,n){this.xt=!0,this.kp=Y({width:0,height:0}),this.Ip=()=>this.Zp(3),this.Ep=t==="left",this.Uu=i.Sc,this.ys=e,this.Qv=s,this.tm=n,this.Ef=document.createElement("div"),this.Ef.style.width="25px",this.Ef.style.height="100%",this.Ef.style.overflow="hidden",this.Np=Yi(this.Ef,Y({width:16,height:16})),this.Np.subscribeSuggestedBitmapSizeChanged(this.Ip)}m(){this.Np.unsubscribeSuggestedBitmapSizeChanged(this.Ip),Xi(this.Np.canvasElement),this.Np.dispose()}Of(){return this.Ef}Nf(){return this.kp}Kp(t){Bi(this.kp,t)||(this.kp=t,this.Np.resizeCanvasElement(t),this.Ef.style.width=`${t.width}px`,this.Ef.style.height=`${t.height}px`,this.xt=!0)}Zp(t){if(t<3&&!this.xt||this.kp.width===0||this.kp.height===0)return;this.xt=!1,this.Np.applySuggestedBitmapSize();const e=$i(this.Np,{colorSpace:this.ys.layout.colorSpace});e!==null&&e.useBitmapCoordinateSpace(i=>{this.Jp(i),this.Qp(i)})}Wf(){return this.Np.bitmapSize}Ff(t,e,i){const s=this.Wf();s.width>0&&s.height>0&&t.drawImage(this.Np.canvasElement,e,i)}Qp({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(!this.Qv())return;t.fillStyle=this.ys.timeScale.borderColor;const n=Math.floor(this.Uu.N().S*i),h=Math.floor(this.Uu.N().S*s),l=this.Ep?e.width-n:0;t.fillRect(l,0,n,h)}Jp({context:t,bitmapSize:e}){dh(t,0,0,e.width,e.height,this.tm())}}function _a(r){return t=>{var e;return((e=t.ia)==null?void 0:e.call(t,r))??[]}}const Cb=_a("normal"),Mb=_a("top"),Tb=_a("bottom");class xb{constructor(t,e){this.im=null,this.sm=null,this.M=null,this.nm=!1,this.kp=Y({width:0,height:0}),this.rm=new G,this.Tp=new zn(5),this.Vp=!1,this.Ip=()=>{this.Vp||this.gp.Qt().ar()},this.Ap=()=>{this.Vp||this.gp.Qt().ar()},this.gp=t,this.i_=e,this.ys=t.N().layout,this.pp=document.createElement("tr"),this.hm=document.createElement("td"),this.hm.style.padding="0",this.am=document.createElement("td"),this.am.style.padding="0",this.Ef=document.createElement("td"),this.Ef.style.height="25px",this.Ef.style.padding="0",this.lm=document.createElement("div"),this.lm.style.width="100%",this.lm.style.height="100%",this.lm.style.position="relative",this.lm.style.overflow="hidden",this.Ef.appendChild(this.lm),this.Np=Yi(this.lm,Y({width:16,height:16})),this.Np.subscribeSuggestedBitmapSizeChanged(this.Ip);const i=this.Np.canvasElement;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.Wp=Yi(this.lm,Y({width:16,height:16})),this.Wp.subscribeSuggestedBitmapSizeChanged(this.Ap);const s=this.Wp.canvasElement;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this.pp.appendChild(this.hm),this.pp.appendChild(this.Ef),this.pp.appendChild(this.am),this.om(),this.gp.Qt().yo().i(this.om.bind(this),this),this.Pf=new vh(this.Wp.canvasElement,this,{Xd:()=>!0,Zd:()=>!this.gp.N().handleScroll.horzTouchDrag})}m(){this.Pf.m(),this.im!==null&&this.im.m(),this.sm!==null&&this.sm.m(),this.Wp.unsubscribeSuggestedBitmapSizeChanged(this.Ap),Xi(this.Wp.canvasElement),this.Wp.dispose(),this.Np.unsubscribeSuggestedBitmapSizeChanged(this.Ip),Xi(this.Np.canvasElement),this.Np.dispose()}Of(){return this.pp}_m(){return this.im}um(){return this.sm}_f(t){if(this.nm)return;this.nm=!0;const e=this.gp.Qt();!e.At().Ki()&&this.gp.N().handleScale.axisPressedMouseMove.time&&e.oc(t.localX)}af(t){this._f(t)}uf(){const t=this.gp.Qt();!t.At().Ki()&&this.nm&&(this.nm=!1,this.gp.N().handleScale.axisPressedMouseMove.time&&t.mc())}Qd(t){const e=this.gp.Qt();!e.At().Ki()&&this.gp.N().handleScale.axisPressedMouseMove.time&&e.vc(t.localX)}Gd(t){this.Qd(t)}nf(){this.nm=!1;const t=this.gp.Qt();t.At().Ki()&&!this.gp.N().handleScale.axisPressedMouseMove.time||t.mc()}if(){this.nf()}Ld(){this.gp.N().handleScale.axisDoubleClickReset.time&&this.gp.Qt().cn()}Bd(){this.Ld()}$d(){this.gp.Qt().N().handleScale.axisPressedMouseMove.time&&this.ev(1)}Mf(){this.ev(0)}Nf(){return this.kp}dm(){return this.rm}fm(t,e,i){Bi(this.kp,t)||(this.kp=t,this.Vp=!0,this.Np.resizeCanvasElement(t),this.Wp.resizeCanvasElement(t),this.Vp=!1,this.Ef.style.width=`${t.width}px`,this.Ef.style.height=`${t.height}px`,this.rm.p(t)),this.im!==null&&this.im.Kp(Y({width:e,height:t.height})),this.sm!==null&&this.sm.Kp(Y({width:i,height:t.height}))}pm(){const t=this.vm();return Math.ceil(t.S+t.C+t.k+t.A+t.V+t.wm)}kt(){this.gp.Qt().At().Va()}Wf(){return this.Np.bitmapSize}Ff(t,e,i){const s=this.Wf();s.width>0&&s.height>0&&t.drawImage(this.Np.canvasElement,e,i)}Zp(t){if(t===0)return;const e={colorSpace:this.ys.colorSpace};if(t!==1){this.Np.applySuggestedBitmapSize();const s=$i(this.Np,e);s!==null&&(s.useBitmapCoordinateSpace(n=>{this.Jp(n),this.Qp(n),this.gm(s,Tb)}),this.iv(s),this.gm(s,Cb)),this.im!==null&&this.im.Zp(t),this.sm!==null&&this.sm.Zp(t)}this.Wp.applySuggestedBitmapSize();const i=$i(this.Wp,e);i!==null&&(i.useBitmapCoordinateSpace(({context:s,bitmapSize:n})=>{s.clearRect(0,0,n.width,n.height)}),this.Mm([...this.gp.Qt().js(),this.gp.Qt().sc()],i),this.gm(i,Mb))}gm(t,e){const i=this.gp.Qt().js();for(const s of i)$o(e,n=>Bo(n,t,!1,void 0),s,void 0);for(const s of i)$o(e,n=>Fr(n,t,!1,void 0),s,void 0)}Jp({context:t,bitmapSize:e}){dh(t,0,0,e.width,e.height,this.gp.Qt().Vc())}Qp({context:t,bitmapSize:e,verticalPixelRatio:i}){if(this.gp.N().timeScale.borderVisible){t.fillStyle=this.bm();const s=Math.max(1,Math.floor(this.vm().S*i));t.fillRect(0,0,e.width,s)}}iv(t){const e=this.gp.Qt().At(),i=e.Va();if(!i||i.length===0)return;const s=this.i_.maxTickMarkWeight(i),n=this.vm(),h=e.N();h.borderVisible&&h.ticksVisible&&t.useBitmapCoordinateSpace(({context:l,horizontalPixelRatio:c,verticalPixelRatio:u})=>{l.strokeStyle=this.bm(),l.fillStyle=this.bm();const d=Math.max(1,Math.floor(c)),p=Math.floor(.5*c);l.beginPath();const m=Math.round(n.C*u);for(let v=i.length;v--;){const _=Math.round(i[v].coord*c);l.rect(_-p,0,d,m)}l.fill()}),t.useMediaCoordinateSpace(({context:l})=>{const c=n.S+n.C+n.A+n.k/2;l.textAlign="center",l.textBaseline="middle",l.fillStyle=this.H(),l.font=this.Yp();for(const u of i)if(u.weight<s){const d=u.needAlignCoordinate?this.Sm(l,u.coord,u.label):u.coord;l.fillText(u.label,d,c)}this.gp.N().timeScale.allowBoldLabels&&(l.font=this.xm());for(const u of i)if(u.weight>=s){const d=u.needAlignCoordinate?this.Sm(l,u.coord,u.label):u.coord;l.fillText(u.label,d,c)}})}Sm(t,e,i){const s=this.Tp.Vi(t,i),n=s/2,h=Math.floor(e-n)+.5;return h<0?e+=Math.abs(0-h):h+s>this.kp.width&&(e-=Math.abs(this.kp.width-(h+s))),e}Mm(t,e){const i=this.vm();for(const s of t)for(const n of s.cs())n.Tt().nt(e,i)}bm(){return this.gp.N().timeScale.borderColor}H(){return this.ys.textColor}W(){return this.ys.fontSize}Yp(){return Rn(this.W(),this.ys.fontFamily)}xm(){return Rn(this.W(),this.ys.fontFamily,"bold")}vm(){this.M===null&&(this.M={S:1,L:NaN,A:NaN,V:NaN,Ji:NaN,C:5,k:NaN,P:"",Gi:new zn,wm:0});const t=this.M,e=this.Yp();if(t.P!==e){const i=this.W();t.k=i,t.P=e,t.A=3*i/12,t.V=3*i/12,t.Ji=9*i/12,t.L=0,t.wm=4*i/12,t.Gi.In()}return this.M}ev(t){this.Ef.style.cursor=t===1?"ew-resize":"default"}om(){const t=this.gp.Qt(),e=t.N();e.leftPriceScale.visible||this.im===null||(this.hm.removeChild(this.im.Of()),this.im.m(),this.im=null),e.rightPriceScale.visible||this.sm===null||(this.am.removeChild(this.sm.Of()),this.sm.m(),this.sm=null);const i={Sc:this.gp.Qt().Sc()},s=()=>e.leftPriceScale.borderVisible&&t.At().N().borderVisible,n=()=>t.Vc();e.leftPriceScale.visible&&this.im===null&&(this.im=new ml("left",e,i,s,n),this.hm.appendChild(this.im.Of())),e.rightPriceScale.visible&&this.sm===null&&(this.sm=new ml("right",e,i,s,n),this.am.appendChild(this.sm.Of()))}}var zl;const Sb=!!$s&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(r=>r.brand.includes("Chromium"))&&!!$s&&((zl=navigator==null?void 0:navigator.userAgentData)!=null&&zl.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);class Nb{constructor(t,e,i){var s;this.Cm=[],this.ym=[],this.km=0,this.tl=0,this.fo=0,this.Pm=0,this.Tm=0,this.Rm=null,this.Dm=!1,this.uv=new G,this.cv=new G,this.Wu=new G,this.Vm=null,this.Im=null,this.wp=t,this.ys=e,this.i_=i,this.pp=document.createElement("div"),this.pp.classList.add("tv-lightweight-charts"),this.pp.style.overflow="hidden",this.pp.style.direction="ltr",this.pp.style.width="100%",this.pp.style.height="100%",(s=this.pp).style.userSelect="none",s.style.webkitUserSelect="none",s.style.msUserSelect="none",s.style.MozUserSelect="none",s.style.webkitTapHighlightColor="transparent",this.Bm=document.createElement("table"),this.Bm.setAttribute("cellspacing","0"),this.pp.appendChild(this.Bm),this.Am=this.Em.bind(this),Dh(this.ys)&&this.zm(!0),this.ts=new db(this.Hu.bind(this),this.ys,i),this.Qt().nc().i(this.Lm.bind(this),this),this.Om=new xb(this,this.i_),this.Bm.appendChild(this.Om.Of());const n=e.autoSize&&this.Nm();let h=this.ys.width,l=this.ys.height;if(n||h===0||l===0){const c=t.getBoundingClientRect();h=h||c.width,l=l||c.height}this.Wm(h,l),this.Fm(),t.appendChild(this.pp),this.Hm(),this.ts.At().Cu().i(this.ts.Bh.bind(this.ts),this),this.ts.yo().i(this.ts.Bh.bind(this.ts),this)}Qt(){return this.ts}N(){return this.ys}If(){return this.Cm}Um(){return this.Om}m(){this.zm(!1),this.km!==0&&window.cancelAnimationFrame(this.km),this.ts.nc().u(this),this.ts.At().Cu().u(this),this.ts.yo().u(this),this.ts.m();for(const t of this.Cm)this.Bm.removeChild(t.Of()),t.Lv().u(this),t.Ov().u(this),t.m();this.Cm=[];for(const t of this.ym)this.$m(t);this.ym=[],E(this.Om).m(),this.pp.parentElement!==null&&this.pp.parentElement.removeChild(this.pp),this.Wu.m(),this.uv.m(),this.cv.m(),this.qm()}Wm(t,e,i=!1){if(this.tl===e&&this.fo===t)return;const s=function(l){const c=Math.floor(l.width),u=Math.floor(l.height);return Y({width:c-c%2,height:u-u%2})}(Y({width:t,height:e}));this.tl=s.height,this.fo=s.width;const n=this.tl+"px",h=this.fo+"px";E(this.pp).style.height=n,E(this.pp).style.width=h,this.Bm.style.height=n,this.Bm.style.width=h,i?this.Ym(lt.gn(),performance.now()):this.ts.Bh()}Zp(t){t===void 0&&(t=lt.gn());for(let e=0;e<this.Cm.length;e++)this.Cm[e].Zp(t.en(e).tn);this.ys.timeScale.visible&&this.Om.Zp(t.nn())}hr(t){var s;const e=Dh(this.ys);this.ts.hr(t);const i=Dh(this.ys);i!==e&&this.zm(i),(s=t.layout)!=null&&s.panes&&this.jm(),this.Hm(),this.Km(t)}Lv(){return this.uv}Ov(){return this.cv}nc(){return this.Wu}Xm(){this.Rm!==null&&(this.Ym(this.Rm,performance.now()),this.Rm=null);const t=this.Zm(null),e=document.createElement("canvas");e.width=t.width,e.height=t.height;const i=E(e.getContext("2d"));return this.Zm(i),e}Gm(t){return t==="left"&&!this.Jm()||t==="right"&&!this.Qm()||this.Cm.length===0?0:E(t==="left"?this.Cm[0].qv():this.Cm[0].Yv()).Xp()}tw(){return this.ys.autoSize&&this.Vm!==null}Uf(){return this.pp}iw(t){this.Im=t,this.Im?this.Uf().style.setProperty("cursor",t):this.Uf().style.removeProperty("cursor")}sw(){return this.Im}nw(t){return Mt(this.Cm[t]).Nf()}jm(){this.ym.forEach(t=>{t.kt()})}Km(t){(t.autoSize!==void 0||!this.Vm||t.width===void 0&&t.height===void 0)&&(t.autoSize&&!this.Vm&&this.Nm(),t.autoSize===!1&&this.Vm!==null&&this.qm(),t.autoSize||t.width===void 0&&t.height===void 0||this.Wm(t.width||this.fo,t.height||this.tl))}Zm(t){let e=0,i=0;const s=this.Cm[0],n=(l,c)=>{let u=0;for(let d=0;d<this.Cm.length;d++){const p=this.Cm[d],m=E(l==="left"?p.qv():p.Yv()),v=m.Wf();if(t!==null&&m.Ff(t,c,u),u+=v.height,d<this.Cm.length-1){const _=this.ym[d],C=_.Wf();t!==null&&_.Ff(t,c,u),u+=C.height}}};this.Jm()&&(n("left",0),e+=E(s.qv()).Wf().width);for(let l=0;l<this.Cm.length;l++){const c=this.Cm[l],u=c.Wf();if(t!==null&&c.Ff(t,e,i),i+=u.height,l<this.Cm.length-1){const d=this.ym[l],p=d.Wf();t!==null&&d.Ff(t,e,i),i+=p.height}}e+=s.Wf().width,this.Qm()&&(n("right",e),e+=E(s.Yv()).Wf().width);const h=(l,c,u)=>{E(l==="left"?this.Om._m():this.Om.um()).Ff(E(t),c,u)};if(this.ys.timeScale.visible){const l=this.Om.Wf();if(t!==null){let c=0;this.Jm()&&(h("left",c,i),c=E(s.qv()).Wf().width),this.Om.Ff(t,c,i),c+=l.width,this.Qm()&&h("right",c,i)}i+=l.height}return Y({width:e,height:i})}ew(){let t=0,e=0,i=0;for(const O of this.Cm)this.Jm()&&(e=Math.max(e,E(O.qv()).qp(),this.ys.leftPriceScale.minimumWidth)),this.Qm()&&(i=Math.max(i,E(O.Yv()).qp(),this.ys.rightPriceScale.minimumWidth)),t+=O.ko();e=Do(e),i=Do(i);const s=this.fo,n=this.tl,h=Math.max(s-e-i,0),l=1*this.ym.length,c=this.ys.timeScale.visible;let u=c?Math.max(this.Om.pm(),this.ys.timeScale.minimumHeight):0;var d;u=(d=u)+d%2;const p=l+u,m=n<p?0:n-p,v=m/t;let _=0;const C=window.devicePixelRatio||1;for(let O=0;O<this.Cm.length;++O){const k=this.Cm[O];k.yv(this.ts.$s()[O]);let P=0,U=0;U=O===this.Cm.length-1?Math.ceil((m-_)*C)/C:Math.round(k.ko()*v*C)/C,P=Math.max(U,2),_+=P,k.Kp(Y({width:h,height:P})),this.Jm()&&k.Wv(e,"left"),this.Qm()&&k.Wv(i,"right"),k.Xf()&&this.ts.ec(k.Xf(),P)}this.Om.fm(Y({width:c?h:0,height:u}),c?e:0,c?i:0),this.ts.To(h),this.Pm!==e&&(this.Pm=e),this.Tm!==i&&(this.Tm=i)}zm(t){t?this.pp.addEventListener("wheel",this.Am,{passive:!1}):this.pp.removeEventListener("wheel",this.Am)}rw(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return Sb?1/window.devicePixelRatio:1}Em(t){if(!(t.deltaX!==0&&this.ys.handleScroll.mouseWheel||t.deltaY!==0&&this.ys.handleScale.mouseWheel))return;const e=this.rw(t),i=e*t.deltaX/100,s=-e*t.deltaY/100;if(t.cancelable&&t.preventDefault(),s!==0&&this.ys.handleScale.mouseWheel){const n=Math.sign(s)*Math.min(1,Math.abs(s)),h=t.clientX-this.pp.getBoundingClientRect().left;this.Qt()._c(h,n)}i!==0&&this.ys.handleScroll.mouseWheel&&this.Qt().uc(-80*i)}Ym(t,e){var s;const i=t.nn();i===3&&this.hw(),i!==3&&i!==2||(this.aw(t),this.lw(t,e),this.Om.kt(),this.Cm.forEach(n=>{n.Pv()}),((s=this.Rm)==null?void 0:s.nn())===3&&(this.Rm.vn(t),this.hw(),this.aw(this.Rm),this.lw(this.Rm,e),t=this.Rm,this.Rm=null)),this.Zp(t)}lw(t,e){for(const i of t.pn())this.mn(i,e)}aw(t){const e=this.ts.$s();for(let i=0;i<e.length;i++)t.en(i).sn&&e[i].Uo()}mn(t,e){const i=this.ts.At();switch(t.an){case 0:i.ku();break;case 1:i.Pu(t.Ft);break;case 2:i.dn(t.Ft);break;case 3:i.fn(t.Ft);break;case 4:i.du();break;case 5:t.Ft.Mu(e)||i.fn(t.Ft.bu(e))}}Hu(t){this.Rm!==null?this.Rm.vn(t):this.Rm=t,this.Dm||(this.Dm=!0,this.km=window.requestAnimationFrame(e=>{if(this.Dm=!1,this.km=0,this.Rm!==null){const i=this.Rm;this.Rm=null,this.Ym(i,e);for(const s of i.pn())if(s.an===5&&!s.Ft.Mu(e)){this.Qt()._n(s.Ft);break}}}))}hw(){this.Fm()}$m(t){this.Bm.removeChild(t.Of()),t.m()}Fm(){const t=this.ts.$s(),e=t.length,i=this.Cm.length;for(let s=e;s<i;s++){const n=Mt(this.Cm.pop());this.Bm.removeChild(n.Of()),n.Lv().u(this),n.Ov().u(this),n.m();const h=this.ym.pop();h!==void 0&&this.$m(h)}for(let s=i;s<e;s++){const n=new wa(this,t[s]);if(n.Lv().i(this.ow.bind(this,n),this),n.Ov().i(this._w.bind(this,n),this),this.Cm.push(n),s>0){const h=new bb(this,s-1,s);this.ym.push(h),this.Bm.insertBefore(h.Of(),this.Om.Of())}this.Bm.insertBefore(n.Of(),this.Om.Of())}for(let s=0;s<e;s++){const n=t[s],h=this.Cm[s];h.Xf()!==n?h.yv(n):h.Cv()}this.Hm(),this.ew()}uw(t,e,i,s){var p;const n=new Map;t!==null&&this.ts.js().forEach(m=>{const v=m.Xs().Wr(t);v!==null&&n.set(m,v)});let h;if(t!==null){const m=(p=this.ts.At().ss(t))==null?void 0:p.originalTime;m!==void 0&&(h=m)}const l=this.Qt().Gu(),c=l!==null&&l.Xo instanceof gh?l.Xo:void 0,u=l!==null&&l.Zo!==void 0?l.Zo.Kn:void 0,d=this.cw(s);return{dw:h,Re:t??void 0,fw:e??void 0,pw:d!==-1?d:void 0,mw:c,ww:n,gw:u,Mw:i??void 0}}cw(t){let e=-1;if(t)e=this.Cm.indexOf(t);else{const i=this.Qt().sc().Us();i!==null&&(e=this.Qt().$s().indexOf(i))}return e}ow(t,e,i,s){this.uv.p(()=>this.uw(e,i,s,t))}_w(t,e,i,s){this.cv.p(()=>this.uw(e,i,s,t))}Lm(t,e,i){var s;this.iw(((s=this.Qt().Gu())==null?void 0:s.Jo)??null),this.Wu.p(()=>this.uw(t,e,i))}Hm(){const t=this.ys.timeScale.visible?"":"none";this.Om.Of().style.display=t}Jm(){return this.Cm[0].Xf().Bo().N().visible}Qm(){return this.Cm[0].Xf().Ao().N().visible}Nm(){return"ResizeObserver"in window&&(this.Vm=new ResizeObserver(t=>{const e=t[t.length-1];e&&this.Wm(e.contentRect.width,e.contentRect.height)}),this.Vm.observe(this.wp,{box:"border-box"}),!0)}qm(){this.Vm!==null&&this.Vm.disconnect(),this.Vm=null}}function Dh(r){return!!(r.handleScroll.mouseWheel||r.handleScale.mouseWheel)}function Ob(r){return r.open===void 0&&r.value===void 0}function Ib(r){return function(t){return t.open!==void 0}(r)||function(t){return t.value!==void 0}(r)}function gl(r,t,e,i){const s=e.value,n={Re:t,wt:r,Ft:[s,s,s,s],dw:i};return e.color!==void 0&&(n.R=e.color),n}function Ab(r,t,e,i){const s=e.value,n={Re:t,wt:r,Ft:[s,s,s,s],dw:i};return e.lineColor!==void 0&&(n.vt=e.lineColor),e.topColor!==void 0&&(n.mr=e.topColor),e.bottomColor!==void 0&&(n.wr=e.bottomColor),n}function kb(r,t,e,i){const s=e.value,n={Re:t,wt:r,Ft:[s,s,s,s],dw:i};return e.topLineColor!==void 0&&(n.gr=e.topLineColor),e.bottomLineColor!==void 0&&(n.Mr=e.bottomLineColor),e.topFillColor1!==void 0&&(n.br=e.topFillColor1),e.topFillColor2!==void 0&&(n.Sr=e.topFillColor2),e.bottomFillColor1!==void 0&&(n.Cr=e.bottomFillColor1),e.bottomFillColor2!==void 0&&(n.yr=e.bottomFillColor2),n}function Rb(r,t,e,i){const s={Re:t,wt:r,Ft:[e.open,e.high,e.low,e.close],dw:i};return e.color!==void 0&&(s.R=e.color),s}function zb(r,t,e,i){const s={Re:t,wt:r,Ft:[e.open,e.high,e.low,e.close],dw:i};return e.color!==void 0&&(s.R=e.color),e.borderColor!==void 0&&(s.Ht=e.borderColor),e.wickColor!==void 0&&(s.vr=e.wickColor),s}function Lb(r,t,e,i,s){const n=Mt(s)(e),h=Math.max(...n),l=Math.min(...n),c=n[n.length-1],u=[c,h,l,c],{time:d,color:p,...m}=e;return{Re:t,wt:r,Ft:u,dw:i,se:m,R:p}}function tn(r){return r.Ft!==void 0}function vl(r,t){return t.customValues!==void 0&&(r.bw=t.customValues),r}function oi(r){return(t,e,i,s,n,h)=>function(l,c){return c?c(l):Ob(l)}(i,h)?vl({wt:t,Re:e,dw:s},i):vl(r(t,e,i,s,n),i)}function bl(r){return{Candlestick:oi(zb),Bar:oi(Rb),Area:oi(Ab),Baseline:oi(kb),Histogram:oi(gl),Line:oi(gl),Custom:oi(Lb)}[r]}function wl(r){return{Re:0,Sw:new Map,Hh:r}}function _l(r,t){if(r!==void 0&&r.length!==0)return{xw:t.key(r[0].wt),Cw:t.key(r[r.length-1].wt)}}function yl(r){let t;return r.forEach(e=>{t===void 0&&(t=e.dw)}),Mt(t)}class Pb{constructor(t){this.yw=new Map,this.kw=new Map,this.Pw=new Map,this.Tw=[],this.i_=t}m(){this.yw.clear(),this.kw.clear(),this.Pw.clear(),this.Tw=[]}Rw(t,e){let i=this.yw.size!==0,s=!1;const n=this.kw.get(t);if(n!==void 0)if(this.kw.size===1)i=!1,s=!0,this.yw.clear();else for(const c of this.Tw)c.pointData.Sw.delete(t)&&(s=!0);let h=[];if(e.length!==0){const c=e.map(v=>v.time),u=this.i_.createConverterToInternalObj(e),d=bl(t.Rr()),p=t.da(),m=t.pa();h=e.map((v,_)=>{const C=u(v.time),O=this.i_.key(C);let k=this.yw.get(O);k===void 0&&(k=wl(C),this.yw.set(O,k),s=!0);const P=d(C,k.Re,v,c[_],p,m);return k.Sw.set(t,P),P})}i&&this.Dw(),this.Vw(t,h);let l=-1;if(s){const c=[];this.yw.forEach(u=>{c.push({timeWeight:0,time:u.Hh,pointData:u,originalTime:yl(u.Sw)})}),c.sort((u,d)=>this.i_.key(u.time)-this.i_.key(d.time)),l=this.Iw(c)}return this.Bw(t,l,function(c,u,d){const p=_l(c,d),m=_l(u,d);if(p!==void 0&&m!==void 0)return{Aw:!1,zh:p.Cw>=m.Cw&&p.xw>=m.xw}}(this.kw.get(t),n,this.i_))}yc(t){return this.Rw(t,[])}Ew(t,e,i){const s=e;(function(O){O.dw===void 0&&(O.dw=O.time)})(s),this.i_.preprocessData(e);const n=this.i_.createConverterToInternalObj([e])(e.time),h=this.Pw.get(t);if(!i&&h!==void 0&&this.i_.key(n)<this.i_.key(h))throw new Error(`Cannot update oldest data, last time=${h}, new time=${n}`);let l=this.yw.get(this.i_.key(n));if(i&&l===void 0)throw new Error("Cannot update non-existing data point when historicalUpdate is true");const c=l===void 0;l===void 0&&(l=wl(n),this.yw.set(this.i_.key(n),l));const u=bl(t.Rr()),d=t.da(),p=t.pa(),m=u(n,l.Re,e,s.dw,d,p);l.Sw.set(t,m),i?this.zw(t,m,l.Re):this.Lw(t,m);const v={zh:tn(m),Aw:i};if(!c)return this.Bw(t,-1,v);const _={timeWeight:0,time:l.Hh,pointData:l,originalTime:yl(l.Sw)},C=Bs(this.Tw,this.i_.key(_.time),(O,k)=>this.i_.key(O.time)<k);this.Tw.splice(C,0,_);for(let O=C;O<this.Tw.length;++O)Bh(this.Tw[O].pointData,O);return this.i_.fillWeightsForPoints(this.Tw,C),this.Bw(t,C,v)}Lw(t,e){let i=this.kw.get(t);i===void 0&&(i=[],this.kw.set(t,i));const s=i.length!==0?i[i.length-1]:null;s===null||this.i_.key(e.wt)>this.i_.key(s.wt)?tn(e)&&i.push(e):tn(e)?i[i.length-1]=e:i.splice(-1,1),this.Pw.set(t,e.wt)}zw(t,e,i){const s=this.kw.get(t);if(s===void 0)return;const n=Bs(s,i,(h,l)=>h.Re<l);tn(e)?s[n]=e:s.splice(n,1)}Vw(t,e){e.length!==0?(this.kw.set(t,e.filter(tn)),this.Pw.set(t,e[e.length-1].wt)):(this.kw.delete(t),this.Pw.delete(t))}Dw(){for(const t of this.Tw)t.pointData.Sw.size===0&&this.yw.delete(this.i_.key(t.time))}Iw(t){let e=-1;for(let i=0;i<this.Tw.length&&i<t.length;++i){const s=this.Tw[i],n=t[i];if(this.i_.key(s.time)!==this.i_.key(n.time)){e=i;break}n.timeWeight=s.timeWeight,Bh(n.pointData,i)}if(e===-1&&this.Tw.length!==t.length&&(e=Math.min(this.Tw.length,t.length)),e===-1)return-1;for(let i=e;i<t.length;++i)Bh(t[i].pointData,i);return this.i_.fillWeightsForPoints(t,e),this.Tw=t,e}Ow(){if(this.kw.size===0)return null;let t=0;return this.kw.forEach(e=>{e.length!==0&&(t=Math.max(t,e[e.length-1].Re))}),t}Bw(t,e,i){const s={Do:new Map,At:{iu:this.Ow()}};if(e!==-1)this.kw.forEach((n,h)=>{s.Do.set(h,{se:n,Nw:h===t?i:void 0})}),this.kw.has(t)||s.Do.set(t,{se:[],Nw:i}),s.At.Ww=this.Tw,s.At.Fw=e;else{const n=this.kw.get(t);s.Do.set(t,{se:n||[],Nw:i})}return s}}function Bh(r,t){r.Re=t,r.Sw.forEach(e=>{e.Re=t})}function Db(r,t){return r.wt<t}function Bb(r,t){return t<r.wt}function nf(r,t,e){const i=t.Uh(),s=t.bi(),n=Bs(r,i,Db),h=Gd(r,s,Bb);if(!e)return{from:n,to:h};let l=n,c=h;return n>0&&n<r.length&&r[n].wt>=i&&(l=n-1),h>0&&h<r.length&&r[h-1].wt<=s&&(c=h+1),{from:l,to:c}}class ya{constructor(t,e,i){this.Hw=!0,this.Uw=!0,this.$w=!0,this.qw=[],this.Yw=null,this.Jn=t,this.Qn=e,this.jw=i}kt(t){this.Hw=!0,t==="data"&&(this.Uw=!0),t==="options"&&(this.$w=!0)}Tt(){return this.Jn.Vt()?(this.Kw(),this.Yw===null?null:this.Xw):null}Zw(){this.qw=this.qw.map(t=>({...t,...this.Jn.Rh().Dr(t.wt)}))}Gw(){this.Yw=null}Kw(){this.Uw&&(this.Jw(),this.Uw=!1),this.$w&&(this.Zw(),this.$w=!1),this.Hw&&(this.Qw(),this.Hw=!1)}Qw(){const t=this.Jn.Wt(),e=this.Qn.At();if(this.Gw(),e.Ki()||t.Ki())return;const i=e.ye();if(i===null||this.Jn.Xs().zr()===0)return;const s=this.Jn.zt();s!==null&&(this.Yw=nf(this.qw,i,this.jw),this.tg(t,e,s.Ft),this.ig())}}class $b{constructor(t,e){this.sg=t,this.Yi=e}nt(t,e,i){this.sg.draw(t,this.Yi,e,i)}}class Vb extends ya{constructor(t,e,i){super(t,e,!1),this.sh=i,this.Xw=new $b(this.sh.renderer(),s=>{const n=t.zt();return n===null?null:t.Wt().Nt(s,n.Ft)})}fa(t){return this.sh.priceValueBuilder(t)}va(t){return this.sh.isWhitespace(t)}Jw(){const t=this.Jn.Rh();this.qw=this.Jn.Xs().Hr().map(e=>({wt:e.Re,_t:NaN,...t.Dr(e.Re),ng:e.se}))}tg(t,e){e.su(this.qw,kn(this.Yw))}ig(){this.sh.update({bars:this.qw.map(Fb),barSpacing:this.Qn.At().lu(),visibleRange:this.Yw},this.Jn.N())}}function Fb(r){return{x:r._t,time:r.wt,originalData:r.ng,barColor:r.cr}}const Yb={color:"#2196f3"},Xb=(r,t,e)=>{const i=Ge(e);return new Vb(r,t,i)};function Ea(r){const t={value:r.Ft[3],time:r.dw};return r.bw!==void 0&&(t.customValues=r.bw),t}function El(r){const t=Ea(r);return r.R!==void 0&&(t.color=r.R),t}function Hb(r){const t=Ea(r);return r.vt!==void 0&&(t.lineColor=r.vt),r.mr!==void 0&&(t.topColor=r.mr),r.wr!==void 0&&(t.bottomColor=r.wr),t}function Ub(r){const t=Ea(r);return r.gr!==void 0&&(t.topLineColor=r.gr),r.Mr!==void 0&&(t.bottomLineColor=r.Mr),r.br!==void 0&&(t.topFillColor1=r.br),r.Sr!==void 0&&(t.topFillColor2=r.Sr),r.Cr!==void 0&&(t.bottomFillColor1=r.Cr),r.yr!==void 0&&(t.bottomFillColor2=r.yr),t}function rf(r){const t={open:r.Ft[0],high:r.Ft[1],low:r.Ft[2],close:r.Ft[3],time:r.dw};return r.bw!==void 0&&(t.customValues=r.bw),t}function Wb(r){const t=rf(r);return r.R!==void 0&&(t.color=r.R),t}function qb(r){const t=rf(r),{R:e,Ht:i,vr:s}=r;return e!==void 0&&(t.color=e),i!==void 0&&(t.borderColor=i),s!==void 0&&(t.wickColor=s),t}function Vo(r){return{Area:Hb,Line:El,Baseline:Ub,Histogram:El,Bar:Wb,Candlestick:qb,Custom:jb}[r]}function jb(r){const t=r.dw;return{...r.se,time:t}}const Qb={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},Gb={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},Zb={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:Yd,panes:{enableResize:!0,separatorColor:"#E0E3EB",separatorHoverColor:"rgba(178, 181, 189, 0.2)"},attributionLogo:!0,colorSpace:"srgb",colorParsers:[]},$h={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0,ensureEdgeTickMarksVisible:!1},Kb={rightOffset:0,barSpacing:6,minBarSpacing:.5,maxBarSpacing:0,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0,ignoreWhitespaceIndices:!1};function Cl(){return{width:0,height:0,autoSize:!1,layout:Zb,crosshair:Qb,grid:Gb,overlayPriceScales:{...$h},leftPriceScale:{...$h,visible:!1},rightPriceScale:{...$h,visible:!0},timeScale:Kb,localization:{locale:$s?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class hf{constructor(t,e,i){this.Df=t,this.eg=e,this.rg=i??0}applyOptions(t){this.Df.Qt().Qu(this.eg,t,this.rg)}options(){return this.Yi().N()}width(){return ph(this.eg)?this.Df.Gm(this.eg):0}setVisibleRange(t){this.setAutoScale(!1),this.Yi().Nl(new gt(t.from,t.to))}getVisibleRange(){const t=this.Yi().Qe();return t===null?null:{from:t.$e(),to:t.qe()}}setAutoScale(t){this.applyOptions({autoScale:t})}Yi(){return E(this.Df.Qt().tc(this.eg,this.rg)).Wt}}class Jb{constructor(t,e,i,s){this.Df=t,this.yt=i,this.hg=e,this.ag=s}getHeight(){return this.yt.$t()}setHeight(t){const e=this.Df.Qt(),i=e.Bc(this.yt);e.hc(i,t)}paneIndex(){return this.Df.Qt().Bc(this.yt)}moveTo(t){const e=this.paneIndex();e!==t&&(ut(t>=0&&t<this.Df.If().length,"Invalid pane index"),this.Df.Qt().ac(e,t))}getSeries(){return this.yt.Do().map(t=>this.hg(t))??[]}getHTMLElement(){return this.Df.If()[this.paneIndex()].Of()}attachPrimitive(t){this.yt.ua(t),t.attached&&t.attached({chart:this.ag,requestUpdate:()=>this.yt.Qt().Bh()})}detachPrimitive(t){this.yt.ca(t)}priceScale(t){if(this.yt.Co(t)===null)throw new Error(`Cannot find price scale with id: ${t}`);return new hf(this.Df,t,this.paneIndex())}}const tw={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class Ml{constructor(t){this.ir=t}applyOptions(t){this.ir.hr(t)}options(){return this.ir.N()}lg(){return this.ir}}class ew{constructor(t,e,i,s,n,h){this.og=new G,this.Jn=t,this._g=e,this.ug=i,this.i_=n,this.ag=s,this.cg=h}m(){this.og.m()}priceFormatter(){return this.Jn.ra()}priceToCoordinate(t){const e=this.Jn.zt();return e===null?null:this.Jn.Wt().Nt(t,e.Ft)}coordinateToPrice(t){const e=this.Jn.zt();return e===null?null:this.Jn.Wt().Ts(t,e.Ft)}barsInLogicalRange(t){if(t===null)return null;const e=new hs(new rs(t.from,t.to)).w_(),i=this.Jn.Xs();if(i.Ki())return null;const s=i.Wr(e.Uh(),1),n=i.Wr(e.bi(),-1),h=E(i.Lr()),l=E(i.Ks());if(s!==null&&n!==null&&s.Re>n.Re)return{barsBefore:t.from-h,barsAfter:l-t.to};const c={barsBefore:s===null||s.Re===h?t.from-h:s.Re-h,barsAfter:n===null||n.Re===l?l-t.to:l-n.Re};return s!==null&&n!==null&&(c.from=s.dw,c.to=n.dw),c}setData(t){this.i_,this.Jn.Rr(),this._g.dg(this.Jn,t),this.fg("full")}update(t,e=!1){this.Jn.Rr(),this._g.pg(this.Jn,t,e),this.fg("update")}dataByIndex(t,e){const i=this.Jn.Xs().Wr(t,e);return i===null?null:Vo(this.seriesType())(i)}data(){const t=Vo(this.seriesType());return this.Jn.Xs().Hr().map(e=>t(e))}subscribeDataChanged(t){this.og.i(t)}unsubscribeDataChanged(t){this.og._(t)}applyOptions(t){this.Jn.hr(t)}options(){return we(this.Jn.N())}priceScale(){return this.ug.priceScale(this.Jn.Wt().wa(),this.getPane().paneIndex())}createPriceLine(t){const e=Ot(we(tw),t),i=this.Jn.Oh(e);return new Ml(i)}removePriceLine(t){this.Jn.Nh(t.lg())}priceLines(){return this.Jn.Wh().map(t=>new Ml(t))}seriesType(){return this.Jn.Rr()}attachPrimitive(t){this.Jn.ua(t),t.attached&&t.attached({chart:this.ag,series:this,requestUpdate:()=>this.Jn.Qt().Bh(),horzScaleBehavior:this.i_})}detachPrimitive(t){this.Jn.ca(t),t.detached&&t.detached(),this.Jn.Qt().Bh()}getPane(){const t=this.Jn,e=E(this.Jn.Qt().Hn(t));return this.cg(e)}moveToPane(t){this.Jn.Qt().Rc(this.Jn,t)}seriesOrder(){const t=this.Jn.Qt().Hn(this.Jn);return t===null?-1:t.Do().indexOf(this.Jn)}setSeriesOrder(t){const e=this.Jn.Qt().Hn(this.Jn);e!==null&&e.qo(this.Jn,t)}fg(t){this.og.v()&&this.og.p(t)}}class iw{constructor(t,e,i){this.vg=new G,this.T_=new G,this.rm=new G,this.ts=t,this.uh=t.At(),this.Om=e,this.uh.Su().i(this.mg.bind(this)),this.uh.xu().i(this.wg.bind(this)),this.Om.dm().i(this.gg.bind(this)),this.i_=i}m(){this.uh.Su().u(this),this.uh.xu().u(this),this.Om.dm().u(this),this.vg.m(),this.T_.m(),this.rm.m()}scrollPosition(){return this.uh._u()}scrollToPosition(t,e){e?this.uh.gu(t,1e3):this.ts.fn(t)}scrollToRealTime(){this.uh.wu()}getVisibleRange(){const t=this.uh.K_();return t===null?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){const e={from:this.i_.convertHorzItemToInternal(t.from),to:this.i_.convertHorzItemToInternal(t.to)},i=this.uh.J_(e);this.ts.Pc(i)}getVisibleLogicalRange(){const t=this.uh.j_();return t===null?null:{from:t.Uh(),to:t.bi()}}setVisibleLogicalRange(t){ut(t.from<=t.to,"The from index cannot be after the to index."),this.ts.Pc(t)}resetTimeScale(){this.ts.cn()}fitContent(){this.ts.ku()}logicalToCoordinate(t){const e=this.ts.At();return e.Ki()?null:e.qt(t)}coordinateToLogical(t){return this.uh.Ki()?null:this.uh.nu(t)}timeToIndex(t,e){const i=this.i_.convertHorzItemToInternal(t);return this.uh.U_(i,e)}timeToCoordinate(t){const e=this.timeToIndex(t,!1);return e===null?null:this.uh.qt(e)}coordinateToTime(t){const e=this.ts.At(),i=e.nu(t),s=e.ss(i);return s===null?null:s.originalTime}width(){return this.Om.Nf().width}height(){return this.Om.Nf().height}subscribeVisibleTimeRangeChange(t){this.vg.i(t)}unsubscribeVisibleTimeRangeChange(t){this.vg._(t)}subscribeVisibleLogicalRangeChange(t){this.T_.i(t)}unsubscribeVisibleLogicalRangeChange(t){this.T_._(t)}subscribeSizeChange(t){this.rm.i(t)}unsubscribeSizeChange(t){this.rm._(t)}applyOptions(t){this.uh.hr(t)}options(){return{...we(this.uh.N()),barSpacing:this.uh.lu()}}mg(){this.vg.v()&&this.vg.p(this.getVisibleRange())}wg(){this.T_.v()&&this.T_.p(this.getVisibleLogicalRange())}gg(t){this.rm.p(t.width,t.height)}}function sw(r){if(r===void 0||r.type==="custom")return;const t=r;t.minMove!==void 0&&t.precision===void 0&&(t.precision=function(e){if(e>=1)return 0;let i=0;for(;i<8;i++){const s=Math.round(e);if(Math.abs(s-e)<1e-8)return i;e*=10}return i}(t.minMove))}function Tl(r){return function(t){if(Sr(t.handleScale)){const i=t.handleScale;t.handleScale={axisDoubleClickReset:{time:i,price:i},axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(t.handleScale!==void 0){const{axisPressedMouseMove:i,axisDoubleClickReset:s}=t.handleScale;Sr(i)&&(t.handleScale.axisPressedMouseMove={time:i,price:i}),Sr(s)&&(t.handleScale.axisDoubleClickReset={time:s,price:s})}const e=t.handleScroll;Sr(e)&&(t.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e})}(r),r}class nw{constructor(t,e,i){this.Mg=new Map,this.bg=new Map,this.Sg=new G,this.xg=new G,this.Cg=new G,this.zu=new WeakMap,this.yg=new Pb(e);const s=i===void 0?we(Cl()):Ot(we(Cl()),Tl(i));this.kg=e,this.Df=new Nb(t,s,e),this.Df.Lv().i(h=>{this.Sg.v()&&this.Sg.p(this.Pg(h()))},this),this.Df.Ov().i(h=>{this.xg.v()&&this.xg.p(this.Pg(h()))},this),this.Df.nc().i(h=>{this.Cg.v()&&this.Cg.p(this.Pg(h()))},this);const n=this.Df.Qt();this.Tg=new iw(n,this.Df.Um(),this.kg)}remove(){this.Df.Lv().u(this),this.Df.Ov().u(this),this.Df.nc().u(this),this.Tg.m(),this.Df.m(),this.Mg.clear(),this.bg.clear(),this.Sg.m(),this.xg.m(),this.Cg.m(),this.yg.m()}resize(t,e,i){this.autoSizeActive()||this.Df.Wm(t,e,i)}addCustomSeries(t,e={},i=0){const s=(n=>({type:"Custom",isBuiltIn:!1,defaultOptions:{...Yb,...n.defaultOptions()},Rg:Xb,Dg:n}))(Ge(t));return this.Vg(s,e,i)}addSeries(t,e={},i=0){return this.Vg(t,e,i)}removeSeries(t){const e=Mt(this.Mg.get(t)),i=this.yg.yc(e);this.Df.Qt().yc(e),this.Ig(i),this.Mg.delete(t),this.bg.delete(e)}dg(t,e){this.Ig(this.yg.Rw(t,e))}pg(t,e,i){this.Ig(this.yg.Ew(t,e,i))}subscribeClick(t){this.Sg.i(t)}unsubscribeClick(t){this.Sg._(t)}subscribeCrosshairMove(t){this.Cg.i(t)}unsubscribeCrosshairMove(t){this.Cg._(t)}subscribeDblClick(t){this.xg.i(t)}unsubscribeDblClick(t){this.xg._(t)}priceScale(t,e=0){return new hf(this.Df,t,e)}timeScale(){return this.Tg}applyOptions(t){this.Df.hr(Tl(t))}options(){return this.Df.N()}takeScreenshot(){return this.Df.Xm()}removePane(t){this.Df.Qt().rc(t)}swapPanes(t,e){this.Df.Qt().ac(t,e)}autoSizeActive(){return this.Df.tw()}chartElement(){return this.Df.Uf()}panes(){return this.Df.Qt().$s().map(t=>this.Bg(t))}paneSize(t=0){const e=this.Df.nw(t);return{height:e.height,width:e.width}}setCrosshairPosition(t,e,i){const s=this.Mg.get(i);if(s===void 0)return;const n=this.Df.Qt().Hn(s);n!==null&&this.Df.Qt().gc(t,e,n)}clearCrosshairPosition(){this.Df.Qt().Mc(!0)}horzBehaviour(){return this.kg}Vg(t,e={},i=0){ut(t.Rg!==void 0),sw(e.priceFormat),t.type==="Candlestick"&&function(c){c.borderColor!==void 0&&(c.borderUpColor=c.borderColor,c.borderDownColor=c.borderColor),c.wickColor!==void 0&&(c.wickUpColor=c.wickColor,c.wickDownColor=c.wickColor)}(e);const s=Ot(we(Vd),we(t.defaultOptions),e),n=t.Rg,h=new gh(this.Df.Qt(),t.type,s,n,t.Dg);this.Df.Qt().xc(h,i);const l=new ew(h,this,this,this,this.kg,c=>this.Bg(c));return this.Mg.set(l,h),this.bg.set(h,l),l}Ig(t){const e=this.Df.Qt();e.bc(t.At.iu,t.At.Ww,t.At.Fw),t.Do.forEach((i,s)=>s.ht(i.se,i.Nw)),e.At().O_(),e.au()}Ag(t){return Mt(this.bg.get(t))}Pg(t){const e=new Map;t.ww.forEach((s,n)=>{const h=n.Rr(),l=Vo(h)(s);if(h!=="Custom")ut(Ib(l));else{const c=n.pa();ut(!c||c(l)===!1)}e.set(this.Ag(n),l)});const i=t.mw!==void 0&&this.bg.has(t.mw)?this.Ag(t.mw):void 0;return{time:t.dw,logical:t.Re,point:t.fw,paneIndex:t.pw,hoveredSeries:i,hoveredObjectId:t.gw,seriesData:e,sourceEvent:t.Mw}}Bg(t){let e=this.zu.get(t);return e||(e=new Jb(this.Df,i=>this.Ag(i),t,this),this.zu.set(t,e)),e}}function rw(r){if(Mr(r)){const t=document.getElementById(r);return ut(t!==null,`Cannot find element in DOM with id=${r}`),t}return r}function hw(r,t,e){const i=rw(r),s=new nw(i,t,e);return t.setOptions(s.options()),s}function of(r,t){return hw(r,new al,al.Xc(t))}class Ca extends ya{constructor(t,e){super(t,e,!0)}tg(t,e,i){e.su(this.qw,kn(this.Yw)),t.Hl(this.qw,i,kn(this.Yw))}Eg(t,e){return{wt:t,gt:e,_t:NaN,ut:NaN}}Jw(){const t=this.Jn.Rh();this.qw=this.Jn.Xs().Hr().map(e=>{const i=e.Ft[3];return this.zg(e.Re,i,t)})}}function af(r,t,e,i,s,n,h){if(t.length===0||i.from>=t.length||i.to<=0)return;const{context:l,horizontalPixelRatio:c,verticalPixelRatio:u}=r,d=t[i.from];let p=n(r,d),m=d;if(i.to-i.from<2){const v=s/2;l.beginPath();const _={_t:d._t-v,ut:d.ut},C={_t:d._t+v,ut:d.ut};l.moveTo(_._t*c,_.ut*u),l.lineTo(C._t*c,C.ut*u),h(r,p,_,C)}else{const v=(C,O)=>{h(r,p,m,O),l.beginPath(),p=C,m=O};let _=m;l.beginPath(),l.moveTo(d._t*c,d.ut*u);for(let C=i.from+1;C<i.to;++C){_=t[C];const O=n(r,_);switch(e){case 0:l.lineTo(_._t*c,_.ut*u);break;case 1:l.lineTo(_._t*c,t[C-1].ut*u),O!==p&&(v(O,_),l.lineTo(_._t*c,t[C-1].ut*u)),l.lineTo(_._t*c,_.ut*u);break;case 2:{const[k,P]=ow(t,C-1,C);l.bezierCurveTo(k._t*c,k.ut*u,P._t*c,P.ut*u,_._t*c,_.ut*u);break}}e!==1&&O!==p&&(v(O,_),l.moveTo(_._t*c,_.ut*u))}(m!==_||m===_&&e===1)&&h(r,p,m,_)}}const xl=6;function Vh(r,t){return{_t:r._t-t._t,ut:r.ut-t.ut}}function Sl(r,t){return{_t:r._t/t,ut:r.ut/t}}function ow(r,t,e){const i=Math.max(0,t-1),s=Math.min(r.length-1,e+1);var n,h;return[(n=r[t],h=Sl(Vh(r[e],r[i]),xl),{_t:n._t+h._t,ut:n.ut+h.ut}),Vh(r[e],Sl(Vh(r[s],r[t]),xl))]}function aw(r,t){const e=r.context;e.strokeStyle=t,e.stroke()}class lw extends Ee{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et(t){if(this.rt===null)return;const{ot:e,lt:i,Lg:s,Og:n,ct:h,Xt:l,Ng:c}=this.rt;if(i===null)return;const u=t.context;u.lineCap="butt",u.lineWidth=h*t.verticalPixelRatio,Vi(u,l),u.lineJoin="round";const d=this.Wg.bind(this);n!==void 0&&af(t,e,n,i,s,d,aw),c&&function(p,m,v,_,C){if(_.to-_.from<=0)return;const{horizontalPixelRatio:O,verticalPixelRatio:k,context:P}=p;let U=null;const W=Math.max(1,Math.floor(O))%2/2,xt=v*k+W;for(let zt=_.to-1;zt>=_.from;--zt){const kt=m[zt];if(kt){const ce=C(p,kt);ce!==U&&(P.beginPath(),U!==null&&P.fill(),P.fillStyle=ce,U=ce);const Ce=Math.round(kt._t*O)+W,Zs=kt.ut*k;P.moveTo(Ce,Zs),P.arc(Ce,Zs,xt,0,2*Math.PI)}}P.fill()}(t,e,c,i,d)}}class lf extends lw{Wg(t,e){return e.vt}}class cw extends Ca{constructor(){super(...arguments),this.Xw=new lf}zg(t,e,i){return{...this.Eg(t,e),...i.Dr(t)}}ig(){const t=this.Jn.N(),e={ot:this.qw,Xt:t.lineStyle,Og:t.lineVisible?t.lineType:void 0,ct:t.lineWidth,Ng:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0,lt:this.Yw,Lg:this.Qn.At().lu()};this.Xw.ht(e)}}const Fo={type:"Line",isBuiltIn:!0,defaultOptions:{color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Rg:(r,t)=>new cw(r,t)};function uw(r,t,e,i,s){const{context:n,horizontalPixelRatio:h,verticalPixelRatio:l}=t;n.lineTo(s._t*h,r*l),n.lineTo(i._t*h,r*l),n.closePath(),n.fillStyle=e,n.fill()}class dw extends Ee{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et(t){if(this.rt===null)return;const{ot:e,lt:i,Lg:s,ct:n,Xt:h,Og:l}=this.rt,c=this.rt.jg??(this.rt.Kg?0:t.mediaSize.height);if(i===null)return;const u=t.context;u.lineCap="butt",u.lineJoin="round",u.lineWidth=n,Vi(u,h),u.lineWidth=1,af(t,e,l,i,s,this.Xg.bind(this),uw.bind(null,c))}}class fw{Zg(t,e){const i=this.Gg,{Jg:s,Qg:n,tM:h,iM:l,jg:c,sM:u,nM:d}=e;if(this.eM===void 0||i===void 0||i.Jg!==s||i.Qg!==n||i.tM!==h||i.iM!==l||i.jg!==c||i.sM!==u||i.nM!==d){const{verticalPixelRatio:p}=t,m=c||u>0?p:1,v=u*m,_=d===t.bitmapSize.height?d:d*m,C=(c??0)*m,O=t.context.createLinearGradient(0,v,0,_);if(O.addColorStop(0,s),c!=null){const k=ns((C-v)/(_-v),0,1);O.addColorStop(k,n),O.addColorStop(k,h)}O.addColorStop(1,l),this.eM=O,this.Gg=e}return this.eM}}class pw extends dw{constructor(){super(...arguments),this.rM=new fw}Xg(t,e){var i;return this.rM.Zg(t,{Jg:e.mr,Qg:"",tM:"",iM:e.wr,sM:((i=this.rt)==null?void 0:i.sM)??0,nM:t.bitmapSize.height})}}class mw extends Ca{constructor(t,e){super(t,e),this.Xw=new Xd,this.oM=new pw,this._M=new lf,this.Xw.st([this.oM,this._M])}zg(t,e,i){return{...this.Eg(t,e),...i.Dr(t)}}ig(){const t=this.Jn.N();if(this.Yw===null||this.qw.length===0)return;let e;if(t.relativeGradient){e=this.qw[this.Yw.from].ut;for(let i=this.Yw.from;i<this.Yw.to;i++){const s=this.qw[i];s.ut<e&&(e=s.ut)}}this.oM.ht({Og:t.lineType,ot:this.qw,Xt:t.lineStyle,ct:t.lineWidth,jg:null,sM:e,Kg:t.invertFilledArea,lt:this.Yw,Lg:this.Qn.At().lu()}),this._M.ht({Og:t.lineVisible?t.lineType:void 0,ot:this.qw,Xt:t.lineStyle,ct:t.lineWidth,lt:this.Yw,Lg:this.Qn.At().lu(),Ng:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0})}}const gw={type:"Area",isBuiltIn:!0,defaultOptions:{topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,relativeGradient:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Rg:(r,t)=>new mw(r,t)};class vw extends ya{constructor(t,e){super(t,e,!1)}tg(t,e,i){e.su(this.qw,kn(this.Yw)),t.$l(this.qw,i,kn(this.Yw))}vM(t,e,i){return{wt:t,qh:e.Ft[0],Yh:e.Ft[1],jh:e.Ft[2],Kh:e.Ft[3],_t:NaN,ql:NaN,Yl:NaN,jl:NaN,Kl:NaN}}Jw(){const t=this.Jn.Rh();this.qw=this.Jn.Xs().Hr().map(e=>this.zg(e.Re,e,t))}}class bw extends Ee{constructor(){super(...arguments),this.Yt=null,this.uM=0}ht(t){this.Yt=t}et(t){if(this.Yt===null||this.Yt.Xs.length===0||this.Yt.lt===null)return;const{horizontalPixelRatio:e}=t;this.uM=function(n,h){if(n>=2.5&&n<=4)return Math.floor(3*h);const l=1-.2*Math.atan(Math.max(4,n)-4)/(.5*Math.PI),c=Math.floor(n*l*h),u=Math.floor(n*h),d=Math.min(c,u);return Math.max(Math.floor(h),d)}(this.Yt.lu,e),this.uM>=2&&Math.floor(e)%2!=this.uM%2&&this.uM--;const i=this.Yt.Xs;this.Yt.mM&&this.wM(t,i,this.Yt.lt),this.Yt.Mi&&this.Qp(t,i,this.Yt.lt);const s=this.gM(e);(!this.Yt.Mi||this.uM>2*s)&&this.MM(t,i,this.Yt.lt)}wM(t,e,i){if(this.Yt===null)return;const{context:s,horizontalPixelRatio:n,verticalPixelRatio:h}=t;let l="",c=Math.min(Math.floor(n),Math.floor(this.Yt.lu*n));c=Math.max(Math.floor(n),Math.min(c,this.uM));const u=Math.floor(.5*c);let d=null;for(let p=i.from;p<i.to;p++){const m=e[p];m.pr!==l&&(s.fillStyle=m.pr,l=m.pr);const v=Math.round(Math.min(m.ql,m.Kl)*h),_=Math.round(Math.max(m.ql,m.Kl)*h),C=Math.round(m.Yl*h),O=Math.round(m.jl*h);let k=Math.round(n*m._t)-u;const P=k+c-1;d!==null&&(k=Math.max(d+1,k),k=Math.min(k,P));const U=P-k+1;s.fillRect(k,C,U,v-C),s.fillRect(k,_+1,U,O-_),d=P}}gM(t){let e=Math.floor(1*t);this.uM<=2*e&&(e=Math.floor(.5*(this.uM-1)));const i=Math.max(Math.floor(t),e);return this.uM<=2*i?Math.max(Math.floor(t),Math.floor(1*t)):i}Qp(t,e,i){if(this.Yt===null)return;const{context:s,horizontalPixelRatio:n,verticalPixelRatio:h}=t;let l="";const c=this.gM(n);let u=null;for(let d=i.from;d<i.to;d++){const p=e[d];p.dr!==l&&(s.fillStyle=p.dr,l=p.dr);let m=Math.round(p._t*n)-Math.floor(.5*this.uM);const v=m+this.uM-1,_=Math.round(Math.min(p.ql,p.Kl)*h),C=Math.round(Math.max(p.ql,p.Kl)*h);if(u!==null&&(m=Math.max(u+1,m),m=Math.min(m,v)),this.Yt.lu*n>2*c)w1(s,m,_,v-m+1,C-_+1,c);else{const O=v-m+1;s.fillRect(m,_,O,C-_+1)}u=v}}MM(t,e,i){if(this.Yt===null)return;const{context:s,horizontalPixelRatio:n,verticalPixelRatio:h}=t;let l="";const c=this.gM(n);for(let u=i.from;u<i.to;u++){const d=e[u];let p=Math.round(Math.min(d.ql,d.Kl)*h),m=Math.round(Math.max(d.ql,d.Kl)*h),v=Math.round(d._t*n)-Math.floor(.5*this.uM),_=v+this.uM-1;if(d.cr!==l){const C=d.cr;s.fillStyle=C,l=C}this.Yt.Mi&&(v+=c,p+=c,_-=c,m-=c),p>m||s.fillRect(v,p,_-v+1,m-p+1)}}}class ww extends vw{constructor(){super(...arguments),this.Xw=new bw}zg(t,e,i){return{...this.vM(t,e,i),...i.Dr(t)}}ig(){const t=this.Jn.N();this.Xw.ht({Xs:this.qw,lu:this.Qn.At().lu(),mM:t.wickVisible,Mi:t.borderVisible,lt:this.Yw})}}const _w={type:"Candlestick",isBuiltIn:!0,defaultOptions:{upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Rg:(r,t)=>new ww(r,t)};class yw extends Ee{constructor(){super(...arguments),this.Yt=null,this.bM=[]}ht(t){this.Yt=t,this.bM=[]}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.Yt===null||this.Yt.ot.length===0||this.Yt.lt===null)return;this.bM.length||this.SM(e);const s=Math.max(1,Math.floor(i)),n=Math.round(this.Yt.xM*i)-Math.floor(s/2),h=n+s;for(let l=this.Yt.lt.from;l<this.Yt.lt.to;l++){const c=this.Yt.ot[l],u=this.bM[l-this.Yt.lt.from],d=Math.round(c.ut*i);let p,m;t.fillStyle=c.cr,d<=n?(p=d,m=h):(p=n,m=d-Math.floor(s/2)+s),t.fillRect(u.Uh,p,u.bi-u.Uh+1,m-p)}}SM(t){if(this.Yt===null||this.Yt.ot.length===0||this.Yt.lt===null)return void(this.bM=[]);const e=Math.ceil(this.Yt.lu*t)<=1?0:Math.max(1,Math.floor(t)),i=Math.round(this.Yt.lu*t)-e;this.bM=new Array(this.Yt.lt.to-this.Yt.lt.from);for(let n=this.Yt.lt.from;n<this.Yt.lt.to;n++){const h=this.Yt.ot[n],l=Math.round(h._t*t);let c,u;if(i%2){const d=(i-1)/2;c=l-d,u=l+d}else{const d=i/2;c=l-d,u=l+d-1}this.bM[n-this.Yt.lt.from]={Uh:c,bi:u,CM:l,ne:h._t*t,wt:h.wt}}for(let n=this.Yt.lt.from+1;n<this.Yt.lt.to;n++){const h=this.bM[n-this.Yt.lt.from],l=this.bM[n-this.Yt.lt.from-1];h.wt===l.wt+1&&h.Uh-l.bi!==e+1&&(l.CM>l.ne?l.bi=h.Uh-e-1:h.Uh=l.bi+e+1)}let s=Math.ceil(this.Yt.lu*t);for(let n=this.Yt.lt.from;n<this.Yt.lt.to;n++){const h=this.bM[n-this.Yt.lt.from];h.bi<h.Uh&&(h.bi=h.Uh);const l=h.bi-h.Uh+1;s=Math.min(l,s)}if(e>0&&s<4)for(let n=this.Yt.lt.from;n<this.Yt.lt.to;n++){const h=this.bM[n-this.Yt.lt.from];h.bi-h.Uh+1>s&&(h.CM>h.ne?h.bi-=1:h.Uh+=1)}}}class Ew extends Ca{constructor(){super(...arguments),this.Xw=new yw}zg(t,e,i){return{...this.Eg(t,e),...i.Dr(t)}}ig(){const t={ot:this.qw,lu:this.Qn.At().lu(),lt:this.Yw,xM:this.Jn.Wt().Nt(this.Jn.N().base,E(this.Jn.zt()).Ft)};this.Xw.ht(t)}}const Cw={type:"Histogram",isBuiltIn:!0,defaultOptions:{color:"#26a69a",base:0},Rg:(r,t)=>new Ew(r,t)};class Mw{constructor(t,e){this.Jn=t,this.ah=e,this.kM()}detach(){this.Jn.detachPrimitive(this.ah)}getSeries(){return this.Jn}applyOptions(t){this.ah&&this.ah.hr&&this.ah.hr(t)}kM(){this.Jn.attachPrimitive(this.ah)}}const Tw={zOrder:"normal"};function En(r,t){return va(Math.min(Math.max(r,12),30)*t)}function Vs(r,t){switch(r){case"arrowDown":case"arrowUp":return En(t,1);case"circle":return En(t,.8);case"square":return En(t,.7)}}function cf(r){return function(t){const e=Math.ceil(t);return e%2!=0?e-1:e}(En(r,1))}function uf(r){return Math.max(En(r,.1),3)}function Nl(r,t,e){return t?r:e?Math.ceil(r/2):0}function Ol(r,t,e,i){const s=(Vs("arrowUp",i)-1)/2*e.XM,n=(va(i/2)-1)/2*e.XM;t.beginPath(),r?(t.moveTo(e._t-s,e.ut),t.lineTo(e._t,e.ut-s),t.lineTo(e._t+s,e.ut),t.lineTo(e._t+n,e.ut),t.lineTo(e._t+n,e.ut+s),t.lineTo(e._t-n,e.ut+s),t.lineTo(e._t-n,e.ut)):(t.moveTo(e._t-s,e.ut),t.lineTo(e._t,e.ut+s),t.lineTo(e._t+s,e.ut),t.lineTo(e._t+n,e.ut),t.lineTo(e._t+n,e.ut-s),t.lineTo(e._t-n,e.ut-s),t.lineTo(e._t-n,e.ut)),t.fill()}function Il(r,t,e,i,s,n){const h=(Vs("arrowUp",i)-1)/2,l=(va(i/2)-1)/2;return s>=t-l-2&&s<=t+l+2&&n>=(r?e:e-h)-2&&n<=(r?e+h:e)+2?!0:(()=>{if(s<t-h-3||s>t+h+3||n<(r?e-h-3:e)||n>(r?e:e+h+3))return!1;const c=Math.abs(s-t);return Math.abs(n-e)+3>=c/2})()}class xw{constructor(){this.Yt=null,this.On=new zn,this.W=-1,this.F="",this.Rp="",this.ZM="normal"}ht(t){this.Yt=t}Nn(t,e,i){this.W===t&&this.F===e||(this.W=t,this.F=e,this.Rp=Rn(t,e),this.On.In()),this.ZM=i}jn(t,e){if(this.Yt===null||this.Yt.lt===null)return null;for(let i=this.Yt.lt.from;i<this.Yt.lt.to;i++){const s=this.Yt.ot[i];if(s&&Nw(s,t,e))return{zOrder:"normal",externalId:s.Kn??""}}return null}draw(t){this.ZM!=="aboveSeries"&&t.useBitmapCoordinateSpace(e=>{this.et(e)})}drawBackground(t){this.ZM==="aboveSeries"&&t.useBitmapCoordinateSpace(e=>{this.et(e)})}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.Yt!==null&&this.Yt.lt!==null){t.textBaseline="middle",t.font=this.Rp;for(let s=this.Yt.lt.from;s<this.Yt.lt.to;s++){const n=this.Yt.ot[s];n.ri!==void 0&&(n.ri.Qi=this.On.Vi(t,n.ri.GM),n.ri.$t=this.W,n.ri._t=n._t-n.ri.Qi/2),Sw(n,t,e,i)}}}}function Sw(r,t,e,i){t.fillStyle=r.R,r.ri!==void 0&&function(s,n,h,l,c,u){s.save(),s.scale(c,u),s.fillText(n,h,l),s.restore()}(t,r.ri.GM,r.ri._t,r.ri.ut,e,i),function(s,n,h){if(s.zr!==0){switch(s.JM){case"arrowDown":return void Ol(!1,n,h,s.zr);case"arrowUp":return void Ol(!0,n,h,s.zr);case"circle":return void function(l,c,u){const d=(Vs("circle",u)-1)/2;l.beginPath(),l.arc(c._t,c.ut,d*c.XM,0,2*Math.PI,!1),l.fill()}(n,h,s.zr);case"square":return void function(l,c,u){const d=Vs("square",u),p=(d-1)*c.XM/2,m=c._t-p,v=c.ut-p;l.fillRect(m,v,d*c.XM,d*c.XM)}(n,h,s.zr)}s.JM}}(r,t,function(s,n,h){const l=Math.max(1,Math.floor(n))%2/2;return{_t:Math.round(s._t*n)+l,ut:s.ut*h,XM:n}}(r,e,i))}function Nw(r,t,e){return!(r.ri===void 0||!function(i,s,n,h,l,c){const u=h/2;return l>=i&&l<=i+n&&c>=s-u&&c<=s+u}(r.ri._t,r.ri.ut,r.ri.Qi,r.ri.$t,t,e))||function(i,s,n){if(i.zr===0)return!1;switch(i.JM){case"arrowDown":return Il(!0,i._t,i.ut,i.zr,s,n);case"arrowUp":return Il(!1,i._t,i.ut,i.zr,s,n);case"circle":return function(h,l,c,u,d){const p=2+Vs("circle",c)/2,m=h-u,v=l-d;return Math.sqrt(m*m+v*v)<=p}(i._t,i.ut,i.zr,s,n);case"square":return function(h,l,c,u,d){const p=Vs("square",c),m=(p-1)/2,v=h-m,_=l-m;return u>=v&&u<=v+p&&d>=_&&d<=_+p}(i._t,i.ut,i.zr,s,n)}}(r,t,e)}function Al(r){return r==="atPriceTop"||r==="atPriceBottom"||r==="atPriceMiddle"}function Ow(r,t,e,i,s,n,h,l){const c=function(_,C){if(Al(C.position)&&C.price!==void 0)return C.price;if("value"in(O=_)&&typeof O.value=="number")return _.value;var O;if(function(k){return"open"in k&&"high"in k&&"low"in k&&"close"in k}(_)){if(C.position==="inBar")return _.close;if(C.position==="aboveBar")return _.high;if(C.position==="belowBar")return _.low}}(e,t);if(c===void 0)return;const u=Al(t.position),d=l.timeScale(),p=Fi(t.size)?Math.max(t.size,0):1,m=cf(d.options().barSpacing)*p,v=m/2;switch(r.zr=m,t.position){case"inBar":case"atPriceMiddle":return r.ut=E(h.priceToCoordinate(c)),void(r.ri!==void 0&&(r.ri.ut=r.ut+v+n+.6*s));case"aboveBar":case"atPriceTop":{const _=u?0:i.QM;return r.ut=E(h.priceToCoordinate(c))-v-_,r.ri!==void 0&&(r.ri.ut=r.ut-v-.6*s,i.QM+=1.2*s),void(u||(i.QM+=m+n))}case"belowBar":case"atPriceBottom":{const _=u?0:i.tb;return r.ut=E(h.priceToCoordinate(c))+v+_,r.ri!==void 0&&(r.ri.ut=r.ut+v+n+.6*s,i.tb+=1.2*s),void(u||(i.tb+=m+n))}}}class Iw{constructor(t,e,i){this.ib=[],this.xt=!0,this.sb=!0,this.Gt=new xw,this.ge=t,this.gp=e,this.Yt={ot:[],lt:null},this.ys=i}renderer(){if(!this.ge.options().visible)return null;this.xt&&this.nb();const t=this.gp.options().layout;return this.Gt.Nn(t.fontSize,t.fontFamily,this.ys.zOrder),this.Gt.ht(this.Yt),this.Gt}eb(t){this.ib=t,this.kt("data")}kt(t){this.xt=!0,t==="data"&&(this.sb=!0)}rb(t){this.xt=!0,this.ys=t}zOrder(){return this.ys.zOrder==="aboveSeries"?"top":this.ys.zOrder}nb(){const t=this.gp.timeScale(),e=this.ib;this.sb&&(this.Yt.ot=e.map(u=>({wt:u.time,_t:0,ut:0,zr:0,JM:u.shape,R:u.color,Kn:u.id,hb:u.hb,ri:void 0})),this.sb=!1);const i=this.gp.options().layout;this.Yt.lt=null;const s=t.getVisibleLogicalRange();if(s===null)return;const n=new rs(Math.floor(s.from),Math.ceil(s.to));if(this.ge.data()[0]===null||this.Yt.ot.length===0)return;let h=NaN;const l=uf(t.options().barSpacing),c={QM:l,tb:l};this.Yt.lt=nf(this.Yt.ot,n,!0);for(let u=this.Yt.lt.from;u<this.Yt.lt.to;u++){const d=e[u];d.time!==h&&(c.QM=l,c.tb=l,h=d.time);const p=this.Yt.ot[u];p._t=E(t.logicalToCoordinate(d.time)),d.text!==void 0&&d.text.length>0&&(p.ri={GM:d.text,_t:0,ut:0,Qi:0,$t:0});const m=this.ge.dataByIndex(d.time,0);m!==null&&Ow(p,d,m,c,i.fontSize,l,this.ge,this.gp)}this.xt=!1}}function kl(r){return{...Tw,...r}}class Aw{constructor(t){this.sh=null,this.ib=[],this.ab=[],this.lb=null,this.ge=null,this.gp=null,this.ob=!0,this._b=null,this.ub=null,this.cb=null,this.fb=!0,this.ys=kl(t)}attached(t){this.pb(),this.gp=t.chart,this.ge=t.series,this.sh=new Iw(this.ge,E(this.gp),this.ys),this.jM=t.requestUpdate,this.ge.subscribeDataChanged(e=>this.fg(e)),this.fb=!0,this.IM()}IM(){this.jM&&this.jM()}detached(){this.ge&&this.lb&&this.ge.unsubscribeDataChanged(this.lb),this.gp=null,this.ge=null,this.sh=null,this.lb=null}eb(t){this.fb=!0,this.ib=t,this.pb(),this.ob=!0,this.ub=null,this.IM()}mb(){return this.ib}paneViews(){return this.sh?[this.sh]:[]}updateAllViews(){this.wb()}hitTest(t,e){var i;return this.sh?((i=this.sh.renderer())==null?void 0:i.jn(t,e))??null:null}autoscaleInfo(t,e){if(this.sh){const i=this.gb();if(i)return{priceRange:null,margins:i}}return null}hr(t){this.ys=kl({...this.ys,...t}),this.IM&&this.IM()}gb(){const t=E(this.gp).timeScale().options().barSpacing;if(this.ob||t!==this.cb){if(this.cb=t,this.ib.length>0){const e=uf(t),i=1.5*cf(t)+2*e,s=this.Mb();this._b={above:Nl(i,s.aboveBar,s.inBar),below:Nl(i,s.belowBar,s.inBar)}}else this._b=null;this.ob=!1}return this._b}Mb(){return this.ub===null&&(this.ub=this.ib.reduce((t,e)=>(t[e.position]||(t[e.position]=!0),t),{inBar:!1,aboveBar:!1,belowBar:!1,atPriceTop:!1,atPriceBottom:!1,atPriceMiddle:!1})),this.ub}pb(){var s;if(!this.fb||!this.gp||!this.ge)return;const t=this.gp.timeScale(),e=(s=this.ge)==null?void 0:s.data();if(t.getVisibleLogicalRange()==null||!this.ge||e.length===0)return void(this.ab=[]);const i=t.timeToIndex(E(e[0].time),!0);this.ab=this.ib.map((n,h)=>{const l=t.timeToIndex(n.time,!0),c=l<i?1:-1,u=E(this.ge).dataByIndex(l,c),d={time:t.timeToIndex(E(u).time,!1),position:n.position,shape:n.shape,color:n.color,id:n.id,hb:h,text:n.text,size:n.size,price:n.price,dw:n.time};if(n.position==="atPriceTop"||n.position==="atPriceBottom"||n.position==="atPriceMiddle"){if(n.price===void 0)throw new Error(`Price is required for position ${n.position}`);return{...d,position:n.position,price:n.price}}return{...d,position:n.position,price:n.price}}),this.fb=!1}wb(t){this.sh&&(this.pb(),this.sh.eb(this.ab),this.sh.rb(this.ys),this.sh.kt(t))}fg(t){this.fb=!0,this.IM()}}class kw extends Mw{constructor(t,e,i){super(t,e),i&&this.setMarkers(i)}setMarkers(t){this.ah.eb(t)}markers(){return this.ah.mb()}}function Rw(r,t,e){const i=new kw(r,new Aw({}));return t&&i.setMarkers(t),i}({...Vd});const zw="_icon_4o1gt_29",Lw={"no-data":"_no-data_4o1gt_1",icon:zw},Pw=`<div class="no-data">\r
	<div class="icon">\r
		<svg\r
			height="800px"\r
			width="800px"\r
			version="1.1"\r
			id="Layer_1"\r
			xmlns="http://www.w3.org/2000/svg"\r
			xmlns:xlink="http://www.w3.org/1999/xlink"\r
			viewBox="0 0 512 512"\r
			xml:space="preserve"\r
		>\r
			<path\r
				style="fill: #57c3d9"\r
				d="M456.344,511.991c-5.152,0-10.141-2.391-13.359-6.679l-36.728-48.972l-36.728,48.972\r
	c-6.304,8.413-20.413,8.413-26.717,0l-36.728-48.972l-36.728,48.972c-6.304,8.413-20.413,8.413-26.717,0l-36.728-48.972\r
	l-36.728,48.972c-6.304,8.413-20.413,8.413-26.717,0l-36.728-48.972l-36.728,48.972c-4.315,5.755-11.815,8.114-18.641,5.82\r
	c-6.815-2.272-11.413-8.652-11.413-15.837V217.04C38.96,97.363,136.328,0,256,0s217.04,97.363,217.04,217.04v278.256\r
	c0,7.185-4.598,13.566-11.413,15.837C459.888,511.714,458.105,511.991,456.344,511.991z"\r
			/>\r
			<path\r
				style="fill: #3db1cc"\r
				d="M269.358,505.312l36.728-48.972l36.728,48.972c6.304,8.413,20.413,8.413,26.717,0l36.728-48.972\r
	l36.728,48.972c3.218,4.288,8.206,6.679,13.359,6.679c1.761,0,3.544-0.277,5.282-0.858c6.815-2.272,11.413-8.652,11.413-15.837\r
	V217.04C473.04,97.363,375.672,0,256,0v511.622C261.103,511.622,266.206,509.518,269.358,505.312z"\r
			/>\r
			<path\r
				style="fill: #edf0f2"\r
				d="M172.523,300.517c-36.826,0-66.781-29.956-66.781-66.781s29.956-66.781,66.781-66.781\r
	s66.781,29.956,66.781,66.781S209.349,300.517,172.523,300.517z"\r
			/>\r
			<path\r
				style="fill: #dae1e6"\r
				d="M339.477,300.517c-36.826,0-66.781-29.956-66.781-66.781s29.956-66.781,66.781-66.781\r
	s66.781,29.956,66.781,66.781S376.302,300.517,339.477,300.517z"\r
			/>\r
			<circle style="fill: #736056" cx="189.214" cy="250.43" r="16.695" />\r
			<circle style="fill: #665247" cx="356.168" cy="250.43" r="16.695" />\r
		</svg>\r
	</div>\r
	<p>No data available</p>\r
</div>\r
`;var Cs;class Ma extends I{constructor(){super(...arguments);f(this,Cs,null)}render(){return this.element=A.htmlToElement(Pw,[],Lw),g(this,Cs,M(this.element)),this.element}show(){o(this,Cs).css("display","flex")}hide(){o(this,Cs).css("display","none")}}Cs=new WeakMap,N(Ma,"COMPONENT_NAME","NoData");const Dw="_spinner_l25u5_1",Bw="_rotate_l25u5_1",$w="_background_l25u5_35",Vw="_path_l25u5_47",Fw={spinner:Dw,rotate:Bw,background:$w,path:Vw},Yw=`<div class="spinner">\r
	<svg viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">\r
		<circle\r
			class="background"\r
			cx="25"\r
			cy="25"\r
			r="20"\r
			fill="none"\r
			stroke-width="4"\r
		/>\r
		<circle\r
			class="path"\r
			cx="25"\r
			cy="25"\r
			r="20"\r
			fill="none"\r
			stroke="currentColor"\r
			stroke-width="4"\r
			stroke-linecap="round"\r
		/>\r
	</svg>\r
</div>\r
`;var Ms;class Ta extends I{constructor(){super(...arguments);f(this,Ms,null)}render(){return this.element=A.htmlToElement(Yw,[],Fw),g(this,Ms,M(this.element)),this.element}show(){o(this,Ms).css("display","flex")}hide(){o(this,Ms).css("display","none")}}Ms=new WeakMap,N(Ta,"COMPONENT_NAME","Spinner");function q(r){return getComputedStyle(document.documentElement).getPropertyValue(r).trim()||null}const Yo=()=>({autoSize:!0,layout:{background:{type:"solid",color:q("--color-bg-primary")||"#ffffff"},textColor:q("--color-text-primary")||"#292121",fontFamily:"system-ui, sans-serif",panes:{separatorColor:q("--color-border-secondary")||"#e0e3eb",separatorHoverColor:q("--color-chart-separator-hover")||"rgb(224 227 235 / 20%)"},attributionLogo:!1},rightPriceScale:{scaleMargins:{top:.1,bottom:.05},borderVisible:!1,entireTextOnly:!0},crosshair:{mode:0,vertLine:{color:q("--color-chart-crosshair-line")||"#a5a5a5",style:3,labelBackgroundColor:q("--color-chart-crosshair-label")||"#2e2e2e"},horzLine:{color:q("--color-chart-crosshair-line")||"#a5a5a5",style:3,labelBackgroundColor:q("--color-chart-crosshair-label")||"#2e2e2e"}},grid:{vertLines:{color:q("--color-chart-grid")||"#edf0ee"},horzLines:{color:q("--color-chart-grid")||"#edf0ee"}},timeScale:{rightOffset:10,barSpacing:6,minBarSpacing:2,borderVisible:!1,rightBarStaysOnScroll:!0,tickMarkFormatter:r=>{const t=new Date(r*1e3),e=t.getUTCDate(),i=t.getUTCMonth(),s=t.getUTCFullYear(),n=t.getUTCHours(),h=t.getUTCMinutes();if(i===0&&e===1&&n===0&&h===0)return String(s);if(e===1&&n===0&&h===0)return t.toLocaleString("en-US",{month:"short"});if(n===0&&h===0)return String(e);const l=String(n).padStart(2,"0"),c=String(h).padStart(2,"0");return`${l}:${c}`}},localization:{timeFormatter:r=>{const t=new Date(r*1e3),e=t.toLocaleString("en-US",{weekday:"short"}),i=String(t.getUTCDate()).padStart(2,"0"),s=t.toLocaleString("en-US",{month:"short"}),n=t.toLocaleString("ru-RU",{year:"2-digit"}),h=String(t.getUTCHours()).padStart(2,"0"),l=String(t.getUTCMinutes()).padStart(2,"0");return`${e} ${i} ${s} ${n}  ${h}:${l}`}}}),Xw=()=>({borderVisible:!1,upColor:q("--color-chart-up")||"#008984",downColor:q("--color-chart-down")||"#f23645",wickUpColor:q("--color-chart-up")||"#008984",wickDownColor:q("--color-chart-down")||"#f23645"}),Hw=()=>({lastValueVisible:!1,priceLineVisible:!1,color:q("--color-chart-line")||"#3b6cb7",lineWidth:2,crosshairMarkerVisible:!1}),zr=1e3,Rl=50,df=1e3,ff={lastValueVisible:!1,priceLineVisible:!1,lineWidth:3,crosshairMarkerVisible:!1};class Uw extends Qs{async getKlines(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/chart/klines/${t}`,method:"GET",errorMessage:"Failed to load candlestick data"})}async getIndicators(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/chart/indicators/${t}`,method:"GET",errorMessage:"Failed to load indicator data"})}async getDeals(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/chart/deals/${t}`,method:"GET",errorMessage:"Failed to load deal markers"})}}const Fh=new Uw,Ww={"chart-panel":"_chart-panel_1t7il_1","chart-canvas":"_chart-canvas_1t7il_25"},qw=`<div class="chart-panel" data-ref="chartPanel">\r
	<component-spinner></component-spinner>\r
	<component-no-data></component-no-data>\r
	<component-ruler-tool></component-ruler-tool>\r
	<component-scroll-button></component-scroll-button>\r
	<component-main-info-panel></component-main-info-panel>\r
	<div class="chart-canvas" data-ref="chartCanvas"></div>\r
</div>\r
`,jw="_primary_3cyuk_27",Qw="_secondary_3cyuk_35",Yh={"indicators-info-panel":"_indicators-info-panel_3cyuk_1",primary:jw,secondary:Qw},Gw=`<div class="indicators-info-panel"></div>\r
`;var Xe,Ts,Ws,mf,gf;class pf extends I{constructor(){super(...arguments);f(this,Ws);f(this,Xe,null);f(this,Ts,new Map)}render(e){return this.element=A.htmlToElement(Gw,[],Yh),g(this,Xe,M(this.element)),e?o(this,Xe).addClass(Yh.primary):o(this,Xe).addClass(Yh.secondary),this.element}update(e,i=!1,s=null){if(i){if(!s)throw new Error("Indicator keys must be provided when withRender is true");o(this,Ts).clear(),a(this,Ws,mf).call(this,s)}o(this,Ts).forEach((n,h)=>{const l=e[h];if(!l)return;let{value:c,color:u}=l;u==="transparent"&&(c="∅",u="inherit");const d=n.text(),p=n.css("color");d!==String(c)&&n.text(c),p!==u&&n.css("color",u)})}remove(){this.element.remove()}}Xe=new WeakMap,Ts=new WeakMap,Ws=new WeakSet,mf=function(e){const i=a(this,Ws,gf).call(this,e);o(this,Xe).html(i),o(this,Xe).findAll("[data-field]").forEach(s=>{const n=s.data("field");o(this,Ts).set(n,s)})},gf=function(e){return e.map(i=>`
					<div>
						<span>${i}</span>
						<span data-field="${i}"></span>
					</div>
				`).join("")},N(pf,"COMPONENT_NAME","IndicatorsInfoPanel");const Zw="_meta_13vbf_29",Kw="_candlestick_13vbf_37",Jw="_red_13vbf_47",t_="_green_13vbf_55",en={"main-info-panel":"_main-info-panel_13vbf_1",meta:Zw,candlestick:Kw,red:Jw,green:t_},e_=`<div class="main-info-panel">\r
	<div class="meta" data-ref="meta">\r
		<span data-field="symbol"></span> • <span data-field="interval"></span> •\r
		<span data-field="exchange"></span>\r
	</div>\r
	<div class="candlestick" data-ref="candlestick">\r
		<div>O <span data-field="open"></span></div>\r
		<div>H <span data-field="high"></span></div>\r
		<div>L <span data-field="low"></span></div>\r
		<div>C <span data-field="close"></span></div>\r
	</div>\r
</div>\r
`;var xs,sr,nr,ne,bf,wf,_f,yf;class vf extends I{constructor(){super(...arguments);f(this,ne);f(this,xs,null);f(this,sr,new Map);f(this,nr,new Map)}render(){return a(this,ne,bf).call(this),a(this,ne,wf).call(this),this.element}update(e,i=!1){e&&(i&&a(this,ne,_f).call(this),a(this,ne,yf).call(this,e))}}xs=new WeakMap,sr=new WeakMap,nr=new WeakMap,ne=new WeakSet,bf=function(){this.element=A.htmlToElement(e_,[],en),g(this,xs,M(this.element))},wf=function(){const e=o(this,xs).find('[data-ref="meta"]').findAll("[data-field]"),i=o(this,xs).find('[data-ref="candlestick"]').findAll("[data-field]");e.forEach(s=>{const n=s.data("field");o(this,sr).set(n,s)}),i.forEach(s=>{const n=s.data("field");o(this,nr).set(n,s)})},_f=function(){const e=b.get(w.EXECUTION_CONTEXT);o(this,sr).forEach((i,s)=>{i.text(e[s])})},yf=function(e){const i=e.close>=e.open,s=i?en.green:en.red,n=i?en.red:en.green;o(this,nr).forEach((h,l)=>{const c=h.text(),u=e[l];c!==String(u)&&h.text(u),h.hasClass(s)||h.addClass(s).removeClass(n)})},N(vf,"COMPONENT_NAME","MainInfoPanel");const i_="_info_156i3_25",s_="_arrow_156i3_95",n_={"ruler-tool":"_ruler-tool_156i3_1",info:i_,"price-diff":"_price-diff_156i3_59","line-x":"_line-x_156i3_71","line-y":"_line-y_156i3_73","arrow-right":"_arrow-right_156i3_95","arrow-left":"_arrow-left_156i3_111","arrow-up":"_arrow-up_156i3_157","arrow-down":"_arrow-down_156i3_173",arrow:s_},r_=`<div\r
	class="ruler-tool"\r
	data-ref="rulerTool"\r
	data-active="false"\r
	data-trend="up"\r
>\r
	<div class="info">\r
		<div class="price-diff">\r
			<span data-field="price-abs"></span>\r
			<span data-field="price-pct"></span>\r
			<span data-field="price-ticks"></span>\r
		</div>\r
		<span data-field="bar-distance"></span>\r
	</div>\r
	<div class="line-x" data-ref="lineX" data-direction="right">\r
		<div class="arrow arrow-right"></div>\r
		<div class="arrow arrow-left"></div>\r
	</div>\r
	<div class="line-y" data-ref="lineY" data-direction="up">\r
		<div class="arrow arrow-up"></div>\r
		<div class="arrow arrow-down"></div>\r
	</div>\r
</div>\r
`;var K,ve,Ci,Ss,Ns,ct,Os,rr,hr,L,vn,Cf,Mf,Tf,xf,Sf,Nf,Xo,Of,If,Af,kf,Ho,Uo,Wo,qo;class Ef extends I{constructor(){super(...arguments);f(this,L);f(this,K,null);f(this,ve,null);f(this,Ci,null);f(this,Ss,null);f(this,Ns,new Map);f(this,ct,{chartX:void 0,chartY:void 0,localX:void 0,localY:void 0});f(this,Os,!1);f(this,rr);f(this,hr)}render(){return a(this,L,Cf).call(this),a(this,L,Mf).call(this),this.element}update({logical:e,point:i,sourceEvent:s,candlestickSeries:n}){o(this,Os)&&(a(this,L,Af).call(this,{localX:s.localX,localY:s.localY}),a(this,L,kf).call(this,{chartX:e,chartY:n.coordinateToPrice(i.y)}))}initialize(){o(this,L,vn)||a(this,L,xf).call(this)}deactivate(){a(this,L,Sf).call(this),o(this,K).data("active","false"),g(this,Os,!1)}}K=new WeakMap,ve=new WeakMap,Ci=new WeakMap,Ss=new WeakMap,Ns=new WeakMap,ct=new WeakMap,Os=new WeakMap,rr=new WeakMap,hr=new WeakMap,L=new WeakSet,vn=function(){return o(this,K).is("data-active")},Cf=function(){this.element=A.htmlToElement(r_,[],n_),g(this,K,M(this.element)),g(this,ve,o(this,K).find('[data-ref="lineX"]')),g(this,Ci,o(this,K).find('[data-ref="lineY"]'))},Mf=function(){g(this,Ss,a(this,L,Nf).bind(this)),o(this,K).findAll("[data-field]").forEach(e=>{const i=e.data("field");o(this,Ns).set(i,e)}),b.subscribe(w.EXECUTION_CONTEXT,a(this,L,Xo).bind(this))},Tf=function(){o(this,L,vn)||(o(this,K).data("active","true"),g(this,Os,!0))},xf=function(){const e=b.get(w.CHART_API);e&&e.subscribeClick(o(this,Ss))},Sf=function(){const e=b.get(w.CHART_API);e&&e.unsubscribeClick(o(this,Ss))},Nf=function({logical:e,point:i,sourceEvent:s}){if(o(this,L,vn)){a(this,L,Xo).call(this);return}const n=b.get(w.CANDLE_SERIES);n&&a(this,L,Of).call(this,{logical:e,point:i,sourceEvent:s,candlestickSeries:n})},Xo=function(){o(this,L,vn)&&b.set(w.RULER_ACTIVE,!1)},Of=function({logical:e,point:i,sourceEvent:s,candlestickSeries:n}){const{minMove:h,precision:l}=b.get(w.EXECUTION_CONTEXT);g(this,rr,h),g(this,hr,l),g(this,ct,{chartX:e,chartY:n.coordinateToPrice(i.y),localX:s.localX,localY:s.localY}),a(this,L,If).call(this),a(this,L,Tf).call(this)},If=function(){const e={"price-abs":a(this,L,Ho).call(this,o(this,ct).chartY),"price-pct":a(this,L,Uo).call(this,o(this,ct).chartY),"price-ticks":a(this,L,Wo).call(this,o(this,ct).chartY),"bar-distance":a(this,L,qo).call(this,o(this,ct).chartX)};o(this,Ns).forEach((i,s)=>{i.text(e[s])}),o(this,K).data("trend","up"),o(this,ve).data("direction","right"),o(this,Ci).data("direction","up"),o(this,K).css("left",`${o(this,ct).localX}px`).css("top",`${o(this,ct).localY}px`).css("width","0px").css("height","0px")},Af=function({localX:e,localY:i}){const s=e-o(this,ct).localX,n=o(this,ct).localY-i;s>=0?(o(this,ve).data("direction")==="left"&&o(this,ve).data("direction","right"),o(this,K).css("width",`${s}px`)):(o(this,ve).data("direction")==="right"&&o(this,ve).data("direction","left"),o(this,K).css("left",`${e}px`).css("width",`${Math.abs(s)}px`)),n>=0?(o(this,K).data("trend")==="down"&&(o(this,K).data("trend","up"),o(this,Ci).data("direction","up")),o(this,K).css("top",`${i}px`).css("height",`${n}px`)):(o(this,K).data("trend")==="up"&&(o(this,K).data("trend","down"),o(this,Ci).data("direction","down")),o(this,K).css("height",`${Math.abs(n)}px`))},kf=function({chartX:e,chartY:i}){const s={"price-abs":a(this,L,Ho).call(this,i),"price-pct":a(this,L,Uo).call(this,i),"price-ticks":a(this,L,Wo).call(this,i),"bar-distance":a(this,L,qo).call(this,e)};o(this,Ns).forEach((n,h)=>{n.text(s[h])})},Ho=function(e){return(e-o(this,ct).chartY).toFixed(o(this,hr))},Uo=function(e){return`(${((e/o(this,ct).chartY-1)*100).toFixed(2)}%)`},Wo=function(e){return((e-o(this,ct).chartY)/o(this,rr)).toFixed(0)},qo=function(e){return`${(e-o(this,ct).chartX).toFixed(0)} bars`},N(Ef,"COMPONENT_NAME","RulerTool");const h_={"scroll-button":"_scroll-button_umc9l_1"},o_=`<button class="scroll-button">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 18 18"\r
		width="18"\r
		height="18"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M7.45 3.5 12.48 9l-5.03 5.49 1.1 1.01L14.52 9 8.55 2.49 7.45 3.5Z"\r
		></path>\r
		<path\r
			fill="currentColor"\r
			d="m3.93 5.99 2.58 3-2.58 3.02 1.14.98 3.42-4-3.42-3.98L3.93 6Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var or,ti,zf,Lf,Pf;class Rf extends I{constructor(){super(...arguments);f(this,ti);f(this,or,null)}render(){return a(this,ti,zf).call(this),a(this,ti,Lf).call(this),this.element}}or=new WeakMap,ti=new WeakSet,zf=function(){this.element=A.htmlToElement(o_,[],h_),g(this,or,M(this.element))},Lf=function(){o(this,or).on("click",a(this,ti,Pf).bind(this))},Pf=function(){const e=b.get(w.CHART_API);if(!e)return;const i=Yo().timeScale.rightOffset;e.timeScale().scrollToPosition(i,!1)},N(Rf,"COMPONENT_NAME","ScrollButton");var Mi,Ct,tt,F,Gt,Zt,Is,y,Df,Bf,$f,Vf,Ff,Yf,Xf,Qo,Hf,Uf,Go,Zo,Wf,qf,jf,Qf,Gf,Zf,Kf,Jf,tp,ep,Yr,ip,sp,np,Ko,Jo,rp,hp,op,ap,ue,lp,cp,up,dp,fp,pp,mp,gp,vp,Xr,bp,wp,_p,yp,Ep,Cp;const Sn=class Sn extends I{constructor(){super(...arguments);f(this,y);f(this,Mi,null);f(this,Ct,null);f(this,tt,{candlesticks:null,indicators:null,deals:null});f(this,F,{candlestick:null,indicators:new Map,deals:null});f(this,Gt,new Map);f(this,Zt,zr);f(this,Is)}set height(e){o(this,Mi).css("bottom",`${e}px`)}render(){return a(this,y,Df).call(this),a(this,y,Bf).call(this),a(this,y,$f).call(this),this.element}};Mi=new WeakMap,Ct=new WeakMap,tt=new WeakMap,F=new WeakMap,Gt=new WeakMap,Zt=new WeakMap,Is=new WeakMap,y=new WeakSet,Df=function(){this.spinner=new Ta,this.noData=new Ma,this.rulerTool=new Ef,this.ScrollButton=new Rf,this.mainInfoPanel=new vf},Bf=function(){this.element=A.htmlToElement(qw,[this.spinner,this.noData,this.rulerTool,this.ScrollButton,this.mainInfoPanel],Ww),g(this,Mi,M(this.element))},$f=function(){a(this,y,Vf).call(this),a(this,y,Ff).call(this),a(this,y,Yf).call(this),a(this,y,Xf).call(this)},Vf=function(){const e=o(this,Mi).find('[data-ref="chartCanvas"]').element,i=Yo();g(this,Ct,of(e,i))},Ff=function(){b.subscribe(w.EXECUTION_CONTEXT,a(this,y,Qo).bind(this)),b.subscribe(w.THEME,a(this,y,Hf).bind(this)),b.subscribe(w.SELECTED_TIME,a(this,y,Wf).bind(this)),o(this,Ct).subscribeCrosshairMove(a(this,y,qf).bind(this)),o(this,Ct).timeScale().subscribeVisibleLogicalRangeChange(a(this,y,Zf).bind(this))},Yf=function(){b.set(w.RULER_TOOL,this.rulerTool),b.set(w.CHART_API,o(this,Ct)),b.set(w.CANDLE_SERIES,null)},Xf=function(){const e=b.get(w.EXECUTION_CONTEXT);a(this,y,Qo).call(this,e)},Qo=async function(e){if(!e.id){a(this,y,Kf).call(this);return}await a(this,y,tp).call(this,e),o(this,Is)!==e.id&&(g(this,Is,e.id),a(this,y,Ko).call(this),a(this,y,Jo).call(this),a(this,y,ue).call(this)&&(a(this,y,lp).call(this),a(this,y,pp).call(this))),a(this,y,Jf).call(this)},Hf=function(){if(a(this,y,Uf).call(this),a(this,y,ue).call(this)){const e=b.get(w.EXECUTION_CONTEXT);a(this,y,Go).call(this,e),a(this,y,Zo).call(this,e)}},Uf=function(){const e=Yo();o(this,Ct).applyOptions(e)},Go=function(e){if(!o(this,F).candlestick||!e)return;const{precision:i,minMove:s}=e,n=Xw();o(this,F).candlestick.applyOptions({...n,priceFormat:{type:"price",precision:i,minMove:s}})},Zo=function(e){const i=Hw(),n=b.get(w.STRATEGIES)[e.strategy].indicatorOptions;o(this,F).indicators.forEach((h,l)=>{const c=n[l];c&&h.applyOptions({...i,...c})})},Wf=function(e){if(!e||!a(this,y,ue).call(this))return;const i=o(this,tt).candlesticks;let s=null;for(let l=0;l<i.length-1;l++){const c=i[l].time,u=i[l+1].time;if(e>=c&&e<u){s=l;break}}if(s===null)return;const n=i.length-s;n>o(this,Zt)&&(g(this,Zt,n+zr),a(this,y,Xr).call(this));const h=o(this,Ct).timeScale().timeToIndex(i[s].time);o(this,Ct).timeScale().setVisibleLogicalRange({from:h-Rl,to:h+Rl})},qf=function({logical:e,point:i,seriesData:s,sourceEvent:n,time:h}){if(!i||!h||!a(this,y,ue).call(this))return;const l=s.get(o(this,F).candlestick);a(this,y,jf).call(this,l),a(this,y,Qf).call(this,s),a(this,y,Gf).call(this,{logical:e,point:i,sourceEvent:n})},jf=function(e){e&&this.mainInfoPanel.update(e)},Qf=function(e){const i=Object.fromEntries([...o(this,F).indicators].map(([s,n])=>[s,e.get(n)]));o(this,Gt).forEach(s=>{s.update(i)})},Gf=function({logical:e,point:i,sourceEvent:s}){this.rulerTool.update({logical:e,point:i,sourceEvent:s,candlestickSeries:o(this,F).candlestick})},Zf=function(e){if(a(this,y,ue).call(this)){if(e===null){g(this,Zt,zr);return}o(this,Zt)>=o(this,tt).candlesticks.length||e.from<50&&(g(this,Zt,o(this,Zt)+zr),a(this,y,Xr).call(this))}},Kf=function(){g(this,Is,void 0),a(this,y,Yr).call(this),a(this,y,Ko).call(this),a(this,y,Jo).call(this),this.noData.show(),b.set(w.CANDLE_SERIES,null)},Jf=function(){a(this,y,ue).call(this)?(a(this,y,Xr).call(this),a(this,y,yp).call(this),this.noData.hide(),b.set(w.CANDLE_SERIES,o(this,F).candlestick)):(this.noData.show(),b.set(w.CANDLE_SERIES,null))},tp=async function(e){if(!e.id){a(this,y,Yr).call(this);return}try{await a(this,y,ep).call(this,Promise.all([a(this,y,ip).call(this,e.id),a(this,y,sp).call(this,e.id),a(this,y,np).call(this,e.id)]))}catch(i){console.error("Error loading chart data.",i),a(this,y,Yr).call(this)}},ep=async function(e){let i;try{return i=setTimeout(()=>{this.spinner.show()},df),await e}finally{clearTimeout(i),this.spinner.hide()}},Yr=function(){g(this,tt,{candlesticks:null,indicators:null,deals:null})},ip=async function(e){try{o(this,tt).candlesticks=await Fh.getKlines(e)}catch{o(this,tt).candlesticks=[]}},sp=async function(e){try{o(this,tt).indicators=await Fh.getIndicators(e)}catch{o(this,tt).indicators={}}},np=async function(e){try{o(this,tt).deals=await Fh.getDeals(e)}catch{o(this,tt).deals=[]}},Ko=function(){o(this,Gt).forEach(e=>{e.remove()}),o(this,Gt).clear()},Jo=function(){a(this,y,rp).call(this),a(this,y,hp).call(this),a(this,y,op).call(this),a(this,y,ap).call(this),Nt.removeAll()},rp=function(){const e=o(this,F).candlestick;e&&(o(this,Ct).removeSeries(e),o(this,F).candlestick=null)},hp=function(){o(this,F).indicators.forEach(e=>{o(this,Ct).removeSeries(e)}),o(this,F).indicators.clear()},op=function(){Nt.removeAll()},ap=function(){o(this,F).deals=null},ue=function(){return o(this,tt).candlesticks&&o(this,tt).candlesticks.length},lp=function(){const e=b.get(w.EXECUTION_CONTEXT);a(this,y,cp).call(this),a(this,y,up).call(this,e),a(this,y,dp).call(this),a(this,y,Go).call(this,e),a(this,y,Zo).call(this,e)},cp=function(){o(this,F).candlestick=o(this,Ct).addSeries(_w)},up=function(e){const s=b.get(w.STRATEGIES)[e.strategy].indicatorOptions;Object.entries(s).forEach(([n,h])=>{const l=Sn.INDICATOR_TYPES,c=h.type??"line",u=l[c]??l.line,d=Math.max(0,Math.min(3,h.pane??0)),p=o(this,Ct).addSeries(u,void 0,d);o(this,F).indicators.set(n,p)})},dp=function(){a(this,y,fp).call(this)},fp=function(){const e=Nt.get("trendlines");e.length&&e.forEach(i=>{Nt.renderSeries(Fo,ff,i)})},pp=function(){requestAnimationFrame(()=>{const e=b.get(w.EXECUTION_CONTEXT),s=b.get(w.STRATEGIES)[e.strategy].indicatorOptions;a(this,y,mp).call(this,s);const n=a(this,y,gp).call(this);a(this,y,vp).call(this,n)})},mp=function(e){Object.values(e).forEach(i=>{const s=i.pane??0;if(!o(this,Gt).has(s)){const n=new pf;o(this,Gt).set(s,n)}})},gp=function(){return o(this,Mi).findAll("table > tr").slice(0,-1).filter(e=>e.css("height")!=="1px").map(e=>e.find("td > div"))},vp=function(e){e.forEach((i,s)=>{const n=o(this,Gt).get(s);if(!n)return;const h=s===0,l=n.render(h);i.append(l)})},Xr=function(){!o(this,F).candlestick||!a(this,y,ue).call(this)||(a(this,y,bp).call(this),a(this,y,wp).call(this),a(this,y,_p).call(this))},bp=function(){o(this,F).candlestick.setData(o(this,tt).candlesticks.slice(-o(this,Zt)))},wp=function(){Object.values(o(this,tt).indicators).length&&o(this,F).indicators.forEach((e,i)=>{const s=o(this,tt).indicators[i];e.setData(s.slice(-o(this,Zt)))})},_p=function(){if(!o(this,tt).deals.length)return;const e=o(this,F).candlestick.data()[0].time,i=o(this,tt).deals.filter(s=>s.time>=e);o(this,F).deals?o(this,F).deals.setMarkers(i):o(this,F).deals=Rw(o(this,F).candlestick,i)},yp=function(){a(this,y,ue).call(this)&&(a(this,y,Ep).call(this),requestAnimationFrame(()=>{a(this,y,Cp).call(this)}))},Ep=function(){const e=o(this,F).candlestick.data().at(-1);e&&this.mainInfoPanel.update(e,!0)},Cp=function(){const e=b.get(w.EXECUTION_CONTEXT),s=b.get(w.STRATEGIES)[e.strategy].indicatorOptions,n=Object.fromEntries(Array.from(o(this,F).indicators,([h,l])=>{const c=l.data();return[h,c.length?c.at(-1):null]}));o(this,Gt).forEach((h,l)=>{const c=Object.entries(s).filter(([u,d])=>(d.pane??0)===l).map(([u])=>u);h.update(n,!0,c)})},N(Sn,"COMPONENT_NAME","ChartPanel"),N(Sn,"INDICATOR_TYPES",{line:Fo,histogram:Cw});let jo=Sn;const a_={"report-header":"_report-header_1eimu_1","tab-buttons":"_tab-buttons_1eimu_21","size-buttons":"_size-buttons_1eimu_23"},l_=`<div class="report-header">\r
	<div class="tab-buttons" data-ref="tabButtons"></div>\r
	<div class="size-buttons">\r
		<component-toggle-visibility-button></component-toggle-visibility-button>\r
		<component-toggle-expansion-button></component-toggle-expansion-button>\r
	</div>\r
</div>\r
`,c_={"report-tab-button":"_report-tab-button_1my8y_1"},u_=`<button class="report-tab-button" data-active="false"></button>\r
`;var Ti,ar;class es extends I{constructor({title:e}){super();f(this,Ti,null);f(this,ar);g(this,ar,e)}render(){return this.element=A.htmlToElement(u_,[],c_),g(this,Ti,M(this.element).text(o(this,ar))),this.element}setOnClick(e){o(this,Ti).click(e)}activate(){o(this,Ti).data("active","true")}deactivate(){o(this,Ti).data("active","false")}}Ti=new WeakMap,ar=new WeakMap,N(es,"COMPONENT_NAME","ReportTabButton");var As,ei,Tp,xp,Sp;class Mp extends I{constructor({toggleVisibilityButton:e,toggleExpansionButton:i}){super();f(this,ei);f(this,As,null);this.toggleVisibilityButton=e,this.toggleExpansionButton=i}get minHeight(){return parseInt(o(this,As).css("min-height"))}render(){return a(this,ei,Tp).call(this),a(this,ei,xp).call(this),this.element}connectButtons(e){Object.entries(this.buttons).forEach(([i,s])=>{s.setOnClick(()=>{a(this,ei,Sp).call(this,i),e==null||e(i)})})}}As=new WeakMap,ei=new WeakSet,Tp=function(){this.buttons={overviewMetrics:new es({title:"Overview"}),performanceMetrics:new es({title:"Performance"}),tradeMetrics:new es({title:"Trade Analytics"}),riskMetrics:new es({title:"Risk & Ratios"}),trades:new es({title:"Trade Log"})}},xp=function(){this.element=A.htmlToElement(l_,[this.toggleVisibilityButton,this.toggleExpansionButton],a_),g(this,As,M(this.element));const e=o(this,As).find('[data-ref="tabButtons"]');Object.values(this.buttons).forEach(i=>{e.append(i.render())}),this.buttons.overviewMetrics.activate()},Sp=function(e){for(const[i,s]of Object.entries(this.buttons))i===e?s.activate():s.deactivate()},N(Mp,"COMPONENT_NAME","ReportHeader");const d_={"toggle-expansion-button":"_toggle-expansion-button_1fmm1_1","icon-collapsed":"_icon-collapsed_1fmm1_11","icon-expanded":"_icon-expanded_1fmm1_19"},f_=`<button class="toggle-expansion-button" data-active="false">\r
	<div class="icon-collapsed">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 28 28"\r
			width="28"\r
			height="28"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M19.32 6H8.68A2.68 2.68 0 0 0 6 8.68V11h1V8.68C7 7.75 7.75 7 8.68 7h10.64c.93 0 1.68.75 1.68 1.68V11h1V8.68C22 7.2 20.8 6 19.32 6ZM7 19.32c0 .93.75 1.68 1.68 1.68h10.64c.93 0 1.68-.75 1.68-1.68V17h1v2.32C22 20.8 20.8 22 19.32 22H8.68A2.68 2.68 0 0 1 6 19.32V17h1v2.32Z"\r
			></path>\r
		</svg>\r
	</div>\r
	<div class="icon-expanded">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			viewBox="0 0 28 28"\r
			width="28"\r
			height="28"\r
		>\r
			<path\r
				fill="currentColor"\r
				d="M19.32 17H8.68A2.68 2.68 0 0 0 6 19.68V22h1v-2.32c0-.93.75-1.68 1.68-1.68h10.64c.93 0 1.68.75 1.68 1.68V22h1v-2.32C22 18.2 20.8 17 19.32 17ZM7 8.32C7 9.25 7.75 10 8.68 10h10.64c.93 0 1.68-.75 1.68-1.68V6h1v2.32C22 9.8 20.8 11 19.32 11H8.68A2.68 2.68 0 0 1 6 8.32V6h1v2.32Z"\r
			></path>\r
		</svg>\r
	</div>\r
</button>\r
`;var xi,ii,Op,Ip,Ap;class Np extends I{constructor({onClick:e}){super();f(this,ii);f(this,xi,null);this.onClick=e}get isActive(){return o(this,xi).is("data-active")}render(){return a(this,ii,Op).call(this),a(this,ii,Ip).call(this),this.element}toggleActiveState(){const e=String(!this.isActive);o(this,xi).data("active",e)}}xi=new WeakMap,ii=new WeakSet,Op=function(){this.element=A.htmlToElement(f_,[],d_),g(this,xi,M(this.element))},Ip=function(){o(this,xi).on("click",a(this,ii,Ap).bind(this))},Ap=function(){var e;this.toggleActiveState(),(e=this.onClick)==null||e.call(this)},N(Np,"COMPONENT_NAME","ToggleExpansionButton");const p_={"toggle-visibility-button":"_toggle-visibility-button_1pi6n_1","icon-visible":"_icon-visible_1pi6n_11","icon-hidden":"_icon-hidden_1pi6n_19"},m_=`<button class="toggle-visibility-button" data-active="false">\r
	<div class="icon-visible">\r
		<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
			<path fill="currentColor" d="M7 20h14v1H7z"></path>\r
		</svg>\r
	</div>\r
	<div class="icon-hidden">\r
		<svg xmlns="http://www.w3.org/2000/svg" width="19" height="12" fill="none">\r
			<path stroke="currentColor" d="M1 8l8.5-6.5L18 8"></path>\r
		</svg>\r
	</div>\r
</button>\r
`;var Si,si,Rp,zp,Lp;class kp extends I{constructor({onClick:e}){super();f(this,si);f(this,Si,null);this.onClick=e}get isActive(){return o(this,Si).is("data-active")}render(){return a(this,si,Rp).call(this),a(this,si,zp).call(this),this.element}toggleActiveState(){const e=String(!this.isActive);o(this,Si).data("active",e)}}Si=new WeakMap,si=new WeakSet,Rp=function(){this.element=A.htmlToElement(m_,[],p_),g(this,Si,M(this.element))},zp=function(){o(this,Si).on("click",a(this,si,Lp).bind(this))},Lp=function(){var e;this.toggleActiveState(),(e=this.onClick)==null||e.call(this)},N(kp,"COMPONENT_NAME","ToggleVisibilityButton");const g_="_handle_10bl0_27",v_={"report-panel":"_report-panel_10bl0_1",handle:g_},b_=`<div class="report-panel">\r
	<div class="handle" data-ref="handle"></div>\r
	<component-report-header></component-report-header>\r
	<component-report-content></component-report-content>\r
</div>\r
`,w_={"report-content":"_report-content_1plw8_1"},__=`<div class="report-content">\r
	<component-overview-metrics-tab></component-overview-metrics-tab>\r
	<component-performance-metrics-tab></component-performance-metrics-tab>\r
	<component-trade-metrics-tab></component-trade-metrics-tab>\r
	<component-risk-metrics-tab></component-risk-metrics-tab>\r
	<component-trades-tab></component-trades-tab>\r
</div>\r
`;class y_ extends Qs{async getOverviewMetrics(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/metrics/${t}/overview`,method:"GET",errorMessage:"Failed to load overview metrics"})}async getPerformanceMetrics(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/metrics/${t}/performance`,method:"GET",errorMessage:"Failed to load performance metrics"})}async getTradeMetrics(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/metrics/${t}/trades`,method:"GET",errorMessage:"Failed to load trade-related metrics"})}async getRiskMetrics(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/metrics/${t}/risk`,method:"GET",errorMessage:"Failed to load risk-related metrics"})}async getTrades(t){return this._validateRequired({contextId:t},"contextId is required"),this._executeRequest({path:`/report/trades/${t}`,method:"GET",errorMessage:"Failed to load report trades"})}}const Tr=new y_,E_={"overview-metrics-tab":"_overview-metrics-tab_16dhb_1"},C_=`<div class="overview-metrics-tab">\r
	<component-spinner></component-spinner>\r
	<component-no-data></component-no-data>\r
	<component-overview-metrics></component-overview-metrics>\r
	<component-equity-curve></component-equity-curve>\r
</div>\r
`,M_=()=>({autoSize:!0,layout:{background:{type:"solid",color:q("--color-bg-primary")||"#ffffff"},textColor:q("--color-text-primary")||"#292121",fontFamily:"system-ui, sans-serif",attributionLogo:!1},rightPriceScale:{scaleMargins:{top:.05,bottom:.05},borderVisible:!1,entireTextOnly:!0},crosshair:{vertLine:{color:q("--color-equity-curve-crosshair")||"#e8e8e8",style:0,labelVisible:!1},horzLine:{visible:!1,labelVisible:!1}},grid:{vertLines:{visible:!1},horzLines:{visible:!1}},timeScale:{maxBarSpacing:50,fixLeftEdge:!0,fixRightEdge:!0,lockVisibleTimeRangeOnResize:!0,borderVisible:!1,tickMarkFormatter:(r,t)=>{const e=new Date(r*1e3),i=String(e.getUTCFullYear()),s=e.toLocaleString("en-US",{month:"short"}),n=String(e.getUTCDate());if(t===0)return String(i);if(t===1)return s;if(t===2)return n}}}),T_=()=>({lastValueVisible:!1,priceLineVisible:!1,topColor:q("--color-equity-curve-area-top")||"#78CEFF",bottomColor:q("--color-equity-curve-area-bottom")||"#EBF5FB",lineColor:q("--color-equity-curve-line")||"#00A9FF",lineWidth:3,crosshairMarkerBorderColor:q("--color-equity-curve-marker")||"#ffffff",crosshairMarkerBorderWidth:3}),x_=100,S_={weekday:"short",month:"short",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"UTC"},N_=50,O_=20,I_={"equity-curve":"_equity-curve_vfuql_1"},A_=`<div class="equity-curve">\r
	<component-equity-tooltip></component-equity-tooltip>\r
</div>\r
`,k_={"equity-tooltip":"_equity-tooltip_nst2y_1","text-white":"_text-white_nst2y_41"},R_=`<div class="equity-tooltip" data-active="false">\r
	<div>Trade #<span data-field="deal"></span></div>\r
	<div class="text-white">\r
		Current Equity: <span data-field="equity"></span>\r
	</div>\r
	<div><span data-field="time"></span></div>\r
	<div>Click to show on chart</div>\r
</div>\r
`;var Kt,lr,ks,ie,Dp,Bp,Hr;class Pp extends I{constructor(){super(...arguments);f(this,ie);f(this,Kt,null);f(this,lr,new Map);f(this,ks,!1)}get width(){return parseInt(o(this,Kt).css("width"))}get height(){return parseInt(o(this,Kt).css("height"))}get offsetX(){return O_}get isActive(){return o(this,ks)}render(){return a(this,ie,Dp).call(this),a(this,ie,Bp).call(this),this.element}updateContent({deal:e,equity:i,timestamp:s}){const h=new Date(s*1e3).toLocaleString("en-US",S_);a(this,ie,Hr).call(this,"deal",`${e}`),a(this,ie,Hr).call(this,"equity",`${i} USDT`),a(this,ie,Hr).call(this,"time",h)}updatePosition({left:e,bottom:i}){o(this,Kt).css("left",`${e}px`).css("bottom",`${i}px`)}activate(){o(this,Kt).data("active","true"),g(this,ks,!0)}deactivate(){o(this,Kt).data("active","false"),g(this,ks,!1)}}Kt=new WeakMap,lr=new WeakMap,ks=new WeakMap,ie=new WeakSet,Dp=function(){this.element=A.htmlToElement(R_,[],k_),g(this,Kt,M(this.element))},Bp=function(){["deal","equity","time"].forEach(e=>{const i=o(this,Kt).find(`[data-field="${e}"]`);o(this,lr).set(e,i)})},Hr=function(e,i){o(this,lr).get(e).text(i)},N(Pp,"COMPONENT_NAME","EquityTooltip");var Rs,Jt,He,Ni,cr,B,Vp,Fp,Yp,Xp,Hp,ta,ea,Up,Wp,qp,jp,Qp,Gp,Zp;class $p extends I{constructor(){super(...arguments);f(this,B);f(this,Rs,null);f(this,Jt,null);f(this,He,null);f(this,Ni,null);f(this,cr,!1)}render(){return a(this,B,Vp).call(this),a(this,B,Fp).call(this),a(this,B,Yp).call(this),this.element}update(e){o(this,He).setData(e),o(this,Jt).timeScale().fitContent()}show(){o(this,Rs).css("display","block")}hide(){o(this,Rs).css("display","none")}}Rs=new WeakMap,Jt=new WeakMap,He=new WeakMap,Ni=new WeakMap,cr=new WeakMap,B=new WeakSet,Vp=function(){this.equityTooltip=new Pp},Fp=function(){this.element=A.htmlToElement(A_,[this.equityTooltip],I_),g(this,Rs,M(this.element))},Yp=function(){a(this,B,Xp).call(this),a(this,B,Up).call(this)},Xp=function(){g(this,Jt,of(this.element)),g(this,He,o(this,Jt).addSeries(gw)),a(this,B,ta).call(this),a(this,B,ea).call(this)},Hp=function(){a(this,B,ta).call(this),a(this,B,ea).call(this)},ta=function(){const e=M_();o(this,Jt).applyOptions(e)},ea=function(){const e=T_();o(this,He).applyOptions(e)},Up=function(){o(this,Jt).subscribeClick(a(this,B,Wp).bind(this)),o(this,Jt).subscribeCrosshairMove(a(this,B,qp).bind(this)),o(this,Jt).timeScale().subscribeVisibleLogicalRangeChange(a(this,B,Gp).bind(this)),b.subscribe(w.THEME,a(this,B,Hp).bind(this))},Wp=function({time:e}){b.set(w.SELECTED_TIME,e)},qp=function(e){const{point:i,time:s,sourceEvent:n}=e;if(!i||!s||i.x<0||i.y<0){this.equityTooltip.deactivate();return}this.equityTooltip.isActive||(g(this,Ni,a(this,B,Zp).call(this)),this.equityTooltip.activate()),a(this,B,jp).call(this,e),n&&a(this,B,Qp).call(this,n)},jp=function(e){const{logical:i,seriesData:s}=e,n=s.get(o(this,He));n&&this.equityTooltip.updateContent({deal:i+1,equity:n.value,timestamp:n.time})},Qp=function(e){const{clientX:i,clientY:s}=e,{width:n,height:h,offsetX:l}=this.equityTooltip,c=o(this,Ni).height-s-h/2;let u=i-o(this,Ni).left-n-l;u<N_&&(u=i-o(this,Ni).left+l),this.equityTooltip.updatePosition({left:u,bottom:c})},Gp=function(e){const i=e.to-e.from<=x_;i!==o(this,cr)&&(g(this,cr,i),o(this,He).applyOptions({pointMarkersVisible:i}))},Zp=function(){return{left:this.element.getBoundingClientRect().left,height:window.innerHeight}},N($p,"COMPONENT_NAME","EquityCurve");const z_="_cell_96plr_15",L_="_title_96plr_25",P_="_values_96plr_33",D_="_red_96plr_43",B_="_green_96plr_51",sn={"overview-metrics":"_overview-metrics_96plr_1",cell:z_,title:L_,values:P_,red:D_,green:B_},$_=`<div class="overview-metrics">\r
	<div class="cell">\r
		<div class="title">Total P&L</div>\r
		<div class="values">\r
			<span data-field="0"></span>\r
			<span data-field="1"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Profit Factor</div>\r
		<div class="values">\r
			<span data-field="2"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Max Drawdown</div>\r
		<div class="values">\r
			<span data-field="3"></span>\r
			<span data-field="4"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Average per Trade</div>\r
		<div class="values">\r
			<span data-field="5"></span>\r
			<span data-field="6"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Winning Trades</div>\r
		<div class="values">\r
			<span data-field="7"></span>\r
		</div>\r
	</div>\r
	<div class="cell">\r
		<div class="title">Total Trades</div>\r
		<div class="values">\r
			<span data-field="8"></span>\r
		</div>\r
	</div>\r
</div>\r
`;var Kr,ur,dr,re,Kp,Jp,tm,em;const Nn=class Nn extends I{constructor(){super(...arguments);f(this,re);f(this,ur,null);f(this,dr,new Map)}render(){return a(this,re,Kp).call(this),a(this,re,Jp).call(this),this.element}update(e){o(this,dr).forEach(({element:i,isProfitField:s},n)=>{const h=e[n];i.text(h),s&&a(this,re,em).call(this,i,h)})}};Kr=new WeakMap,ur=new WeakMap,dr=new WeakMap,re=new WeakSet,Kp=function(){this.element=A.htmlToElement($_,[],sn),g(this,ur,M(this.element))},Jp=function(){o(this,ur).findAll("[data-field]").forEach(e=>{const i=Number(e.data("field")),s=a(this,re,tm).call(this,i);o(this,dr).set(i,{element:e,isProfitField:s})})},tm=function(e){return o(Nn,Kr).includes(e)},em=function(e,i){i.startsWith("-")?e.removeClass(sn.green).addClass(sn.red):e.removeClass(sn.red).addClass(sn.green)},N(Nn,"COMPONENT_NAME","OverviewMetrics"),f(Nn,Kr,[0,1,5,6]);let ia=Nn;var zs,It,sm,nm,rm,sa,hm;class im extends I{constructor(){super(...arguments);f(this,It);f(this,zs,null)}render(){return a(this,It,sm).call(this),a(this,It,nm).call(this),a(this,It,rm).call(this),this.element}show(){o(this,zs).css("display","flex")}hide(){o(this,zs).css("display","none")}}zs=new WeakMap,It=new WeakSet,sm=function(){this.spinner=new Ta,this.noData=new Ma,this.overviewMetrics=new ia,this.equityCurve=new $p},nm=function(){this.element=A.htmlToElement(C_,[this.spinner,this.noData,this.overviewMetrics,this.equityCurve],E_),g(this,zs,M(this.element))},rm=function(){b.subscribe(w.EXECUTION_CONTEXT,a(this,It,sa).bind(this)),a(this,It,sa).call(this,b.get(w.EXECUTION_CONTEXT))},sa=async function(e){try{let i={primary:[],equity:[]};if(e.id)try{i=await a(this,It,hm).call(this,Tr.getOverviewMetrics(e.id))}catch{i={primary:[],equity:[]}}i.equity.length?(this.overviewMetrics.update(i.primary),this.equityCurve.update(i.equity),this.noData.hide()):this.noData.show()}catch(i){console.error("Failed to update overview.",i)}},hm=async function(e){let i;try{return i=setTimeout(()=>{this.spinner.show()},df),await e}finally{clearTimeout(i),this.spinner.hide()}},N(im,"COMPONENT_NAME","OverviewMetricsTab");const V_="_cell_1pfav_23",F_={"metrics-item":"_metrics-item_1pfav_1",cell:V_,"align-end":"_align-end_1pfav_35","text-sm":"_text-sm_1pfav_43"},Y_=`<div class="metrics-item">\r
	<div class="cell">\r
		<span data-field="title.0"></span>\r
	</div>\r
	<div class="cell align-end">\r
		<span data-field="all.0"></span>\r
		<span data-field="all.1" class="text-sm"></span>\r
	</div>\r
	<div class="cell align-end">\r
		<span data-field="long.0"></span>\r
		<span data-field="long.1" class="text-sm"></span>\r
	</div>\r
	<div class="cell align-end">\r
		<span data-field="short.0"></span>\r
		<span data-field="short.1" class="text-sm"></span>\r
	</div>\r
	<div class="cell align-end"></div>\r
</div>\r
`;var fr,pr,qs,om,am;class bh extends I{constructor(){super(...arguments);f(this,qs);f(this,fr,null);f(this,pr,new Map)}render(){return a(this,qs,om).call(this),a(this,qs,am).call(this),this.element}update(e){o(this,pr).forEach(({element:i,group:s,index:n})=>{i.text(e[s][n])})}}fr=new WeakMap,pr=new WeakMap,qs=new WeakSet,om=function(){this.element=A.htmlToElement(Y_,[],F_),g(this,fr,M(this.element))},am=function(){o(this,fr).findAll("[data-field]").forEach(e=>{const i=e.data("field"),[s,n]=i.split(".");o(this,pr).set(i,{element:e,group:s,index:Number(n)})})},N(bh,"COMPONENT_NAME","MetricsItem");const X_="_table_m7c19_11",H_="_header_m7c19_27",U_="_row_m7c19_39",W_="_cell_m7c19_49",q_="_items_m7c19_79",j_={"performance-metrics-tab":"_performance-metrics-tab_m7c19_1",table:X_,header:H_,row:U_,cell:W_,"align-end":"_align-end_m7c19_63",items:q_},Q_=`<div class="performance-metrics-tab">\r
	<div class="table">\r
		<div class="header">\r
			<div class="row">\r
				<div class="cell">Metric</div>\r
				<div class="cell align-end">All</div>\r
				<div class="cell align-end">Long</div>\r
				<div class="cell align-end">Short</div>\r
				<div class="cell align-end"></div>\r
			</div>\r
		</div>\r
		<div class="items" data-ref="metricsItems"></div>\r
	</div>\r
</div>\r
`;var Oi,Ii,$t,cm,um,na,dm;class lm extends I{constructor(){super(...arguments);f(this,$t);f(this,Oi,null);f(this,Ii,new Map)}render(){return a(this,$t,cm).call(this),a(this,$t,um).call(this),this.element}show(){o(this,Oi).css("display","flex")}hide(){o(this,Oi).css("display","none")}}Oi=new WeakMap,Ii=new WeakMap,$t=new WeakSet,cm=function(){this.element=A.htmlToElement(Q_,[],j_),g(this,Oi,M(this.element))},um=function(){b.subscribe(w.EXECUTION_CONTEXT,a(this,$t,na).bind(this)),a(this,$t,na).call(this,b.get(w.EXECUTION_CONTEXT))},na=async function(e){try{let i=[];if(e.id)try{i=await Tr.getPerformanceMetrics(e.id)}catch{i=[]}a(this,$t,dm).call(this,i)}catch(i){console.error("Failed to update metrics.",i)}},dm=function(e){if(!e.length){o(this,Ii).forEach(s=>s.element.remove()),o(this,Ii).clear();return}const i=o(this,Oi).find('[data-ref="metricsItems"]');e.forEach((s,n)=>{let h=o(this,Ii).get(n);h||(h=new bh,o(this,Ii).set(n,h),i.append(h.render())),h.update(s)})},N(lm,"COMPONENT_NAME","PerformanceMetricsTab");const G_="_table_arjnf_11",Z_="_header_arjnf_27",K_="_row_arjnf_39",J_="_cell_arjnf_49",ty="_items_arjnf_79",ey={"risk-metrics-tab":"_risk-metrics-tab_arjnf_1",table:G_,header:Z_,row:K_,cell:J_,"align-end":"_align-end_arjnf_63",items:ty},iy=`<div class="risk-metrics-tab">\r
	<div class="table">\r
		<div class="header">\r
			<div class="row">\r
				<div class="cell">Metric</div>\r
				<div class="cell align-end">All</div>\r
				<div class="cell align-end">Long</div>\r
				<div class="cell align-end">Short</div>\r
				<div class="cell align-end"></div>\r
			</div>\r
		</div>\r
		<div class="items" data-ref="metricsItems"></div>\r
	</div>\r
</div>\r
`;var Ai,ki,Vt,pm,mm,ra,gm;class fm extends I{constructor(){super(...arguments);f(this,Vt);f(this,Ai,null);f(this,ki,new Map)}render(){return a(this,Vt,pm).call(this),a(this,Vt,mm).call(this),this.element}show(){o(this,Ai).css("display","flex")}hide(){o(this,Ai).css("display","none")}}Ai=new WeakMap,ki=new WeakMap,Vt=new WeakSet,pm=function(){this.element=A.htmlToElement(iy,[],ey),g(this,Ai,M(this.element))},mm=function(){b.subscribe(w.EXECUTION_CONTEXT,a(this,Vt,ra).bind(this)),a(this,Vt,ra).call(this,b.get(w.EXECUTION_CONTEXT))},ra=async function(e){try{let i=[];if(e.id)try{i=await Tr.getRiskMetrics(e.id)}catch{i=[]}a(this,Vt,gm).call(this,i)}catch(i){console.error("Failed to update metrics.",i)}},gm=function(e){if(!e.length){o(this,ki).forEach(s=>s.element.remove()),o(this,ki).clear();return}const i=o(this,Ai).find('[data-ref="metricsItems"]');e.forEach((s,n)=>{let h=o(this,ki).get(n);h||(h=new bh,o(this,ki).set(n,h),i.append(h.render())),h.update(s)})},N(fm,"COMPONENT_NAME","RiskMetricsTab");const sy="_table_1xb6b_11",ny="_header_1xb6b_27",ry="_row_1xb6b_39",hy="_cell_1xb6b_49",oy="_items_1xb6b_79",ay={"trade-metrics-tab":"_trade-metrics-tab_1xb6b_1",table:sy,header:ny,row:ry,cell:hy,"align-end":"_align-end_1xb6b_63",items:oy},ly=`<div class="trade-metrics-tab">\r
	<div class="table">\r
		<div class="header">\r
			<div class="row">\r
				<div class="cell">Metric</div>\r
				<div class="cell align-end">All</div>\r
				<div class="cell align-end">Long</div>\r
				<div class="cell align-end">Short</div>\r
				<div class="cell align-end"></div>\r
			</div>\r
		</div>\r
		<div class="items" data-ref="metricsItems"></div>\r
	</div>\r
</div>\r
`;var Ri,zi,Ft,bm,wm,ha,_m;class vm extends I{constructor(){super(...arguments);f(this,Ft);f(this,Ri,null);f(this,zi,new Map)}render(){return a(this,Ft,bm).call(this),a(this,Ft,wm).call(this),this.element}show(){o(this,Ri).css("display","flex")}hide(){o(this,Ri).css("display","none")}}Ri=new WeakMap,zi=new WeakMap,Ft=new WeakSet,bm=function(){this.element=A.htmlToElement(ly,[],ay),g(this,Ri,M(this.element))},wm=function(){b.subscribe(w.EXECUTION_CONTEXT,a(this,Ft,ha).bind(this)),a(this,Ft,ha).call(this,b.get(w.EXECUTION_CONTEXT))},ha=async function(e){try{let i=[];if(e.id)try{i=await Tr.getTradeMetrics(e.id)}catch{i=[]}a(this,Ft,_m).call(this,i)}catch(i){console.error("Failed to update metrics.",i)}},_m=function(e){if(!e.length){o(this,zi).forEach(s=>s.element.remove()),o(this,zi).clear();return}const i=o(this,Ri).find('[data-ref="metricsItems"]');e.forEach((s,n)=>{let h=o(this,zi).get(n);h||(h=new bh,o(this,zi).set(n,h),i.append(h.render())),h.update(s)})},N(vm,"COMPONENT_NAME","TradeMetricsTab");const cy="_table_q3m30_13",uy="_header_q3m30_29",dy="_row_q3m30_41",fy="_cell_q3m30_51",py="_items_q3m30_99",my={"trades-tab":"_trades-tab_q3m30_1",table:cy,header:uy,row:dy,cell:fy,"align-end":"_align-end_q3m30_83",items:py},gy=`<div class="trades-tab">\r
	<div class="table">\r
		<div class="header">\r
			<div class="row">\r
				<div class="cell">\r
					<component-toggle-sorting-button></component-toggle-sorting-button>\r
				</div>\r
				<div class="cell">Type</div>\r
				<div class="cell">Signal</div>\r
				<div class="cell">Date/Time</div>\r
				<div class="cell align-end">Price</div>\r
				<div class="cell align-end">Quantity</div>\r
				<div class="cell align-end">P&L</div>\r
				<div class="cell align-end">Cumulative P&L</div>\r
			</div>\r
		</div>\r
		<div class="items" data-ref="tradesItems"></div>\r
	</div>\r
</div>\r
`,vy={"toggle-sorting-button":"_toggle-sorting-button_7fiwl_1","icon-ascending":"_icon-ascending_7fiwl_21","icon-descending":"_icon-descending_7fiwl_29"},by=`<button class="toggle-sorting-button" data-active="false">\r
	<span>Trade #</span>\r
	<span class="icon-ascending">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			width="16"\r
			height="16"\r
			fill="#6a6d78"\r
			class="bi bi-arrow-up"\r
			viewBox="0 0 16 16"\r
		>\r
			<path\r
				fill-rule="evenodd"\r
				d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5"\r
			/>\r
		</svg>\r
	</span>\r
	<span class="icon-descending">\r
		<svg\r
			xmlns="http://www.w3.org/2000/svg"\r
			width="16"\r
			height="16"\r
			fill="#6a6d78"\r
			class="bi bi-arrow-down"\r
			viewBox="0 0 16 16"\r
		>\r
			<path\r
				fill-rule="evenodd"\r
				d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"\r
			/>\r
		</svg>\r
	</span>\r
</button>\r
`;var Li,ni,Em,Cm,Mm;class ym extends I{constructor({onClick:e}){super();f(this,ni);f(this,Li,null);this.onClick=e}get isActive(){return o(this,Li).is("data-active")}render(){return a(this,ni,Em).call(this),a(this,ni,Cm).call(this),this.element}toggleActiveState(){o(this,Li).data("active",String(!this.isActive))}}Li=new WeakMap,ni=new WeakSet,Em=function(){this.element=A.htmlToElement(by,[],vy),g(this,Li,M(this.element))},Cm=function(){o(this,Li).on("click",a(this,ni,Mm).bind(this))},Mm=function(){var e;this.toggleActiveState(),(e=this.onClick)==null||e.call(this)},N(ym,"COMPONENT_NAME","ToggleSortingButton");const wy="_cell_s94hx_23",_y="_compact_s94hx_85",yy="_red_s94hx_101",Ey="_green_s94hx_109",nn={"trades-item":"_trades-item_s94hx_1",cell:wy,"border-bottom":"_border-bottom_s94hx_43","align-end":"_align-end_s94hx_69",compact:_y,"text-sm":"_text-sm_s94hx_93",red:yy,green:Ey},Cy=`<div class="trades-item">\r
	<div class="cell">\r
		<div data-field="0"></div>\r
	</div>\r
	<div class="cell">\r
		<div data-field="1" class="border-bottom"></div>\r
		<div data-field="2"></div>\r
	</div>\r
	<div class="cell">\r
		<div data-field="3" class="border-bottom"></div>\r
		<div data-field="4"></div>\r
	</div>\r
	<div class="cell">\r
		<div data-field="5" class="border-bottom"></div>\r
		<div data-field="6"></div>\r
	</div>\r
	<div class="cell align-end">\r
		<div data-field="7" class="border-bottom"></div>\r
		<div data-field="8"></div>\r
	</div>\r
	<div class="cell align-end">\r
		<div data-field="9"></div>\r
	</div>\r
	<div class="cell align-end compact">\r
		<span data-field="10"></span>\r
		<span data-field="11" class="text-sm"></span>\r
	</div>\r
	<div class="cell align-end compact">\r
		<span data-field="12"></span>\r
		<span data-field="13" class="text-sm"></span>\r
	</div>\r
</div>\r
`;var Jr,mr,gr,he,Tm,xm,Sm,Nm;const On=class On extends I{constructor(){super(...arguments);f(this,he);f(this,mr,null);f(this,gr,new Map)}render(){return a(this,he,Tm).call(this),a(this,he,xm).call(this),this.element}update(e){o(this,gr).forEach(({element:i,isProfitField:s},n)=>{const h=e[n];i.text(h),s&&a(this,he,Nm).call(this,i,h)})}remove(){this.element.remove()}};Jr=new WeakMap,mr=new WeakMap,gr=new WeakMap,he=new WeakSet,Tm=function(){this.element=A.htmlToElement(Cy,[],nn),g(this,mr,M(this.element))},xm=function(){o(this,mr).findAll("[data-field]").forEach(e=>{const i=Number(e.data("field")),s=a(this,he,Sm).call(this,i);o(this,gr).set(i,{element:e,isProfitField:s})})},Sm=function(e){return o(On,Jr).includes(e)},Nm=function(e,i){i.startsWith("-")?e.removeClass(nn.green).addClass(nn.red):e.removeClass(nn.red).addClass(nn.green)},N(On,"COMPONENT_NAME","TradesItem"),f(On,Jr,[10,11,12,13]);let oa=On;var te,mt,be,Ls,vr,Ue,th,br,wr,eh,V,Im,Am,km,Rm,zm,aa,la,Lm,ca,Ur,Wr;class Om extends I{constructor(){super(...arguments);f(this,V);f(this,te,null);f(this,mt,[]);f(this,be,new Map);f(this,Ls,0);f(this,vr,0);f(this,Ue,100);f(this,th,10);f(this,br,0);f(this,wr,0);f(this,eh,30)}render(){return a(this,V,Im).call(this),a(this,V,Am).call(this),a(this,V,km).call(this),this.element}handleSortingToggle(){o(this,mt).length&&(a(this,V,la).call(this),a(this,V,ca).call(this),a(this,V,Ur).call(this),a(this,V,Wr).call(this))}show(){o(this,te).css("display","flex")}hide(){o(this,te).css("display","none")}}te=new WeakMap,mt=new WeakMap,be=new WeakMap,Ls=new WeakMap,vr=new WeakMap,Ue=new WeakMap,th=new WeakMap,br=new WeakMap,wr=new WeakMap,eh=new WeakMap,V=new WeakSet,Im=function(){this.toggleSortingButton=new ym({onClick:this.handleSortingToggle.bind(this)})},Am=function(){this.element=A.htmlToElement(gy,[this.toggleSortingButton],my),g(this,te,M(this.element))},km=function(){a(this,V,Rm).call(this),a(this,V,aa).call(this,b.get(w.EXECUTION_CONTEXT))},Rm=function(){o(this,te).on("scroll",a(this,V,zm).bind(this)),b.subscribe(w.EXECUTION_CONTEXT,a(this,V,aa).bind(this))},zm=function(){const e=Date.now();e-o(this,wr)<o(this,eh)||(g(this,wr,e),g(this,br,o(this,te).element.scrollTop),a(this,V,Ur).call(this),a(this,V,Wr).call(this))},aa=async function(e){try{let i=[];if(e.id)try{i=await Tr.getTrades(e.id)}catch{i=[]}g(this,mt,[...i]),a(this,V,la).call(this),a(this,V,Lm).call(this),a(this,V,Ur).call(this),a(this,V,Wr).call(this)}catch(i){console.error("Failed to update trades.",i)}},la=function(){for(const e of o(this,be).values())e.element.remove();o(this,be).clear()},Lm=function(){if(o(this,mt).length<2)return;(this.toggleSortingButton.isActive?o(this,mt)[0][0]<o(this,mt)[1][0]:o(this,mt)[0][0]>o(this,mt)[1][0])&&a(this,V,ca).call(this)},ca=function(){o(this,mt).reverse()},Ur=function(){const e=Math.max(o(this,th),Math.ceil(o(this,te).element.clientHeight/o(this,Ue))+2);g(this,Ls,Math.floor(o(this,br)/o(this,Ue))),g(this,vr,Math.min(o(this,Ls)+e-1,o(this,mt).length-1))},Wr=function(){const e=o(this,te).find('[data-ref="tradesItems"]');if(!o(this,mt).length){e.css("height","0px");return}const i=o(this,mt).length*o(this,Ue);e.css("height",`${i}px`);const s=new Map;for(let n=o(this,Ls);n<=o(this,vr);n++){const h=o(this,mt)[n];let l;o(this,be).has(n)?l=o(this,be).get(n):(l=new oa,e.append(l.render()),M(l.element).css({position:"absolute",top:`${n*o(this,Ue)}px`,left:"0",right:"0",height:`${o(this,Ue)}px`}),l.update(h)),s.set(n,l)}for(const[n,h]of o(this,be))s.has(n)||h.element.remove();g(this,be,s)},N(Om,"COMPONENT_NAME","TradesTab");var js,Dm,Bm;class Pm extends I{constructor(){super(...arguments);f(this,js)}render(){return a(this,js,Dm).call(this),a(this,js,Bm).call(this),this.element}showOnly(e){Object.entries(this.tabs).forEach(([i,s])=>{i===e?s.show():s.hide()})}}js=new WeakSet,Dm=function(){this.tabs={overviewMetrics:new im,performanceMetrics:new lm,tradeMetrics:new vm,riskMetrics:new fm,trades:new Om}},Bm=function(){this.element=A.htmlToElement(__,Object.values(this.tabs),w_)},N(Pm,"COMPONENT_NAME","ReportContent");var We,oe,Vm,Fm,Ym,Xm;class $m extends I{constructor({reportHeader:e,onMousedown:i}){super();f(this,oe);f(this,We,null);this.reportHeader=e,this.onMousedown=i}get height(){return parseInt(o(this,We).css("height"))}set height(e){o(this,We).css("height",`${e}px`)}get minHeight(){const e=o(this,We).find('[data-ref="handle"]').css("min-height"),i=this.reportHeader.minHeight;return parseInt(e)+i}render(){return a(this,oe,Vm).call(this),a(this,oe,Fm).call(this),a(this,oe,Ym).call(this),this.element}}We=new WeakMap,oe=new WeakSet,Vm=function(){this.reportContent=new Pm},Fm=function(){this.element=A.htmlToElement(b_,[this.reportHeader,this.reportContent],v_),g(this,We,M(this.element))},Ym=function(){o(this,We).find('[data-ref="handle"]').on("mousedown",a(this,oe,Xm).bind(this)),this.reportHeader.connectButtons(e=>{this.reportContent.showOnly(e)})},Xm=function(e){var i;(i=this.onMousedown)==null||i.call(this,e.clientY)},N($m,"COMPONENT_NAME","ReportPanel");var _r,Ps,qe,Pi,et,Um,Wm,qm,bn,is;class Hm extends I{constructor(){super(...arguments);f(this,et);f(this,_r,null);f(this,Ps);f(this,qe);f(this,Pi)}render(){return a(this,et,Um).call(this),a(this,et,Wm).call(this),a(this,et,qm).call(this),this.element}handleVisibilityToggle(){this.toggleVisibilityButton.isActive?(this.toggleExpansionButton.isActive?this.toggleExpansionButton.toggleActiveState():a(this,et,bn).call(this),a(this,et,is).call(this,o(this,qe))):a(this,et,is).call(this,o(this,Ps))}handleExpansionToggle(){this.toggleExpansionButton.isActive?(this.toggleVisibilityButton.isActive?this.toggleVisibilityButton.toggleActiveState():a(this,et,bn).call(this),a(this,et,is).call(this,o(this,Pi))):a(this,et,is).call(this,o(this,Ps))}handleManualResize(e){a(this,et,bn).call(this);const i=this.reportPanel.height;let s=this.toggleVisibilityButton.isActive,n=this.toggleExpansionButton.isActive;const h=c=>{const u=Math.max(o(this,qe),i+e-c.clientY);a(this,et,is).call(this,u),u===o(this,qe)&&!s?(this.toggleVisibilityButton.toggleActiveState(),s=!s):s&&u>o(this,qe)&&(this.toggleVisibilityButton.toggleActiveState(),s=!s),u>=o(this,Pi)&&!n?(this.toggleExpansionButton.toggleActiveState(),n=!n):n&&u<o(this,Pi)&&(this.toggleExpansionButton.toggleActiveState(),n=!n)},l=()=>{M(document).off("mousemove",h).off("mouseup",l).find("body").removeClass("resizing")};M(document).on("mousemove",h).on("mouseup",l).find("body").addClass("resizing")}}_r=new WeakMap,Ps=new WeakMap,qe=new WeakMap,Pi=new WeakMap,et=new WeakSet,Um=function(){this.chartPanel=new jo,this.toggleVisibilityButton=new kp({onClick:this.handleVisibilityToggle.bind(this)}),this.toggleExpansionButton=new Np({onClick:this.handleExpansionToggle.bind(this)}),this.reportHeader=new Mp({toggleVisibilityButton:this.toggleVisibilityButton,toggleExpansionButton:this.toggleExpansionButton}),this.reportPanel=new $m({reportHeader:this.reportHeader,onMousedown:this.handleManualResize.bind(this)})},Wm=function(){this.element=A.htmlToElement(i1,[this.chartPanel,this.reportPanel],e1),g(this,_r,M(this.element))},qm=function(){requestAnimationFrame(()=>a(this,et,bn).call(this))},bn=function(){g(this,Ps,this.reportPanel.height),g(this,qe,this.reportPanel.minHeight),g(this,Pi,parseInt(o(this,_r).css("height")))},is=function(e){this.chartPanel.height=e,this.reportPanel.height=e},N(Hm,"COMPONENT_NAME","Dashboard");const My=`<div class="notification" data-ref="notification">\r
	<div class="content" data-field="content"></div>\r
</div>\r
`;class jm extends I{render(){return this.element=A.htmlToElement(My,[],Lr),this.element}}N(jm,"COMPONENT_NAME","Notification");const Ty="_toolbox_lvde1_1",xy={toolbox:Ty},Sy=`<div class="toolbox">\r
	<component-screenshot-button></component-screenshot-button>\r
	<component-full-screen-button></component-full-screen-button>\r
	<hr />\r
	<component-trendline-tool-button></component-trendline-tool-button>\r
	<component-ruler-tool-button></component-ruler-tool-button>\r
	<hr />\r
	<component-hide-drawings-button></component-hide-drawings-button>\r
	<component-clear-drawings-button></component-clear-drawings-button>\r
</div>\r
`,Ny={"clear-drawings-button":"_clear-drawings-button_1x3ps_1"},Oy=`<button class="clear-drawings-button" title="Remove Drawings">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M18 7h5v1h-2.01l-1.33 14.64a1.5 1.5 0 0 1-1.5 1.36H9.84a1.5 1.5 0 0 1-1.49-1.36L7.01 8H5V7h5V6c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v1Zm-6-2a1 1 0 0 0-1 1v1h6V6a1 1 0 0 0-1-1h-4ZM8.02 8l1.32 14.54a.5.5 0 0 0 .5.46h8.33a.5.5 0 0 0 .5-.46L19.99 8H8.02Z"\r
		></path>\r
	</svg>\r
</button>\r
`;var yr,ri,Gm,Zm,Km;class Qm extends I{constructor(){super(...arguments);f(this,ri);f(this,yr,null)}render(){return a(this,ri,Gm).call(this),a(this,ri,Zm).call(this),this.element}}yr=new WeakMap,ri=new WeakSet,Gm=function(){this.element=A.htmlToElement(Oy,[],Ny),g(this,yr,M(this.element))},Zm=function(){o(this,yr).on("click",a(this,ri,Km).bind(this))},Km=function(){const e=b.get(w.CHART_API),i=b.get(w.CANDLE_SERIES);if(!e||!i){X.show("warning","No chart data available");return}Nt.removeAll(),Nt.clear()},N(Qm,"COMPONENT_NAME","ClearDrawingsButton");const Iy={"full-screen-button":"_full-screen-button_rj2mh_1"},Ay=`<button class="full-screen-button" title="Full Screen Mode">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<path\r
			fill="currentColor"\r
			d="M8.5 6A2.5 2.5 0 0 0 6 8.5V11h1V8.5C7 7.67 7.67 7 8.5 7H11V6H8.5zM6 17v2.5A2.5 2.5 0 0 0 8.5 22H11v-1H8.5A1.5 1.5 0 0 1 7 19.5V17H6zM19.5 7H17V6h2.5A2.5 2.5 0 0 1 22 8.5V11h-1V8.5c0-.83-.67-1.5-1.5-1.5zM22 19.5V17h-1v2.5c0 .83-.67 1.5-1.5 1.5H17v1h2.5a2.5 2.5 0 0 0 2.5-2.5z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Er,hi,tg,eg,ig;class Jm extends I{constructor(){super(...arguments);f(this,hi);f(this,Er,null)}render(){return a(this,hi,tg).call(this),a(this,hi,eg).call(this),this.element}}Er=new WeakMap,hi=new WeakSet,tg=function(){this.element=A.htmlToElement(Ay,[],Iy),g(this,Er,M(this.element))},eg=function(){o(this,Er).on("click",a(this,hi,ig).bind(this))},ig=function(){var s,n,h,l;const e=M('[data-ref="chartPanel"]').element;if(!e)return;const i=((s=e.requestFullscreen)==null?void 0:s.bind(e))||((n=e.webkitRequestFullscreen)==null?void 0:n.bind(e))||((h=e.mozRequestFullScreen)==null?void 0:h.bind(e))||((l=e.msRequestFullscreen)==null?void 0:l.bind(e));i&&i()},N(Jm,"COMPONENT_NAME","FullScreenButton");const ky={true:"Show drawing objects",false:"Hide drawing objects"},Ry={"hide-drawings-button":"_hide-drawings-button_a2i4m_1","icon-visible":"_icon-visible_a2i4m_11","icon-hidden":"_icon-hidden_a2i4m_19"},zy=`<button class="hide-drawings-button" data-active="false" title="Hide Drawings">\r
	<div class="icon-visible">\r
		<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
			<path\r
				fill="currentColor"\r
				fill-rule="evenodd"\r
				d="M5 10.76l-.41-.72-.03-.04.03-.04a15 15 0 012.09-2.9c1.47-1.6 3.6-3.12 6.32-3.12 2.73 0 4.85 1.53 6.33 3.12a15.01 15.01 0 012.08 2.9l.03.04-.03.04a15 15 0 01-2.09 2.9c-1.47 1.6-3.6 3.12-6.32 3.12-2.73 0-4.85-1.53-6.33-3.12a15 15 0 01-1.66-2.18zm17.45-.98L22 10l.45.22-.01.02a5.04 5.04 0 01-.15.28 16.01 16.01 0 01-2.23 3.1c-1.56 1.69-3.94 3.44-7.06 3.44-3.12 0-5.5-1.75-7.06-3.44a16 16 0 01-2.38-3.38v-.02h-.01L4 10l-.45-.22.01-.02a5.4 5.4 0 01.15-.28 16 16 0 012.23-3.1C7.5 4.69 9.88 2.94 13 2.94c3.12 0 5.5 1.75 7.06 3.44a16.01 16.01 0 012.38 3.38v.02h.01zM22 10l.45-.22.1.22-.1.22L22 10zM3.55 9.78L4 10l-.45.22-.1-.22.1-.22zm6.8.22A2.6 2.6 0 0113 7.44 2.6 2.6 0 0115.65 10 2.6 2.6 0 0113 12.56 2.6 2.6 0 0110.35 10zM13 6.44A3.6 3.6 0 009.35 10 3.6 3.6 0 0013 13.56c2 0 3.65-1.58 3.65-3.56A3.6 3.6 0 0013 6.44zm7.85 12l.8-.8.7.71-.79.8a.5.5 0 000 .7l.59.59c.2.2.5.2.7 0l1.8-1.8.7.71-1.79 1.8a1.5 1.5 0 01-2.12 0l-.59-.59a1.5 1.5 0 010-2.12zM16.5 21.5l-.35-.35a.5.5 0 00-.07.07l-1 1.5-1 1.5a.5.5 0 00.42.78h4a2.5 2.5 0 001.73-.77A2.5 2.5 0 0021 22.5a2.5 2.5 0 00-.77-1.73A2.5 2.5 0 0018.5 20a3.1 3.1 0 00-1.65.58 5.28 5.28 0 00-.69.55v.01h-.01l.35.36zm.39.32l-.97 1.46-.49.72h3.07c.34 0 .72-.17 1.02-.48.3-.3.48-.68.48-1.02 0-.34-.17-.72-.48-1.02-.3-.3-.68-.48-1.02-.48-.35 0-.75.18-1.1.42a4.27 4.27 0 00-.51.4z"\r
			></path>\r
		</svg>\r
	</div>\r
	<div class="icon-hidden">\r
		<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
			<path\r
				fill="currentColor"\r
				fill-rule="evenodd"\r
				d="M19.76 6.07l-.7.7a13.4 13.4 0 011.93 2.47c.19.3.33.55.42.72l.03.04-.03.04a15 15 0 01-2.09 2.9c-1.47 1.6-3.6 3.12-6.32 3.12-.98 0-1.88-.2-2.7-.52l-.77.76c1.03.47 2.18.76 3.47.76 3.12 0 5.5-1.75 7.06-3.44a16 16 0 002.38-3.38v-.02h.01L22 10l.45.22.1-.22-.1-.22L22 10l.45-.22-.01-.02a5.1 5.1 0 00-.15-.28 16 16 0 00-2.53-3.41zM6.24 13.93l.7-.7-.27-.29a15 15 0 01-2.08-2.9L4.56 10l.03-.04a15 15 0 012.09-2.9c1.47-1.6 3.6-3.12 6.32-3.12.98 0 1.88.2 2.7.52l.77-.76A8.32 8.32 0 0013 2.94c-3.12 0-5.5 1.75-7.06 3.44a16 16 0 00-2.38 3.38v.02h-.01L4 10l-.45-.22-.1.22.1.22L4 10l-.45.22.01.02a5.5 5.5 0 00.15.28 16 16 0 002.53 3.41zm6.09-.43a3.6 3.6 0 004.24-4.24l-.93.93a2.6 2.6 0 01-2.36 2.36l-.95.95zm-1.97-3.69l-.93.93a3.6 3.6 0 014.24-4.24l-.95.95a2.6 2.6 0 00-2.36 2.36zm11.29 7.84l-.8.79a1.5 1.5 0 000 2.12l.59.59a1.5 1.5 0 002.12 0l1.8-1.8-.71-.7-1.8 1.79a.5.5 0 01-.7 0l-.59-.59a.5.5 0 010-.7l.8-.8-.71-.7zm-5.5 3.5l.35.35-.35-.35.01-.02.02-.02.02-.02a4.68 4.68 0 01.65-.5c.4-.27 1-.59 1.65-.59.66 0 1.28.33 1.73.77.44.45.77 1.07.77 1.73a2.5 2.5 0 01-.77 1.73 2.5 2.5 0 01-1.73.77h-4a.5.5 0 01-.42-.78l1-1.5 1-1.5a.5.5 0 01.07-.07zm.74.67a3.46 3.46 0 01.51-.4c.35-.24.75-.42 1.1-.42.34 0 .72.17 1.02.48.3.3.48.68.48 1.02 0 .34-.17.72-.48 1.02-.3.3-.68.48-1.02.48h-3.07l.49-.72.97-1.46zM21.2 2.5L5.5 18.2l-.7-.7L20.5 1.8l.7.7z"\r
			></path>\r
		</svg>\r
	</div>\r
</button>\r
`;var Di,At,ng,rg,hg,og,ua;class sg extends I{constructor({onActivate:e}){super();f(this,At);f(this,Di,null);this.onActivate=e}render(){return a(this,At,rg).call(this),a(this,At,hg).call(this),this.element}deactivate(){a(this,At,ua).call(this,!1)}}Di=new WeakMap,At=new WeakSet,ng=function(){return o(this,Di).is("data-active")},rg=function(){this.element=A.htmlToElement(zy,[],Ry),g(this,Di,M(this.element))},hg=function(){o(this,Di).on("click",a(this,At,og).bind(this))},og=function(){var n;const e=b.get(w.CHART_API),i=b.get(w.CANDLE_SERIES);if(!e||!i){X.show("warning","No chart data available");return}const s=!o(this,At,ng);a(this,At,ua).call(this,s),s&&((n=this.onActivate)==null||n.call(this))},ua=function(e){o(this,Di).data("active",e).attr("title",ky[e?"true":"false"]),e?Nt.hide():Nt.show()},N(sg,"COMPONENT_NAME","HideDrawingsButton");const Ly={"ruler-tool-button":"_ruler-tool-button_njj72_1"},Py=`<button class="ruler-tool-button" data-active="false" title="Measure">\r
	<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28">\r
		<path\r
			fill="currentColor"\r
			d="M2 9.75a1.5 1.5 0 0 0-1.5 1.5v5.5a1.5 1.5 0 0 0 1.5 1.5h24a1.5 1.5 0 0 0 1.5-1.5v-5.5a1.5 1.5 0 0 0-1.5-1.5zm0 1h3v2.5h1v-2.5h3.25v3.9h1v-3.9h3.25v2.5h1v-2.5h3.25v3.9h1v-3.9H22v2.5h1v-2.5h3a.5.5 0 0 1 .5.5v5.5a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-5.5a.5.5 0 0 1 .5-.5z"\r
			transform="rotate(-45 14 14)"\r
		></path>\r
	</svg>\r
</button>\r
`;var je,bt,da,lg,cg,ug,dg,fg;class ag extends I{constructor({onActivate:e}){super();f(this,bt);f(this,je,null);this.onActivate=e}render(){return a(this,bt,lg).call(this),a(this,bt,cg).call(this),this.element}deactivate(){const e=b.get(w.RULER_TOOL);!o(this,bt,da)||!e||(o(this,je).data("active","false"),this.element.blur(),e.deactivate())}}je=new WeakMap,bt=new WeakSet,da=function(){return o(this,je).is("data-active")},lg=function(){this.element=A.htmlToElement(Py,[],Ly),g(this,je,M(this.element))},cg=function(){o(this,je).on("click",a(this,bt,ug).bind(this)),b.subscribe(w.RULER_ACTIVE,a(this,bt,dg).bind(this))},ug=function(){var e;if(o(this,bt,da))this.deactivate();else{const i=b.get(w.CHART_API),s=b.get(w.CANDLE_SERIES);if(!i||!s){X.show("warning","No chart data available");return}a(this,bt,fg).call(this),(e=this.onActivate)==null||e.call(this)}},dg=function(e){e||this.deactivate()},fg=function(){const e=b.get(w.RULER_TOOL);e&&(o(this,je).data("active","true"),e.initialize())},N(ag,"COMPONENT_NAME","RulerToolButton");const Dy={"screenshot-button":"_screenshot-button_ir7q9_1"},By=`<button class="screenshot-button" title="Take Screenshot">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		width="28"\r
		height="28"\r
		fill="currentColor"\r
	>\r
		<path\r
			fill-rule="evenodd"\r
			clip-rule="evenodd"\r
			d="M11.118 6a.5.5 0 0 0-.447.276L9.809 8H5.5A1.5 1.5 0 0 0 4 9.5v10A1.5 1.5 0 0 0 5.5 21h16a1.5 1.5 0 0 0 1.5-1.5v-10A1.5 1.5 0 0 0 21.5 8h-4.309l-.862-1.724A.5.5 0 0 0 15.882 6h-4.764zm-1.342-.17A1.5 1.5 0 0 1 11.118 5h4.764a1.5 1.5 0 0 1 1.342.83L17.809 7H21.5A2.5 2.5 0 0 1 24 9.5v10a2.5 2.5 0 0 1-2.5 2.5h-16A2.5 2.5 0 0 1 3 19.5v-10A2.5 2.5 0 0 1 5.5 7h3.691l.585-1.17z"\r
		></path>\r
		<path\r
			fill-rule="evenodd"\r
			clip-rule="evenodd"\r
			d="M13.5 18a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7zm0 1a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9z"\r
		></path>\r
	</svg>\r
</button>\r
`;var Cr,ae,mg,gg,vg,bg;class pg extends I{constructor(){super(...arguments);f(this,ae);f(this,Cr,null)}render(){return a(this,ae,mg).call(this),a(this,ae,gg).call(this),this.element}}Cr=new WeakMap,ae=new WeakSet,mg=function(){this.element=A.htmlToElement(By,[],Dy),g(this,Cr,M(this.element))},gg=function(){o(this,Cr).on("click",a(this,ae,vg).bind(this))},vg=function(){const e=b.get(w.CHART_API),i=b.get(w.CANDLE_SERIES);if(!e||!i){X.show("warning","No chart data available");return}e.takeScreenshot().toBlob(a(this,ae,bg),"image/png",1)},bg=function(e){const i=URL.createObjectURL(e),s=window.open(i,"_blank");s&&(s.onload=()=>URL.revokeObjectURL(i))},N(pg,"COMPONENT_NAME","ScreenshotButton");const $y={"trendline-tool-button":"_trendline-tool-button_1havz_1"},Vy=`<button class="trendline-tool-button" data-active="false" title="Trend Line">\r
	<svg\r
		xmlns="http://www.w3.org/2000/svg"\r
		viewBox="0 0 28 28"\r
		width="28"\r
		height="28"\r
	>\r
		<g fill="currentColor" fill-rule="nonzero">\r
			<path d="M7.354 21.354l14-14-.707-.707-14 14z"></path>\r
			<path\r
				d="M22.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"\r
			></path>\r
		</g>\r
	</svg>\r
</button>\r
`;var Qe,Ds,Rt,it,fa,_g,yg,Eg,Cg,Mg,Tg,xg;class wg extends I{constructor({onActivate:e}){super();f(this,it);f(this,Qe,null);f(this,Ds,null);f(this,Rt,[]);this.onActivate=e}render(){return a(this,it,_g).call(this),a(this,it,yg).call(this),this.element}deactivate(){o(this,it,fa)&&(o(this,Qe).data("active","false"),this.element.blur(),g(this,Rt,[]),a(this,it,Tg).call(this))}}Qe=new WeakMap,Ds=new WeakMap,Rt=new WeakMap,it=new WeakSet,fa=function(){return o(this,Qe).is("data-active")},_g=function(){this.element=A.htmlToElement(Vy,[],$y),g(this,Qe,M(this.element))},yg=function(){o(this,Qe).on("click",a(this,it,Eg).bind(this)),g(this,Ds,a(this,it,xg).bind(this)),b.subscribe(w.CANDLE_SERIES,this.deactivate.bind(this))},Eg=function(){var e;if(o(this,it,fa))this.deactivate();else{if(!b.get(w.CANDLE_SERIES)){X.show("warning","No chart data available");return}a(this,it,Cg).call(this),(e=this.onActivate)==null||e.call(this)}},Cg=function(){o(this,Qe).data("active","true"),a(this,it,Mg).call(this),X.show("info","Select two points on the chart")},Mg=function(){const e=b.get(w.CHART_API);e&&e.subscribeClick(o(this,Ds))},Tg=function(){const e=b.get(w.CHART_API);e&&e.unsubscribeClick(o(this,Ds))},xg=function({time:e,point:i}){const s=b.get(w.CHART_API),n=b.get(w.CANDLE_SERIES);if(!s||!n){X.show("warning","No chart data available");return}if(!s||!n)return;const h=e,l=n.coordinateToPrice(i.y);if(!h){X.show("warning","Cannot draw a line outside the chart area"),this.deactivate();return}if(!o(this,Rt).length){o(this,Rt).push({time:h,value:l});return}if(h===o(this,Rt)[0].time){X.show("warning","Cannot draw a vertical line"),this.deactivate();return}const c={time:h,value:l};h>o(this,Rt)[0].time?o(this,Rt).push(c):o(this,Rt).unshift(c),Nt.renderSeries(Fo,ff,o(this,Rt)),Nt.add("trendlines",o(this,Rt)),this.deactivate()},N(wg,"COMPONENT_NAME","TrendlineToolButton");var le,Ng,Og,Ig,Ag;class Sg extends I{constructor(){super(...arguments);f(this,le)}render(){return a(this,le,Ng).call(this),a(this,le,Og).call(this),a(this,le,Ig).call(this),this.element}handleTrendlineToolActivate(){this.rulerToolButton.deactivate(),this.hideDrawingsButton.deactivate()}handleRulerToolActivate(){this.trendlineToolButton.deactivate()}handleHideDrawingsButtonActivate(){this.trendlineToolButton.deactivate()}}le=new WeakSet,Ng=function(){this.trendlineToolButton=new wg({onActivate:this.handleTrendlineToolActivate.bind(this)}),this.rulerToolButton=new ag({onActivate:this.handleRulerToolActivate.bind(this)}),this.hideDrawingsButton=new sg({onActivate:this.handleHideDrawingsButtonActivate.bind(this)})},Og=function(){this.element=A.htmlToElement(Sy,[pg,Jm,this.trendlineToolButton,this.rulerToolButton,this.hideDrawingsButton,Qm],xy)},Ig=function(){document.addEventListener("keydown",a(this,le,Ag).bind(this))},Ag=function(e){e.key==="Escape"&&(this.trendlineToolButton.deactivate(),this.rulerToolButton.deactivate())},N(Sg,"COMPONENT_NAME","Toolbox");class kg extends I{render(){return this.element=A.htmlToElement(nv,[Sg,Hm,Pd,jm],sv),this.element}}N(kg,"COMPONENT_NAME","App");class Fy extends Qs{async getExchanges(){return this._executeRequest({path:"/data/exchanges",method:"GET",errorMessage:"Failed to load supported exchanges"})}async getIntervals(){return this._executeRequest({path:"/data/intervals",method:"GET",errorMessage:"Failed to load supported intervals"})}async getStrategies(){return this._executeRequest({path:"/data/strategies",method:"GET",errorMessage:"Failed to load strategy registry"})}}const Xh=new Fy;class Yy{static async start(){try{console.log("Initializing state..."),await this.initState(),console.log("Initializing services..."),this.initServices(),console.log("Rendering app..."),this.renderApp(),console.log("App initialized successfully!")}catch(t){console.error("App initialization failed:",t)}}static async initState(){const[t,e,i,s]=await Promise.all([Xh.getStrategies(),Xh.getExchanges(),Xh.getIntervals(),St.getAll()]);if(!Object.keys(t).length)throw new Error("No available strategies");const n=Object.keys(s).length?{id:Object.keys(s)[0],...Object.values(s)[0]}:{};b.set(w.STRATEGIES,t),b.set(w.EXCHANGES,e),b.set(w.INTERVALS,i),b.set(w.EXECUTION_CONTEXTS,s),b.set(w.EXECUTION_CONTEXT,n)}static initServices(){Nt.init(),tv.init(),Pr.init()}static renderApp(){M("#app").append(new kg().render())}}requestAnimationFrame(()=>{Yy.start()});
