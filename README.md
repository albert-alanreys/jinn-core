# TVLite
Программа для оптимизации, тестирования и автоматизации стратегий.

## Установка
Для работы программы потребуется интерпретатор Python и ряд библиотек Python.
- [Скачайте](https://www.python.org/downloads/release/python-3117/) и установите интерпретатор Python версии 3.11.7.
- Запустите командную строку (cmd.exe), перейдите в корневую директорию программы (например, `cd C:\Trading\TVLite`) и командой `pip install -r requirements.txt` установите необходимые библиотеки Python.

## Оптимизация
Оптимизация — это поиск оптимальных значений параметров стратегии. То есть таких значений, при которых стратегия будет иметь отличные торговые показатели. Данная программа выполняет оптимизацию в автоматическом режиме.

Как выполнить оптимизацию одной стратегии?
- Откройте файл starter.py как текстовый документ.
- Присвойте переменной `mode` значение `'optimization'` (`mode = 'optimization'`).
- Укажите приемлемые для вас значения ключей словаря `optimization`. Ключ `'exchange'` определяет биржу (`'binance'` или `'bybit'`). Ключ `'symbol'` определяет торговый символ (прямой фьючерсный контракт). Ключ `'interval'` определяет [таймфрейм](`Примечания). Ключ `'date/time #1'` определяет дату и время первого бара обучающей выборки. Ключ `'date/time #2'` определяет дату и время последнего бара обучающей выборки, а также дату и время первого бара тестовой выборки #1. Ключ `'date/time #3'` определяет дату и время последнего бара тестовой выборки #1, а также дату и время первого бара тестовой выборки #2. Ключ `'date/time #4'` определяет дату и время последнего бара тестовой выборки #2. Ключ `'strategy'` определяет стратегию (см. словарь `strategies` файла starter.py).
- Запустите командную строку, перейдите в корневую директорию программы и командой `python starter.py` запустите программу. По завершении оптимизации в папке optimization (например, в C:\Trading\TVLite\strategies\nugget_v2\optimization) будет создан файл с подобранными параметрами.

Как выполнить оптимизацию множества стратегий?
- Откройте файл starter.py как текстовый документ.
- Присвойте переменной `mode` значение `'optimization'` (`mode = 'optimization'`).
- Создайте JSON-файлы оптимизации optimization.json в папках optimization. Пример JSON-файла представлен в папке help.
- Запустите программу. По завершении оптимизации в папках `optimization` будут созданы файлы с подобранными параметрами.

## Тестирование
Тестирование — это расчет сигналов стратегии на выборке баров с последующим формированием статистики сделок и торговых показателей.

Как выполнить тестирование одной стратегии?
- Откройте файл starter.py как текстовый документ.
- Присвойте переменной `mode` значение `'testing'` (`mode = 'testing'`).
- Укажите приемлемые для вас значения ключей словаря `testing`. Ключ `'exchange'` определяет биржу (`'binance'` или `'bybit'`). Ключ `'symbol'` определяет торговый символ (прямой фьючерсный контракт). Ключ `'interval'` определяет [таймфрейм](`Примечания). Ключ `'date/time #1'` определяет дату и время первого бара тестовой выборки. Ключ `'date/time #2'` определяет дату и время последнего бара тестовой выборки. Ключ `'strategy'` определяет стратегию (см. словарь `strategies` файла `starter.py`).
- Откройте файл интересующей вас стратегии (например, nugget_v2.py) как текстовый документ.
- Укажите приемлемые для вас значения параметров стратегии.
- Запустите программу. После завершения тестирования будет создан Flask сервер с доступом по URL http://127.0.0.1:8080.

Как выполнить тестирование множества стратегий?
- Откройте файл starter.py как текстовый документ.
- Присвойте переменной `mode` значение `'testing'` (`mode = 'testing'`).
- Перенесите из папок optimization в папки backtesting интересующие вас файлы с подобранными параметрами. Файлы можно дополнительно отредактировать: изменить временные рамки для тестирования в первой строке файла. Также, чтобы сохранить временные рамки оптимизации, можно продублировать первую строку файла и в первой строке изменить временные рамки.
- Запустите программу. После завершения тестирования будет создан Flask сервер с доступом по URL http://127.0.0.1:8080.

## Автоматизация
Автоматизация — это расчет стратегии в реальном времени и передача команд о торговых операциях на биржу.

Как выполнить автоматизацию одной стратегий?
- Укажите в файле .env токены аккаунта биржи Bybit и/или Binance, а также, при необходимости, токен вашего [телеграмм бота](https://t.me/BotFather) и ID вашего [телеграмм аккаунта](https://t.me/userinfobot) для отправки торговой информации в телеграмм. Данные должны быть указаны без кавычек.
- Откройте файл starter.py как текстовый документ.
- Присвойте переменной `mode` значение `'automation'` (`mode = 'automation'`).
- Укажите приемлемые для вас значения ключей словаря `automation`. Ключ `'exchange'` определяет биржу (`'binance'` или `'bybit'`). Ключ `'symbol'` определяет торговый символ (прямой фьючерсный контракт). Ключ `'interval'` определяет [таймфрейм](`Примечания). Ключ `'strategy'` определяет стратегию (см. словарь `strategies` файла starter.py).
- Откройте файл интересующей вас стратегии (например, nugget_v2.py) как текстовый документ.
- Укажите приемлемые для вас значения параметров стратегии.
- Запустите программу. В результате будет создан Flask сервер с доступом по URL http://127.0.0.1:8080.

Как выполнить автоматизацию множества стратегий?
- Укажите в файле .env API-ключ аккаунта биржи Bybit и/или Binance, а также, при необходимости, токен вашего [телеграмм бота](https://t.me/BotFather) и ID вашего [телеграмм аккаунта](https://t.me/userinfobot) для отправки торговой информации в телеграмм. Данные должны быть указаны без кавычек.
- Откройте файл starter.py как текстовый документ.
- Присвойте переменной `mode` значение `'automation'` (`mode = 'automation'`).
- В папках automation создайте текстовые файлы автоматизации. Для каждой стратегии можно создать несколько файлов. Название файла должно содержать название биржи, символ фьючерсного контракта и таймфрейм графика (например, bybit_ETHUSDT_1.txt). Каждый файл должен содержать параметры стратегии со значениями. Пример файла автоматизации представлен в папке help.
- Запустите программу. В результате будет создан Flask сервер с доступом по URL http://127.0.0.1:8080.

## Примечания:
- Рекомендуется периодически синхронизировать время на компьютере. Иначе биржа может игнорировать запросы программы и присылать вот такие ошибки: timestamp for this request was 1000ms ahead of the server's time.
- Для указания таймфреймов используйте [REST API Bybit](https://bybit-exchange.github.io/docs/v5/market/kline) или [REST API Binance](https://python-binance.readthedocs.io/en/latest/constants.html).
- Оптимизация основана на [генетическом алгоритме](https://neurohive.io/ru/osnovy-data-science/chto-takoe-geneticheskie-algoritmy/) и реализована в файле optimizer.py.
- Для удалённого доступа к Flask серверу можно организовать туннель с помощью ngrok или подобной программы. URL, предоставленный такой программой, необходимо указать в файле .env.
